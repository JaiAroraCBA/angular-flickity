!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("angular-flickity",[],e):"object"==typeof exports?exports["angular-flickity"]=e():t["angular-flickity"]=e()}(this,function(){return function(t){function e(n){if(i[n])return i[n].exports;var s=i[n]={exports:{},id:n,loaded:!1};return t[n].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(22),r=i(24),a=i(26);angular.module("bc.Flickity",[]).provider("FlickityConfig",n.FlickityConfigProvider).service("FlickityService",s.FlickityService).directive("bcFlickity",o.FlickityDirective).directive("bcFlickityNext",r.FlickityNextDirective).directive("bcFlickityPrevious",a.FlickityPreviousDirective)},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();e.FlickityConfigProvider=function(){function t(){i(this,t),this.accessibility=!0,this.adaptiveHeight=!1,this.autoPlay=!1,this.cellAlign="center",this.cellSelector=void 0,this.contain=!1,this.draggable=!0,this.dragThreshold=3,this.freeScroll=!1,this.freeScrollFriction=!1,this.selectedAttraction=.025,this.friction=.28,this.groupCells=!1,this.initialIndex=0,this.lazyLoad=!0,this.percentPosition=!0,this.prevNextButtons=!0,this.pageDots=!0,this.resize=!0,this.rightToLeft=!1,this.setGallerySize=!0,this.watchCSS=!1,this.wrapAround=!1,this.imagesLoaded=!0,this.asNavFor=!0}return n(t,[{key:"$get",value:function(){return this}}]),t}()},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.FlickityService=void 0;var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=i(3),a=n(r);i(21);e.FlickityService=function(){function t(e,i,n,o){"ngInject";s(this,t),this.$timeout=e,this.$q=i,this.$rootScope=n,this.$log=o,this.instances=[]}return t.$inject=["$timeout","$q","$rootScope","$log"],o(t,[{key:"create",value:function(t){var e=this,i=arguments.length<=1||void 0===arguments[1]?this.instances.length+1:arguments[1],n=arguments[2];return new Promise(function(s,o){if(e._findObjectById(e.instances,i)){var r=e._getFlickityIndex(i);e.$log.error("This ID is already in use: ",e.instances[r]),o()}var c={id:i,instance:new a["default"](t,n)};e.instances.push(c),e._bindEvents(i).then(function(){s(c)})})}},{key:"destroy",value:function(t){var e=this;return new Promise(function(i,n){var s=e._getFlickityIndex(t);s<0&&n("Instance "+t+" not found"),e.instances[s].instance.destroy(),e.instances.splice(s,1),i("Instance "+t+" destroyed.")})}},{key:"next",value:function(t,e,i){var n=this;return this.$q(function(s,o){var r=n._getFlickityIndex(t);r<0?o("Instance "+t+" not found"):(n.instances[r].instance.next(e,i),s(n.instances[r]))})}},{key:"previous",value:function(t,e,i){var n=this;return this.$q(function(s,o){var r=n._getFlickityIndex(t);r<0?o("Instance "+t+" not found"):(n.instances[r].instance.previous(e,i),s(n.instances[r]))})}},{key:"select",value:function(t,e){var i=this,n=!(arguments.length<=2||void 0===arguments[2])&&arguments[2],s=!(arguments.length<=3||void 0===arguments[3])&&arguments[3];return this.$q(function(o,r){var a=i._getFlickityIndex(t);a<0?r("Instance "+t+" not found"):(i.instances[a].instance.select(e,n,s),o(i.instances[a]))})}},{key:"selectCell",value:function(t,e){var i=this,n=!(arguments.length<=2||void 0===arguments[2])&&arguments[2],s=!(arguments.length<=3||void 0===arguments[3])&&arguments[3];return this.$q(function(o,r){var a=i._getFlickityIndex(t);a<0?r("Instance "+t+" not found"):(i.instances[a].instance.selectCell(e,n,s),o(i.instances[a]))})}},{key:"selectedIndex",value:function(t){var e=this;return this.$q(function(i,n){var s=e._getFlickityIndex(t);s<0?n("Instance "+t+" not found"):i(e.instances[s].instance.selectedIndex)})}},{key:"resize",value:function(t){var e=this;return this.$q(function(i,n){var s=e._getFlickityIndex(t);s<0?n("Instance "+t+" not found"):(e.instances[s].instance.resize(),i(e.instances[s]))})}},{key:"reposition",value:function(t){var e=this;return this.$q(function(i,n){var s=e._getFlickityIndex(t);s<0?n("Instance "+t+" not found"):(e.instances[s].instance.reposition(),i(e.instances[s]))})}},{key:"reloadCells",value:function(t){var e=this;return this.$q(function(i,n){var s=e._getFlickityIndex(t);s<0?n("Instance "+t+" not found"):(e.instances[s].instance.reloadCells(),i(e.instances[s]))})}},{key:"get",value:function(t){var e=this;return this.$q(function(i,n){var s=e._getFlickityIndex(t);s<0?n("Instance "+t+" not found"):i(e.instances[s])})}},{key:"getFirst",value:function(){var t=this;return this.$q(function(e,i){!t.instances||t.instances.length<1?i("No instances exist"):e(t.instances[0])})}},{key:"getByElement",value:function(t){return this.$q(function(e,i){var n=a["default"].data(t);n?e(n):i("Instance not found for "+t)})}},{key:"prepend",value:function(t,e){var i=this;return this.$q(function(n,s){var o=i._getFlickityIndex(t);o<0?s("Instance "+t+" not found"):(i.instances[o].instance.prepend(e),n(i.instances[o]))})}},{key:"append",value:function(t,e){var i=this;return this.$q(function(n,s){var o=i._getFlickityIndex(t);o<0?s("Instance "+t+" not found"):(i.instances[o].instance.append(e),n(i.instances[o]))})}},{key:"insert",value:function(t,e,i){var n=this;return this.$q(function(s,o){var r=n._getFlickityIndex(t);r<0?o("Instance "+t+" not found"):(n.instances[r].instance.insert(e,i),s(n.instances[r]))})}},{key:"getCellElements",value:function(t){var e=this;return this.$q(function(i,n){var s=e._getFlickityIndex(t);s<0?n("Instance "+t+" not found"):i(e.instances[s].instance.getCellElements())})}},{key:"remove",value:function(t,e){var i=this;return this.$q(function(n,s){var o=i._getFlickityIndex(t);o<0?s("Instance "+t+" not found"):(i.instances[o].instance.remove(e),n(i.instances[o]))})}},{key:"selectedElement",value:function(t){var e=this;return this.$q(function(i,n){var s=e._getFlickityIndex(t);s<0?n("Instance "+t+" not found"):i(e.instances[s].instance.selectedElement)})}},{key:"cells",value:function(t){var e=this;return this.$q(function(i,n){var s=e._getFlickityIndex(t);s<0?n("Instance "+t+" not found"):i(e.instances[s].instance.cells)})}},{key:"_getFlickityIndex",value:function(t){var e=void 0;return this.instances.length?this.instances.forEach(function(i,n){i.id===t&&(e=n)}):e=-1,e}},{key:"_bindEvents",value:function(t){var e=this;return this.$q(function(i,n){var s=e._getFlickityIndex(t);s<0&&n();var o=e.instances[s].id;e.instances[s].instance.on("select",function(){e.$rootScope.$emit("Flickity:"+o+":select",e.instances[s])}),e.instances[s].instance.on("settle",function(){e.$rootScope.$emit("Flickity:"+o+":settle",e.instances[s])}),e.instances[s].instance.on("scroll",function(t,i){e.$rootScope.$emit("Flickity:"+o+":scroll",{progress:t,positionX:i})}),e.instances[s].instance.on("dragStart",function(t,i){e.$rootScope.$emit("Flickity:"+o+":dragStart",{event:t,pointer:i})}),e.instances[s].instance.on("dragMove",function(t,i,n){e.$rootScope.$emit("Flickity:"+o+":dragMove",{event:t,pointer:i,moveVector:n})}),e.instances[s].instance.on("dragEnd",function(t,i){e.$rootScope.$emit("Flickity:"+o+":dragEnd",{event:t,pointer:i})}),e.instances[s].instance.on("pointerDown",function(t,i){e.$rootScope.$emit("Flickity:"+o+":pointerDown",{event:t,pointer:i})}),e.instances[s].instance.on("pointerMove",function(t,i,n){e.$rootScope.$emit("Flickity:"+o+":pointerMove",{event:t,pointer:i,moveVector:n})}),e.instances[s].instance.on("pointerUp",function(t,i){e.$rootScope.$emit("Flickity:"+o+":pointerUp",{event:t,pointer:i})}),e.instances[s].instance.on("staticClick",function(t,i,n,s){e.$rootScope.$emit("Flickity:"+o+":staticClick",{event:t,pointer:i,cellElement:n,cellIndex:s})}),e.instances[s].instance.on("lazyLoad",function(t,i){e.$rootScope.$emit("Flickity:"+o+":lazyLoad",{event:t,cellElement:i})}),i(!0)})}},{key:"_findObjectById",value:function(t,e){return t.filter(function(t){return t.id===e})[0]}}]),t}()},function(t,e,i){var n,s,o;/*!
	 * Flickity v2.0.3
	 * Touch, responsive, flickable carousels
	 *
	 * Licensed GPLv3 for open source use
	 * or Flickity Commercial License for commercial use
	 *
	 * http://flickity.metafizzy.co
	 * Copyright 2016 Metafizzy
	 */
!function(r,a){s=[i(4),i(12),i(15),i(17),i(18),i(19),i(20)],n=a,o="function"==typeof n?n.apply(e,s):n,!(void 0!==o&&(t.exports=o))}(window,function(t){return t})},function(t,e,i){var n,s;!function(o,r){n=[i(5),i(6),i(7),i(9),i(10),i(11)],s=function(t,e,i,n,s,a){return r(o,t,e,i,n,s,a)}.apply(e,n),!(void 0!==s&&(t.exports=s))}(window,function(t,e,i,n,s,o,r){"use strict";function a(t,e){for(t=n.makeArray(t);t.length;)e.appendChild(t.shift())}function c(t,e){var i=n.getQueryElement(t);if(!i)return void(u&&u.error("Bad element for Flickity: "+(i||t)));if(this.element=i,this.element.flickityGUID){var s=f[this.element.flickityGUID];return s.option(e),s}l&&(this.$element=l(this.element)),this.options=n.extend({},this.constructor.defaults),this.option(e),this._create()}var l=t.jQuery,h=t.getComputedStyle,u=t.console,d=0,f={};c.defaults={accessibility:!0,cellAlign:"center",freeScrollFriction:.075,friction:.28,namespaceJQueryEvents:!0,percentPosition:!0,resize:!0,selectedAttraction:.025,setGallerySize:!0},c.createMethods=[];var p=c.prototype;n.extend(p,e.prototype),p._create=function(){var e=this.guid=++d;this.element.flickityGUID=e,f[e]=this,this.selectedIndex=0,this.restingFrames=0,this.x=0,this.velocity=0,this.originSide=this.options.rightToLeft?"right":"left",this.viewport=document.createElement("div"),this.viewport.className="flickity-viewport",this._createSlider(),(this.options.resize||this.options.watchCSS)&&t.addEventListener("resize",this),c.createMethods.forEach(function(t){this[t]()},this),this.options.watchCSS?this.watchCSS():this.activate()},p.option=function(t){n.extend(this.options,t)},p.activate=function(){if(!this.isActive){this.isActive=!0,this.element.classList.add("flickity-enabled"),this.options.rightToLeft&&this.element.classList.add("flickity-rtl"),this.getSize();var t=this._filterFindCellElements(this.element.children);a(t,this.slider),this.viewport.appendChild(this.slider),this.element.appendChild(this.viewport),this.reloadCells(),this.options.accessibility&&(this.element.tabIndex=0,this.element.addEventListener("keydown",this)),this.emitEvent("activate");var e,i=this.options.initialIndex;e=this.isInitActivated?this.selectedIndex:void 0!==i&&this.cells[i]?i:0,this.select(e,!1,!0),this.isInitActivated=!0}},p._createSlider=function(){var t=document.createElement("div");t.className="flickity-slider",t.style[this.originSide]=0,this.slider=t},p._filterFindCellElements=function(t){return n.filterFindElements(t,this.options.cellSelector)},p.reloadCells=function(){this.cells=this._makeCells(this.slider.children),this.positionCells(),this._getWrapShiftCells(),this.setGallerySize()},p._makeCells=function(t){var e=this._filterFindCellElements(t),i=e.map(function(t){return new s(t,this)},this);return i},p.getLastCell=function(){return this.cells[this.cells.length-1]},p.getLastSlide=function(){return this.slides[this.slides.length-1]},p.positionCells=function(){this._sizeCells(this.cells),this._positionCells(0)},p._positionCells=function(t){t=t||0,this.maxCellHeight=t?this.maxCellHeight||0:0;var e=0;if(t>0){var i=this.cells[t-1];e=i.x+i.size.outerWidth}for(var n=this.cells.length,s=t;s<n;s++){var o=this.cells[s];o.setPosition(e),e+=o.size.outerWidth,this.maxCellHeight=Math.max(o.size.outerHeight,this.maxCellHeight)}this.slideableWidth=e,this.updateSlides(),this._containSlides(),this.slidesWidth=n?this.getLastSlide().target-this.slides[0].target:0},p._sizeCells=function(t){t.forEach(function(t){t.getSize()})},p.updateSlides=function(){if(this.slides=[],this.cells.length){var t=new o(this);this.slides.push(t);var e="left"==this.originSide,i=e?"marginRight":"marginLeft",n=this._getCanCellFit();this.cells.forEach(function(e,s){if(!t.cells.length)return void t.addCell(e);var r=t.outerWidth-t.firstMargin+(e.size.outerWidth-e.size[i]);n.call(this,s,r)?t.addCell(e):(t.updateTarget(),t=new o(this),this.slides.push(t),t.addCell(e))},this),t.updateTarget(),this.updateSelectedSlide()}},p._getCanCellFit=function(){var t=this.options.groupCells;if(!t)return function(){return!1};if("number"==typeof t){var e=parseInt(t,10);return function(t){return t%e!==0}}var i="string"==typeof t&&t.match(/^(\d+)%$/),n=i?parseInt(i[1],10)/100:1;return function(t,e){return e<=(this.size.innerWidth+1)*n}},p._init=p.reposition=function(){this.positionCells(),this.positionSliderAtSelected()},p.getSize=function(){this.size=i(this.element),this.setCellAlign(),this.cursorPosition=this.size.innerWidth*this.cellAlign};var v={center:{left:.5,right:.5},left:{left:0,right:1},right:{right:0,left:1}};return p.setCellAlign=function(){var t=v[this.options.cellAlign];this.cellAlign=t?t[this.originSide]:this.options.cellAlign},p.setGallerySize=function(){if(this.options.setGallerySize){var t=this.options.adaptiveHeight&&this.selectedSlide?this.selectedSlide.height:this.maxCellHeight;this.viewport.style.height=t+"px"}},p._getWrapShiftCells=function(){if(this.options.wrapAround){this._unshiftCells(this.beforeShiftCells),this._unshiftCells(this.afterShiftCells);var t=this.cursorPosition,e=this.cells.length-1;this.beforeShiftCells=this._getGapCells(t,e,-1),t=this.size.innerWidth-this.cursorPosition,this.afterShiftCells=this._getGapCells(t,0,1)}},p._getGapCells=function(t,e,i){for(var n=[];t>0;){var s=this.cells[e];if(!s)break;n.push(s),e+=i,t-=s.size.outerWidth}return n},p._containSlides=function(){if(this.options.contain&&!this.options.wrapAround&&this.cells.length){var t=this.options.rightToLeft,e=t?"marginRight":"marginLeft",i=t?"marginLeft":"marginRight",n=this.slideableWidth-this.getLastCell().size[i],s=n<this.size.innerWidth,o=this.cursorPosition+this.cells[0].size[e],r=n-this.size.innerWidth*(1-this.cellAlign);this.slides.forEach(function(t){s?t.target=n*this.cellAlign:(t.target=Math.max(t.target,o),t.target=Math.min(t.target,r))},this)}},p.dispatchEvent=function(t,e,i){var n=e?[e].concat(i):i;if(this.emitEvent(t,n),l&&this.$element){t+=this.options.namespaceJQueryEvents?".flickity":"";var s=t;if(e){var o=l.Event(e);o.type=t,s=o}this.$element.trigger(s,i)}},p.select=function(t,e,i){this.isActive&&(t=parseInt(t,10),this._wrapSelect(t),(this.options.wrapAround||e)&&(t=n.modulo(t,this.slides.length)),this.slides[t]&&(this.selectedIndex=t,this.updateSelectedSlide(),i?this.positionSliderAtSelected():this.startAnimation(),this.options.adaptiveHeight&&this.setGallerySize(),this.dispatchEvent("select"),this.dispatchEvent("cellSelect")))},p._wrapSelect=function(t){var e=this.slides.length,i=this.options.wrapAround&&e>1;if(!i)return t;var s=n.modulo(t,e),o=Math.abs(s-this.selectedIndex),r=Math.abs(s+e-this.selectedIndex),a=Math.abs(s-e-this.selectedIndex);!this.isDragSelect&&r<o?t+=e:!this.isDragSelect&&a<o&&(t-=e),t<0?this.x-=this.slideableWidth:t>=e&&(this.x+=this.slideableWidth)},p.previous=function(t,e){this.select(this.selectedIndex-1,t,e)},p.next=function(t,e){this.select(this.selectedIndex+1,t,e)},p.updateSelectedSlide=function(){var t=this.slides[this.selectedIndex];t&&(this.unselectSelectedSlide(),this.selectedSlide=t,t.select(),this.selectedCells=t.cells,this.selectedElements=t.getCellElements(),this.selectedCell=t.cells[0],this.selectedElement=this.selectedElements[0])},p.unselectSelectedSlide=function(){this.selectedSlide&&this.selectedSlide.unselect()},p.selectCell=function(t,e,i){var n;"number"==typeof t?n=this.cells[t]:("string"==typeof t&&(t=this.element.querySelector(t)),n=this.getCell(t));for(var s=0;n&&s<this.slides.length;s++){var o=this.slides[s],r=o.cells.indexOf(n);if(r!=-1)return void this.select(s,e,i)}},p.getCell=function(t){for(var e=0;e<this.cells.length;e++){var i=this.cells[e];if(i.element==t)return i}},p.getCells=function(t){t=n.makeArray(t);var e=[];return t.forEach(function(t){var i=this.getCell(t);i&&e.push(i)},this),e},p.getCellElements=function(){return this.cells.map(function(t){return t.element})},p.getParentCell=function(t){var e=this.getCell(t);return e?e:(t=n.getParent(t,".flickity-slider > *"),this.getCell(t))},p.getAdjacentCellElements=function(t,e){if(!t)return this.selectedSlide.getCellElements();e=void 0===e?this.selectedIndex:e;var i=this.slides.length;if(1+2*t>=i)return this.getCellElements();for(var s=[],o=e-t;o<=e+t;o++){var r=this.options.wrapAround?n.modulo(o,i):o,a=this.slides[r];a&&(s=s.concat(a.getCellElements()))}return s},p.uiChange=function(){this.emitEvent("uiChange")},p.childUIPointerDown=function(t){this.emitEvent("childUIPointerDown",[t])},p.onresize=function(){this.watchCSS(),this.resize()},n.debounceMethod(c,"onresize",150),p.resize=function(){if(this.isActive){this.getSize(),this.options.wrapAround&&(this.x=n.modulo(this.x,this.slideableWidth)),this.positionCells(),this._getWrapShiftCells(),this.setGallerySize(),this.emitEvent("resize");var t=this.selectedElements&&this.selectedElements[0];this.selectCell(t,!1,!0)}},p.watchCSS=function(){var t=this.options.watchCSS;if(t){var e=h(this.element,":after").content;e.indexOf("flickity")!=-1?this.activate():this.deactivate()}},p.onkeydown=function(t){if(this.options.accessibility&&(!document.activeElement||document.activeElement==this.element))if(37==t.keyCode){var e=this.options.rightToLeft?"next":"previous";this.uiChange(),this[e]()}else if(39==t.keyCode){var i=this.options.rightToLeft?"previous":"next";this.uiChange(),this[i]()}},p.deactivate=function(){this.isActive&&(this.element.classList.remove("flickity-enabled"),this.element.classList.remove("flickity-rtl"),this.cells.forEach(function(t){t.destroy()}),this.unselectSelectedSlide(),this.element.removeChild(this.viewport),a(this.slider.children,this.element),this.options.accessibility&&(this.element.removeAttribute("tabIndex"),this.element.removeEventListener("keydown",this)),this.isActive=!1,this.emitEvent("deactivate"))},p.destroy=function(){this.deactivate(),t.removeEventListener("resize",this),this.emitEvent("destroy"),l&&this.$element&&l.removeData(this.element,"flickity"),delete this.element.flickityGUID,delete f[this.guid]},n.extend(p,r),c.data=function(t){t=n.getQueryElement(t);var e=t&&t.flickityGUID;return e&&f[e]},n.htmlInit(c,"flickity"),l&&l.bridget&&l.bridget("flickity",c),c.Cell=s,c})},function(t,e,i){var n,s;!function(o,r){n=r,s="function"==typeof n?n.call(e,i,e,t):n,!(void 0!==s&&(t.exports=s))}("undefined"!=typeof window?window:this,function(){"use strict";function t(){}var e=t.prototype;return e.on=function(t,e){if(t&&e){var i=this._events=this._events||{},n=i[t]=i[t]||[];return n.indexOf(e)==-1&&n.push(e),this}},e.once=function(t,e){if(t&&e){this.on(t,e);var i=this._onceEvents=this._onceEvents||{},n=i[t]=i[t]||{};return n[e]=!0,this}},e.off=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var n=i.indexOf(e);return n!=-1&&i.splice(n,1),this}},e.emitEvent=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var n=0,s=i[n];e=e||[];for(var o=this._onceEvents&&this._onceEvents[t];s;){var r=o&&o[s];r&&(this.off(t,s),delete o[s]),s.apply(this,e),n+=r?0:1,s=i[n]}return this}},t})},function(t,e,i){var n;/*!
	 * getSize v2.0.2
	 * measure size of elements
	 * MIT license
	 */
!function(s,o){"use strict";n=function(){return o()}.call(e,i,e,t),!(void 0!==n&&(t.exports=n))}(window,function(){"use strict";function t(t){var e=parseFloat(t),i=t.indexOf("%")==-1&&!isNaN(e);return i&&e}function e(){}function i(){for(var t={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},e=0;e<l;e++){var i=c[e];t[i]=0}return t}function n(t){var e=getComputedStyle(t);return e||a("Style returned "+e+". Are you running this code in a hidden iframe on Firefox? See http://bit.ly/getsizebug1"),e}function s(){if(!h){h=!0;var e=document.createElement("div");e.style.width="200px",e.style.padding="1px 2px 3px 4px",e.style.borderStyle="solid",e.style.borderWidth="1px 2px 3px 4px",e.style.boxSizing="border-box";var i=document.body||document.documentElement;i.appendChild(e);var s=n(e);o.isBoxSizeOuter=r=200==t(s.width),i.removeChild(e)}}function o(e){if(s(),"string"==typeof e&&(e=document.querySelector(e)),e&&"object"==typeof e&&e.nodeType){var o=n(e);if("none"==o.display)return i();var a={};a.width=e.offsetWidth,a.height=e.offsetHeight;for(var h=a.isBorderBox="border-box"==o.boxSizing,u=0;u<l;u++){var d=c[u],f=o[d],p=parseFloat(f);a[d]=isNaN(p)?0:p}var v=a.paddingLeft+a.paddingRight,g=a.paddingTop+a.paddingBottom,y=a.marginLeft+a.marginRight,m=a.marginTop+a.marginBottom,b=a.borderLeftWidth+a.borderRightWidth,k=a.borderTopWidth+a.borderBottomWidth,S=h&&r,E=t(o.width);E!==!1&&(a.width=E+(S?0:v+b));var x=t(o.height);return x!==!1&&(a.height=x+(S?0:g+k)),a.innerWidth=a.width-(v+b),a.innerHeight=a.height-(g+k),a.outerWidth=a.width+y,a.outerHeight=a.height+m,a}}var r,a="undefined"==typeof console?e:function(t){console.error(t)},c=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],l=c.length,h=!1;return o})},function(t,e,i){var n,s;!function(o,r){n=[i(8)],s=function(t){return r(o,t)}.apply(e,n),!(void 0!==s&&(t.exports=s))}(window,function(t,e){"use strict";var i={};i.extend=function(t,e){for(var i in e)t[i]=e[i];return t},i.modulo=function(t,e){return(t%e+e)%e},i.makeArray=function(t){var e=[];if(Array.isArray(t))e=t;else if(t&&"number"==typeof t.length)for(var i=0;i<t.length;i++)e.push(t[i]);else e.push(t);return e},i.removeFrom=function(t,e){var i=t.indexOf(e);i!=-1&&t.splice(i,1)},i.getParent=function(t,i){for(;t!=document.body;)if(t=t.parentNode,e(t,i))return t},i.getQueryElement=function(t){return"string"==typeof t?document.querySelector(t):t},i.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},i.filterFindElements=function(t,n){t=i.makeArray(t);var s=[];return t.forEach(function(t){if(t instanceof HTMLElement){if(!n)return void s.push(t);e(t,n)&&s.push(t);for(var i=t.querySelectorAll(n),o=0;o<i.length;o++)s.push(i[o])}}),s},i.debounceMethod=function(t,e,i){var n=t.prototype[e],s=e+"Timeout";t.prototype[e]=function(){var t=this[s];t&&clearTimeout(t);var e=arguments,o=this;this[s]=setTimeout(function(){n.apply(o,e),delete o[s]},i||100)}},i.docReady=function(t){var e=document.readyState;"complete"==e||"interactive"==e?setTimeout(t):document.addEventListener("DOMContentLoaded",t)},i.toDashed=function(t){return t.replace(/(.)([A-Z])/g,function(t,e,i){return e+"-"+i}).toLowerCase()};var n=t.console;return i.htmlInit=function(e,s){i.docReady(function(){var o=i.toDashed(s),r="data-"+o,a=document.querySelectorAll("["+r+"]"),c=document.querySelectorAll(".js-"+o),l=i.makeArray(a).concat(i.makeArray(c)),h=r+"-options",u=t.jQuery;l.forEach(function(t){var i,o=t.getAttribute(r)||t.getAttribute(h);try{i=o&&JSON.parse(o)}catch(a){return void(n&&n.error("Error parsing "+r+" on "+t.className+": "+a))}var c=new e(t,i);u&&u.data(t,s,c)})})},i})},function(t,e,i){var n,s;!function(o,r){"use strict";n=r,s="function"==typeof n?n.call(e,i,e,t):n,!(void 0!==s&&(t.exports=s))}(window,function(){"use strict";var t=function(){var t=Element.prototype;if(t.matches)return"matches";if(t.matchesSelector)return"matchesSelector";for(var e=["webkit","moz","ms","o"],i=0;i<e.length;i++){var n=e[i],s=n+"MatchesSelector";if(t[s])return s}}();return function(e,i){return e[t](i)}})},function(t,e,i){var n,s;!function(o,r){n=[i(6)],s=function(t){return r(o,t)}.apply(e,n),!(void 0!==s&&(t.exports=s))}(window,function(t,e){"use strict";function i(t,e){this.element=t,this.parent=e,this.create()}var n=i.prototype;return n.create=function(){this.element.style.position="absolute",this.x=0,this.shift=0},n.destroy=function(){this.element.style.position="";var t=this.parent.originSide;this.element.style[t]=""},n.getSize=function(){this.size=e(this.element)},n.setPosition=function(t){this.x=t,this.updateTarget(),this.renderPosition(t)},n.updateTarget=n.setDefaultTarget=function(){var t="left"==this.parent.originSide?"marginLeft":"marginRight";this.target=this.x+this.size[t]+this.size.width*this.parent.cellAlign},n.renderPosition=function(t){var e=this.parent.originSide;this.element.style[e]=this.parent.getPositionValue(t)},n.wrapShift=function(t){this.shift=t,this.renderPosition(this.x+this.parent.slideableWidth*t)},n.remove=function(){this.element.parentNode.removeChild(this.element)},i})},function(t,e,i){var n,s;!function(o,r){n=r,s="function"==typeof n?n.call(e,i,e,t):n,!(void 0!==s&&(t.exports=s))}(window,function(){"use strict";function t(t){this.parent=t,this.isOriginLeft="left"==t.originSide,this.cells=[],this.outerWidth=0,this.height=0}var e=t.prototype;return e.addCell=function(t){if(this.cells.push(t),this.outerWidth+=t.size.outerWidth,this.height=Math.max(t.size.outerHeight,this.height),1==this.cells.length){this.x=t.x;var e=this.isOriginLeft?"marginLeft":"marginRight";this.firstMargin=t.size[e]}},e.updateTarget=function(){var t=this.isOriginLeft?"marginRight":"marginLeft",e=this.getLastCell(),i=e?e.size[t]:0,n=this.outerWidth-(this.firstMargin+i);this.target=this.x+this.firstMargin+n*this.parent.cellAlign},e.getLastCell=function(){return this.cells[this.cells.length-1]},e.select=function(){this.changeSelectedClass("add")},e.unselect=function(){this.changeSelectedClass("remove")},e.changeSelectedClass=function(t){this.cells.forEach(function(e){e.element.classList[t]("is-selected")})},e.getCellElements=function(){return this.cells.map(function(t){return t.element})},t})},function(t,e,i){var n,s;!function(o,r){n=[i(7)],s=function(t){return r(o,t)}.apply(e,n),!(void 0!==s&&(t.exports=s))}(window,function(t,e){"use strict";var i=t.requestAnimationFrame||t.webkitRequestAnimationFrame,n=0;i||(i=function(t){var e=(new Date).getTime(),i=Math.max(0,16-(e-n)),s=setTimeout(t,i);return n=e+i,s});var s={};s.startAnimation=function(){this.isAnimating||(this.isAnimating=!0,this.restingFrames=0,this.animate())},s.animate=function(){this.applyDragForce(),this.applySelectedAttraction();var t=this.x;if(this.integratePhysics(),this.positionSlider(),this.settle(t),this.isAnimating){var e=this;i(function(){e.animate()})}};var o=function(){var t=document.documentElement.style;return"string"==typeof t.transform?"transform":"WebkitTransform"}();return s.positionSlider=function(){var t=this.x;this.options.wrapAround&&this.cells.length>1&&(t=e.modulo(t,this.slideableWidth),t-=this.slideableWidth,this.shiftWrapCells(t)),t+=this.cursorPosition,t=this.options.rightToLeft&&o?-t:t;var i=this.getPositionValue(t);this.slider.style[o]=this.isAnimating?"translate3d("+i+",0,0)":"translateX("+i+")";var n=this.slides[0];if(n){var s=-this.x-n.target,r=s/this.slidesWidth;this.dispatchEvent("scroll",null,[r,s])}},s.positionSliderAtSelected=function(){this.cells.length&&(this.x=-this.selectedSlide.target,this.positionSlider())},s.getPositionValue=function(t){return this.options.percentPosition?.01*Math.round(t/this.size.innerWidth*1e4)+"%":Math.round(t)+"px"},s.settle=function(t){this.isPointerDown||Math.round(100*this.x)!=Math.round(100*t)||this.restingFrames++,this.restingFrames>2&&(this.isAnimating=!1,delete this.isFreeScrolling,this.positionSlider(),this.dispatchEvent("settle"))},s.shiftWrapCells=function(t){var e=this.cursorPosition+t;this._shiftCells(this.beforeShiftCells,e,-1);var i=this.size.innerWidth-(t+this.slideableWidth+this.cursorPosition);this._shiftCells(this.afterShiftCells,i,1)},s._shiftCells=function(t,e,i){for(var n=0;n<t.length;n++){var s=t[n],o=e>0?i:0;s.wrapShift(o),e-=s.size.outerWidth}},s._unshiftCells=function(t){if(t&&t.length)for(var e=0;e<t.length;e++)t[e].wrapShift(0)},s.integratePhysics=function(){this.x+=this.velocity,this.velocity*=this.getFrictionFactor()},s.applyForce=function(t){this.velocity+=t},s.getFrictionFactor=function(){return 1-this.options[this.isFreeScrolling?"freeScrollFriction":"friction"]},s.getRestingPosition=function(){return this.x+this.velocity/(1-this.getFrictionFactor())},s.applyDragForce=function(){if(this.isPointerDown){var t=this.dragX-this.x,e=t-this.velocity;this.applyForce(e)}},s.applySelectedAttraction=function(){if(!this.isPointerDown&&!this.isFreeScrolling&&this.cells.length){var t=this.selectedSlide.target*-1-this.x,e=t*this.options.selectedAttraction;this.applyForce(e)}},s})},function(t,e,i){var n,s;!function(o,r){n=[i(4),i(13),i(7)],s=function(t,e,i){return r(o,t,e,i)}.apply(e,n),!(void 0!==s&&(t.exports=s))}(window,function(t,e,i,n){"use strict";function s(){return{x:t.pageXOffset,y:t.pageYOffset}}n.extend(e.defaults,{draggable:!0,dragThreshold:3}),e.createMethods.push("_createDrag");var o=e.prototype;n.extend(o,i.prototype),o._createDrag=function(){this.on("activate",this.bindDrag),this.on("uiChange",this._uiChangeDrag),this.on("childUIPointerDown",this._childUIPointerDownDrag),this.on("deactivate",this.unbindDrag)},o.bindDrag=function(){this.options.draggable&&!this.isDragBound&&(this.element.classList.add("is-draggable"),this.handles=[this.viewport],this.bindHandles(),this.isDragBound=!0)},o.unbindDrag=function(){this.isDragBound&&(this.element.classList.remove("is-draggable"),this.unbindHandles(),delete this.isDragBound)},o._uiChangeDrag=function(){delete this.isFreeScrolling},o._childUIPointerDownDrag=function(t){t.preventDefault(),this.pointerDownFocus(t)};var r={TEXTAREA:!0,INPUT:!0,OPTION:!0},a={radio:!0,checkbox:!0,button:!0,submit:!0,image:!0,file:!0};o.pointerDown=function(e,i){var n=r[e.target.nodeName]&&!a[e.target.type];if(n)return this.isPointerDown=!1,void delete this.pointerIdentifier;this._dragPointerDown(e,i);var o=document.activeElement;o&&o.blur&&o!=this.element&&o!=document.body&&o.blur(),this.pointerDownFocus(e),this.dragX=this.x,this.viewport.classList.add("is-pointer-down"),this._bindPostStartEvents(e),this.pointerDownScroll=s(),t.addEventListener("scroll",this),this.dispatchEvent("pointerDown",e,[i])};var c={touchstart:!0,MSPointerDown:!0},l={INPUT:!0,SELECT:!0};return o.pointerDownFocus=function(e){if(this.options.accessibility&&!c[e.type]&&!l[e.target.nodeName]){var i=t.pageYOffset;this.element.focus(),t.pageYOffset!=i&&t.scrollTo(t.pageXOffset,i)}},o.canPreventDefaultOnPointerDown=function(t){var e="touchstart"==t.type,i=t.target.nodeName;return!e&&"SELECT"!=i},o.hasDragStarted=function(t){return Math.abs(t.x)>this.options.dragThreshold},o.pointerUp=function(t,e){delete this.isTouchScrolling,this.viewport.classList.remove("is-pointer-down"),this.dispatchEvent("pointerUp",t,[e]),this._dragPointerUp(t,e)},o.pointerDone=function(){t.removeEventListener("scroll",this),delete this.pointerDownScroll},o.dragStart=function(t,e){this.dragStartPosition=this.x,this.startAnimation(),this.dispatchEvent("dragStart",t,[e])},o.pointerMove=function(t,e){var i=this._dragPointerMove(t,e);this.dispatchEvent("pointerMove",t,[e,i]),this._dragMove(t,e,i)},o.dragMove=function(t,e,i){t.preventDefault(),this.previousDragX=this.dragX;var n=this.options.rightToLeft?-1:1,s=this.dragStartPosition+i.x*n;if(!this.options.wrapAround&&this.slides.length){var o=Math.max(-this.slides[0].target,this.dragStartPosition);s=s>o?.5*(s+o):s;var r=Math.min(-this.getLastSlide().target,this.dragStartPosition);s=s<r?.5*(s+r):s}this.dragX=s,this.dragMoveTime=new Date,this.dispatchEvent("dragMove",t,[e,i])},o.dragEnd=function(t,e){this.options.freeScroll&&(this.isFreeScrolling=!0);var i=this.dragEndRestingSelect();if(this.options.freeScroll&&!this.options.wrapAround){var n=this.getRestingPosition();this.isFreeScrolling=-n>this.slides[0].target&&-n<this.getLastSlide().target}else this.options.freeScroll||i!=this.selectedIndex||(i+=this.dragEndBoostSelect());delete this.previousDragX,this.isDragSelect=this.options.wrapAround,this.select(i),delete this.isDragSelect,this.dispatchEvent("dragEnd",t,[e])},o.dragEndRestingSelect=function(){var t=this.getRestingPosition(),e=Math.abs(this.getSlideDistance(-t,this.selectedIndex)),i=this._getClosestResting(t,e,1),n=this._getClosestResting(t,e,-1),s=i.distance<n.distance?i.index:n.index;return s},o._getClosestResting=function(t,e,i){for(var n=this.selectedIndex,s=1/0,o=this.options.contain&&!this.options.wrapAround?function(t,e){return t<=e}:function(t,e){return t<e};o(e,s)&&(n+=i,s=e,e=this.getSlideDistance(-t,n),null!==e);)e=Math.abs(e);return{distance:s,index:n-i}},o.getSlideDistance=function(t,e){var i=this.slides.length,s=this.options.wrapAround&&i>1,o=s?n.modulo(e,i):e,r=this.slides[o];if(!r)return null;var a=s?this.slideableWidth*Math.floor(e/i):0;return t-(r.target+a)},o.dragEndBoostSelect=function(){if(void 0===this.previousDragX||!this.dragMoveTime||new Date-this.dragMoveTime>100)return 0;var t=this.getSlideDistance(-this.dragX,this.selectedIndex),e=this.previousDragX-this.dragX;return t>0&&e>0?1:t<0&&e<0?-1:0},o.staticClick=function(t,e){var i=this.getParentCell(t.target),n=i&&i.element,s=i&&this.cells.indexOf(i);this.dispatchEvent("staticClick",t,[e,n,s])},o.onscroll=function(){var t=s(),e=this.pointerDownScroll.x-t.x,i=this.pointerDownScroll.y-t.y;(Math.abs(e)>3||Math.abs(i)>3)&&this._pointerDone()},e})},function(t,e,i){var n,s;/*!
	 * Unidragger v2.1.0
	 * Draggable base class
	 * MIT license
	 */
!function(o,r){n=[i(14)],s=function(t){return r(o,t)}.apply(e,n),!(void 0!==s&&(t.exports=s))}(window,function(t,e){"use strict";function i(){}function n(){}var s=n.prototype=Object.create(e.prototype);s.bindHandles=function(){this._bindHandles(!0)},s.unbindHandles=function(){this._bindHandles(!1)};var o=t.navigator;return s._bindHandles=function(t){t=void 0===t||!!t;var e;e=o.pointerEnabled?function(e){e.style.touchAction=t?"none":""}:o.msPointerEnabled?function(e){e.style.msTouchAction=t?"none":""}:i;for(var n=t?"addEventListener":"removeEventListener",s=0;s<this.handles.length;s++){var r=this.handles[s];this._bindStartEvent(r,t),e(r),r[n]("click",this)}},s.pointerDown=function(t,e){if("INPUT"==t.target.nodeName&&"range"==t.target.type)return this.isPointerDown=!1,void delete this.pointerIdentifier;this._dragPointerDown(t,e);var i=document.activeElement;i&&i.blur&&i.blur(),this._bindPostStartEvents(t),this.emitEvent("pointerDown",[t,e])},s._dragPointerDown=function(t,i){this.pointerDownPoint=e.getPointerPoint(i);var n=this.canPreventDefaultOnPointerDown(t,i);n&&t.preventDefault()},s.canPreventDefaultOnPointerDown=function(t){return"SELECT"!=t.target.nodeName},s.pointerMove=function(t,e){var i=this._dragPointerMove(t,e);this.emitEvent("pointerMove",[t,e,i]),this._dragMove(t,e,i)},s._dragPointerMove=function(t,i){var n=e.getPointerPoint(i),s={x:n.x-this.pointerDownPoint.x,y:n.y-this.pointerDownPoint.y};return!this.isDragging&&this.hasDragStarted(s)&&this._dragStart(t,i),s},s.hasDragStarted=function(t){return Math.abs(t.x)>3||Math.abs(t.y)>3},s.pointerUp=function(t,e){this.emitEvent("pointerUp",[t,e]),this._dragPointerUp(t,e)},s._dragPointerUp=function(t,e){this.isDragging?this._dragEnd(t,e):this._staticClick(t,e)},s._dragStart=function(t,i){this.isDragging=!0,this.dragStartPoint=e.getPointerPoint(i),this.isPreventingClicks=!0,this.dragStart(t,i)},s.dragStart=function(t,e){this.emitEvent("dragStart",[t,e])},s._dragMove=function(t,e,i){this.isDragging&&this.dragMove(t,e,i)},s.dragMove=function(t,e,i){t.preventDefault(),this.emitEvent("dragMove",[t,e,i])},s._dragEnd=function(t,e){this.isDragging=!1,setTimeout(function(){delete this.isPreventingClicks}.bind(this)),this.dragEnd(t,e)},s.dragEnd=function(t,e){this.emitEvent("dragEnd",[t,e])},s.onclick=function(t){this.isPreventingClicks&&t.preventDefault()},s._staticClick=function(t,e){if(!this.isIgnoringMouseUp||"mouseup"!=t.type){var i=t.target.nodeName;"INPUT"!=i&&"TEXTAREA"!=i||t.target.focus(),this.staticClick(t,e),"mouseup"!=t.type&&(this.isIgnoringMouseUp=!0,setTimeout(function(){delete this.isIgnoringMouseUp}.bind(this),400))}},s.staticClick=function(t,e){this.emitEvent("staticClick",[t,e])},n.getPointerPoint=e.getPointerPoint,n})},function(t,e,i){var n,s;/*!
	 * Unipointer v2.1.0
	 * base class for doing one thing with pointer event
	 * MIT license
	 */
!function(o,r){n=[i(5)],s=function(t){return r(o,t)}.apply(e,n),!(void 0!==s&&(t.exports=s))}(window,function(t,e){"use strict";function i(){}function n(){}var s=n.prototype=Object.create(e.prototype);s.bindStartEvent=function(t){this._bindStartEvent(t,!0)},s.unbindStartEvent=function(t){this._bindStartEvent(t,!1)},s._bindStartEvent=function(e,i){i=void 0===i||!!i;var n=i?"addEventListener":"removeEventListener";t.navigator.pointerEnabled?e[n]("pointerdown",this):t.navigator.msPointerEnabled?e[n]("MSPointerDown",this):(e[n]("mousedown",this),e[n]("touchstart",this))},s.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},s.getTouch=function(t){for(var e=0;e<t.length;e++){var i=t[e];if(i.identifier==this.pointerIdentifier)return i}},s.onmousedown=function(t){var e=t.button;e&&0!==e&&1!==e||this._pointerDown(t,t)},s.ontouchstart=function(t){this._pointerDown(t,t.changedTouches[0])},s.onMSPointerDown=s.onpointerdown=function(t){this._pointerDown(t,t)},s._pointerDown=function(t,e){this.isPointerDown||(this.isPointerDown=!0,this.pointerIdentifier=void 0!==e.pointerId?e.pointerId:e.identifier,this.pointerDown(t,e))},s.pointerDown=function(t,e){this._bindPostStartEvents(t),this.emitEvent("pointerDown",[t,e])};var o={mousedown:["mousemove","mouseup"],touchstart:["touchmove","touchend","touchcancel"],pointerdown:["pointermove","pointerup","pointercancel"],MSPointerDown:["MSPointerMove","MSPointerUp","MSPointerCancel"]};return s._bindPostStartEvents=function(e){if(e){var i=o[e.type];i.forEach(function(e){t.addEventListener(e,this)},this),this._boundPointerEvents=i}},s._unbindPostStartEvents=function(){this._boundPointerEvents&&(this._boundPointerEvents.forEach(function(e){t.removeEventListener(e,this)},this),delete this._boundPointerEvents)},s.onmousemove=function(t){this._pointerMove(t,t)},s.onMSPointerMove=s.onpointermove=function(t){t.pointerId==this.pointerIdentifier&&this._pointerMove(t,t)},s.ontouchmove=function(t){var e=this.getTouch(t.changedTouches);e&&this._pointerMove(t,e)},s._pointerMove=function(t,e){this.pointerMove(t,e)},s.pointerMove=function(t,e){this.emitEvent("pointerMove",[t,e])},s.onmouseup=function(t){this._pointerUp(t,t)},s.onMSPointerUp=s.onpointerup=function(t){t.pointerId==this.pointerIdentifier&&this._pointerUp(t,t)},s.ontouchend=function(t){var e=this.getTouch(t.changedTouches);e&&this._pointerUp(t,e)},s._pointerUp=function(t,e){this._pointerDone(),this.pointerUp(t,e)},s.pointerUp=function(t,e){this.emitEvent("pointerUp",[t,e])},s._pointerDone=function(){this.isPointerDown=!1,delete this.pointerIdentifier,this._unbindPostStartEvents(),this.pointerDone()},s.pointerDone=i,s.onMSPointerCancel=s.onpointercancel=function(t){t.pointerId==this.pointerIdentifier&&this._pointerCancel(t,t)},s.ontouchcancel=function(t){var e=this.getTouch(t.changedTouches);e&&this._pointerCancel(t,e)},s._pointerCancel=function(t,e){this._pointerDone(),this.pointerCancel(t,e)},s.pointerCancel=function(t,e){this.emitEvent("pointerCancel",[t,e])},n.getPointerPoint=function(t){return{x:t.pageX,y:t.pageY}},n})},function(t,e,i){var n,s;!function(o,r){n=[i(4),i(16),i(7)],s=function(t,e,i){return r(o,t,e,i)}.apply(e,n),!(void 0!==s&&(t.exports=s))}(window,function(t,e,i,n){"use strict";function s(t,e){this.direction=t,this.parent=e,this._create()}function o(t){return"string"==typeof t?t:"M "+t.x0+",50 L "+t.x1+","+(t.y1+50)+" L "+t.x2+","+(t.y2+50)+" L "+t.x3+",50  L "+t.x2+","+(50-t.y2)+" L "+t.x1+","+(50-t.y1)+" Z"}var r="http://www.w3.org/2000/svg";s.prototype=new i,s.prototype._create=function(){this.isEnabled=!0,this.isPrevious=this.direction==-1;var t=this.parent.options.rightToLeft?1:-1;this.isLeft=this.direction==t;var e=this.element=document.createElement("button");e.className="flickity-prev-next-button",e.className+=this.isPrevious?" previous":" next",e.setAttribute("type","button"),this.disable(),e.setAttribute("aria-label",this.isPrevious?"previous":"next");var i=this.createSVG();e.appendChild(i),this.parent.on("select",function(){this.update()}.bind(this)),this.on("tap",this.onTap),this.on("pointerDown",function(t,e){this.parent.childUIPointerDown(e)}.bind(this))},s.prototype.activate=function(){this.bindTap(this.element),this.element.addEventListener("click",this),this.parent.element.appendChild(this.element)},s.prototype.deactivate=function(){this.parent.element.removeChild(this.element),i.prototype.destroy.call(this),this.element.removeEventListener("click",this)},s.prototype.createSVG=function(){var t=document.createElementNS(r,"svg");t.setAttribute("viewBox","0 0 100 100");var e=document.createElementNS(r,"path"),i=o(this.parent.options.arrowShape);return e.setAttribute("d",i),e.setAttribute("class","arrow"),this.isLeft||e.setAttribute("transform","translate(100, 100) rotate(180) "),t.appendChild(e),t},s.prototype.onTap=function(){if(this.isEnabled){this.parent.uiChange();var t=this.isPrevious?"previous":"next";this.parent[t]()}},s.prototype.handleEvent=n.handleEvent,s.prototype.onclick=function(){var t=document.activeElement;t&&t==this.element&&this.onTap()},s.prototype.enable=function(){this.isEnabled||(this.element.disabled=!1,this.isEnabled=!0)},s.prototype.disable=function(){this.isEnabled&&(this.element.disabled=!0,this.isEnabled=!1)},s.prototype.update=function(){var t=this.parent.slides;if(this.parent.options.wrapAround&&t.length>1)return void this.enable();var e=t.length?t.length-1:0,i=this.isPrevious?0:e,n=this.parent.selectedIndex==i?"disable":"enable";this[n]()},s.prototype.destroy=function(){this.deactivate()},n.extend(e.defaults,{prevNextButtons:!0,arrowShape:{x0:10,x1:60,y1:50,x2:70,y2:40,x3:30}}),e.createMethods.push("_createPrevNextButtons");var a=e.prototype;return a._createPrevNextButtons=function(){this.options.prevNextButtons&&(this.prevButton=new s((-1),this),this.nextButton=new s(1,this),this.on("activate",this.activatePrevNextButtons))},a.activatePrevNextButtons=function(){this.prevButton.activate(),this.nextButton.activate(),this.on("deactivate",this.deactivatePrevNextButtons)},a.deactivatePrevNextButtons=function(){this.prevButton.deactivate(),this.nextButton.deactivate(),this.off("deactivate",this.deactivatePrevNextButtons)},e.PrevNextButton=s,e})},function(t,e,i){var n,s;/*!
	 * Tap listener v2.0.0
	 * listens to taps
	 * MIT license
	 */
!function(o,r){n=[i(14)],s=function(t){return r(o,t)}.apply(e,n),!(void 0!==s&&(t.exports=s))}(window,function(t,e){"use strict";function i(t){this.bindTap(t)}var n=i.prototype=Object.create(e.prototype);return n.bindTap=function(t){t&&(this.unbindTap(),this.tapElement=t,this._bindStartEvent(t,!0))},n.unbindTap=function(){this.tapElement&&(this._bindStartEvent(this.tapElement,!0),delete this.tapElement)},n.pointerUp=function(i,n){if(!this.isIgnoringMouseUp||"mouseup"!=i.type){var s=e.getPointerPoint(n),o=this.tapElement.getBoundingClientRect(),r=t.pageXOffset,a=t.pageYOffset,c=s.x>=o.left+r&&s.x<=o.right+r&&s.y>=o.top+a&&s.y<=o.bottom+a;if(c&&this.emitEvent("tap",[i,n]),"mouseup"!=i.type){this.isIgnoringMouseUp=!0;var l=this;setTimeout(function(){delete l.isIgnoringMouseUp},400)}}},n.destroy=function(){this.pointerDone(),this.unbindTap()},i})},function(t,e,i){var n,s;!function(o,r){n=[i(4),i(16),i(7)],s=function(t,e,i){return r(o,t,e,i)}.apply(e,n),!(void 0!==s&&(t.exports=s))}(window,function(t,e,i,n){"use strict";function s(t){this.parent=t,this._create()}s.prototype=new i,s.prototype._create=function(){this.holder=document.createElement("ol"),this.holder.className="flickity-page-dots",this.dots=[],this.on("tap",this.onTap)},s.prototype.activate=function(){this.setDots(),this.bindTap(this.holder),this.parent.element.appendChild(this.holder)},s.prototype.deactivate=function(){this.parent.element.removeChild(this.holder),i.prototype.destroy.call(this)},s.prototype.setDots=function(){var t=this.parent.slides.length-this.dots.length;t>0?this.addDots(t):t<0&&this.removeDots(-t)},s.prototype.addDots=function(t){for(var e=document.createDocumentFragment(),i=[];t;){var n=document.createElement("li");n.className="dot",e.appendChild(n),i.push(n),t--}this.holder.appendChild(e),this.dots=this.dots.concat(i)},s.prototype.removeDots=function(t){var e=this.dots.splice(this.dots.length-t,t);e.forEach(function(t){this.holder.removeChild(t)},this)},s.prototype.updateSelected=function(){this.selectedDot&&(this.selectedDot.className="dot"),this.dots.length&&(this.selectedDot=this.dots[this.parent.selectedIndex],this.selectedDot.className="dot is-selected")},s.prototype.onTap=function(t){var e=t.target;if("LI"==e.nodeName){this.parent.uiChange();var i=this.dots.indexOf(e);this.parent.select(i)}},s.prototype.destroy=function(){this.deactivate()},e.PageDots=s,n.extend(e.defaults,{pageDots:!0}),e.createMethods.push("_createPageDots");var o=e.prototype;return o._createPageDots=function(){this.options.pageDots&&(this.pageDots=new s(this),this.on("activate",this.activatePageDots),this.on("select",this.updateSelectedPageDots),this.on("cellChange",this.updatePageDots),this.on("resize",this.updatePageDots),this.on("deactivate",this.deactivatePageDots),this.pageDots.on("pointerDown",function(t){this.childUIPointerDown(t)}.bind(this)))},o.activatePageDots=function(){this.pageDots.activate()},o.updateSelectedPageDots=function(){this.pageDots.updateSelected()},o.updatePageDots=function(){this.pageDots.setDots()},o.deactivatePageDots=function(){this.pageDots.deactivate()},e.PageDots=s,e})},function(t,e,i){var n,s;!function(o,r){n=[i(5),i(7),i(4)],s=function(t,e,i){return r(t,e,i)}.apply(e,n),!(void 0!==s&&(t.exports=s))}(window,function(t,e,i){"use strict";function n(t){this.parent=t,this.state="stopped",o&&(this.onVisibilityChange=function(){this.visibilityChange()}.bind(this),this.onVisibilityPlay=function(){this.visibilityPlay()}.bind(this))}var s,o;"hidden"in document?(s="hidden",o="visibilitychange"):"webkitHidden"in document&&(s="webkitHidden",o="webkitvisibilitychange"),n.prototype=Object.create(t.prototype),n.prototype.play=function(){if("playing"!=this.state){var t=document[s];if(o&&t)return void document.addEventListener(o,this.onVisibilityPlay);this.state="playing",o&&document.addEventListener(o,this.onVisibilityChange),this.tick()}},n.prototype.tick=function(){if("playing"==this.state){var t=this.parent.options.autoPlay;t="number"==typeof t?t:3e3;var e=this;this.clear(),this.timeout=setTimeout(function(){e.parent.next(!0),e.tick()},t)}},n.prototype.stop=function(){this.state="stopped",this.clear(),o&&document.removeEventListener(o,this.onVisibilityChange)},n.prototype.clear=function(){clearTimeout(this.timeout)},n.prototype.pause=function(){"playing"==this.state&&(this.state="paused",this.clear())},n.prototype.unpause=function(){"paused"==this.state&&this.play()},n.prototype.visibilityChange=function(){var t=document[s];this[t?"pause":"unpause"]()},n.prototype.visibilityPlay=function(){this.play(),document.removeEventListener(o,this.onVisibilityPlay)},e.extend(i.defaults,{pauseAutoPlayOnHover:!0}),i.createMethods.push("_createPlayer");var r=i.prototype;return r._createPlayer=function(){this.player=new n(this),this.on("activate",this.activatePlayer),this.on("uiChange",this.stopPlayer),this.on("pointerDown",this.stopPlayer),this.on("deactivate",this.deactivatePlayer)},r.activatePlayer=function(){this.options.autoPlay&&(this.player.play(),this.element.addEventListener("mouseenter",this))},r.playPlayer=function(){this.player.play()},r.stopPlayer=function(){this.player.stop()},r.pausePlayer=function(){this.player.pause()},r.unpausePlayer=function(){this.player.unpause()},r.deactivatePlayer=function(){this.player.stop(),this.element.removeEventListener("mouseenter",this)},r.onmouseenter=function(){this.options.pauseAutoPlayOnHover&&(this.player.pause(),this.element.addEventListener("mouseleave",this))},r.onmouseleave=function(){this.player.unpause(),this.element.removeEventListener("mouseleave",this)},i.Player=n,i})},function(t,e,i){var n,s;!function(o,r){n=[i(4),i(7)],s=function(t,e){return r(o,t,e)}.apply(e,n),!(void 0!==s&&(t.exports=s))}(window,function(t,e,i){"use strict";function n(t){var e=document.createDocumentFragment();return t.forEach(function(t){e.appendChild(t.element)}),e}var s=e.prototype;return s.insert=function(t,e){var i=this._makeCells(t);if(i&&i.length){var s=this.cells.length;e=void 0===e?s:e;var o=n(i),r=e==s;if(r)this.slider.appendChild(o);else{var a=this.cells[e].element;this.slider.insertBefore(o,a)}if(0===e)this.cells=i.concat(this.cells);else if(r)this.cells=this.cells.concat(i);else{var c=this.cells.splice(e,s-e);this.cells=this.cells.concat(i).concat(c)}this._sizeCells(i);var l=e>this.selectedIndex?0:i.length;this._cellAddedRemoved(e,l)}},s.append=function(t){this.insert(t,this.cells.length)},s.prepend=function(t){this.insert(t,0)},s.remove=function(t){var e,n,s=this.getCells(t),o=0,r=s.length;for(e=0;e<r;e++){n=s[e];var a=this.cells.indexOf(n)<this.selectedIndex;o-=a?1:0}for(e=0;e<r;e++)n=s[e],n.remove(),i.removeFrom(this.cells,n);s.length&&this._cellAddedRemoved(0,o)},s._cellAddedRemoved=function(t,e){e=e||0,this.selectedIndex+=e,this.selectedIndex=Math.max(0,Math.min(this.slides.length-1,this.selectedIndex)),this.cellChange(t,!0),this.emitEvent("cellAddedRemoved",[t,e])},s.cellSizeChange=function(t){var e=this.getCell(t);if(e){e.getSize();var i=this.cells.indexOf(e);this.cellChange(i)}},s.cellChange=function(t,e){var i=this.slideableWidth;if(this._positionCells(t),this._getWrapShiftCells(),this.setGallerySize(),this.emitEvent("cellChange",[t]),this.options.freeScroll){var n=i-this.slideableWidth;this.x+=n*this.cellAlign,this.positionSlider()}else e&&this.positionSliderAtSelected(),this.select(this.selectedIndex)},e})},function(t,e,i){var n,s;!function(o,r){n=[i(4),i(7)],s=function(t,e){return r(o,t,e)}.apply(e,n),!(void 0!==s&&(t.exports=s))}(window,function(t,e,i){"use strict";function n(t){if("IMG"==t.nodeName&&t.getAttribute("data-flickity-lazyload"))return[t];var e=t.querySelectorAll("img[data-flickity-lazyload]");return i.makeArray(e)}function s(t,e){this.img=t,this.flickity=e,this.load()}e.createMethods.push("_createLazyload");var o=e.prototype;return o._createLazyload=function(){this.on("select",this.lazyLoad)},o.lazyLoad=function(){var t=this.options.lazyLoad;if(t){var e="number"==typeof t?t:0,i=this.getAdjacentCellElements(e),o=[];i.forEach(function(t){var e=n(t);o=o.concat(e)}),o.forEach(function(t){new s(t,this)},this)}},s.prototype.handleEvent=i.handleEvent,s.prototype.load=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.img.getAttribute("data-flickity-lazyload"),this.img.removeAttribute("data-flickity-lazyload")},s.prototype.onload=function(t){this.complete(t,"flickity-lazyloaded")},s.prototype.onerror=function(t){this.complete(t,"flickity-lazyerror")},s.prototype.complete=function(t,e){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this);var i=this.flickity.getParentCell(this.img),n=i&&i.element;this.flickity.cellSizeChange(n),this.img.classList.add(e),this.flickity.dispatchEvent("lazyLoad",t,n)},e.LazyLoader=s,e})},function(t,e,i){var n,s;/*!
	 * imagesLoaded v4.1.1
	 * JavaScript is all like "You images are done yet or what?"
	 * MIT License
	 */
!function(o,r){"use strict";n=[i(5)],s=function(t){return r(o,t)}.apply(e,n),!(void 0!==s&&(t.exports=s))}(window,function(t,e){"use strict";function i(t,e){for(var i in e)t[i]=e[i];return t}function n(t){var e=[];if(Array.isArray(t))e=t;else if("number"==typeof t.length)for(var i=0;i<t.length;i++)e.push(t[i]);else e.push(t);return e}function s(t,e,o){return this instanceof s?("string"==typeof t&&(t=document.querySelectorAll(t)),this.elements=n(t),this.options=i({},this.options),"function"==typeof e?o=e:i(this.options,e),o&&this.on("always",o),this.getImages(),a&&(this.jqDeferred=new a.Deferred),void setTimeout(function(){this.check()}.bind(this))):new s(t,e,o)}function o(t){this.img=t}function r(t,e){this.url=t,this.element=e,this.img=new Image}var a=t.jQuery,c=t.console;s.prototype=Object.create(e.prototype),s.prototype.options={},s.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},s.prototype.addElementImages=function(t){"IMG"==t.nodeName&&this.addImage(t),this.options.background===!0&&this.addElementBackgroundImages(t);var e=t.nodeType;if(e&&l[e]){for(var i=t.querySelectorAll("img"),n=0;n<i.length;n++){var s=i[n];this.addImage(s)}if("string"==typeof this.options.background){var o=t.querySelectorAll(this.options.background);for(n=0;n<o.length;n++){var r=o[n];this.addElementBackgroundImages(r)}}}};var l={1:!0,9:!0,11:!0};return s.prototype.addElementBackgroundImages=function(t){var e=getComputedStyle(t);if(e)for(var i=/url\((['"])?(.*?)\1\)/gi,n=i.exec(e.backgroundImage);null!==n;){var s=n&&n[2];s&&this.addBackground(s,t),n=i.exec(e.backgroundImage)}},s.prototype.addImage=function(t){var e=new o(t);this.images.push(e)},s.prototype.addBackground=function(t,e){var i=new r(t,e);this.images.push(i)},s.prototype.check=function(){function t(t,i,n){setTimeout(function(){e.progress(t,i,n)})}var e=this;return this.progressedCount=0,this.hasAnyBroken=!1,this.images.length?void this.images.forEach(function(e){e.once("progress",t),e.check()}):void this.complete()},s.prototype.progress=function(t,e,i){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!t.isLoaded,this.emitEvent("progress",[this,t,e]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,t),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&c&&c.log("progress: "+i,t,e)},s.prototype.complete=function(){var t=this.hasAnyBroken?"fail":"done";if(this.isComplete=!0,this.emitEvent(t,[this]),this.emitEvent("always",[this]),this.jqDeferred){var e=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[e](this)}},o.prototype=Object.create(e.prototype),o.prototype.check=function(){var t=this.getIsImageComplete();return t?void this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),void(this.proxyImage.src=this.img.src))},o.prototype.getIsImageComplete=function(){return this.img.complete&&void 0!==this.img.naturalWidth},o.prototype.confirm=function(t,e){this.isLoaded=t,this.emitEvent("progress",[this,this.img,e])},o.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},o.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},o.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},o.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},r.prototype=Object.create(o.prototype),r.prototype.check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url;var t=this.getIsImageComplete();t&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},r.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},r.prototype.confirm=function(t,e){this.isLoaded=t,this.emitEvent("progress",[this,this.element,e])},s.makeJQueryPlugin=function(e){e=e||t.jQuery,e&&(a=e,a.fn.imagesLoaded=function(t,e){var i=new s(this,t,e);return i.jqDeferred.promise(a(this))})},s.makeJQueryPlugin(),s})},function(t,e,i){"use strict";function n(t,e){"ngInject";function i(t,e,i,n){n.bcFlickityId||i.id&&(n.bcFlickityId=i.id)}function n(i,n,s,o){t(function(){e.create(n[0],o.bcFlickityId,o.options).then(function(t){o.Flickity=t.instance,o.bcFlickityId=t.id})});i.$on("$destroy",function(t){e.destroy(o.bcFlickityId)})}i.$inject=["$scope","$element","$attrs","$controller"],n.$inject=["$scope","$element","$attrs","$controller"];var o={restrict:"A",scope:{},bindToController:{bcFlickity:"@?",bcFlickityId:"@?"},compile:function(){return{pre:i,post:n}},controller:s.FlickityController,controllerAs:"vm"};return o}n.$inject=["$timeout","FlickityService"],Object.defineProperty(e,"__esModule",{value:!0}),e.FlickityDirective=n;var s=i(23)},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();e.FlickityController=function(){function t(e){"ngInject";i(this,t),this.FlickityConfig=e,this._activate()}return t.$inject=["FlickityConfig"],n(t,[{key:"_activate",value:function(){this.options=angular.extend({},this.FlickityConfig,angular.fromJson(this.bcFlickity|{}))}}]),t}()},function(t,e,i){"use strict";function n(t,e,i,n,o){"ngInject";function r(t,e,n,s){function r(t,e){s.wrapAround||t!==e?n.$set("disabled",!1):n.$set("disabled","disabled")}var a=s.flickityId,c="Flickity:"+a+":cellSelect",l="Flickity:"+s.flickityId+":settle";i.$on(c,function(t,e){r(e.instance.cells.length,e.instance.selectedIndex+1)}),i.$on(l,function(t,e){r(e.instance.cells.length,e.instance.selectedIndex+1)});e.on("click",function(){o.next(s.flickityId,s.wrapAround)})}r.$inject=["$scope","$element","$attrs","$controller"];var a={restrict:"A",scope:{},bindToController:{bcFlickityNext:"=?",bcFlickityId:"@?"},compile:function(){return{pre:r}},controller:s.NextController,controllerAs:"vm"};return a}n.$inject=["$log","$timeout","$rootScope","FlickityConfig","FlickityService"],Object.defineProperty(e,"__esModule",{value:!0}),e.FlickityNextDirective=n;var s=i(25)},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();e.NextController=function(){function t(e,n,s,o,r){"ngInject";i(this,t),this.$log=e,this.$q=n,this.$timeout=s,this.FlickityConfig=o,this.FlickityService=r,this._activate()}return t.$inject=["$log","$q","$timeout","FlickityConfig","FlickityService"],n(t,[{key:"_activate",value:function(){this.wrapAround=this.bcFlickityNext||this.FlickityConfig.wrapAround,this.flickityId=null,this._setId()}},{key:"_setId",value:function(){var t=this;return this.$q(function(e,i){t.bcFlickityId?(t.flickityId=t.bcFlickityId,e(t.flickityId)):t.$timeout(function(){t.FlickityService.getFirst().then(function(i){t.flickityId=i.id,e(t.flickityId)})["catch"](function(e){t.$log.warn(e),i(e)})})})}}]),t}()},function(t,e,i){"use strict";function n(t,e,i,n,o){"ngInject";function r(t,e,n,s){function r(t){s.wrapAround||0!==t?n.$set("disabled",!1):n.$set("disabled","disabled")}var a=s.flickityId,c="Flickity:"+a+":cellSelect",l="Flickity:"+s.flickityId+":settle";i.$on(c,function(t,e){r(e.instance.selectedIndex)}),i.$on(l,function(t,e){r(e.instance.selectedIndex)});e.on("click",function(){o.previous(s.flickityId,s.wrapAround)})}r.$inject=["$scope","$element","$attrs","$controller"];var a={restrict:"A",scope:{},bindToController:{bcFlickityPrevious:"=?",bcFlickityId:"@?"},compile:function(){return{pre:r}},controller:s.PreviousController,controllerAs:"vm"};return a}n.$inject=["$log","$timeout","$rootScope","FlickityConfig","FlickityService"],Object.defineProperty(e,"__esModule",{value:!0}),e.FlickityPreviousDirective=n;var s=i(27)},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();e.PreviousController=function(){function t(e,n,s,o,r){"ngInject";i(this,t),this.$log=e,this.$q=n,this.$timeout=s,this.FlickityConfig=o,this.FlickityService=r,this._activate()}return t.$inject=["$log","$q","$timeout","FlickityConfig","FlickityService"],n(t,[{key:"_activate",value:function(){this.wrapAround=this.bcFlickityPrevious||this.FlickityConfig.wrapAround,this.flickityId=null,this._setId()}},{key:"_setId",value:function(){var t=this;return this.$q(function(e,i){t.bcFlickityId?(t.flickityId=t.bcFlickityId,e(t.flickityId)):t.$timeout(function(){t.FlickityService.getFirst().then(function(i){t.flickityId=i.id,e(t.flickityId)})["catch"](function(e){t.$log.warn(e),i(e)})})})}}]),t}()}])});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uPzVjYTYiLCJ3ZWJwYWNrOi8vL2FuZ3VsYXItZmxpY2tpdHkubWluLmpzIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCBkOTFmMDMwYTMxZDMwYWNiZmQ3MD8wMzZiIiwid2VicGFjazovLy8uL3NyYy9pbmRleC5qcz85NTUyIiwid2VicGFjazovLy8uL3NyYy9pbmRleC5qcz8xZjM5KiIsIndlYnBhY2s6Ly8vLi9zcmMvZmxpY2tpdHkucHJvdmlkZXIuanM/ZjdhMiIsIndlYnBhY2s6Ly8vLi9zcmMvZmxpY2tpdHkucHJvdmlkZXIuanM/MDFmNSoiLCJ3ZWJwYWNrOi8vLy4vc3JjL2ZsaWNraXR5LnNlcnZpY2UuanM/NzgwMCIsIndlYnBhY2s6Ly8vLi9zcmMvZmxpY2tpdHkuc2VydmljZS5qcz9hZGE1KiIsIndlYnBhY2s6Ly8vLi9+L2ZsaWNraXR5L2pzL2luZGV4LmpzP2E5OTUiLCJ3ZWJwYWNrOi8vLy4vfi9mbGlja2l0eS9qcy9mbGlja2l0eS5qcz82YzJhIiwid2VicGFjazovLy8uL34vZXYtZW1pdHRlci9ldi1lbWl0dGVyLmpzP2FiYmUiLCJ3ZWJwYWNrOi8vLy4vfi9nZXQtc2l6ZS9nZXQtc2l6ZS5qcz9iMzgxIiwid2VicGFjazovLy8uL34vZml6enktdWktdXRpbHMvdXRpbHMuanM/MzUyMCIsIndlYnBhY2s6Ly8vLi9+L2Rlc2FuZHJvLW1hdGNoZXMtc2VsZWN0b3IvbWF0Y2hlcy1zZWxlY3Rvci5qcz9mOTI4Iiwid2VicGFjazovLy8uL34vZmxpY2tpdHkvanMvY2VsbC5qcz85OWFiIiwid2VicGFjazovLy8uL34vZmxpY2tpdHkvanMvc2xpZGUuanM/YzU3YiIsIndlYnBhY2s6Ly8vLi9+L2ZsaWNraXR5L2pzL2FuaW1hdGUuanM/MTE1MyIsIndlYnBhY2s6Ly8vLi9+L2ZsaWNraXR5L2pzL2RyYWcuanM/ZjNkZCIsIndlYnBhY2s6Ly8vLi9+L3VuaWRyYWdnZXIvdW5pZHJhZ2dlci5qcz9hYTM5Iiwid2VicGFjazovLy8uL34vdW5pcG9pbnRlci91bmlwb2ludGVyLmpzPzgwZWQiLCJ3ZWJwYWNrOi8vLy4vfi9mbGlja2l0eS9qcy9wcmV2LW5leHQtYnV0dG9uLmpzP2M4OTciLCJ3ZWJwYWNrOi8vLy4vfi90YXAtbGlzdGVuZXIvdGFwLWxpc3RlbmVyLmpzP2FlZDYiLCJ3ZWJwYWNrOi8vLy4vfi9mbGlja2l0eS9qcy9wYWdlLWRvdHMuanM/ZDA1MSIsIndlYnBhY2s6Ly8vLi9+L2ZsaWNraXR5L2pzL3BsYXllci5qcz85MjJkIiwid2VicGFjazovLy8uL34vZmxpY2tpdHkvanMvYWRkLXJlbW92ZS1jZWxsLmpzP2Y5MDciLCJ3ZWJwYWNrOi8vLy4vfi9mbGlja2l0eS9qcy9sYXp5bG9hZC5qcz9hODU2Iiwid2VicGFjazovLy8uL34vaW1hZ2VzTG9hZGVkL2ltYWdlc2xvYWRlZC5qcz83ZjU3Iiwid2VicGFjazovLy8uL3NyYy9mbGlja2l0eS5kaXJlY3RpdmUuanM/MzRhZiIsIndlYnBhY2s6Ly8vLi9zcmMvZmxpY2tpdHkuZGlyZWN0aXZlLmpzP2Y2MjQqIiwid2VicGFjazovLy8uL3NyYy9mbGlja2l0eS5jb250cm9sbGVyLmpzP2IwN2YiLCJ3ZWJwYWNrOi8vLy4vc3JjL2ZsaWNraXR5LmNvbnRyb2xsZXIuanM/YWQ4OCoiLCJ3ZWJwYWNrOi8vLy4vc3JjL25leHQvZmxpY2tpdHlOZXh0LmRpcmVjdGl2ZS5qcz8zYzYzIiwid2VicGFjazovLy8uL3NyYy9uZXh0L2ZsaWNraXR5TmV4dC5kaXJlY3RpdmUuanM/OGUzZCoiLCJ3ZWJwYWNrOi8vLy4vc3JjL25leHQvbmV4dC5jb250cm9sbGVyLmpzPzY4MzAiLCJ3ZWJwYWNrOi8vLy4vc3JjL25leHQvbmV4dC5jb250cm9sbGVyLmpzPzAxOWUqIiwid2VicGFjazovLy8uL3NyYy9wcmV2aW91cy9mbGlja2l0eVByZXZpb3VzLmRpcmVjdGl2ZS5qcz84MDU3Iiwid2VicGFjazovLy8uL3NyYy9wcmV2aW91cy9mbGlja2l0eVByZXZpb3VzLmRpcmVjdGl2ZS5qcz84NzYxKiIsIndlYnBhY2s6Ly8vLi9zcmMvcHJldmlvdXMvcHJldmlvdXMuY29udHJvbGxlci5qcz9lMDIwIiwid2VicGFjazovLy8uL3NyYy9wcmV2aW91cy9wcmV2aW91cy5jb250cm9sbGVyLmpzP2I4ZjkqIl0sIm5hbWVzIjpbInJvb3QiLCJmYWN0b3J5IiwiZXhwb3J0cyIsIm1vZHVsZSIsImRlZmluZSIsImFtZCIsInRoaXMiLCJtb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaW5zdGFsbGVkTW9kdWxlcyIsImlkIiwibG9hZGVkIiwiY2FsbCIsIm0iLCJjIiwicCIsIl9mbGlja2l0eSIsIl9mbGlja2l0eTIiLCJfZmxpY2tpdHkzIiwiX2ZsaWNraXR5TmV4dCIsIl9mbGlja2l0eVByZXZpb3VzIiwiYW5ndWxhciIsInByb3ZpZGVyIiwiRmxpY2tpdHlDb25maWdQcm92aWRlciIsInNlcnZpY2UiLCJGbGlja2l0eVNlcnZpY2UiLCJkaXJlY3RpdmUiLCJGbGlja2l0eURpcmVjdGl2ZSIsIkZsaWNraXR5TmV4dERpcmVjdGl2ZSIsIkZsaWNraXR5UHJldmlvdXNEaXJlY3RpdmUiLCJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiVHlwZUVycm9yIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJ2YWx1ZSIsIl9jcmVhdGVDbGFzcyIsImRlZmluZVByb3BlcnRpZXMiLCJ0YXJnZXQiLCJwcm9wcyIsImkiLCJsZW5ndGgiLCJkZXNjcmlwdG9yIiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwia2V5IiwicHJvdG9Qcm9wcyIsInN0YXRpY1Byb3BzIiwicHJvdG90eXBlIiwiYWNjZXNzaWJpbGl0eSIsImFkYXB0aXZlSGVpZ2h0IiwiYXV0b1BsYXkiLCJjZWxsQWxpZ24iLCJjZWxsU2VsZWN0b3IiLCJ1bmRlZmluZWQiLCJjb250YWluIiwiZHJhZ2dhYmxlIiwiZHJhZ1RocmVzaG9sZCIsImZyZWVTY3JvbGwiLCJmcmVlU2Nyb2xsRnJpY3Rpb24iLCJzZWxlY3RlZEF0dHJhY3Rpb24iLCJmcmljdGlvbiIsImdyb3VwQ2VsbHMiLCJpbml0aWFsSW5kZXgiLCJsYXp5TG9hZCIsInBlcmNlbnRQb3NpdGlvbiIsInByZXZOZXh0QnV0dG9ucyIsInBhZ2VEb3RzIiwicmVzaXplIiwicmlnaHRUb0xlZnQiLCJzZXRHYWxsZXJ5U2l6ZSIsIndhdGNoQ1NTIiwid3JhcEFyb3VuZCIsImltYWdlc0xvYWRlZCIsImFzTmF2Rm9yIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsIm9iaiIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiJHRpbWVvdXQiLCIkcSIsIiRyb290U2NvcGUiLCIkbG9nIiwiaW5zdGFuY2VzIiwiJGluamVjdCIsImVsZW1lbnQiLCJfdGhpcyIsImFyZ3VtZW50cyIsIm9wdGlvbnMiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsIl9maW5kT2JqZWN0QnlJZCIsImluZGV4IiwiX2dldEZsaWNraXR5SW5kZXgiLCJlcnJvciIsInB1c2giLCJfYmluZEV2ZW50cyIsInRoZW4iLCJfdGhpczIiLCJmbGlja2l0eUluZGV4IiwiZGVzdHJveSIsInNwbGljZSIsImlzV3JhcHBlZCIsImlzSW5zdGFudCIsIl90aGlzMyIsIm5leHQiLCJfdGhpczQiLCJwcmV2aW91cyIsIl90aGlzNSIsInNlbGVjdCIsIl90aGlzNiIsInNlbGVjdENlbGwiLCJfdGhpczciLCJzZWxlY3RlZEluZGV4IiwiX3RoaXM4IiwiX3RoaXM5IiwicmVwb3NpdGlvbiIsIl90aGlzMTAiLCJyZWxvYWRDZWxscyIsIl90aGlzMTEiLCJfdGhpczEyIiwiZGF0YSIsImVsZW1lbnRzIiwiX3RoaXMxMyIsInByZXBlbmQiLCJfdGhpczE0IiwiYXBwZW5kIiwiX3RoaXMxNSIsImluc2VydCIsIl90aGlzMTYiLCJnZXRDZWxsRWxlbWVudHMiLCJfdGhpczE3IiwicmVtb3ZlIiwiX3RoaXMxOCIsInNlbGVjdGVkRWxlbWVudCIsIl90aGlzMTkiLCJjZWxscyIsImZvdW5kSW5kZXgiLCJmb3JFYWNoIiwiX3RoaXMyMCIsIklEIiwib24iLCIkZW1pdCIsInByb2dyZXNzIiwicG9zaXRpb25YIiwiZXZlbnQiLCJwb2ludGVyIiwibW92ZVZlY3RvciIsImNlbGxFbGVtZW50IiwiY2VsbEluZGV4Iiwic291cmNlIiwiZmlsdGVyIiwib2JqZWN0IiwiX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fIiwiX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXyIsIl9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fIiwid2luZG93IiwiYXBwbHkiLCJGbGlja2l0eSIsIkV2RW1pdHRlciIsImdldFNpemUiLCJ1dGlscyIsIkNlbGwiLCJTbGlkZSIsImFuaW1hdGVQcm90b3R5cGUiLCJtb3ZlRWxlbWVudHMiLCJlbGVtcyIsInRvRWxlbSIsIm1ha2VBcnJheSIsImFwcGVuZENoaWxkIiwic2hpZnQiLCJxdWVyeUVsZW1lbnQiLCJnZXRRdWVyeUVsZW1lbnQiLCJjb25zb2xlIiwiZmxpY2tpdHlHVUlEIiwib3B0aW9uIiwialF1ZXJ5IiwiJGVsZW1lbnQiLCJleHRlbmQiLCJjb25zdHJ1Y3RvciIsImRlZmF1bHRzIiwiX2NyZWF0ZSIsImdldENvbXB1dGVkU3R5bGUiLCJHVUlEIiwibmFtZXNwYWNlSlF1ZXJ5RXZlbnRzIiwiY3JlYXRlTWV0aG9kcyIsInByb3RvIiwiZ3VpZCIsInJlc3RpbmdGcmFtZXMiLCJ4IiwidmVsb2NpdHkiLCJvcmlnaW5TaWRlIiwidmlld3BvcnQiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc05hbWUiLCJfY3JlYXRlU2xpZGVyIiwiYWRkRXZlbnRMaXN0ZW5lciIsIm1ldGhvZCIsImFjdGl2YXRlIiwib3B0cyIsImlzQWN0aXZlIiwiY2xhc3NMaXN0IiwiYWRkIiwiY2VsbEVsZW1zIiwiX2ZpbHRlckZpbmRDZWxsRWxlbWVudHMiLCJjaGlsZHJlbiIsInNsaWRlciIsInRhYkluZGV4IiwiZW1pdEV2ZW50IiwiaXNJbml0QWN0aXZhdGVkIiwic3R5bGUiLCJmaWx0ZXJGaW5kRWxlbWVudHMiLCJfbWFrZUNlbGxzIiwicG9zaXRpb25DZWxscyIsIl9nZXRXcmFwU2hpZnRDZWxscyIsIm1hcCIsImNlbGxFbGVtIiwiZ2V0TGFzdENlbGwiLCJnZXRMYXN0U2xpZGUiLCJzbGlkZXMiLCJfc2l6ZUNlbGxzIiwiX3Bvc2l0aW9uQ2VsbHMiLCJtYXhDZWxsSGVpZ2h0IiwiY2VsbFgiLCJzdGFydENlbGwiLCJzaXplIiwib3V0ZXJXaWR0aCIsImxlbiIsImNlbGwiLCJzZXRQb3NpdGlvbiIsIk1hdGgiLCJtYXgiLCJvdXRlckhlaWdodCIsInNsaWRlYWJsZVdpZHRoIiwidXBkYXRlU2xpZGVzIiwiX2NvbnRhaW5TbGlkZXMiLCJzbGlkZXNXaWR0aCIsInNsaWRlIiwiaXNPcmlnaW5MZWZ0IiwibmV4dE1hcmdpbiIsImNhbkNlbGxGaXQiLCJfZ2V0Q2FuQ2VsbEZpdCIsImFkZENlbGwiLCJzbGlkZVdpZHRoIiwiZmlyc3RNYXJnaW4iLCJ1cGRhdGVUYXJnZXQiLCJ1cGRhdGVTZWxlY3RlZFNsaWRlIiwibnVtYmVyIiwicGFyc2VJbnQiLCJwZXJjZW50TWF0Y2giLCJtYXRjaCIsInBlcmNlbnQiLCJpbm5lcldpZHRoIiwiX2luaXQiLCJwb3NpdGlvblNsaWRlckF0U2VsZWN0ZWQiLCJzZXRDZWxsQWxpZ24iLCJjdXJzb3JQb3NpdGlvbiIsImNlbGxBbGlnblNob3J0aGFuZHMiLCJjZW50ZXIiLCJsZWZ0IiwicmlnaHQiLCJzaG9ydGhhbmQiLCJoZWlnaHQiLCJzZWxlY3RlZFNsaWRlIiwiX3Vuc2hpZnRDZWxscyIsImJlZm9yZVNoaWZ0Q2VsbHMiLCJhZnRlclNoaWZ0Q2VsbHMiLCJnYXBYIiwiX2dldEdhcENlbGxzIiwiaW5jcmVtZW50IiwiaXNSaWdodFRvTGVmdCIsImJlZ2luTWFyZ2luIiwiZW5kTWFyZ2luIiwiY29udGVudFdpZHRoIiwiaXNDb250ZW50U21hbGxlciIsImJlZ2luQm91bmQiLCJlbmRCb3VuZCIsIm1pbiIsImRpc3BhdGNoRXZlbnQiLCJ0eXBlIiwiYXJncyIsImVtaXRBcmdzIiwiY29uY2F0IiwiJGV2ZW50IiwialFFdmVudCIsIkV2ZW50IiwidHJpZ2dlciIsImlzV3JhcCIsIl93cmFwU2VsZWN0IiwibW9kdWxvIiwic3RhcnRBbmltYXRpb24iLCJpc1dyYXBwaW5nIiwid3JhcEluZGV4IiwiZGVsdGEiLCJhYnMiLCJiYWNrV3JhcERlbHRhIiwiZm9yZXdhcmRXcmFwRGVsdGEiLCJpc0RyYWdTZWxlY3QiLCJ1bnNlbGVjdFNlbGVjdGVkU2xpZGUiLCJzZWxlY3RlZENlbGxzIiwic2VsZWN0ZWRFbGVtZW50cyIsInNlbGVjdGVkQ2VsbCIsInVuc2VsZWN0IiwicXVlcnlTZWxlY3RvciIsImdldENlbGwiLCJpbmRleE9mIiwiZWxlbSIsImdldENlbGxzIiwiZ2V0UGFyZW50Q2VsbCIsImdldFBhcmVudCIsImdldEFkamFjZW50Q2VsbEVsZW1lbnRzIiwiYWRqQ291bnQiLCJzbGlkZUluZGV4IiwidWlDaGFuZ2UiLCJjaGlsZFVJUG9pbnRlckRvd24iLCJvbnJlc2l6ZSIsImRlYm91bmNlTWV0aG9kIiwid2F0Y2hPcHRpb24iLCJhZnRlckNvbnRlbnQiLCJjb250ZW50IiwiZGVhY3RpdmF0ZSIsIm9ua2V5ZG93biIsImFjdGl2ZUVsZW1lbnQiLCJrZXlDb2RlIiwibGVmdE1ldGhvZCIsInJpZ2h0TWV0aG9kIiwicmVtb3ZlQ2hpbGQiLCJyZW1vdmVBdHRyaWJ1dGUiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwicmVtb3ZlRGF0YSIsImh0bWxJbml0IiwiYnJpZGdldCIsImdsb2JhbCIsImV2ZW50TmFtZSIsImxpc3RlbmVyIiwiZXZlbnRzIiwiX2V2ZW50cyIsImxpc3RlbmVycyIsIm9uY2UiLCJvbmNlRXZlbnRzIiwiX29uY2VFdmVudHMiLCJvbmNlTGlzdGVuZXJzIiwib2ZmIiwiaXNPbmNlIiwiZ2V0U3R5bGVTaXplIiwibnVtIiwicGFyc2VGbG9hdCIsImlzVmFsaWQiLCJpc05hTiIsIm5vb3AiLCJnZXRaZXJvU2l6ZSIsIndpZHRoIiwiaW5uZXJIZWlnaHQiLCJtZWFzdXJlbWVudHNMZW5ndGgiLCJtZWFzdXJlbWVudCIsIm1lYXN1cmVtZW50cyIsImdldFN0eWxlIiwibG9nRXJyb3IiLCJzZXR1cCIsImlzU2V0dXAiLCJkaXYiLCJwYWRkaW5nIiwiYm9yZGVyU3R5bGUiLCJib3JkZXJXaWR0aCIsImJveFNpemluZyIsImJvZHkiLCJkb2N1bWVudEVsZW1lbnQiLCJpc0JveFNpemVPdXRlciIsIm5vZGVUeXBlIiwiZGlzcGxheSIsIm9mZnNldFdpZHRoIiwib2Zmc2V0SGVpZ2h0IiwiaXNCb3JkZXJCb3giLCJwYWRkaW5nV2lkdGgiLCJwYWRkaW5nTGVmdCIsInBhZGRpbmdSaWdodCIsInBhZGRpbmdIZWlnaHQiLCJwYWRkaW5nVG9wIiwicGFkZGluZ0JvdHRvbSIsIm1hcmdpbldpZHRoIiwibWFyZ2luTGVmdCIsIm1hcmdpblJpZ2h0IiwibWFyZ2luSGVpZ2h0IiwibWFyZ2luVG9wIiwibWFyZ2luQm90dG9tIiwiYm9yZGVyTGVmdFdpZHRoIiwiYm9yZGVyUmlnaHRXaWR0aCIsImJvcmRlckhlaWdodCIsImJvcmRlclRvcFdpZHRoIiwiYm9yZGVyQm90dG9tV2lkdGgiLCJpc0JvcmRlckJveFNpemVPdXRlciIsInN0eWxlV2lkdGgiLCJzdHlsZUhlaWdodCIsIm1lc3NhZ2UiLCJtYXRjaGVzU2VsZWN0b3IiLCJhIiwiYiIsInByb3AiLCJhcnkiLCJBcnJheSIsImlzQXJyYXkiLCJyZW1vdmVGcm9tIiwic2VsZWN0b3IiLCJwYXJlbnROb2RlIiwiaGFuZGxlRXZlbnQiLCJmZkVsZW1zIiwiSFRNTEVsZW1lbnQiLCJjaGlsZEVsZW1zIiwicXVlcnlTZWxlY3RvckFsbCIsIl9jbGFzcyIsIm1ldGhvZE5hbWUiLCJ0aHJlc2hvbGQiLCJ0aW1lb3V0TmFtZSIsInRpbWVvdXQiLCJjbGVhclRpbWVvdXQiLCJzZXRUaW1lb3V0IiwiZG9jUmVhZHkiLCJjYWxsYmFjayIsInJlYWR5U3RhdGUiLCJ0b0Rhc2hlZCIsInN0ciIsInJlcGxhY2UiLCIkMSIsIiQyIiwidG9Mb3dlckNhc2UiLCJXaWRnZXRDbGFzcyIsIm5hbWVzcGFjZSIsImRhc2hlZE5hbWVzcGFjZSIsImRhdGFBdHRyIiwiZGF0YUF0dHJFbGVtcyIsImpzRGFzaEVsZW1zIiwiZGF0YU9wdGlvbnNBdHRyIiwiYXR0ciIsImdldEF0dHJpYnV0ZSIsIkpTT04iLCJwYXJzZSIsIm1hdGNoZXNNZXRob2QiLCJFbGVtUHJvdG8iLCJFbGVtZW50IiwibWF0Y2hlcyIsInByZWZpeGVzIiwicHJlZml4IiwicGFyZW50IiwiY3JlYXRlIiwicG9zaXRpb24iLCJzaWRlIiwicmVuZGVyUG9zaXRpb24iLCJzZXREZWZhdWx0VGFyZ2V0IiwibWFyZ2luUHJvcGVydHkiLCJnZXRQb3NpdGlvblZhbHVlIiwid3JhcFNoaWZ0IiwibGFzdENlbGwiLCJsYXN0TWFyZ2luIiwiY2hhbmdlU2VsZWN0ZWRDbGFzcyIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsIndlYmtpdFJlcXVlc3RBbmltYXRpb25GcmFtZSIsImxhc3RUaW1lIiwiY3VyclRpbWUiLCJEYXRlIiwiZ2V0VGltZSIsInRpbWVUb0NhbGwiLCJpc0FuaW1hdGluZyIsImFuaW1hdGUiLCJhcHBseURyYWdGb3JjZSIsImFwcGx5U2VsZWN0ZWRBdHRyYWN0aW9uIiwicHJldmlvdXNYIiwiaW50ZWdyYXRlUGh5c2ljcyIsInBvc2l0aW9uU2xpZGVyIiwic2V0dGxlIiwidHJhbnNmb3JtUHJvcGVydHkiLCJ0cmFuc2Zvcm0iLCJzaGlmdFdyYXBDZWxscyIsImZpcnN0U2xpZGUiLCJyb3VuZCIsImlzUG9pbnRlckRvd24iLCJpc0ZyZWVTY3JvbGxpbmciLCJiZWZvcmVHYXAiLCJfc2hpZnRDZWxscyIsImFmdGVyR2FwIiwiZ2FwIiwiY2VsbFNoaWZ0IiwiZ2V0RnJpY3Rpb25GYWN0b3IiLCJhcHBseUZvcmNlIiwiZm9yY2UiLCJnZXRSZXN0aW5nUG9zaXRpb24iLCJkcmFnVmVsb2NpdHkiLCJkcmFnWCIsImRyYWdGb3JjZSIsImRpc3RhbmNlIiwiVW5pZHJhZ2dlciIsImdldFNjcm9sbFBvc2l0aW9uIiwicGFnZVhPZmZzZXQiLCJ5IiwicGFnZVlPZmZzZXQiLCJfY3JlYXRlRHJhZyIsImJpbmREcmFnIiwiX3VpQ2hhbmdlRHJhZyIsIl9jaGlsZFVJUG9pbnRlckRvd25EcmFnIiwidW5iaW5kRHJhZyIsImlzRHJhZ0JvdW5kIiwiaGFuZGxlcyIsImJpbmRIYW5kbGVzIiwidW5iaW5kSGFuZGxlcyIsInByZXZlbnREZWZhdWx0IiwicG9pbnRlckRvd25Gb2N1cyIsImN1cnNvck5vZGVzIiwiVEVYVEFSRUEiLCJJTlBVVCIsIk9QVElPTiIsImNsaWNrVHlwZXMiLCJyYWRpbyIsImNoZWNrYm94IiwiYnV0dG9uIiwic3VibWl0IiwiaW1hZ2UiLCJmaWxlIiwicG9pbnRlckRvd24iLCJpc0N1cnNvcklucHV0Iiwibm9kZU5hbWUiLCJwb2ludGVySWRlbnRpZmllciIsIl9kcmFnUG9pbnRlckRvd24iLCJmb2N1c2VkIiwiYmx1ciIsIl9iaW5kUG9zdFN0YXJ0RXZlbnRzIiwicG9pbnRlckRvd25TY3JvbGwiLCJ0b3VjaFN0YXJ0RXZlbnRzIiwidG91Y2hzdGFydCIsIk1TUG9pbnRlckRvd24iLCJmb2N1c05vZGVzIiwiU0VMRUNUIiwicHJldlNjcm9sbFkiLCJmb2N1cyIsInNjcm9sbFRvIiwiY2FuUHJldmVudERlZmF1bHRPblBvaW50ZXJEb3duIiwiaXNUb3VjaHN0YXJ0IiwidGFyZ2V0Tm9kZU5hbWUiLCJoYXNEcmFnU3RhcnRlZCIsInBvaW50ZXJVcCIsImlzVG91Y2hTY3JvbGxpbmciLCJfZHJhZ1BvaW50ZXJVcCIsInBvaW50ZXJEb25lIiwiZHJhZ1N0YXJ0IiwiZHJhZ1N0YXJ0UG9zaXRpb24iLCJwb2ludGVyTW92ZSIsIl9kcmFnUG9pbnRlck1vdmUiLCJfZHJhZ01vdmUiLCJkcmFnTW92ZSIsInByZXZpb3VzRHJhZ1giLCJkaXJlY3Rpb24iLCJvcmlnaW5Cb3VuZCIsImRyYWdNb3ZlVGltZSIsImRyYWdFbmQiLCJkcmFnRW5kUmVzdGluZ1NlbGVjdCIsInJlc3RpbmdYIiwiZHJhZ0VuZEJvb3N0U2VsZWN0IiwiZ2V0U2xpZGVEaXN0YW5jZSIsInBvc2l0aXZlUmVzdGluZyIsIl9nZXRDbG9zZXN0UmVzdGluZyIsIm5lZ2F0aXZlUmVzdGluZyIsIm1pbkRpc3RhbmNlIiwiSW5maW5pdHkiLCJjb25kaXRpb24iLCJkIiwibWQiLCJpc1dyYXBBcm91bmQiLCJ3cmFwIiwiZmxvb3IiLCJzdGF0aWNDbGljayIsImNsaWNrZWRDZWxsIiwib25zY3JvbGwiLCJzY3JvbGwiLCJzY3JvbGxNb3ZlWCIsInNjcm9sbE1vdmVZIiwiX3BvaW50ZXJEb25lIiwiVW5pcG9pbnRlciIsIl9iaW5kSGFuZGxlcyIsIm5hdmlnYXRvciIsImlzQmluZCIsImJpbmRlckV4dHJhIiwicG9pbnRlckVuYWJsZWQiLCJoYW5kbGUiLCJ0b3VjaEFjdGlvbiIsIm1zUG9pbnRlckVuYWJsZWQiLCJtc1RvdWNoQWN0aW9uIiwiYmluZE1ldGhvZCIsIl9iaW5kU3RhcnRFdmVudCIsInBvaW50ZXJEb3duUG9pbnQiLCJnZXRQb2ludGVyUG9pbnQiLCJjYW5QcmV2ZW50RGVmYXVsdCIsIm1vdmVQb2ludCIsImlzRHJhZ2dpbmciLCJfZHJhZ1N0YXJ0IiwiX2RyYWdFbmQiLCJfc3RhdGljQ2xpY2siLCJkcmFnU3RhcnRQb2ludCIsImlzUHJldmVudGluZ0NsaWNrcyIsImJpbmQiLCJvbmNsaWNrIiwiaXNJZ25vcmluZ01vdXNlVXAiLCJiaW5kU3RhcnRFdmVudCIsInVuYmluZFN0YXJ0RXZlbnQiLCJnZXRUb3VjaCIsInRvdWNoZXMiLCJ0b3VjaCIsImlkZW50aWZpZXIiLCJvbm1vdXNlZG93biIsIl9wb2ludGVyRG93biIsIm9udG91Y2hzdGFydCIsImNoYW5nZWRUb3VjaGVzIiwib25NU1BvaW50ZXJEb3duIiwib25wb2ludGVyZG93biIsInBvaW50ZXJJZCIsInBvc3RTdGFydEV2ZW50cyIsIm1vdXNlZG93biIsInBvaW50ZXJkb3duIiwiX2JvdW5kUG9pbnRlckV2ZW50cyIsIl91bmJpbmRQb3N0U3RhcnRFdmVudHMiLCJvbm1vdXNlbW92ZSIsIl9wb2ludGVyTW92ZSIsIm9uTVNQb2ludGVyTW92ZSIsIm9ucG9pbnRlcm1vdmUiLCJvbnRvdWNobW92ZSIsIm9ubW91c2V1cCIsIl9wb2ludGVyVXAiLCJvbk1TUG9pbnRlclVwIiwib25wb2ludGVydXAiLCJvbnRvdWNoZW5kIiwib25NU1BvaW50ZXJDYW5jZWwiLCJvbnBvaW50ZXJjYW5jZWwiLCJfcG9pbnRlckNhbmNlbCIsIm9udG91Y2hjYW5jZWwiLCJwb2ludGVyQ2FuY2VsIiwicGFnZVgiLCJwYWdlWSIsIlRhcExpc3RlbmVyIiwiUHJldk5leHRCdXR0b24iLCJnZXRBcnJvd01vdmVtZW50cyIsInNoYXBlIiwieDAiLCJ4MSIsInkxIiwieDIiLCJ5MiIsIngzIiwic3ZnVVJJIiwiaXNFbmFibGVkIiwiaXNQcmV2aW91cyIsImxlZnREaXJlY3Rpb24iLCJpc0xlZnQiLCJzZXRBdHRyaWJ1dGUiLCJkaXNhYmxlIiwic3ZnIiwiY3JlYXRlU1ZHIiwidXBkYXRlIiwib25UYXAiLCJiaW5kVGFwIiwiY3JlYXRlRWxlbWVudE5TIiwicGF0aCIsInBhdGhNb3ZlbWVudHMiLCJhcnJvd1NoYXBlIiwiZW5hYmxlIiwiZGlzYWJsZWQiLCJsYXN0SW5kZXgiLCJib3VuZEluZGV4IiwiX2NyZWF0ZVByZXZOZXh0QnV0dG9ucyIsInByZXZCdXR0b24iLCJuZXh0QnV0dG9uIiwiYWN0aXZhdGVQcmV2TmV4dEJ1dHRvbnMiLCJkZWFjdGl2YXRlUHJldk5leHRCdXR0b25zIiwidW5iaW5kVGFwIiwidGFwRWxlbWVudCIsInBvaW50ZXJQb2ludCIsImJvdW5kaW5nUmVjdCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsInNjcm9sbFgiLCJzY3JvbGxZIiwiaXNJbnNpZGUiLCJ0b3AiLCJib3R0b20iLCJQYWdlRG90cyIsImhvbGRlciIsImRvdHMiLCJzZXREb3RzIiwiYWRkRG90cyIsInJlbW92ZURvdHMiLCJjb3VudCIsImZyYWdtZW50IiwiY3JlYXRlRG9jdW1lbnRGcmFnbWVudCIsIm5ld0RvdHMiLCJkb3QiLCJ1cGRhdGVTZWxlY3RlZCIsInNlbGVjdGVkRG90IiwiX2NyZWF0ZVBhZ2VEb3RzIiwiYWN0aXZhdGVQYWdlRG90cyIsInVwZGF0ZVNlbGVjdGVkUGFnZURvdHMiLCJ1cGRhdGVQYWdlRG90cyIsImRlYWN0aXZhdGVQYWdlRG90cyIsIlBsYXllciIsInN0YXRlIiwidmlzaWJpbGl0eUV2ZW50Iiwib25WaXNpYmlsaXR5Q2hhbmdlIiwidmlzaWJpbGl0eUNoYW5nZSIsIm9uVmlzaWJpbGl0eVBsYXkiLCJ2aXNpYmlsaXR5UGxheSIsImhpZGRlblByb3BlcnR5IiwicGxheSIsImlzUGFnZUhpZGRlbiIsInRpY2siLCJ0aW1lIiwiY2xlYXIiLCJzdG9wIiwicGF1c2UiLCJ1bnBhdXNlIiwicGF1c2VBdXRvUGxheU9uSG92ZXIiLCJfY3JlYXRlUGxheWVyIiwicGxheWVyIiwiYWN0aXZhdGVQbGF5ZXIiLCJzdG9wUGxheWVyIiwiZGVhY3RpdmF0ZVBsYXllciIsInBsYXlQbGF5ZXIiLCJwYXVzZVBsYXllciIsInVucGF1c2VQbGF5ZXIiLCJvbm1vdXNlZW50ZXIiLCJvbm1vdXNlbGVhdmUiLCJnZXRDZWxsc0ZyYWdtZW50IiwiaXNBcHBlbmQiLCJpbnNlcnRDZWxsRWxlbWVudCIsImluc2VydEJlZm9yZSIsImVuZENlbGxzIiwic2VsZWN0ZWRJbmRleERlbHRhIiwiX2NlbGxBZGRlZFJlbW92ZWQiLCJ3YXNCZWZvcmUiLCJjaGFuZ2VkQ2VsbEluZGV4IiwiY2VsbENoYW5nZSIsImNlbGxTaXplQ2hhbmdlIiwiaXNQb3NpdGlvbmluZ1NsaWRlciIsInByZXZTbGlkZWFibGVXaWR0aCIsImRlbHRhWCIsImdldENlbGxMYXp5SW1hZ2VzIiwiaW1ncyIsIkxhenlMb2FkZXIiLCJpbWciLCJmbGlja2l0eSIsImxvYWQiLCJfY3JlYXRlTGF6eWxvYWQiLCJsYXp5SW1hZ2VzIiwibGF6eUNlbGxJbWFnZXMiLCJzcmMiLCJvbmxvYWQiLCJjb21wbGV0ZSIsIm9uZXJyb3IiLCJJbWFnZXNMb2FkZWQiLCJvbkFsd2F5cyIsImdldEltYWdlcyIsIiQiLCJqcURlZmVycmVkIiwiRGVmZXJyZWQiLCJjaGVjayIsIkxvYWRpbmdJbWFnZSIsIkJhY2tncm91bmQiLCJ1cmwiLCJJbWFnZSIsImltYWdlcyIsImFkZEVsZW1lbnRJbWFnZXMiLCJhZGRJbWFnZSIsImJhY2tncm91bmQiLCJhZGRFbGVtZW50QmFja2dyb3VuZEltYWdlcyIsImVsZW1lbnROb2RlVHlwZXMiLCJjaGlsZEltZ3MiLCJjaGlsZCIsIjEiLCI5IiwiMTEiLCJyZVVSTCIsImV4ZWMiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJhZGRCYWNrZ3JvdW5kIiwibG9hZGluZ0ltYWdlIiwib25Qcm9ncmVzcyIsInByb2dyZXNzZWRDb3VudCIsImhhc0FueUJyb2tlbiIsImlzTG9hZGVkIiwibm90aWZ5IiwiZGVidWciLCJsb2ciLCJpc0NvbXBsZXRlIiwianFNZXRob2QiLCJnZXRJc0ltYWdlQ29tcGxldGUiLCJjb25maXJtIiwibmF0dXJhbFdpZHRoIiwicHJveHlJbWFnZSIsInVuYmluZEV2ZW50cyIsIm1ha2VKUXVlcnlQbHVnaW4iLCJmbiIsInByb21pc2UiLCJwcmVMaW5rRnVuY3Rpb24iLCIkc2NvcGUiLCIkYXR0cnMiLCIkY29udHJvbGxlciIsImJjRmxpY2tpdHlJZCIsInBvc3RMaW5rRnVuY3Rpb24iLCJmbGlja2l0eUluc3RhbmNlIiwiJG9uIiwicmVzdHJpY3QiLCJzY29wZSIsImJpbmRUb0NvbnRyb2xsZXIiLCJiY0ZsaWNraXR5IiwiY29tcGlsZSIsInByZSIsInBvc3QiLCJjb250cm9sbGVyIiwiY29udHJvbGxlckFzIiwiRmxpY2tpdHlDb250cm9sbGVyIiwiRmxpY2tpdHlDb25maWciLCJfYWN0aXZhdGUiLCJmcm9tSnNvbiIsIl9kaXNhYmxlQnV0dG9uSWZOZWVkZWQiLCJjZWxsQ291bnQiLCIkc2V0IiwiZmxpY2tpdHlJZCIsInNlbGVjdEV2ZW50Iiwic2V0dGxlRXZlbnQiLCJiY0ZsaWNraXR5TmV4dCIsIl9uZXh0IiwiTmV4dENvbnRyb2xsZXIiLCJfc2V0SWQiLCJnZXRGaXJzdCIsIndhcm4iLCJiY0ZsaWNraXR5UHJldmlvdXMiLCJfcHJldmlvdXMiLCJQcmV2aW91c0NvbnRyb2xsZXIiXSwibWFwcGluZ3MiOiJDQUFBLFNBQUFBLEVBQUFDLEdBQ0EsZ0JBQUFDLFVBQUEsZ0JBQUFDLFFBQ0FBLE9BQUFELFFBQUFELElBQ0Esa0JBQUFHLGdCQUFBQyxJQUNBRCxPQUFBLHNCQUFBSCxHQUNBLGdCQUFBQyxTQUNBQSxRQUFBLG9CQUFBRCxJQUVBRCxFQUFBLG9CQUFBQyxLQUNDSyxLQUFBLFdBQ0QsTUNBZ0IsVUFBVUMsR0NOMUIsUUFBQUMsR0FBQUMsR0FHQSxHQUFBQyxFQUFBRCxHQUNBLE1BQUFDLEdBQUFELEdBQUFQLE9BR0EsSUFBQUMsR0FBQU8sRUFBQUQsSUFDQVAsV0FDQVMsR0FBQUYsRUFDQUcsUUFBQSxFQVVBLE9BTkFMLEdBQUFFLEdBQUFJLEtBQUFWLEVBQUFELFFBQUFDLElBQUFELFFBQUFNLEdBR0FMLEVBQUFTLFFBQUEsRUFHQVQsRUFBQUQsUUF2QkEsR0FBQVEsS0FxQ0EsT0FUQUYsR0FBQU0sRUFBQVAsRUFHQUMsRUFBQU8sRUFBQUwsRUFHQUYsRUFBQVEsRUFBQSxHQUdBUixFQUFBLEtEZ0JNLFNBQVNMLEVBQVFELEVBQVNNLEdFdERoQyxZQ0FBLElBQUFTLEdBQUFULEVBQUEsR0FDQVUsRUFBQVYsRUFBQSxHQUNBVyxFQUFBWCxFQUFBLElBQ0FZLEVBQUFaLEVBQUEsSUFDQWEsRUFBQWIsRUFBQSxHQUVBYyxTQUFRbkIsT0FBTyxrQkFDVm9CLFNBQVMsaUJBRGROLEVBQUFPLHdCQUVLQyxRQUFRLGtCQUZiUCxFQUFBUSxpQkFHS0MsVUFBVSxhQUhmUixFQUFBUyxtQkFJS0QsVUFBVSxpQkFKZlAsRUFBQVMsdUJBS0tGLFVBQVUscUJBTGZOLEVBQUFTLDRCSGtFTSxTQUFT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QVlDLEdBQWlKLE1BQTlIRCxJQUFZVixFQUFpQk4sRUFBWWtCLFVBQVdGLEdBQWlCQyxHQUFhWCxFQUFpQk4sRUFBYWlCLEdBQXFCakIsS3JDcThLdGdCL0IsR0FBUWkwQixtQkFBcUIsV3NDejhLbkQsUUFBQUEsR0FDSTl1QixFQUFNRixFQUFJRCxFQUNWZ3VCLEVBQWdCeHhCLEdBRWhCLFVBREZLLEdBQUF6QixLQUFBNnpCLEdBR0U3ekIsS0FBSytFLEtBQU9BLEVBQ1ovRSxLQUFLNkUsR0FBS0EsRUFDVjdFLEtBQUs0RSxTQUFXQSxFQUNoQjVFLEtBQUs0eUIsZUFBaUJBLEVBQ3RCNXlCLEtBQUtvQixnQkFBa0JBLEVBR3ZCcEIsS0FBSzZ5QixZRG9EVCxNckN5NEtDZ0IsR0FBbUI1dUIsU0FBVyxPQUFRLEtBQU0sV0FBWSxpQkFBa0IsbUJxQ243SzNFakQsRUFBYTZ4QixJQUNUbnhCLElBQUssWUFDTFgsTUFBTyxXQ0hQL0IsS0FBS3FFLFdBQWFyRSxLQUFLMnpCLG9CQUFzQjN6QixLQUFLNHlCLGVBQWV2dUIsV0FDakVyRSxLQUFLa3pCLFdBQWEsS0FHbEJsekIsS0FBS3d6QixZRGVMOXdCLElBQUssU0FDTFgsTUFBTyxXQ05GLEdBQUFvRCxHQUFBbkYsSUFFTCxPQUFPQSxNQUFLNkUsR0FBRyxTQUFDVSxFQUFTQyxHQUVqQkwsRUFBSzJzQixjQUNMM3NCLEVBQUsrdEIsV0FBYS90QixFQUFLMnNCLGFBQ3ZCdnNCLEVBQVFKLEVBQUsrdEIsYUFFYi90QixFQUFLUCxTQUFTLFdBQ1ZPLEVBQUsvRCxnQkFBZ0JxeUIsV0FDaEIxdEIsS0FBSyxTQUFDckUsR0FDSHlELEVBQUsrdEIsV0FBYXh4QixFQUFTckIsR0FDM0JrRixFQUFRSixFQUFLK3RCLGNBSHJCL3RCLFNBS1csU0FBQ1MsR0FDSlQsRUFBS0osS0FBSzJ1QixLQUFLOXRCLEdBQ2ZKLEVBQU9JLGFEYXhCaXVCIiwiZmlsZSI6ImFuZ3VsYXItZmxpY2tpdHkubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoXCJhbmd1bGFyLWZsaWNraXR5XCIsIFtdLCBmYWN0b3J5KTtcblx0ZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpXG5cdFx0ZXhwb3J0c1tcImFuZ3VsYXItZmxpY2tpdHlcIl0gPSBmYWN0b3J5KCk7XG5cdGVsc2Vcblx0XHRyb290W1wiYW5ndWxhci1mbGlja2l0eVwiXSA9IGZhY3RvcnkoKTtcbn0pKHRoaXMsIGZ1bmN0aW9uKCkge1xucmV0dXJuIFxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIHdlYnBhY2svdW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvblxuICoqLyIsIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFwiYW5ndWxhci1mbGlja2l0eVwiLCBbXSwgZmFjdG9yeSk7XG5cdGVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKVxuXHRcdGV4cG9ydHNbXCJhbmd1bGFyLWZsaWNraXR5XCJdID0gZmFjdG9yeSgpO1xuXHRlbHNlXG5cdFx0cm9vdFtcImFuZ3VsYXItZmxpY2tpdHlcIl0gPSBmYWN0b3J5KCk7XG59KSh0aGlzLCBmdW5jdGlvbigpIHtcbnJldHVybiAvKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwXG4vKioqKioqLyBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4vKioqKioqLyBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4vKioqKioqLyBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4vKioqKioqLyBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbi8qKioqKiovIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4vKioqKioqLyBcdFx0XHRleHBvcnRzOiB7fSxcbi8qKioqKiovIFx0XHRcdGlkOiBtb2R1bGVJZCxcbi8qKioqKiovIFx0XHRcdGxvYWRlZDogZmFsc2Vcbi8qKioqKiovIFx0XHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbi8qKioqKiovIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuLyoqKioqKi8gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuLyoqKioqKi8gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbi8qKioqKiovIFx0fVxuLyoqKioqKi9cbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLyoqKioqKi8gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcbi8qKioqKiovIH0pXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gKFtcbi8qIDAgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdHZhciBfZmxpY2tpdHkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXHRcblx0dmFyIF9mbGlja2l0eTIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xuXHRcblx0dmFyIF9mbGlja2l0eTMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIyKTtcblx0XG5cdHZhciBfZmxpY2tpdHlOZXh0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNCk7XG5cdFxuXHR2YXIgX2ZsaWNraXR5UHJldmlvdXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI2KTtcblx0XG5cdGFuZ3VsYXIubW9kdWxlKCdiYy5GbGlja2l0eScsIFtdKS5wcm92aWRlcignRmxpY2tpdHlDb25maWcnLCBfZmxpY2tpdHkuRmxpY2tpdHlDb25maWdQcm92aWRlcikuc2VydmljZSgnRmxpY2tpdHlTZXJ2aWNlJywgX2ZsaWNraXR5Mi5GbGlja2l0eVNlcnZpY2UpLmRpcmVjdGl2ZSgnYmNGbGlja2l0eScsIF9mbGlja2l0eTMuRmxpY2tpdHlEaXJlY3RpdmUpLmRpcmVjdGl2ZSgnYmNGbGlja2l0eU5leHQnLCBfZmxpY2tpdHlOZXh0LkZsaWNraXR5TmV4dERpcmVjdGl2ZSkuZGlyZWN0aXZlKCdiY0ZsaWNraXR5UHJldmlvdXMnLCBfZmxpY2tpdHlQcmV2aW91cy5GbGlja2l0eVByZXZpb3VzRGlyZWN0aXZlKTtcblxuLyoqKi8gfSxcbi8qIDEgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuXHQgICAgdmFsdWU6IHRydWVcblx0fSk7XG5cdFxuXHR2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXHRcblx0ZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblx0XG5cdHZhciBGbGlja2l0eUNvbmZpZ1Byb3ZpZGVyID0gZXhwb3J0cy5GbGlja2l0eUNvbmZpZ1Byb3ZpZGVyID0gZnVuY3Rpb24gKCkge1xuXHQgICAgZnVuY3Rpb24gRmxpY2tpdHlDb25maWdQcm92aWRlcigpIHtcblx0ICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRmxpY2tpdHlDb25maWdQcm92aWRlcik7XG5cdFxuXHQgICAgICAgIC8vIERlZmluZSBGbGlja2l0eSBkZWZhdWx0c1xuXHQgICAgICAgIHRoaXMuYWNjZXNzaWJpbGl0eSA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5hZGFwdGl2ZUhlaWdodCA9IGZhbHNlO1xuXHQgICAgICAgIHRoaXMuYXV0b1BsYXkgPSBmYWxzZTtcblx0ICAgICAgICB0aGlzLmNlbGxBbGlnbiA9ICdjZW50ZXInO1xuXHQgICAgICAgIHRoaXMuY2VsbFNlbGVjdG9yID0gdW5kZWZpbmVkO1xuXHQgICAgICAgIHRoaXMuY29udGFpbiA9IGZhbHNlO1xuXHQgICAgICAgIHRoaXMuZHJhZ2dhYmxlID0gdHJ1ZTtcblx0ICAgICAgICB0aGlzLmRyYWdUaHJlc2hvbGQgPSAzO1xuXHQgICAgICAgIHRoaXMuZnJlZVNjcm9sbCA9IGZhbHNlO1xuXHQgICAgICAgIHRoaXMuZnJlZVNjcm9sbEZyaWN0aW9uID0gZmFsc2U7XG5cdCAgICAgICAgdGhpcy5zZWxlY3RlZEF0dHJhY3Rpb24gPSAuMDI1O1xuXHQgICAgICAgIHRoaXMuZnJpY3Rpb24gPSAuMjg7XG5cdCAgICAgICAgdGhpcy5ncm91cENlbGxzID0gZmFsc2U7XG5cdCAgICAgICAgdGhpcy5pbml0aWFsSW5kZXggPSAwO1xuXHQgICAgICAgIHRoaXMubGF6eUxvYWQgPSB0cnVlO1xuXHQgICAgICAgIHRoaXMucGVyY2VudFBvc2l0aW9uID0gdHJ1ZTtcblx0ICAgICAgICB0aGlzLnByZXZOZXh0QnV0dG9ucyA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5wYWdlRG90cyA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5yZXNpemUgPSB0cnVlO1xuXHQgICAgICAgIHRoaXMucmlnaHRUb0xlZnQgPSBmYWxzZTtcblx0ICAgICAgICB0aGlzLnNldEdhbGxlcnlTaXplID0gdHJ1ZTtcblx0ICAgICAgICB0aGlzLndhdGNoQ1NTID0gZmFsc2U7XG5cdCAgICAgICAgdGhpcy53cmFwQXJvdW5kID0gZmFsc2U7XG5cdCAgICAgICAgdGhpcy5pbWFnZXNMb2FkZWQgPSB0cnVlO1xuXHQgICAgICAgIHRoaXMuYXNOYXZGb3IgPSB0cnVlO1xuXHQgICAgfVxuXHRcblx0ICAgIF9jcmVhdGVDbGFzcyhGbGlja2l0eUNvbmZpZ1Byb3ZpZGVyLCBbe1xuXHQgICAgICAgIGtleTogJyRnZXQnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiAkZ2V0KCkge1xuXHQgICAgICAgICAgICByZXR1cm4gdGhpcztcblx0ICAgICAgICB9XG5cdCAgICB9XSk7XG5cdFxuXHQgICAgcmV0dXJuIEZsaWNraXR5Q29uZmlnUHJvdmlkZXI7XG5cdH0oKTtcblxuLyoqKi8gfSxcbi8qIDIgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuXHQgICAgdmFsdWU6IHRydWVcblx0fSk7XG5cdGV4cG9ydHMuRmxpY2tpdHlTZXJ2aWNlID0gdW5kZWZpbmVkO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblx0XG5cdHZhciBfZmxpY2tpdHkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpO1xuXHRcblx0dmFyIF9mbGlja2l0eTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9mbGlja2l0eSk7XG5cdFxuXHRfX3dlYnBhY2tfcmVxdWlyZV9fKDIxKTtcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cdFxuXHRmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXHRcblx0dmFyIEZsaWNraXR5U2VydmljZSA9IGV4cG9ydHMuRmxpY2tpdHlTZXJ2aWNlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgRmxpY2tpdHlTZXJ2aWNlLiRpbmplY3QgPSBbXCIkdGltZW91dFwiLCBcIiRxXCIsIFwiJHJvb3RTY29wZVwiLCBcIiRsb2dcIl07XG5cdCAgICBmdW5jdGlvbiBGbGlja2l0eVNlcnZpY2UoJHRpbWVvdXQsICRxLCAkcm9vdFNjb3BlLCAkbG9nKSB7XG5cdCAgICAgICAgJ25nSW5qZWN0Jztcblx0XG5cdCAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEZsaWNraXR5U2VydmljZSk7XG5cdFxuXHQgICAgICAgIHRoaXMuJHRpbWVvdXQgPSAkdGltZW91dDtcblx0ICAgICAgICB0aGlzLiRxID0gJHE7XG5cdCAgICAgICAgdGhpcy4kcm9vdFNjb3BlID0gJHJvb3RTY29wZTtcblx0ICAgICAgICB0aGlzLiRsb2cgPSAkbG9nO1xuXHRcblx0ICAgICAgICB0aGlzLmluc3RhbmNlcyA9IFtdO1xuXHQgICAgfVxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQ3JlYXRlIGEgbmV3IEZsaWNraXR5IGluc3RhbmNlXG5cdCAgICAgKlxuXHQgICAgICogQHBhcmFtIHtFbGVtZW50fSBlbGVtZW50XG5cdCAgICAgKiBAcGFyYW0ge1N0cmluZ30gaWRcblx0ICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zXG5cdCAgICAgKiBAcmV0dXJuIHtPYmplY3R9IGluc3RhbmNlXG5cdCAgICAgKi9cblx0XG5cdFxuXHQgICAgX2NyZWF0ZUNsYXNzKEZsaWNraXR5U2VydmljZSwgW3tcblx0ICAgICAgICBrZXk6ICdjcmVhdGUnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGUoZWxlbWVudCkge1xuXHQgICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXHRcblx0ICAgICAgICAgICAgdmFyIGlkID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8gdGhpcy5pbnN0YW5jZXMubGVuZ3RoICsgMSA6IGFyZ3VtZW50c1sxXTtcblx0ICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHNbMl07XG5cdFxuXHQgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXHQgICAgICAgICAgICAgICAgLy8gQ2hlY2sgdG8gc2VlIGlmIHRoZSBJRCBpcyBhbHJlYWR5IGluIHVzZVxuXHQgICAgICAgICAgICAgICAgaWYgKF90aGlzLl9maW5kT2JqZWN0QnlJZChfdGhpcy5pbnN0YW5jZXMsIGlkKSkge1xuXHQgICAgICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IF90aGlzLl9nZXRGbGlja2l0eUluZGV4KGlkKTtcblx0ICAgICAgICAgICAgICAgICAgICBfdGhpcy4kbG9nLmVycm9yKCdUaGlzIElEIGlzIGFscmVhZHkgaW4gdXNlOiAnLCBfdGhpcy5pbnN0YW5jZXNbaW5kZXhdKTtcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICAgICAgLy8gRGVmaW5lIHRoZSBuZXcgaW5zdGFuY2Vcblx0ICAgICAgICAgICAgICAgIHZhciBpbnN0YW5jZSA9IHtcblx0ICAgICAgICAgICAgICAgICAgICBpZDogaWQsXG5cdCAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2U6IG5ldyBfZmxpY2tpdHkyLmRlZmF1bHQoZWxlbWVudCwgb3B0aW9ucylcblx0ICAgICAgICAgICAgICAgIH07XG5cdFxuXHQgICAgICAgICAgICAgICAgLy8gU2F2ZSB0aGlzIGluc3RhbmNlIHRvIHRoZSBhcnJheVxuXHQgICAgICAgICAgICAgICAgX3RoaXMuaW5zdGFuY2VzLnB1c2goaW5zdGFuY2UpO1xuXHRcblx0ICAgICAgICAgICAgICAgIC8vIEJpbmQgdG8gYWxsIGV2ZW50c1xuXHQgICAgICAgICAgICAgICAgX3RoaXMuX2JpbmRFdmVudHMoaWQpLnRoZW4oZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoaW5zdGFuY2UpO1xuXHQgICAgICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogRGVzdHJveSBhIEZsaWNraXR5IGluc3RhbmNlXG5cdCAgICAgICAgICpcblx0ICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gaWRcblx0ICAgICAgICAgKiBAcmV0dXJuIHtPYmplY3R9IGluc3RhbmNlXG5cdCAgICAgICAgICovXG5cdFxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ2Rlc3Ryb3knLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KGlkKSB7XG5cdCAgICAgICAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblx0ICAgICAgICAgICAgICAgIHZhciBmbGlja2l0eUluZGV4ID0gX3RoaXMyLl9nZXRGbGlja2l0eUluZGV4KGlkKTtcblx0XG5cdCAgICAgICAgICAgICAgICBpZiAoZmxpY2tpdHlJbmRleCA8IDApIHtcblx0ICAgICAgICAgICAgICAgICAgICByZWplY3QoJ0luc3RhbmNlICcgKyBpZCArICcgbm90IGZvdW5kJyk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICAgICAgLy8gRGVzdHJveSB0aGUgRmxpY2tpdHkgaW5zdGFuY2Vcblx0ICAgICAgICAgICAgICAgIF90aGlzMi5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0uaW5zdGFuY2UuZGVzdHJveSgpO1xuXHRcblx0ICAgICAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgaW5zdGFuY2UgZnJvbSB0aGUgYXJyYXlcblx0ICAgICAgICAgICAgICAgIF90aGlzMi5pbnN0YW5jZXMuc3BsaWNlKGZsaWNraXR5SW5kZXgsIDEpO1xuXHRcblx0ICAgICAgICAgICAgICAgIHJlc29sdmUoJ0luc3RhbmNlICcgKyBpZCArICcgZGVzdHJveWVkLicpO1xuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIE1vdmUgdG8gdGhlIG5leHQgc2xpZGVcblx0ICAgICAgICAgKlxuXHQgICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuXHQgICAgICAgICAqIEBwYXJhbSB7Qm9vbH0gaXNXcmFwcGVkXG5cdCAgICAgICAgICogQHBhcmFtIHtCb29sfSBpc0luc3RhbnRcblx0ICAgICAgICAgKiBAcmV0dXJuIHtPYmplY3R9IGluc3RhbmNlXG5cdCAgICAgICAgICovXG5cdFxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ25leHQnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBuZXh0KGlkLCBpc1dyYXBwZWQsIGlzSW5zdGFudCkge1xuXHQgICAgICAgICAgICB2YXIgX3RoaXMzID0gdGhpcztcblx0XG5cdCAgICAgICAgICAgIHJldHVybiB0aGlzLiRxKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblx0ICAgICAgICAgICAgICAgIHZhciBmbGlja2l0eUluZGV4ID0gX3RoaXMzLl9nZXRGbGlja2l0eUluZGV4KGlkKTtcblx0XG5cdCAgICAgICAgICAgICAgICBpZiAoZmxpY2tpdHlJbmRleCA8IDApIHtcblx0ICAgICAgICAgICAgICAgICAgICByZWplY3QoJ0luc3RhbmNlICcgKyBpZCArICcgbm90IGZvdW5kJyk7XG5cdCAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgICAgIC8vIE1vdmUgdG8gdGhlIG5leHQgc2xpZGVcblx0ICAgICAgICAgICAgICAgICAgICBfdGhpczMuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLm5leHQoaXNXcmFwcGVkLCBpc0luc3RhbnQpO1xuXHRcblx0ICAgICAgICAgICAgICAgICAgICByZXNvbHZlKF90aGlzMy5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0pO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIE1vdmUgdG8gdGhlIHByZXZpb3VzIHNsaWRlXG5cdCAgICAgICAgICpcblx0ICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gaWRcblx0ICAgICAgICAgKiBAcGFyYW0ge0Jvb2x9IGlzV3JhcHBlZFxuXHQgICAgICAgICAqIEBwYXJhbSB7Qm9vbH0gaXNJbnN0YW50XG5cdCAgICAgICAgICogQHJldHVybiB7T2JqZWN0fSBpbnN0YW5jZVxuXHQgICAgICAgICAqL1xuXHRcblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdwcmV2aW91cycsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHByZXZpb3VzKGlkLCBpc1dyYXBwZWQsIGlzSW5zdGFudCkge1xuXHQgICAgICAgICAgICB2YXIgX3RoaXM0ID0gdGhpcztcblx0XG5cdCAgICAgICAgICAgIHJldHVybiB0aGlzLiRxKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblx0ICAgICAgICAgICAgICAgIHZhciBmbGlja2l0eUluZGV4ID0gX3RoaXM0Ll9nZXRGbGlja2l0eUluZGV4KGlkKTtcblx0XG5cdCAgICAgICAgICAgICAgICBpZiAoZmxpY2tpdHlJbmRleCA8IDApIHtcblx0ICAgICAgICAgICAgICAgICAgICByZWplY3QoJ0luc3RhbmNlICcgKyBpZCArICcgbm90IGZvdW5kJyk7XG5cdCAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgICAgIC8vIE1vdmUgdG8gdGhlIHByZXZpb3VzIHNsaWRlXG5cdCAgICAgICAgICAgICAgICAgICAgX3RoaXM0Lmluc3RhbmNlc1tmbGlja2l0eUluZGV4XS5pbnN0YW5jZS5wcmV2aW91cyhpc1dyYXBwZWQsIGlzSW5zdGFudCk7XG5cdFxuXHQgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoX3RoaXM0Lmluc3RhbmNlc1tmbGlja2l0eUluZGV4XSk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogU2VsZWN0IGEgc2xpZGVcblx0ICAgICAgICAgKlxuXHQgICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBpZFxuXHQgICAgICAgICAqIEBwYXJhbSB7SW50ZWdlcn0gaW5kZXhcblx0ICAgICAgICAgKiBAcGFyYW0ge0Jvb2x9IGlzV3JhcHBlZFxuXHQgICAgICAgICAqIEBwYXJhbSB7Qm9vbH0gaXNJbnN0YW50XG5cdCAgICAgICAgICogQHJldHVybiB7T2JqZWN0fSBpbnN0YW5jZVxuXHQgICAgICAgICAqL1xuXHRcblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdzZWxlY3QnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZWxlY3QoaWQsIGluZGV4KSB7XG5cdCAgICAgICAgICAgIHZhciBfdGhpczUgPSB0aGlzO1xuXHRcblx0ICAgICAgICAgICAgdmFyIGlzV3JhcHBlZCA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMiB8fCBhcmd1bWVudHNbMl0gPT09IHVuZGVmaW5lZCA/IGZhbHNlIDogYXJndW1lbnRzWzJdO1xuXHQgICAgICAgICAgICB2YXIgaXNJbnN0YW50ID0gYXJndW1lbnRzLmxlbmd0aCA8PSAzIHx8IGFyZ3VtZW50c1szXSA9PT0gdW5kZWZpbmVkID8gZmFsc2UgOiBhcmd1bWVudHNbM107XG5cdFxuXHQgICAgICAgICAgICByZXR1cm4gdGhpcy4kcShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdCAgICAgICAgICAgICAgICB2YXIgZmxpY2tpdHlJbmRleCA9IF90aGlzNS5fZ2V0RmxpY2tpdHlJbmRleChpZCk7XG5cdFxuXHQgICAgICAgICAgICAgICAgaWYgKGZsaWNraXR5SW5kZXggPCAwKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCdJbnN0YW5jZSAnICsgaWQgKyAnIG5vdCBmb3VuZCcpO1xuXHQgICAgICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgICAgICAvLyBNb3ZlIHRvIHRoZSBzZWxlY3RlZCBzbGlkZVxuXHQgICAgICAgICAgICAgICAgICAgIF90aGlzNS5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0uaW5zdGFuY2Uuc2VsZWN0KGluZGV4LCBpc1dyYXBwZWQsIGlzSW5zdGFudCk7XG5cdFxuXHQgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoX3RoaXM1Lmluc3RhbmNlc1tmbGlja2l0eUluZGV4XSk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogU2VsZWN0IGEgc2xpZGUgb2YgYSBjZWxsXG5cdCAgICAgICAgICpcblx0ICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gaWRcblx0ICAgICAgICAgKiBAcGFyYW0ge0ludGVnZXJ8U3RyaW5nfSB2YWx1ZVxuXHQgICAgICAgICAqIEBwYXJhbSB7Qm9vbH0gaXNXcmFwcGVkXG5cdCAgICAgICAgICogQHBhcmFtIHtCb29sfSBpc0luc3RhbnRcblx0ICAgICAgICAgKiBAcmV0dXJuIHtPYmplY3R9IGluc3RhbmNlXG5cdCAgICAgICAgICovXG5cdFxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ3NlbGVjdENlbGwnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZWxlY3RDZWxsKGlkLCB2YWx1ZSkge1xuXHQgICAgICAgICAgICB2YXIgX3RoaXM2ID0gdGhpcztcblx0XG5cdCAgICAgICAgICAgIHZhciBpc1dyYXBwZWQgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDIgfHwgYXJndW1lbnRzWzJdID09PSB1bmRlZmluZWQgPyBmYWxzZSA6IGFyZ3VtZW50c1syXTtcblx0ICAgICAgICAgICAgdmFyIGlzSW5zdGFudCA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMyB8fCBhcmd1bWVudHNbM10gPT09IHVuZGVmaW5lZCA/IGZhbHNlIDogYXJndW1lbnRzWzNdO1xuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHEoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXHQgICAgICAgICAgICAgICAgdmFyIGZsaWNraXR5SW5kZXggPSBfdGhpczYuX2dldEZsaWNraXR5SW5kZXgoaWQpO1xuXHRcblx0ICAgICAgICAgICAgICAgIGlmIChmbGlja2l0eUluZGV4IDwgMCkge1xuXHQgICAgICAgICAgICAgICAgICAgIHJlamVjdCgnSW5zdGFuY2UgJyArIGlkICsgJyBub3QgZm91bmQnKTtcblx0ICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICAgICAgLy8gTW92ZSB0byB0aGUgc2VsZWN0ZWQgc2xpZGVcblx0ICAgICAgICAgICAgICAgICAgICBfdGhpczYuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLnNlbGVjdENlbGwodmFsdWUsIGlzV3JhcHBlZCwgaXNJbnN0YW50KTtcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShfdGhpczYuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdKTtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBHZXQgdGhlIGN1cnJlbnQgc2xpZGUgaW5kZXhcblx0ICAgICAgICAgKlxuXHQgICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBpZFxuXHQgICAgICAgICAqIEByZXR1cm4ge0ludGVnZXJ9IHNlbGVjdGVkSW5kZXhcblx0ICAgICAgICAgKi9cblx0XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnc2VsZWN0ZWRJbmRleCcsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNlbGVjdGVkSW5kZXgoaWQpIHtcblx0ICAgICAgICAgICAgdmFyIF90aGlzNyA9IHRoaXM7XG5cdFxuXHQgICAgICAgICAgICByZXR1cm4gdGhpcy4kcShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdCAgICAgICAgICAgICAgICB2YXIgZmxpY2tpdHlJbmRleCA9IF90aGlzNy5fZ2V0RmxpY2tpdHlJbmRleChpZCk7XG5cdFxuXHQgICAgICAgICAgICAgICAgaWYgKGZsaWNraXR5SW5kZXggPCAwKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCdJbnN0YW5jZSAnICsgaWQgKyAnIG5vdCBmb3VuZCcpO1xuXHQgICAgICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgICAgICAvLyBSZXR1cm4gdGhlIGN1cnJlbnQgaW5kZXhcblx0ICAgICAgICAgICAgICAgICAgICByZXNvbHZlKF90aGlzNy5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0uaW5zdGFuY2Uuc2VsZWN0ZWRJbmRleCk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogUmVzaXplIHRoZSBnYWxsZXJ5IGFuZCByZS1wb3NpdGlvbiBjZWxscy5cblx0ICAgICAgICAgKlxuXHQgICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBpZFxuXHQgICAgICAgICAqIEByZXR1cm4ge09iamVjdH0gaW5zdGFuY2Vcblx0ICAgICAgICAgKi9cblx0XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAncmVzaXplJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVzaXplKGlkKSB7XG5cdCAgICAgICAgICAgIHZhciBfdGhpczggPSB0aGlzO1xuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHEoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXHQgICAgICAgICAgICAgICAgdmFyIGZsaWNraXR5SW5kZXggPSBfdGhpczguX2dldEZsaWNraXR5SW5kZXgoaWQpO1xuXHRcblx0ICAgICAgICAgICAgICAgIGlmIChmbGlja2l0eUluZGV4IDwgMCkge1xuXHQgICAgICAgICAgICAgICAgICAgIHJlamVjdCgnSW5zdGFuY2UgJyArIGlkICsgJyBub3QgZm91bmQnKTtcblx0ICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICAgICAgLy8gVHJpZ2dlciB0aGUgcmVzaXplXG5cdCAgICAgICAgICAgICAgICAgICAgX3RoaXM4Lmluc3RhbmNlc1tmbGlja2l0eUluZGV4XS5pbnN0YW5jZS5yZXNpemUoKTtcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShfdGhpczguaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdKTtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBQb3NpdGlvbiBjZWxscyBhdCBzZWxlY3RlZCBwb3NpdGlvbi5cblx0ICAgICAgICAgKiBUcmlnZ2VyIHJlcG9zaXRpb24gYWZ0ZXIgdGhlIHNpemUgb2YgYSBjZWxsIGhhcyBiZWVuIGNoYW5nZWQuXG5cdCAgICAgICAgICpcblx0ICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gaWRcblx0ICAgICAgICAgKiBAcmV0dXJuIHtPYmplY3R9IGluc3RhbmNlXG5cdCAgICAgICAgICovXG5cdFxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ3JlcG9zaXRpb24nLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZXBvc2l0aW9uKGlkKSB7XG5cdCAgICAgICAgICAgIHZhciBfdGhpczkgPSB0aGlzO1xuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHEoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXHQgICAgICAgICAgICAgICAgdmFyIGZsaWNraXR5SW5kZXggPSBfdGhpczkuX2dldEZsaWNraXR5SW5kZXgoaWQpO1xuXHRcblx0ICAgICAgICAgICAgICAgIGlmIChmbGlja2l0eUluZGV4IDwgMCkge1xuXHQgICAgICAgICAgICAgICAgICAgIHJlamVjdCgnSW5zdGFuY2UgJyArIGlkICsgJyBub3QgZm91bmQnKTtcblx0ICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICAgICAgLy8gVHJpZ2dlciB0aGUgcmVzaXplXG5cdCAgICAgICAgICAgICAgICAgICAgX3RoaXM5Lmluc3RhbmNlc1tmbGlja2l0eUluZGV4XS5pbnN0YW5jZS5yZXBvc2l0aW9uKCk7XG5cdFxuXHQgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoX3RoaXM5Lmluc3RhbmNlc1tmbGlja2l0eUluZGV4XSk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogUmUtY29sbGVjdCBhbGwgY2VsbCBlbGVtZW50cyBpbiBgZmxpY2tpdHktc2xpZGVyYC5cblx0ICAgICAgICAgKlxuXHQgICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBpZFxuXHQgICAgICAgICAqIEByZXR1cm4ge09iamVjdH0gaW5zdGFuY2Vcblx0ICAgICAgICAgKi9cblx0XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAncmVsb2FkQ2VsbHMnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZWxvYWRDZWxscyhpZCkge1xuXHQgICAgICAgICAgICB2YXIgX3RoaXMxMCA9IHRoaXM7XG5cdFxuXHQgICAgICAgICAgICByZXR1cm4gdGhpcy4kcShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdCAgICAgICAgICAgICAgICB2YXIgZmxpY2tpdHlJbmRleCA9IF90aGlzMTAuX2dldEZsaWNraXR5SW5kZXgoaWQpO1xuXHRcblx0ICAgICAgICAgICAgICAgIGlmIChmbGlja2l0eUluZGV4IDwgMCkge1xuXHQgICAgICAgICAgICAgICAgICAgIHJlamVjdCgnSW5zdGFuY2UgJyArIGlkICsgJyBub3QgZm91bmQnKTtcblx0ICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICAgICAgLy8gUmVsb2FkIGNlbGxzXG5cdCAgICAgICAgICAgICAgICAgICAgX3RoaXMxMC5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0uaW5zdGFuY2UucmVsb2FkQ2VsbHMoKTtcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShfdGhpczEwLmluc3RhbmNlc1tmbGlja2l0eUluZGV4XSk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogR2V0IHRoZSBGbGlja2l0eSBpbnN0YW5jZVxuXHQgICAgICAgICAqXG5cdCAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IGlkXG5cdCAgICAgICAgICogQHJldHVybiB7T2JqZWN0fSBpbnN0YW5jZVxuXHQgICAgICAgICAqL1xuXHRcblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdnZXQnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXQoaWQpIHtcblx0ICAgICAgICAgICAgdmFyIF90aGlzMTEgPSB0aGlzO1xuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHEoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXHQgICAgICAgICAgICAgICAgdmFyIGZsaWNraXR5SW5kZXggPSBfdGhpczExLl9nZXRGbGlja2l0eUluZGV4KGlkKTtcblx0XG5cdCAgICAgICAgICAgICAgICBpZiAoZmxpY2tpdHlJbmRleCA8IDApIHtcblx0ICAgICAgICAgICAgICAgICAgICByZWplY3QoJ0luc3RhbmNlICcgKyBpZCArICcgbm90IGZvdW5kJyk7XG5cdCAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoX3RoaXMxMS5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0pO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIEdldCB0aGUgZmlyc3QgRmxpY2tpdHkgaW5zdGFuY2Vcblx0ICAgICAgICAgKlxuXHQgICAgICAgICAqIEByZXR1cm4ge09iamVjdH0gaW5zdGFuY2Vcblx0ICAgICAgICAgKi9cblx0XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnZ2V0Rmlyc3QnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRGaXJzdCgpIHtcblx0ICAgICAgICAgICAgdmFyIF90aGlzMTIgPSB0aGlzO1xuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHEoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXHQgICAgICAgICAgICAgICAgaWYgKCFfdGhpczEyLmluc3RhbmNlcyB8fCBfdGhpczEyLmluc3RhbmNlcy5sZW5ndGggPCAxKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCdObyBpbnN0YW5jZXMgZXhpc3QnKTtcblx0ICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShfdGhpczEyLmluc3RhbmNlc1swXSk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogR2V0IHRoZSBGbGlja2l0eSBpbnN0YW5jZVxuXHQgICAgICAgICAqXG5cdCAgICAgICAgICogQHBhcmFtIHtFbGVtZW50fSBlbGVtZW50XG5cdCAgICAgICAgICogQHJldHVybiB7T2JqZWN0fSBpbnN0YW5jZVxuXHQgICAgICAgICAqL1xuXHRcblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdnZXRCeUVsZW1lbnQnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRCeUVsZW1lbnQoZWxlbWVudCkge1xuXHQgICAgICAgICAgICByZXR1cm4gdGhpcy4kcShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdCAgICAgICAgICAgICAgICB2YXIgaW5zdGFuY2UgPSBfZmxpY2tpdHkyLmRlZmF1bHQuZGF0YShlbGVtZW50KTtcblx0XG5cdCAgICAgICAgICAgICAgICBpZiAoaW5zdGFuY2UpIHtcblx0ICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGluc3RhbmNlKTtcblx0ICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCdJbnN0YW5jZSBub3QgZm91bmQgZm9yICcgKyBlbGVtZW50KTtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBQcmVwZW5kIGVsZW1lbnRzIGFuZCBjcmVhdGUgY2VsbHMgdG8gdGhlIGJlZ2lubmluZyBvZiB0aGUgZ2FsbGVyeS5cblx0ICAgICAgICAgKlxuXHQgICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBpZFxuXHQgICAgICAgICAqIEBwYXJhbSB7Kn0gZWxlbWVudChzKSAtIGpRdWVyeSBvYmplY3QsIEFycmF5IG9mIEVsZW1lbnRzLCBFbGVtZW50LCBvciBOb2RlTGlzdFxuXHQgICAgICAgICAqIEByZXR1cm4ge09iamVjdH0gaW5zdGFuY2Vcblx0ICAgICAgICAgKi9cblx0XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAncHJlcGVuZCcsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHByZXBlbmQoaWQsIGVsZW1lbnRzKSB7XG5cdCAgICAgICAgICAgIHZhciBfdGhpczEzID0gdGhpcztcblx0XG5cdCAgICAgICAgICAgIHJldHVybiB0aGlzLiRxKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblx0ICAgICAgICAgICAgICAgIHZhciBmbGlja2l0eUluZGV4ID0gX3RoaXMxMy5fZ2V0RmxpY2tpdHlJbmRleChpZCk7XG5cdFxuXHQgICAgICAgICAgICAgICAgaWYgKGZsaWNraXR5SW5kZXggPCAwKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCdJbnN0YW5jZSAnICsgaWQgKyAnIG5vdCBmb3VuZCcpO1xuXHQgICAgICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgICAgICAvLyBQcmVwZW5kIHRoZSBzbGlkZXNcblx0ICAgICAgICAgICAgICAgICAgICBfdGhpczEzLmluc3RhbmNlc1tmbGlja2l0eUluZGV4XS5pbnN0YW5jZS5wcmVwZW5kKGVsZW1lbnRzKTtcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShfdGhpczEzLmluc3RhbmNlc1tmbGlja2l0eUluZGV4XSk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogQXBwZW5kIGVsZW1lbnRzIGFuZCBjcmVhdGUgY2VsbHMgdG8gdGhlIGVuZCBvZiB0aGUgZ2FsbGVyeS5cblx0ICAgICAgICAgKlxuXHQgICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBpZFxuXHQgICAgICAgICAqIEBwYXJhbSB7Kn0gZWxlbWVudChzKSAtIGpRdWVyeSBvYmplY3QsIEFycmF5IG9mIEVsZW1lbnRzLCBFbGVtZW50LCBvciBOb2RlTGlzdFxuXHQgICAgICAgICAqIEByZXR1cm4ge09iamVjdH0gaW5zdGFuY2Vcblx0ICAgICAgICAgKi9cblx0XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnYXBwZW5kJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYXBwZW5kKGlkLCBlbGVtZW50cykge1xuXHQgICAgICAgICAgICB2YXIgX3RoaXMxNCA9IHRoaXM7XG5cdFxuXHQgICAgICAgICAgICByZXR1cm4gdGhpcy4kcShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdCAgICAgICAgICAgICAgICB2YXIgZmxpY2tpdHlJbmRleCA9IF90aGlzMTQuX2dldEZsaWNraXR5SW5kZXgoaWQpO1xuXHRcblx0ICAgICAgICAgICAgICAgIGlmIChmbGlja2l0eUluZGV4IDwgMCkge1xuXHQgICAgICAgICAgICAgICAgICAgIHJlamVjdCgnSW5zdGFuY2UgJyArIGlkICsgJyBub3QgZm91bmQnKTtcblx0ICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICAgICAgLy8gQXBwZW5kIHRoZSBzbGlkZXNcblx0ICAgICAgICAgICAgICAgICAgICBfdGhpczE0Lmluc3RhbmNlc1tmbGlja2l0eUluZGV4XS5pbnN0YW5jZS5hcHBlbmQoZWxlbWVudHMpO1xuXHRcblx0ICAgICAgICAgICAgICAgICAgICByZXNvbHZlKF90aGlzMTQuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdKTtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBJbnNlcnQgZWxlbWVudHMgaW50byB0aGUgZ2FsbGVyeSBhbmQgY3JlYXRlIGNlbGxzIGF0IHRoZSBkZXNpcmVkIGluZGV4LlxuXHQgICAgICAgICAqXG5cdCAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IGlkXG5cdCAgICAgICAgICogQHBhcmFtIHsqfSBlbGVtZW50KHMpIC0galF1ZXJ5IG9iamVjdCwgQXJyYXkgb2YgRWxlbWVudHMsIEVsZW1lbnQsIG9yIE5vZGVMaXN0XG5cdCAgICAgICAgICogQHBhcmFtIHtJbnRlZ2VyfSBpbmRleCAtIFplcm8gYmFzZWQgaW5kZXhcblx0ICAgICAgICAgKiBAcmV0dXJuIHtPYmplY3R9IGluc3RhbmNlXG5cdCAgICAgICAgICovXG5cdFxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ2luc2VydCcsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluc2VydChpZCwgZWxlbWVudHMsIGluZGV4KSB7XG5cdCAgICAgICAgICAgIHZhciBfdGhpczE1ID0gdGhpcztcblx0XG5cdCAgICAgICAgICAgIHJldHVybiB0aGlzLiRxKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblx0ICAgICAgICAgICAgICAgIHZhciBmbGlja2l0eUluZGV4ID0gX3RoaXMxNS5fZ2V0RmxpY2tpdHlJbmRleChpZCk7XG5cdFxuXHQgICAgICAgICAgICAgICAgaWYgKGZsaWNraXR5SW5kZXggPCAwKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCdJbnN0YW5jZSAnICsgaWQgKyAnIG5vdCBmb3VuZCcpO1xuXHQgICAgICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgICAgICAvLyBJbnNlcnQgdGhlIHNsaWRlc1xuXHQgICAgICAgICAgICAgICAgICAgIF90aGlzMTUuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLmluc2VydChlbGVtZW50cywgaW5kZXgpO1xuXHRcblx0ICAgICAgICAgICAgICAgICAgICByZXNvbHZlKF90aGlzMTUuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdKTtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBHZXQgdGhlIGVsZW1lbnRzIG9mIHRoZSBjZWxsc1xuXHQgICAgICAgICAqXG5cdCAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IGlkXG5cdCAgICAgICAgICogQHJldHVybiB7QXJyYXl9IGNlbGxFbGVtZW50c1xuXHQgICAgICAgICAqL1xuXHRcblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdnZXRDZWxsRWxlbWVudHMnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRDZWxsRWxlbWVudHMoaWQpIHtcblx0ICAgICAgICAgICAgdmFyIF90aGlzMTYgPSB0aGlzO1xuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHEoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXHQgICAgICAgICAgICAgICAgdmFyIGZsaWNraXR5SW5kZXggPSBfdGhpczE2Ll9nZXRGbGlja2l0eUluZGV4KGlkKTtcblx0XG5cdCAgICAgICAgICAgICAgICBpZiAoZmxpY2tpdHlJbmRleCA8IDApIHtcblx0ICAgICAgICAgICAgICAgICAgICByZWplY3QoJ0luc3RhbmNlICcgKyBpZCArICcgbm90IGZvdW5kJyk7XG5cdCAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoX3RoaXMxNi5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0uaW5zdGFuY2UuZ2V0Q2VsbEVsZW1lbnRzKCkpO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIEdldCB0aGUgZWxlbWVudHMgb2YgdGhlIGNlbGxzXG5cdCAgICAgICAgICpcblx0ICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gaWRcblx0ICAgICAgICAgKiBAcmV0dXJuIHtPYmplY3R9IGluc3RhbmNlXG5cdCAgICAgICAgICovXG5cdFxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ3JlbW92ZScsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZShpZCwgZWxlbWVudHMpIHtcblx0ICAgICAgICAgICAgdmFyIF90aGlzMTcgPSB0aGlzO1xuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHEoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXHQgICAgICAgICAgICAgICAgdmFyIGZsaWNraXR5SW5kZXggPSBfdGhpczE3Ll9nZXRGbGlja2l0eUluZGV4KGlkKTtcblx0XG5cdCAgICAgICAgICAgICAgICBpZiAoZmxpY2tpdHlJbmRleCA8IDApIHtcblx0ICAgICAgICAgICAgICAgICAgICByZWplY3QoJ0luc3RhbmNlICcgKyBpZCArICcgbm90IGZvdW5kJyk7XG5cdCAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgICAgIF90aGlzMTcuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLnJlbW92ZShlbGVtZW50cyk7XG5cdFxuXHQgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoX3RoaXMxNy5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0pO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIEdldCB0aGUgY3VycmVudGx5IHNlbGVjdGVkIGNlbGwgZWxlbWVudFxuXHQgICAgICAgICAqXG5cdCAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IGlkXG5cdCAgICAgICAgICogQHJldHVybiB7RWxlbWVudH0gc2VsZWN0ZWRDZWxsRWxlbWVudFxuXHQgICAgICAgICAqL1xuXHRcblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdzZWxlY3RlZEVsZW1lbnQnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZWxlY3RlZEVsZW1lbnQoaWQpIHtcblx0ICAgICAgICAgICAgdmFyIF90aGlzMTggPSB0aGlzO1xuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHEoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXHQgICAgICAgICAgICAgICAgdmFyIGZsaWNraXR5SW5kZXggPSBfdGhpczE4Ll9nZXRGbGlja2l0eUluZGV4KGlkKTtcblx0XG5cdCAgICAgICAgICAgICAgICBpZiAoZmxpY2tpdHlJbmRleCA8IDApIHtcblx0ICAgICAgICAgICAgICAgICAgICByZWplY3QoJ0luc3RhbmNlICcgKyBpZCArICcgbm90IGZvdW5kJyk7XG5cdCAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoX3RoaXMxOC5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0uaW5zdGFuY2Uuc2VsZWN0ZWRFbGVtZW50KTtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBHZXQgYW4gYXJyYXkgb2YgYWxsIGNlbGxzXG5cdCAgICAgICAgICpcblx0ICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gaWRcblx0ICAgICAgICAgKiBAcmV0dXJuIHtBcnJheX0gY2VsbHNcblx0ICAgICAgICAgKi9cblx0XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnY2VsbHMnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjZWxscyhpZCkge1xuXHQgICAgICAgICAgICB2YXIgX3RoaXMxOSA9IHRoaXM7XG5cdFxuXHQgICAgICAgICAgICByZXR1cm4gdGhpcy4kcShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdCAgICAgICAgICAgICAgICB2YXIgZmxpY2tpdHlJbmRleCA9IF90aGlzMTkuX2dldEZsaWNraXR5SW5kZXgoaWQpO1xuXHRcblx0ICAgICAgICAgICAgICAgIGlmIChmbGlja2l0eUluZGV4IDwgMCkge1xuXHQgICAgICAgICAgICAgICAgICAgIHJlamVjdCgnSW5zdGFuY2UgJyArIGlkICsgJyBub3QgZm91bmQnKTtcblx0ICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShfdGhpczE5Lmluc3RhbmNlc1tmbGlja2l0eUluZGV4XS5pbnN0YW5jZS5jZWxscyk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLy9cblx0ICAgICAgICAvLyBIZWxwZXIgbWV0aG9kc1xuXHQgICAgICAgIC8vXG5cdFxuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBGaW5kIHRoZSBpbmRleCBmb3IgYSBGbGlja2l0eSBpbnN0YW5jZVxuXHQgICAgICAgICAqXG5cdCAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IGlkXG5cdCAgICAgICAgICogQHJldHVybiB7SW50ZWdlcn0gZmxpY2tpdHlJbmRleFxuXHQgICAgICAgICAqL1xuXHRcblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdfZ2V0RmxpY2tpdHlJbmRleCcsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9nZXRGbGlja2l0eUluZGV4KGlkKSB7XG5cdCAgICAgICAgICAgIHZhciBmb3VuZEluZGV4ID0gdm9pZCAwO1xuXHRcblx0ICAgICAgICAgICAgLy8gSWYgbm8gaW5zdGFuY2VzIGV4aXN0XG5cdCAgICAgICAgICAgIGlmICghdGhpcy5pbnN0YW5jZXMubGVuZ3RoKSB7XG5cdFxuXHQgICAgICAgICAgICAgICAgZm91bmRJbmRleCA9IC0xO1xuXHQgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgLy8gaWYgaW5zdGFuY2VzIGRvIGV4aXN0XG5cdFxuXHQgICAgICAgICAgICAgICAgLy8gQ2hlY2sgdGhlIElEIG9mIGVhY2ggaW5zdGFuY2Vcblx0ICAgICAgICAgICAgICAgIHRoaXMuaW5zdGFuY2VzLmZvckVhY2goZnVuY3Rpb24gKGluc3RhbmNlLCBpbmRleCkge1xuXHRcblx0ICAgICAgICAgICAgICAgICAgICAvLyBJZiBpdCBtYXRjaGVzIG91ciBJRCwgc2V0IHRoZSBpbmRleFxuXHQgICAgICAgICAgICAgICAgICAgIGlmIChpbnN0YW5jZS5pZCA9PT0gaWQpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgZm91bmRJbmRleCA9IGluZGV4O1xuXHQgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICByZXR1cm4gZm91bmRJbmRleDtcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnX2JpbmRFdmVudHMnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfYmluZEV2ZW50cyhpZCkge1xuXHQgICAgICAgICAgICB2YXIgX3RoaXMyMCA9IHRoaXM7XG5cdFxuXHQgICAgICAgICAgICByZXR1cm4gdGhpcy4kcShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdCAgICAgICAgICAgICAgICB2YXIgZmxpY2tpdHlJbmRleCA9IF90aGlzMjAuX2dldEZsaWNraXR5SW5kZXgoaWQpO1xuXHRcblx0ICAgICAgICAgICAgICAgIGlmIChmbGlja2l0eUluZGV4IDwgMCkge1xuXHQgICAgICAgICAgICAgICAgICAgIHJlamVjdCgpO1xuXHQgICAgICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgICAgIHZhciBJRCA9IF90aGlzMjAuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmlkO1xuXHRcblx0ICAgICAgICAgICAgICAgIF90aGlzMjAuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLm9uKCdzZWxlY3QnLCBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgX3RoaXMyMC4kcm9vdFNjb3BlLiRlbWl0KCdGbGlja2l0eTonICsgSUQgKyAnOnNlbGVjdCcsIF90aGlzMjAuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdKTtcblx0ICAgICAgICAgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICAgICAgICAgIF90aGlzMjAuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLm9uKCdzZXR0bGUnLCBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgX3RoaXMyMC4kcm9vdFNjb3BlLiRlbWl0KCdGbGlja2l0eTonICsgSUQgKyAnOnNldHRsZScsIF90aGlzMjAuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdKTtcblx0ICAgICAgICAgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICAgICAgICAgIF90aGlzMjAuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLm9uKCdzY3JvbGwnLCBmdW5jdGlvbiAocHJvZ3Jlc3MsIHBvc2l0aW9uWCkge1xuXHQgICAgICAgICAgICAgICAgICAgIF90aGlzMjAuJHJvb3RTY29wZS4kZW1pdCgnRmxpY2tpdHk6JyArIElEICsgJzpzY3JvbGwnLCB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHByb2dyZXNzOiBwcm9ncmVzcyxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25YOiBwb3NpdGlvblhcblx0ICAgICAgICAgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICAgICAgICAgIF90aGlzMjAuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLm9uKCdkcmFnU3RhcnQnLCBmdW5jdGlvbiAoZXZlbnQsIHBvaW50ZXIpIHtcblx0ICAgICAgICAgICAgICAgICAgICBfdGhpczIwLiRyb290U2NvcGUuJGVtaXQoJ0ZsaWNraXR5OicgKyBJRCArICc6ZHJhZ1N0YXJ0Jywge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBldmVudDogZXZlbnQsXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50ZXI6IHBvaW50ZXJcblx0ICAgICAgICAgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICAgICAgICAgIF90aGlzMjAuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLm9uKCdkcmFnTW92ZScsIGZ1bmN0aW9uIChldmVudCwgcG9pbnRlciwgbW92ZVZlY3Rvcikge1xuXHQgICAgICAgICAgICAgICAgICAgIF90aGlzMjAuJHJvb3RTY29wZS4kZW1pdCgnRmxpY2tpdHk6JyArIElEICsgJzpkcmFnTW92ZScsIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQ6IGV2ZW50LFxuXHQgICAgICAgICAgICAgICAgICAgICAgICBwb2ludGVyOiBwb2ludGVyLFxuXHQgICAgICAgICAgICAgICAgICAgICAgICBtb3ZlVmVjdG9yOiBtb3ZlVmVjdG9yXG5cdCAgICAgICAgICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgICAgICAgICBfdGhpczIwLmluc3RhbmNlc1tmbGlja2l0eUluZGV4XS5pbnN0YW5jZS5vbignZHJhZ0VuZCcsIGZ1bmN0aW9uIChldmVudCwgcG9pbnRlcikge1xuXHQgICAgICAgICAgICAgICAgICAgIF90aGlzMjAuJHJvb3RTY29wZS4kZW1pdCgnRmxpY2tpdHk6JyArIElEICsgJzpkcmFnRW5kJywge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBldmVudDogZXZlbnQsXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50ZXI6IHBvaW50ZXJcblx0ICAgICAgICAgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICAgICAgICAgIF90aGlzMjAuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLm9uKCdwb2ludGVyRG93bicsIGZ1bmN0aW9uIChldmVudCwgcG9pbnRlcikge1xuXHQgICAgICAgICAgICAgICAgICAgIF90aGlzMjAuJHJvb3RTY29wZS4kZW1pdCgnRmxpY2tpdHk6JyArIElEICsgJzpwb2ludGVyRG93bicsIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQ6IGV2ZW50LFxuXHQgICAgICAgICAgICAgICAgICAgICAgICBwb2ludGVyOiBwb2ludGVyXG5cdCAgICAgICAgICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgICAgICAgICBfdGhpczIwLmluc3RhbmNlc1tmbGlja2l0eUluZGV4XS5pbnN0YW5jZS5vbigncG9pbnRlck1vdmUnLCBmdW5jdGlvbiAoZXZlbnQsIHBvaW50ZXIsIG1vdmVWZWN0b3IpIHtcblx0ICAgICAgICAgICAgICAgICAgICBfdGhpczIwLiRyb290U2NvcGUuJGVtaXQoJ0ZsaWNraXR5OicgKyBJRCArICc6cG9pbnRlck1vdmUnLCB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50OiBldmVudCxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRlcjogcG9pbnRlcixcblx0ICAgICAgICAgICAgICAgICAgICAgICAgbW92ZVZlY3RvcjogbW92ZVZlY3RvclxuXHQgICAgICAgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgICAgICAgICAgX3RoaXMyMC5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0uaW5zdGFuY2Uub24oJ3BvaW50ZXJVcCcsIGZ1bmN0aW9uIChldmVudCwgcG9pbnRlcikge1xuXHQgICAgICAgICAgICAgICAgICAgIF90aGlzMjAuJHJvb3RTY29wZS4kZW1pdCgnRmxpY2tpdHk6JyArIElEICsgJzpwb2ludGVyVXAnLCB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50OiBldmVudCxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRlcjogcG9pbnRlclxuXHQgICAgICAgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgICAgICAgICAgX3RoaXMyMC5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0uaW5zdGFuY2Uub24oJ3N0YXRpY0NsaWNrJywgZnVuY3Rpb24gKGV2ZW50LCBwb2ludGVyLCBjZWxsRWxlbWVudCwgY2VsbEluZGV4KSB7XG5cdCAgICAgICAgICAgICAgICAgICAgX3RoaXMyMC4kcm9vdFNjb3BlLiRlbWl0KCdGbGlja2l0eTonICsgSUQgKyAnOnN0YXRpY0NsaWNrJywge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBldmVudDogZXZlbnQsXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50ZXI6IHBvaW50ZXIsXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGNlbGxFbGVtZW50OiBjZWxsRWxlbWVudCxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgY2VsbEluZGV4OiBjZWxsSW5kZXhcblx0ICAgICAgICAgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICAgICAgICAgIF90aGlzMjAuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLm9uKCdsYXp5TG9hZCcsIGZ1bmN0aW9uIChldmVudCwgY2VsbEVsZW1lbnQpIHtcblx0ICAgICAgICAgICAgICAgICAgICBfdGhpczIwLiRyb290U2NvcGUuJGVtaXQoJ0ZsaWNraXR5OicgKyBJRCArICc6bGF6eUxvYWQnLCB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50OiBldmVudCxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgY2VsbEVsZW1lbnQ6IGNlbGxFbGVtZW50XG5cdCAgICAgICAgICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgICAgICAgICByZXNvbHZlKHRydWUpO1xuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIEZpbmQgYW4gb2JqZWN0IHdpdGhpbiBhbiBhcnJheSBieSBJRFxuXHQgICAgICAgICAqXG5cdCAgICAgICAgICogQHBhcmFtIHtBcnJheX0gc291cmNlXG5cdCAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IGlkXG5cdCAgICAgICAgICogQHJldHVybiB7T2JqZWN0fSBtYXRjaFxuXHQgICAgICAgICAqL1xuXHRcblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdfZmluZE9iamVjdEJ5SWQnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfZmluZE9iamVjdEJ5SWQoc291cmNlLCBpZCkge1xuXHQgICAgICAgICAgICByZXR1cm4gc291cmNlLmZpbHRlcihmdW5jdGlvbiAob2JqZWN0KSB7XG5cdCAgICAgICAgICAgICAgICByZXR1cm4gb2JqZWN0LmlkID09PSBpZDtcblx0ICAgICAgICAgICAgfSlbMF07XG5cdCAgICAgICAgfVxuXHQgICAgfV0pO1xuXHRcblx0ICAgIHJldHVybiBGbGlja2l0eVNlcnZpY2U7XG5cdH0oKTtcblxuLyoqKi8gfSxcbi8qIDMgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdHZhciBfX1dFQlBBQ0tfQU1EX0RFRklORV9GQUNUT1JZX18sIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fOy8qIVxuXHQgKiBGbGlja2l0eSB2Mi4wLjNcblx0ICogVG91Y2gsIHJlc3BvbnNpdmUsIGZsaWNrYWJsZSBjYXJvdXNlbHNcblx0ICpcblx0ICogTGljZW5zZWQgR1BMdjMgZm9yIG9wZW4gc291cmNlIHVzZVxuXHQgKiBvciBGbGlja2l0eSBDb21tZXJjaWFsIExpY2Vuc2UgZm9yIGNvbW1lcmNpYWwgdXNlXG5cdCAqXG5cdCAqIGh0dHA6Ly9mbGlja2l0eS5tZXRhZml6enkuY29cblx0ICogQ29weXJpZ2h0IDIwMTYgTWV0YWZpenp5XG5cdCAqL1xuXHRcblx0KCBmdW5jdGlvbiggd2luZG93LCBmYWN0b3J5ICkge1xuXHQgIC8vIHVuaXZlcnNhbCBtb2R1bGUgZGVmaW5pdGlvblxuXHQgIC8qIGpzaGludCBzdHJpY3Q6IGZhbHNlICovXG5cdCAgaWYgKCB0cnVlICkge1xuXHQgICAgLy8gQU1EXG5cdCAgICAhKF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18gPSBbXG5cdCAgICAgIF9fd2VicGFja19yZXF1aXJlX18oNCksXG5cdCAgICAgIF9fd2VicGFja19yZXF1aXJlX18oMTIpLFxuXHQgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1KSxcblx0ICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxNyksXG5cdCAgICAgIF9fd2VicGFja19yZXF1aXJlX18oMTgpLFxuXHQgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDE5KSxcblx0ICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXygyMClcblx0ICAgIF0sIF9fV0VCUEFDS19BTURfREVGSU5FX0ZBQ1RPUllfXyA9IChmYWN0b3J5KSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gPSAodHlwZW9mIF9fV0VCUEFDS19BTURfREVGSU5FX0ZBQ1RPUllfXyA9PT0gJ2Z1bmN0aW9uJyA/IChfX1dFQlBBQ0tfQU1EX0RFRklORV9GQUNUT1JZX18uYXBwbHkoZXhwb3J0cywgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXykpIDogX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fKSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gIT09IHVuZGVmaW5lZCAmJiAobW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXykpO1xuXHQgIH0gZWxzZSBpZiAoIHR5cGVvZiBtb2R1bGUgPT0gJ29iamVjdCcgJiYgbW9kdWxlLmV4cG9ydHMgKSB7XG5cdCAgICAvLyBDb21tb25KU1xuXHQgICAgbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KFxuXHQgICAgICByZXF1aXJlKCcuL2ZsaWNraXR5JyksXG5cdCAgICAgIHJlcXVpcmUoJy4vZHJhZycpLFxuXHQgICAgICByZXF1aXJlKCcuL3ByZXYtbmV4dC1idXR0b24nKSxcblx0ICAgICAgcmVxdWlyZSgnLi9wYWdlLWRvdHMnKSxcblx0ICAgICAgcmVxdWlyZSgnLi9wbGF5ZXInKSxcblx0ICAgICAgcmVxdWlyZSgnLi9hZGQtcmVtb3ZlLWNlbGwnKSxcblx0ICAgICAgcmVxdWlyZSgnLi9sYXp5bG9hZCcpXG5cdCAgICApO1xuXHQgIH1cblx0XG5cdH0pKCB3aW5kb3csIGZ1bmN0aW9uIGZhY3RvcnkoIEZsaWNraXR5ICkge1xuXHQgIC8qanNoaW50IHN0cmljdDogZmFsc2UqL1xuXHQgIHJldHVybiBGbGlja2l0eTtcblx0fSk7XG5cblxuLyoqKi8gfSxcbi8qIDQgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdHZhciBfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXzsvLyBGbGlja2l0eSBtYWluXG5cdCggZnVuY3Rpb24oIHdpbmRvdywgZmFjdG9yeSApIHtcblx0ICAvLyB1bml2ZXJzYWwgbW9kdWxlIGRlZmluaXRpb25cblx0ICAvKiBqc2hpbnQgc3RyaWN0OiBmYWxzZSAqL1xuXHQgIGlmICggdHJ1ZSApIHtcblx0ICAgIC8vIEFNRFxuXHQgICAgIShfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fID0gW1xuXHQgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpLFxuXHQgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpLFxuXHQgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpLFxuXHQgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpLFxuXHQgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKSxcblx0ICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMSlcblx0ICAgIF0sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fID0gZnVuY3Rpb24oIEV2RW1pdHRlciwgZ2V0U2l6ZSwgdXRpbHMsIENlbGwsIFNsaWRlLCBhbmltYXRlUHJvdG90eXBlICkge1xuXHQgICAgICByZXR1cm4gZmFjdG9yeSggd2luZG93LCBFdkVtaXR0ZXIsIGdldFNpemUsIHV0aWxzLCBDZWxsLCBTbGlkZSwgYW5pbWF0ZVByb3RvdHlwZSApO1xuXHQgICAgfS5hcHBseShleHBvcnRzLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fKSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gIT09IHVuZGVmaW5lZCAmJiAobW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXykpO1xuXHQgIH0gZWxzZSBpZiAoIHR5cGVvZiBtb2R1bGUgPT0gJ29iamVjdCcgJiYgbW9kdWxlLmV4cG9ydHMgKSB7XG5cdCAgICAvLyBDb21tb25KU1xuXHQgICAgbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KFxuXHQgICAgICB3aW5kb3csXG5cdCAgICAgIHJlcXVpcmUoJ2V2LWVtaXR0ZXInKSxcblx0ICAgICAgcmVxdWlyZSgnZ2V0LXNpemUnKSxcblx0ICAgICAgcmVxdWlyZSgnZml6enktdWktdXRpbHMnKSxcblx0ICAgICAgcmVxdWlyZSgnLi9jZWxsJyksXG5cdCAgICAgIHJlcXVpcmUoJy4vc2xpZGUnKSxcblx0ICAgICAgcmVxdWlyZSgnLi9hbmltYXRlJylcblx0ICAgICk7XG5cdCAgfSBlbHNlIHtcblx0ICAgIC8vIGJyb3dzZXIgZ2xvYmFsXG5cdCAgICB2YXIgX0ZsaWNraXR5ID0gd2luZG93LkZsaWNraXR5O1xuXHRcblx0ICAgIHdpbmRvdy5GbGlja2l0eSA9IGZhY3RvcnkoXG5cdCAgICAgIHdpbmRvdyxcblx0ICAgICAgd2luZG93LkV2RW1pdHRlcixcblx0ICAgICAgd2luZG93LmdldFNpemUsXG5cdCAgICAgIHdpbmRvdy5maXp6eVVJVXRpbHMsXG5cdCAgICAgIF9GbGlja2l0eS5DZWxsLFxuXHQgICAgICBfRmxpY2tpdHkuU2xpZGUsXG5cdCAgICAgIF9GbGlja2l0eS5hbmltYXRlUHJvdG90eXBlXG5cdCAgICApO1xuXHQgIH1cblx0XG5cdH0oIHdpbmRvdywgZnVuY3Rpb24gZmFjdG9yeSggd2luZG93LCBFdkVtaXR0ZXIsIGdldFNpemUsXG5cdCAgdXRpbHMsIENlbGwsIFNsaWRlLCBhbmltYXRlUHJvdG90eXBlICkge1xuXHRcblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0Ly8gdmFyc1xuXHR2YXIgalF1ZXJ5ID0gd2luZG93LmpRdWVyeTtcblx0dmFyIGdldENvbXB1dGVkU3R5bGUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZTtcblx0dmFyIGNvbnNvbGUgPSB3aW5kb3cuY29uc29sZTtcblx0XG5cdGZ1bmN0aW9uIG1vdmVFbGVtZW50cyggZWxlbXMsIHRvRWxlbSApIHtcblx0ICBlbGVtcyA9IHV0aWxzLm1ha2VBcnJheSggZWxlbXMgKTtcblx0ICB3aGlsZSAoIGVsZW1zLmxlbmd0aCApIHtcblx0ICAgIHRvRWxlbS5hcHBlbmRDaGlsZCggZWxlbXMuc2hpZnQoKSApO1xuXHQgIH1cblx0fVxuXHRcblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gRmxpY2tpdHkgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cblx0XG5cdC8vIGdsb2JhbGx5IHVuaXF1ZSBpZGVudGlmaWVyc1xuXHR2YXIgR1VJRCA9IDA7XG5cdC8vIGludGVybmFsIHN0b3JlIG9mIGFsbCBGbGlja2l0eSBpbnRhbmNlc1xuXHR2YXIgaW5zdGFuY2VzID0ge307XG5cdFxuXHRmdW5jdGlvbiBGbGlja2l0eSggZWxlbWVudCwgb3B0aW9ucyApIHtcblx0ICB2YXIgcXVlcnlFbGVtZW50ID0gdXRpbHMuZ2V0UXVlcnlFbGVtZW50KCBlbGVtZW50ICk7XG5cdCAgaWYgKCAhcXVlcnlFbGVtZW50ICkge1xuXHQgICAgaWYgKCBjb25zb2xlICkge1xuXHQgICAgICBjb25zb2xlLmVycm9yKCAnQmFkIGVsZW1lbnQgZm9yIEZsaWNraXR5OiAnICsgKCBxdWVyeUVsZW1lbnQgfHwgZWxlbWVudCApICk7XG5cdCAgICB9XG5cdCAgICByZXR1cm47XG5cdCAgfVxuXHQgIHRoaXMuZWxlbWVudCA9IHF1ZXJ5RWxlbWVudDtcblx0ICAvLyBkbyBub3QgaW5pdGlhbGl6ZSB0d2ljZSBvbiBzYW1lIGVsZW1lbnRcblx0ICBpZiAoIHRoaXMuZWxlbWVudC5mbGlja2l0eUdVSUQgKSB7XG5cdCAgICB2YXIgaW5zdGFuY2UgPSBpbnN0YW5jZXNbIHRoaXMuZWxlbWVudC5mbGlja2l0eUdVSUQgXTtcblx0ICAgIGluc3RhbmNlLm9wdGlvbiggb3B0aW9ucyApO1xuXHQgICAgcmV0dXJuIGluc3RhbmNlO1xuXHQgIH1cblx0XG5cdCAgLy8gYWRkIGpRdWVyeVxuXHQgIGlmICggalF1ZXJ5ICkge1xuXHQgICAgdGhpcy4kZWxlbWVudCA9IGpRdWVyeSggdGhpcy5lbGVtZW50ICk7XG5cdCAgfVxuXHQgIC8vIG9wdGlvbnNcblx0ICB0aGlzLm9wdGlvbnMgPSB1dGlscy5leHRlbmQoIHt9LCB0aGlzLmNvbnN0cnVjdG9yLmRlZmF1bHRzICk7XG5cdCAgdGhpcy5vcHRpb24oIG9wdGlvbnMgKTtcblx0XG5cdCAgLy8ga2ljayB0aGluZ3Mgb2ZmXG5cdCAgdGhpcy5fY3JlYXRlKCk7XG5cdH1cblx0XG5cdEZsaWNraXR5LmRlZmF1bHRzID0ge1xuXHQgIGFjY2Vzc2liaWxpdHk6IHRydWUsXG5cdCAgLy8gYWRhcHRpdmVIZWlnaHQ6IGZhbHNlLFxuXHQgIGNlbGxBbGlnbjogJ2NlbnRlcicsXG5cdCAgLy8gY2VsbFNlbGVjdG9yOiB1bmRlZmluZWQsXG5cdCAgLy8gY29udGFpbjogZmFsc2UsXG5cdCAgZnJlZVNjcm9sbEZyaWN0aW9uOiAwLjA3NSwgLy8gZnJpY3Rpb24gd2hlbiBmcmVlLXNjcm9sbGluZ1xuXHQgIGZyaWN0aW9uOiAwLjI4LCAvLyBmcmljdGlvbiB3aGVuIHNlbGVjdGluZ1xuXHQgIG5hbWVzcGFjZUpRdWVyeUV2ZW50czogdHJ1ZSxcblx0ICAvLyBpbml0aWFsSW5kZXg6IDAsXG5cdCAgcGVyY2VudFBvc2l0aW9uOiB0cnVlLFxuXHQgIHJlc2l6ZTogdHJ1ZSxcblx0ICBzZWxlY3RlZEF0dHJhY3Rpb246IDAuMDI1LFxuXHQgIHNldEdhbGxlcnlTaXplOiB0cnVlXG5cdCAgLy8gd2F0Y2hDU1M6IGZhbHNlLFxuXHQgIC8vIHdyYXBBcm91bmQ6IGZhbHNlXG5cdH07XG5cdFxuXHQvLyBoYXNoIG9mIG1ldGhvZHMgdHJpZ2dlcmVkIG9uIF9jcmVhdGUoKVxuXHRGbGlja2l0eS5jcmVhdGVNZXRob2RzID0gW107XG5cdFxuXHR2YXIgcHJvdG8gPSBGbGlja2l0eS5wcm90b3R5cGU7XG5cdC8vIGluaGVyaXQgRXZlbnRFbWl0dGVyXG5cdHV0aWxzLmV4dGVuZCggcHJvdG8sIEV2RW1pdHRlci5wcm90b3R5cGUgKTtcblx0XG5cdHByb3RvLl9jcmVhdGUgPSBmdW5jdGlvbigpIHtcblx0ICAvLyBhZGQgaWQgZm9yIEZsaWNraXR5LmRhdGFcblx0ICB2YXIgaWQgPSB0aGlzLmd1aWQgPSArK0dVSUQ7XG5cdCAgdGhpcy5lbGVtZW50LmZsaWNraXR5R1VJRCA9IGlkOyAvLyBleHBhbmRvXG5cdCAgaW5zdGFuY2VzWyBpZCBdID0gdGhpczsgLy8gYXNzb2NpYXRlIHZpYSBpZFxuXHQgIC8vIGluaXRpYWwgcHJvcGVydGllc1xuXHQgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IDA7XG5cdCAgLy8gaG93IG1hbnkgZnJhbWVzIHNsaWRlciBoYXMgYmVlbiBpbiBzYW1lIHBvc2l0aW9uXG5cdCAgdGhpcy5yZXN0aW5nRnJhbWVzID0gMDtcblx0ICAvLyBpbml0aWFsIHBoeXNpY3MgcHJvcGVydGllc1xuXHQgIHRoaXMueCA9IDA7XG5cdCAgdGhpcy52ZWxvY2l0eSA9IDA7XG5cdCAgdGhpcy5vcmlnaW5TaWRlID0gdGhpcy5vcHRpb25zLnJpZ2h0VG9MZWZ0ID8gJ3JpZ2h0JyA6ICdsZWZ0Jztcblx0ICAvLyBjcmVhdGUgdmlld3BvcnQgJiBzbGlkZXJcblx0ICB0aGlzLnZpZXdwb3J0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdCAgdGhpcy52aWV3cG9ydC5jbGFzc05hbWUgPSAnZmxpY2tpdHktdmlld3BvcnQnO1xuXHQgIHRoaXMuX2NyZWF0ZVNsaWRlcigpO1xuXHRcblx0ICBpZiAoIHRoaXMub3B0aW9ucy5yZXNpemUgfHwgdGhpcy5vcHRpb25zLndhdGNoQ1NTICkge1xuXHQgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoICdyZXNpemUnLCB0aGlzICk7XG5cdCAgfVxuXHRcblx0ICBGbGlja2l0eS5jcmVhdGVNZXRob2RzLmZvckVhY2goIGZ1bmN0aW9uKCBtZXRob2QgKSB7XG5cdCAgICB0aGlzWyBtZXRob2QgXSgpO1xuXHQgIH0sIHRoaXMgKTtcblx0XG5cdCAgaWYgKCB0aGlzLm9wdGlvbnMud2F0Y2hDU1MgKSB7XG5cdCAgICB0aGlzLndhdGNoQ1NTKCk7XG5cdCAgfSBlbHNlIHtcblx0ICAgIHRoaXMuYWN0aXZhdGUoKTtcblx0ICB9XG5cdFxuXHR9O1xuXHRcblx0LyoqXG5cdCAqIHNldCBvcHRpb25zXG5cdCAqIEBwYXJhbSB7T2JqZWN0fSBvcHRzXG5cdCAqL1xuXHRwcm90by5vcHRpb24gPSBmdW5jdGlvbiggb3B0cyApIHtcblx0ICB1dGlscy5leHRlbmQoIHRoaXMub3B0aW9ucywgb3B0cyApO1xuXHR9O1xuXHRcblx0cHJvdG8uYWN0aXZhdGUgPSBmdW5jdGlvbigpIHtcblx0ICBpZiAoIHRoaXMuaXNBY3RpdmUgKSB7XG5cdCAgICByZXR1cm47XG5cdCAgfVxuXHQgIHRoaXMuaXNBY3RpdmUgPSB0cnVlO1xuXHQgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdmbGlja2l0eS1lbmFibGVkJyk7XG5cdCAgaWYgKCB0aGlzLm9wdGlvbnMucmlnaHRUb0xlZnQgKSB7XG5cdCAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZmxpY2tpdHktcnRsJyk7XG5cdCAgfVxuXHRcblx0ICB0aGlzLmdldFNpemUoKTtcblx0ICAvLyBtb3ZlIGluaXRpYWwgY2VsbCBlbGVtZW50cyBzbyB0aGV5IGNhbiBiZSBsb2FkZWQgYXMgY2VsbHNcblx0ICB2YXIgY2VsbEVsZW1zID0gdGhpcy5fZmlsdGVyRmluZENlbGxFbGVtZW50cyggdGhpcy5lbGVtZW50LmNoaWxkcmVuICk7XG5cdCAgbW92ZUVsZW1lbnRzKCBjZWxsRWxlbXMsIHRoaXMuc2xpZGVyICk7XG5cdCAgdGhpcy52aWV3cG9ydC5hcHBlbmRDaGlsZCggdGhpcy5zbGlkZXIgKTtcblx0ICB0aGlzLmVsZW1lbnQuYXBwZW5kQ2hpbGQoIHRoaXMudmlld3BvcnQgKTtcblx0ICAvLyBnZXQgY2VsbHMgZnJvbSBjaGlsZHJlblxuXHQgIHRoaXMucmVsb2FkQ2VsbHMoKTtcblx0XG5cdCAgaWYgKCB0aGlzLm9wdGlvbnMuYWNjZXNzaWJpbGl0eSApIHtcblx0ICAgIC8vIGFsbG93IGVsZW1lbnQgdG8gZm9jdXNhYmxlXG5cdCAgICB0aGlzLmVsZW1lbnQudGFiSW5kZXggPSAwO1xuXHQgICAgLy8gbGlzdGVuIGZvciBrZXkgcHJlc3Nlc1xuXHQgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoICdrZXlkb3duJywgdGhpcyApO1xuXHQgIH1cblx0XG5cdCAgdGhpcy5lbWl0RXZlbnQoJ2FjdGl2YXRlJyk7XG5cdFxuXHQgIHZhciBpbmRleDtcblx0ICB2YXIgaW5pdGlhbEluZGV4ID0gdGhpcy5vcHRpb25zLmluaXRpYWxJbmRleDtcblx0ICBpZiAoIHRoaXMuaXNJbml0QWN0aXZhdGVkICkge1xuXHQgICAgaW5kZXggPSB0aGlzLnNlbGVjdGVkSW5kZXg7XG5cdCAgfSBlbHNlIGlmICggaW5pdGlhbEluZGV4ICE9PSB1bmRlZmluZWQgKSB7XG5cdCAgICBpbmRleCA9IHRoaXMuY2VsbHNbIGluaXRpYWxJbmRleCBdID8gaW5pdGlhbEluZGV4IDogMDtcblx0ICB9IGVsc2Uge1xuXHQgICAgaW5kZXggPSAwO1xuXHQgIH1cblx0ICAvLyBzZWxlY3QgaW5zdGFudGx5XG5cdCAgdGhpcy5zZWxlY3QoIGluZGV4LCBmYWxzZSwgdHJ1ZSApO1xuXHQgIC8vIGZsYWcgZm9yIGluaXRpYWwgYWN0aXZhdGlvbiwgZm9yIHVzaW5nIGluaXRpYWxJbmRleFxuXHQgIHRoaXMuaXNJbml0QWN0aXZhdGVkID0gdHJ1ZTtcblx0fTtcblx0XG5cdC8vIHNsaWRlciBwb3NpdGlvbnMgdGhlIGNlbGxzXG5cdHByb3RvLl9jcmVhdGVTbGlkZXIgPSBmdW5jdGlvbigpIHtcblx0ICAvLyBzbGlkZXIgZWxlbWVudCBkb2VzIGFsbCB0aGUgcG9zaXRpb25pbmdcblx0ICB2YXIgc2xpZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdCAgc2xpZGVyLmNsYXNzTmFtZSA9ICdmbGlja2l0eS1zbGlkZXInO1xuXHQgIHNsaWRlci5zdHlsZVsgdGhpcy5vcmlnaW5TaWRlIF0gPSAwO1xuXHQgIHRoaXMuc2xpZGVyID0gc2xpZGVyO1xuXHR9O1xuXHRcblx0cHJvdG8uX2ZpbHRlckZpbmRDZWxsRWxlbWVudHMgPSBmdW5jdGlvbiggZWxlbXMgKSB7XG5cdCAgcmV0dXJuIHV0aWxzLmZpbHRlckZpbmRFbGVtZW50cyggZWxlbXMsIHRoaXMub3B0aW9ucy5jZWxsU2VsZWN0b3IgKTtcblx0fTtcblx0XG5cdC8vIGdvZXMgdGhyb3VnaCBhbGwgY2hpbGRyZW5cblx0cHJvdG8ucmVsb2FkQ2VsbHMgPSBmdW5jdGlvbigpIHtcblx0ICAvLyBjb2xsZWN0aW9uIG9mIGl0ZW0gZWxlbWVudHNcblx0ICB0aGlzLmNlbGxzID0gdGhpcy5fbWFrZUNlbGxzKCB0aGlzLnNsaWRlci5jaGlsZHJlbiApO1xuXHQgIHRoaXMucG9zaXRpb25DZWxscygpO1xuXHQgIHRoaXMuX2dldFdyYXBTaGlmdENlbGxzKCk7XG5cdCAgdGhpcy5zZXRHYWxsZXJ5U2l6ZSgpO1xuXHR9O1xuXHRcblx0LyoqXG5cdCAqIHR1cm4gZWxlbWVudHMgaW50byBGbGlja2l0eS5DZWxsc1xuXHQgKiBAcGFyYW0ge0FycmF5IG9yIE5vZGVMaXN0IG9yIEhUTUxFbGVtZW50fSBlbGVtc1xuXHQgKiBAcmV0dXJucyB7QXJyYXl9IGl0ZW1zIC0gY29sbGVjdGlvbiBvZiBuZXcgRmxpY2tpdHkgQ2VsbHNcblx0ICovXG5cdHByb3RvLl9tYWtlQ2VsbHMgPSBmdW5jdGlvbiggZWxlbXMgKSB7XG5cdCAgdmFyIGNlbGxFbGVtcyA9IHRoaXMuX2ZpbHRlckZpbmRDZWxsRWxlbWVudHMoIGVsZW1zICk7XG5cdFxuXHQgIC8vIGNyZWF0ZSBuZXcgRmxpY2tpdHkgZm9yIGNvbGxlY3Rpb25cblx0ICB2YXIgY2VsbHMgPSBjZWxsRWxlbXMubWFwKCBmdW5jdGlvbiggY2VsbEVsZW0gKSB7XG5cdCAgICByZXR1cm4gbmV3IENlbGwoIGNlbGxFbGVtLCB0aGlzICk7XG5cdCAgfSwgdGhpcyApO1xuXHRcblx0ICByZXR1cm4gY2VsbHM7XG5cdH07XG5cdFxuXHRwcm90by5nZXRMYXN0Q2VsbCA9IGZ1bmN0aW9uKCkge1xuXHQgIHJldHVybiB0aGlzLmNlbGxzWyB0aGlzLmNlbGxzLmxlbmd0aCAtIDEgXTtcblx0fTtcblx0XG5cdHByb3RvLmdldExhc3RTbGlkZSA9IGZ1bmN0aW9uKCkge1xuXHQgIHJldHVybiB0aGlzLnNsaWRlc1sgdGhpcy5zbGlkZXMubGVuZ3RoIC0gMSBdO1xuXHR9O1xuXHRcblx0Ly8gcG9zaXRpb25zIGFsbCBjZWxsc1xuXHRwcm90by5wb3NpdGlvbkNlbGxzID0gZnVuY3Rpb24oKSB7XG5cdCAgLy8gc2l6ZSBhbGwgY2VsbHNcblx0ICB0aGlzLl9zaXplQ2VsbHMoIHRoaXMuY2VsbHMgKTtcblx0ICAvLyBwb3NpdGlvbiBhbGwgY2VsbHNcblx0ICB0aGlzLl9wb3NpdGlvbkNlbGxzKCAwICk7XG5cdH07XG5cdFxuXHQvKipcblx0ICogcG9zaXRpb24gY2VydGFpbiBjZWxsc1xuXHQgKiBAcGFyYW0ge0ludGVnZXJ9IGluZGV4IC0gd2hpY2ggY2VsbCB0byBzdGFydCB3aXRoXG5cdCAqL1xuXHRwcm90by5fcG9zaXRpb25DZWxscyA9IGZ1bmN0aW9uKCBpbmRleCApIHtcblx0ICBpbmRleCA9IGluZGV4IHx8IDA7XG5cdCAgLy8gYWxzbyBtZWFzdXJlIG1heENlbGxIZWlnaHRcblx0ICAvLyBzdGFydCAwIGlmIHBvc2l0aW9uaW5nIGFsbCBjZWxsc1xuXHQgIHRoaXMubWF4Q2VsbEhlaWdodCA9IGluZGV4ID8gdGhpcy5tYXhDZWxsSGVpZ2h0IHx8IDAgOiAwO1xuXHQgIHZhciBjZWxsWCA9IDA7XG5cdCAgLy8gZ2V0IGNlbGxYXG5cdCAgaWYgKCBpbmRleCA+IDAgKSB7XG5cdCAgICB2YXIgc3RhcnRDZWxsID0gdGhpcy5jZWxsc1sgaW5kZXggLSAxIF07XG5cdCAgICBjZWxsWCA9IHN0YXJ0Q2VsbC54ICsgc3RhcnRDZWxsLnNpemUub3V0ZXJXaWR0aDtcblx0ICB9XG5cdCAgdmFyIGxlbiA9IHRoaXMuY2VsbHMubGVuZ3RoO1xuXHQgIGZvciAoIHZhciBpPWluZGV4OyBpIDwgbGVuOyBpKysgKSB7XG5cdCAgICB2YXIgY2VsbCA9IHRoaXMuY2VsbHNbaV07XG5cdCAgICBjZWxsLnNldFBvc2l0aW9uKCBjZWxsWCApO1xuXHQgICAgY2VsbFggKz0gY2VsbC5zaXplLm91dGVyV2lkdGg7XG5cdCAgICB0aGlzLm1heENlbGxIZWlnaHQgPSBNYXRoLm1heCggY2VsbC5zaXplLm91dGVySGVpZ2h0LCB0aGlzLm1heENlbGxIZWlnaHQgKTtcblx0ICB9XG5cdCAgLy8ga2VlcCB0cmFjayBvZiBjZWxsWCBmb3Igd3JhcC1hcm91bmRcblx0ICB0aGlzLnNsaWRlYWJsZVdpZHRoID0gY2VsbFg7XG5cdCAgLy8gc2xpZGVzXG5cdCAgdGhpcy51cGRhdGVTbGlkZXMoKTtcblx0ICAvLyBjb250YWluIHNsaWRlcyB0YXJnZXRcblx0ICB0aGlzLl9jb250YWluU2xpZGVzKCk7XG5cdCAgLy8gdXBkYXRlIHNsaWRlc1dpZHRoXG5cdCAgdGhpcy5zbGlkZXNXaWR0aCA9IGxlbiA/IHRoaXMuZ2V0TGFzdFNsaWRlKCkudGFyZ2V0IC0gdGhpcy5zbGlkZXNbMF0udGFyZ2V0IDogMDtcblx0fTtcblx0XG5cdC8qKlxuXHQgKiBjZWxsLmdldFNpemUoKSBvbiBtdWx0aXBsZSBjZWxsc1xuXHQgKiBAcGFyYW0ge0FycmF5fSBjZWxsc1xuXHQgKi9cblx0cHJvdG8uX3NpemVDZWxscyA9IGZ1bmN0aW9uKCBjZWxscyApIHtcblx0ICBjZWxscy5mb3JFYWNoKCBmdW5jdGlvbiggY2VsbCApIHtcblx0ICAgIGNlbGwuZ2V0U2l6ZSgpO1xuXHQgIH0pO1xuXHR9O1xuXHRcblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vXG5cdFxuXHRwcm90by51cGRhdGVTbGlkZXMgPSBmdW5jdGlvbigpIHtcblx0ICB0aGlzLnNsaWRlcyA9IFtdO1xuXHQgIGlmICggIXRoaXMuY2VsbHMubGVuZ3RoICkge1xuXHQgICAgcmV0dXJuO1xuXHQgIH1cblx0XG5cdCAgdmFyIHNsaWRlID0gbmV3IFNsaWRlKCB0aGlzICk7XG5cdCAgdGhpcy5zbGlkZXMucHVzaCggc2xpZGUgKTtcblx0ICB2YXIgaXNPcmlnaW5MZWZ0ID0gdGhpcy5vcmlnaW5TaWRlID09ICdsZWZ0Jztcblx0ICB2YXIgbmV4dE1hcmdpbiA9IGlzT3JpZ2luTGVmdCA/ICdtYXJnaW5SaWdodCcgOiAnbWFyZ2luTGVmdCc7XG5cdFxuXHQgIHZhciBjYW5DZWxsRml0ID0gdGhpcy5fZ2V0Q2FuQ2VsbEZpdCgpO1xuXHRcblx0ICB0aGlzLmNlbGxzLmZvckVhY2goIGZ1bmN0aW9uKCBjZWxsLCBpICkge1xuXHQgICAgLy8ganVzdCBhZGQgY2VsbCBpZiBmaXJzdCBjZWxsIGluIHNsaWRlXG5cdCAgICBpZiAoICFzbGlkZS5jZWxscy5sZW5ndGggKSB7XG5cdCAgICAgIHNsaWRlLmFkZENlbGwoIGNlbGwgKTtcblx0ICAgICAgcmV0dXJuO1xuXHQgICAgfVxuXHRcblx0ICAgIHZhciBzbGlkZVdpZHRoID0gKCBzbGlkZS5vdXRlcldpZHRoIC0gc2xpZGUuZmlyc3RNYXJnaW4gKSArXG5cdCAgICAgICggY2VsbC5zaXplLm91dGVyV2lkdGggLSBjZWxsLnNpemVbIG5leHRNYXJnaW4gXSApO1xuXHRcblx0ICAgIGlmICggY2FuQ2VsbEZpdC5jYWxsKCB0aGlzLCBpLCBzbGlkZVdpZHRoICkgKSB7XG5cdCAgICAgIHNsaWRlLmFkZENlbGwoIGNlbGwgKTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIC8vIGRvZXNuJ3QgZml0LCBuZXcgc2xpZGVcblx0ICAgICAgc2xpZGUudXBkYXRlVGFyZ2V0KCk7XG5cdFxuXHQgICAgICBzbGlkZSA9IG5ldyBTbGlkZSggdGhpcyApO1xuXHQgICAgICB0aGlzLnNsaWRlcy5wdXNoKCBzbGlkZSApO1xuXHQgICAgICBzbGlkZS5hZGRDZWxsKCBjZWxsICk7XG5cdCAgICB9XG5cdCAgfSwgdGhpcyApO1xuXHQgIC8vIGxhc3Qgc2xpZGVcblx0ICBzbGlkZS51cGRhdGVUYXJnZXQoKTtcblx0ICAvLyB1cGRhdGUgLnNlbGVjdGVkU2xpZGVcblx0ICB0aGlzLnVwZGF0ZVNlbGVjdGVkU2xpZGUoKTtcblx0fTtcblx0XG5cdHByb3RvLl9nZXRDYW5DZWxsRml0ID0gZnVuY3Rpb24oKSB7XG5cdCAgdmFyIGdyb3VwQ2VsbHMgPSB0aGlzLm9wdGlvbnMuZ3JvdXBDZWxscztcblx0ICBpZiAoICFncm91cENlbGxzICkge1xuXHQgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuXHQgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICB9O1xuXHQgIH0gZWxzZSBpZiAoIHR5cGVvZiBncm91cENlbGxzID09ICdudW1iZXInICkge1xuXHQgICAgLy8gZ3JvdXAgYnkgbnVtYmVyLiAzIC0+IFswLDEsMl0sIFszLDQsNV0sIC4uLlxuXHQgICAgdmFyIG51bWJlciA9IHBhcnNlSW50KCBncm91cENlbGxzLCAxMCApO1xuXHQgICAgcmV0dXJuIGZ1bmN0aW9uKCBpICkge1xuXHQgICAgICByZXR1cm4gKCBpICUgbnVtYmVyICkgIT09IDA7XG5cdCAgICB9O1xuXHQgIH1cblx0ICAvLyBkZWZhdWx0LCBncm91cCBieSB3aWR0aCBvZiBzbGlkZVxuXHQgIC8vIHBhcnNlICc3NSVcblx0ICB2YXIgcGVyY2VudE1hdGNoID0gdHlwZW9mIGdyb3VwQ2VsbHMgPT0gJ3N0cmluZycgJiZcblx0ICAgIGdyb3VwQ2VsbHMubWF0Y2goL14oXFxkKyklJC8pO1xuXHQgIHZhciBwZXJjZW50ID0gcGVyY2VudE1hdGNoID8gcGFyc2VJbnQoIHBlcmNlbnRNYXRjaFsxXSwgMTAgKSAvIDEwMCA6IDE7XG5cdCAgcmV0dXJuIGZ1bmN0aW9uKCBpLCBzbGlkZVdpZHRoICkge1xuXHQgICAgcmV0dXJuIHNsaWRlV2lkdGggPD0gKCB0aGlzLnNpemUuaW5uZXJXaWR0aCArIDEgKSAqIHBlcmNlbnQ7XG5cdCAgfTtcblx0fTtcblx0XG5cdC8vIGFsaWFzIF9pbml0IGZvciBqUXVlcnkgcGx1Z2luIC5mbGlja2l0eSgpXG5cdHByb3RvLl9pbml0ID1cblx0cHJvdG8ucmVwb3NpdGlvbiA9IGZ1bmN0aW9uKCkge1xuXHQgIHRoaXMucG9zaXRpb25DZWxscygpO1xuXHQgIHRoaXMucG9zaXRpb25TbGlkZXJBdFNlbGVjdGVkKCk7XG5cdH07XG5cdFxuXHRwcm90by5nZXRTaXplID0gZnVuY3Rpb24oKSB7XG5cdCAgdGhpcy5zaXplID0gZ2V0U2l6ZSggdGhpcy5lbGVtZW50ICk7XG5cdCAgdGhpcy5zZXRDZWxsQWxpZ24oKTtcblx0ICB0aGlzLmN1cnNvclBvc2l0aW9uID0gdGhpcy5zaXplLmlubmVyV2lkdGggKiB0aGlzLmNlbGxBbGlnbjtcblx0fTtcblx0XG5cdHZhciBjZWxsQWxpZ25TaG9ydGhhbmRzID0ge1xuXHQgIC8vIGNlbGwgYWxpZ24sIHRoZW4gYmFzZWQgb24gb3JpZ2luIHNpZGVcblx0ICBjZW50ZXI6IHtcblx0ICAgIGxlZnQ6IDAuNSxcblx0ICAgIHJpZ2h0OiAwLjVcblx0ICB9LFxuXHQgIGxlZnQ6IHtcblx0ICAgIGxlZnQ6IDAsXG5cdCAgICByaWdodDogMVxuXHQgIH0sXG5cdCAgcmlnaHQ6IHtcblx0ICAgIHJpZ2h0OiAwLFxuXHQgICAgbGVmdDogMVxuXHQgIH1cblx0fTtcblx0XG5cdHByb3RvLnNldENlbGxBbGlnbiA9IGZ1bmN0aW9uKCkge1xuXHQgIHZhciBzaG9ydGhhbmQgPSBjZWxsQWxpZ25TaG9ydGhhbmRzWyB0aGlzLm9wdGlvbnMuY2VsbEFsaWduIF07XG5cdCAgdGhpcy5jZWxsQWxpZ24gPSBzaG9ydGhhbmQgPyBzaG9ydGhhbmRbIHRoaXMub3JpZ2luU2lkZSBdIDogdGhpcy5vcHRpb25zLmNlbGxBbGlnbjtcblx0fTtcblx0XG5cdHByb3RvLnNldEdhbGxlcnlTaXplID0gZnVuY3Rpb24oKSB7XG5cdCAgaWYgKCB0aGlzLm9wdGlvbnMuc2V0R2FsbGVyeVNpemUgKSB7XG5cdCAgICB2YXIgaGVpZ2h0ID0gdGhpcy5vcHRpb25zLmFkYXB0aXZlSGVpZ2h0ICYmIHRoaXMuc2VsZWN0ZWRTbGlkZSA/XG5cdCAgICAgIHRoaXMuc2VsZWN0ZWRTbGlkZS5oZWlnaHQgOiB0aGlzLm1heENlbGxIZWlnaHQ7XG5cdCAgICB0aGlzLnZpZXdwb3J0LnN0eWxlLmhlaWdodCA9IGhlaWdodCArICdweCc7XG5cdCAgfVxuXHR9O1xuXHRcblx0cHJvdG8uX2dldFdyYXBTaGlmdENlbGxzID0gZnVuY3Rpb24oKSB7XG5cdCAgLy8gb25seSBmb3Igd3JhcC1hcm91bmRcblx0ICBpZiAoICF0aGlzLm9wdGlvbnMud3JhcEFyb3VuZCApIHtcblx0ICAgIHJldHVybjtcblx0ICB9XG5cdCAgLy8gdW5zaGlmdCBwcmV2aW91cyBjZWxsc1xuXHQgIHRoaXMuX3Vuc2hpZnRDZWxscyggdGhpcy5iZWZvcmVTaGlmdENlbGxzICk7XG5cdCAgdGhpcy5fdW5zaGlmdENlbGxzKCB0aGlzLmFmdGVyU2hpZnRDZWxscyApO1xuXHQgIC8vIGdldCBiZWZvcmUgY2VsbHNcblx0ICAvLyBpbml0aWFsIGdhcFxuXHQgIHZhciBnYXBYID0gdGhpcy5jdXJzb3JQb3NpdGlvbjtcblx0ICB2YXIgY2VsbEluZGV4ID0gdGhpcy5jZWxscy5sZW5ndGggLSAxO1xuXHQgIHRoaXMuYmVmb3JlU2hpZnRDZWxscyA9IHRoaXMuX2dldEdhcENlbGxzKCBnYXBYLCBjZWxsSW5kZXgsIC0xICk7XG5cdCAgLy8gZ2V0IGFmdGVyIGNlbGxzXG5cdCAgLy8gZW5kaW5nIGdhcCBiZXR3ZWVuIGxhc3QgY2VsbCBhbmQgZW5kIG9mIGdhbGxlcnkgdmlld3BvcnRcblx0ICBnYXBYID0gdGhpcy5zaXplLmlubmVyV2lkdGggLSB0aGlzLmN1cnNvclBvc2l0aW9uO1xuXHQgIC8vIHN0YXJ0IGNsb25pbmcgYXQgZmlyc3QgY2VsbCwgd29ya2luZyBmb3J3YXJkc1xuXHQgIHRoaXMuYWZ0ZXJTaGlmdENlbGxzID0gdGhpcy5fZ2V0R2FwQ2VsbHMoIGdhcFgsIDAsIDEgKTtcblx0fTtcblx0XG5cdHByb3RvLl9nZXRHYXBDZWxscyA9IGZ1bmN0aW9uKCBnYXBYLCBjZWxsSW5kZXgsIGluY3JlbWVudCApIHtcblx0ICAvLyBrZWVwIGFkZGluZyBjZWxscyB1bnRpbCB0aGUgY292ZXIgdGhlIGluaXRpYWwgZ2FwXG5cdCAgdmFyIGNlbGxzID0gW107XG5cdCAgd2hpbGUgKCBnYXBYID4gMCApIHtcblx0ICAgIHZhciBjZWxsID0gdGhpcy5jZWxsc1sgY2VsbEluZGV4IF07XG5cdCAgICBpZiAoICFjZWxsICkge1xuXHQgICAgICBicmVhaztcblx0ICAgIH1cblx0ICAgIGNlbGxzLnB1c2goIGNlbGwgKTtcblx0ICAgIGNlbGxJbmRleCArPSBpbmNyZW1lbnQ7XG5cdCAgICBnYXBYIC09IGNlbGwuc2l6ZS5vdXRlcldpZHRoO1xuXHQgIH1cblx0ICByZXR1cm4gY2VsbHM7XG5cdH07XG5cdFxuXHQvLyAtLS0tLSBjb250YWluIC0tLS0tIC8vXG5cdFxuXHQvLyBjb250YWluIGNlbGwgdGFyZ2V0cyBzbyBubyBleGNlc3Mgc2xpZGluZ1xuXHRwcm90by5fY29udGFpblNsaWRlcyA9IGZ1bmN0aW9uKCkge1xuXHQgIGlmICggIXRoaXMub3B0aW9ucy5jb250YWluIHx8IHRoaXMub3B0aW9ucy53cmFwQXJvdW5kIHx8ICF0aGlzLmNlbGxzLmxlbmd0aCApIHtcblx0ICAgIHJldHVybjtcblx0ICB9XG5cdCAgdmFyIGlzUmlnaHRUb0xlZnQgPSB0aGlzLm9wdGlvbnMucmlnaHRUb0xlZnQ7XG5cdCAgdmFyIGJlZ2luTWFyZ2luID0gaXNSaWdodFRvTGVmdCA/ICdtYXJnaW5SaWdodCcgOiAnbWFyZ2luTGVmdCc7XG5cdCAgdmFyIGVuZE1hcmdpbiA9IGlzUmlnaHRUb0xlZnQgPyAnbWFyZ2luTGVmdCcgOiAnbWFyZ2luUmlnaHQnO1xuXHQgIHZhciBjb250ZW50V2lkdGggPSB0aGlzLnNsaWRlYWJsZVdpZHRoIC0gdGhpcy5nZXRMYXN0Q2VsbCgpLnNpemVbIGVuZE1hcmdpbiBdO1xuXHQgIC8vIGNvbnRlbnQgaXMgbGVzcyB0aGFuIGdhbGxlcnkgc2l6ZVxuXHQgIHZhciBpc0NvbnRlbnRTbWFsbGVyID0gY29udGVudFdpZHRoIDwgdGhpcy5zaXplLmlubmVyV2lkdGg7XG5cdCAgLy8gYm91bmRzXG5cdCAgdmFyIGJlZ2luQm91bmQgPSB0aGlzLmN1cnNvclBvc2l0aW9uICsgdGhpcy5jZWxsc1swXS5zaXplWyBiZWdpbk1hcmdpbiBdO1xuXHQgIHZhciBlbmRCb3VuZCA9IGNvbnRlbnRXaWR0aCAtIHRoaXMuc2l6ZS5pbm5lcldpZHRoICogKCAxIC0gdGhpcy5jZWxsQWxpZ24gKTtcblx0ICAvLyBjb250YWluIGVhY2ggY2VsbCB0YXJnZXRcblx0ICB0aGlzLnNsaWRlcy5mb3JFYWNoKCBmdW5jdGlvbiggc2xpZGUgKSB7XG5cdCAgICBpZiAoIGlzQ29udGVudFNtYWxsZXIgKSB7XG5cdCAgICAgIC8vIGFsbCBjZWxscyBmaXQgaW5zaWRlIGdhbGxlcnlcblx0ICAgICAgc2xpZGUudGFyZ2V0ID0gY29udGVudFdpZHRoICogdGhpcy5jZWxsQWxpZ247XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICAvLyBjb250YWluIHRvIGJvdW5kc1xuXHQgICAgICBzbGlkZS50YXJnZXQgPSBNYXRoLm1heCggc2xpZGUudGFyZ2V0LCBiZWdpbkJvdW5kICk7XG5cdCAgICAgIHNsaWRlLnRhcmdldCA9IE1hdGgubWluKCBzbGlkZS50YXJnZXQsIGVuZEJvdW5kICk7XG5cdCAgICB9XG5cdCAgfSwgdGhpcyApO1xuXHR9O1xuXHRcblx0Ly8gLS0tLS0gIC0tLS0tIC8vXG5cdFxuXHQvKipcblx0ICogZW1pdHMgZXZlbnRzIHZpYSBldmVudEVtaXR0ZXIgYW5kIGpRdWVyeSBldmVudHNcblx0ICogQHBhcmFtIHtTdHJpbmd9IHR5cGUgLSBuYW1lIG9mIGV2ZW50XG5cdCAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50IC0gb3JpZ2luYWwgZXZlbnRcblx0ICogQHBhcmFtIHtBcnJheX0gYXJncyAtIGV4dHJhIGFyZ3VtZW50c1xuXHQgKi9cblx0cHJvdG8uZGlzcGF0Y2hFdmVudCA9IGZ1bmN0aW9uKCB0eXBlLCBldmVudCwgYXJncyApIHtcblx0ICB2YXIgZW1pdEFyZ3MgPSBldmVudCA/IFsgZXZlbnQgXS5jb25jYXQoIGFyZ3MgKSA6IGFyZ3M7XG5cdCAgdGhpcy5lbWl0RXZlbnQoIHR5cGUsIGVtaXRBcmdzICk7XG5cdFxuXHQgIGlmICggalF1ZXJ5ICYmIHRoaXMuJGVsZW1lbnQgKSB7XG5cdCAgICAvLyBkZWZhdWx0IHRyaWdnZXIgd2l0aCB0eXBlIGlmIG5vIGV2ZW50XG5cdCAgICB0eXBlICs9IHRoaXMub3B0aW9ucy5uYW1lc3BhY2VKUXVlcnlFdmVudHMgPyAnLmZsaWNraXR5JyA6ICcnO1xuXHQgICAgdmFyICRldmVudCA9IHR5cGU7XG5cdCAgICBpZiAoIGV2ZW50ICkge1xuXHQgICAgICAvLyBjcmVhdGUgalF1ZXJ5IGV2ZW50XG5cdCAgICAgIHZhciBqUUV2ZW50ID0galF1ZXJ5LkV2ZW50KCBldmVudCApO1xuXHQgICAgICBqUUV2ZW50LnR5cGUgPSB0eXBlO1xuXHQgICAgICAkZXZlbnQgPSBqUUV2ZW50O1xuXHQgICAgfVxuXHQgICAgdGhpcy4kZWxlbWVudC50cmlnZ2VyKCAkZXZlbnQsIGFyZ3MgKTtcblx0ICB9XG5cdH07XG5cdFxuXHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBzZWxlY3QgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cblx0XG5cdC8qKlxuXHQgKiBAcGFyYW0ge0ludGVnZXJ9IGluZGV4IC0gaW5kZXggb2YgdGhlIHNsaWRlXG5cdCAqIEBwYXJhbSB7Qm9vbGVhbn0gaXNXcmFwIC0gd2lsbCB3cmFwLWFyb3VuZCB0byBsYXN0L2ZpcnN0IGlmIGF0IHRoZSBlbmRcblx0ICogQHBhcmFtIHtCb29sZWFufSBpc0luc3RhbnQgLSB3aWxsIGltbWVkaWF0ZWx5IHNldCBwb3NpdGlvbiBhdCBzZWxlY3RlZCBjZWxsXG5cdCAqL1xuXHRwcm90by5zZWxlY3QgPSBmdW5jdGlvbiggaW5kZXgsIGlzV3JhcCwgaXNJbnN0YW50ICkge1xuXHQgIGlmICggIXRoaXMuaXNBY3RpdmUgKSB7XG5cdCAgICByZXR1cm47XG5cdCAgfVxuXHQgIGluZGV4ID0gcGFyc2VJbnQoIGluZGV4LCAxMCApO1xuXHQgIHRoaXMuX3dyYXBTZWxlY3QoIGluZGV4ICk7XG5cdFxuXHQgIGlmICggdGhpcy5vcHRpb25zLndyYXBBcm91bmQgfHwgaXNXcmFwICkge1xuXHQgICAgaW5kZXggPSB1dGlscy5tb2R1bG8oIGluZGV4LCB0aGlzLnNsaWRlcy5sZW5ndGggKTtcblx0ICB9XG5cdCAgLy8gYmFpbCBpZiBpbnZhbGlkIGluZGV4XG5cdCAgaWYgKCAhdGhpcy5zbGlkZXNbIGluZGV4IF0gKSB7XG5cdCAgICByZXR1cm47XG5cdCAgfVxuXHQgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IGluZGV4O1xuXHQgIHRoaXMudXBkYXRlU2VsZWN0ZWRTbGlkZSgpO1xuXHQgIGlmICggaXNJbnN0YW50ICkge1xuXHQgICAgdGhpcy5wb3NpdGlvblNsaWRlckF0U2VsZWN0ZWQoKTtcblx0ICB9IGVsc2Uge1xuXHQgICAgdGhpcy5zdGFydEFuaW1hdGlvbigpO1xuXHQgIH1cblx0ICBpZiAoIHRoaXMub3B0aW9ucy5hZGFwdGl2ZUhlaWdodCApIHtcblx0ICAgIHRoaXMuc2V0R2FsbGVyeVNpemUoKTtcblx0ICB9XG5cdFxuXHQgIHRoaXMuZGlzcGF0Y2hFdmVudCgnc2VsZWN0Jyk7XG5cdCAgLy8gb2xkIHYxIGV2ZW50IG5hbWUsIHJlbW92ZSBpbiB2M1xuXHQgIHRoaXMuZGlzcGF0Y2hFdmVudCgnY2VsbFNlbGVjdCcpO1xuXHR9O1xuXHRcblx0Ly8gd3JhcHMgcG9zaXRpb24gZm9yIHdyYXBBcm91bmQsIHRvIG1vdmUgdG8gY2xvc2VzdCBzbGlkZS4gIzExM1xuXHRwcm90by5fd3JhcFNlbGVjdCA9IGZ1bmN0aW9uKCBpbmRleCApIHtcblx0ICB2YXIgbGVuID0gdGhpcy5zbGlkZXMubGVuZ3RoO1xuXHQgIHZhciBpc1dyYXBwaW5nID0gdGhpcy5vcHRpb25zLndyYXBBcm91bmQgJiYgbGVuID4gMTtcblx0ICBpZiAoICFpc1dyYXBwaW5nICkge1xuXHQgICAgcmV0dXJuIGluZGV4O1xuXHQgIH1cblx0ICB2YXIgd3JhcEluZGV4ID0gdXRpbHMubW9kdWxvKCBpbmRleCwgbGVuICk7XG5cdCAgLy8gZ28gdG8gc2hvcnRlc3Rcblx0ICB2YXIgZGVsdGEgPSBNYXRoLmFicyggd3JhcEluZGV4IC0gdGhpcy5zZWxlY3RlZEluZGV4ICk7XG5cdCAgdmFyIGJhY2tXcmFwRGVsdGEgPSBNYXRoLmFicyggKCB3cmFwSW5kZXggKyBsZW4gKSAtIHRoaXMuc2VsZWN0ZWRJbmRleCApO1xuXHQgIHZhciBmb3Jld2FyZFdyYXBEZWx0YSA9IE1hdGguYWJzKCAoIHdyYXBJbmRleCAtIGxlbiApIC0gdGhpcy5zZWxlY3RlZEluZGV4ICk7XG5cdCAgaWYgKCAhdGhpcy5pc0RyYWdTZWxlY3QgJiYgYmFja1dyYXBEZWx0YSA8IGRlbHRhICkge1xuXHQgICAgaW5kZXggKz0gbGVuO1xuXHQgIH0gZWxzZSBpZiAoICF0aGlzLmlzRHJhZ1NlbGVjdCAmJiBmb3Jld2FyZFdyYXBEZWx0YSA8IGRlbHRhICkge1xuXHQgICAgaW5kZXggLT0gbGVuO1xuXHQgIH1cblx0ICAvLyB3cmFwIHBvc2l0aW9uIHNvIHNsaWRlciBpcyB3aXRoaW4gbm9ybWFsIGFyZWFcblx0ICBpZiAoIGluZGV4IDwgMCApIHtcblx0ICAgIHRoaXMueCAtPSB0aGlzLnNsaWRlYWJsZVdpZHRoO1xuXHQgIH0gZWxzZSBpZiAoIGluZGV4ID49IGxlbiApIHtcblx0ICAgIHRoaXMueCArPSB0aGlzLnNsaWRlYWJsZVdpZHRoO1xuXHQgIH1cblx0fTtcblx0XG5cdHByb3RvLnByZXZpb3VzID0gZnVuY3Rpb24oIGlzV3JhcCwgaXNJbnN0YW50ICkge1xuXHQgIHRoaXMuc2VsZWN0KCB0aGlzLnNlbGVjdGVkSW5kZXggLSAxLCBpc1dyYXAsIGlzSW5zdGFudCApO1xuXHR9O1xuXHRcblx0cHJvdG8ubmV4dCA9IGZ1bmN0aW9uKCBpc1dyYXAsIGlzSW5zdGFudCApIHtcblx0ICB0aGlzLnNlbGVjdCggdGhpcy5zZWxlY3RlZEluZGV4ICsgMSwgaXNXcmFwLCBpc0luc3RhbnQgKTtcblx0fTtcblx0XG5cdHByb3RvLnVwZGF0ZVNlbGVjdGVkU2xpZGUgPSBmdW5jdGlvbigpIHtcblx0ICB2YXIgc2xpZGUgPSB0aGlzLnNsaWRlc1sgdGhpcy5zZWxlY3RlZEluZGV4IF07XG5cdCAgLy8gc2VsZWN0ZWRJbmRleCBjb3VsZCBiZSBvdXRzaWRlIG9mIHNsaWRlcywgaWYgdHJpZ2dlcmVkIGJlZm9yZSByZXNpemUoKVxuXHQgIGlmICggIXNsaWRlICkge1xuXHQgICAgcmV0dXJuO1xuXHQgIH1cblx0ICAvLyB1bnNlbGVjdCBwcmV2aW91cyBzZWxlY3RlZCBzbGlkZVxuXHQgIHRoaXMudW5zZWxlY3RTZWxlY3RlZFNsaWRlKCk7XG5cdCAgLy8gdXBkYXRlIG5ldyBzZWxlY3RlZCBzbGlkZVxuXHQgIHRoaXMuc2VsZWN0ZWRTbGlkZSA9IHNsaWRlO1xuXHQgIHNsaWRlLnNlbGVjdCgpO1xuXHQgIHRoaXMuc2VsZWN0ZWRDZWxscyA9IHNsaWRlLmNlbGxzO1xuXHQgIHRoaXMuc2VsZWN0ZWRFbGVtZW50cyA9IHNsaWRlLmdldENlbGxFbGVtZW50cygpO1xuXHQgIC8vIEhBQ0s6IHNlbGVjdGVkQ2VsbCAmIHNlbGVjdGVkRWxlbWVudCBpcyBmaXJzdCBjZWxsIGluIHNsaWRlLCBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eVxuXHQgIC8vIFJlbW92ZSBpbiB2Mz9cblx0ICB0aGlzLnNlbGVjdGVkQ2VsbCA9IHNsaWRlLmNlbGxzWzBdO1xuXHQgIHRoaXMuc2VsZWN0ZWRFbGVtZW50ID0gdGhpcy5zZWxlY3RlZEVsZW1lbnRzWzBdO1xuXHR9O1xuXHRcblx0cHJvdG8udW5zZWxlY3RTZWxlY3RlZFNsaWRlID0gZnVuY3Rpb24oKSB7XG5cdCAgaWYgKCB0aGlzLnNlbGVjdGVkU2xpZGUgKSB7XG5cdCAgICB0aGlzLnNlbGVjdGVkU2xpZGUudW5zZWxlY3QoKTtcblx0ICB9XG5cdH07XG5cdFxuXHQvKipcblx0ICogc2VsZWN0IHNsaWRlIGZyb20gbnVtYmVyIG9yIGNlbGwgZWxlbWVudFxuXHQgKiBAcGFyYW0ge0VsZW1lbnQgb3IgTnVtYmVyfSBlbGVtXG5cdCAqL1xuXHRwcm90by5zZWxlY3RDZWxsID0gZnVuY3Rpb24oIHZhbHVlLCBpc1dyYXAsIGlzSW5zdGFudCApIHtcblx0ICAvLyBnZXQgY2VsbFxuXHQgIHZhciBjZWxsO1xuXHQgIGlmICggdHlwZW9mIHZhbHVlID09ICdudW1iZXInICkge1xuXHQgICAgY2VsbCA9IHRoaXMuY2VsbHNbIHZhbHVlIF07XG5cdCAgfSBlbHNlIHtcblx0ICAgIC8vIHVzZSBzdHJpbmcgYXMgc2VsZWN0b3Jcblx0ICAgIGlmICggdHlwZW9mIHZhbHVlID09ICdzdHJpbmcnICkge1xuXHQgICAgICB2YWx1ZSA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCB2YWx1ZSApO1xuXHQgICAgfVxuXHQgICAgLy8gZ2V0IGNlbGwgZnJvbSBlbGVtZW50XG5cdCAgICBjZWxsID0gdGhpcy5nZXRDZWxsKCB2YWx1ZSApO1xuXHQgIH1cblx0ICAvLyBzZWxlY3Qgc2xpZGUgdGhhdCBoYXMgY2VsbFxuXHQgIGZvciAoIHZhciBpPTA7IGNlbGwgJiYgaSA8IHRoaXMuc2xpZGVzLmxlbmd0aDsgaSsrICkge1xuXHQgICAgdmFyIHNsaWRlID0gdGhpcy5zbGlkZXNbaV07XG5cdCAgICB2YXIgaW5kZXggPSBzbGlkZS5jZWxscy5pbmRleE9mKCBjZWxsICk7XG5cdCAgICBpZiAoIGluZGV4ICE9IC0xICkge1xuXHQgICAgICB0aGlzLnNlbGVjdCggaSwgaXNXcmFwLCBpc0luc3RhbnQgKTtcblx0ICAgICAgcmV0dXJuO1xuXHQgICAgfVxuXHQgIH1cblx0fTtcblx0XG5cdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIGdldCBjZWxscyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvL1xuXHRcblx0LyoqXG5cdCAqIGdldCBGbGlja2l0eS5DZWxsLCBnaXZlbiBhbiBFbGVtZW50XG5cdCAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbVxuXHQgKiBAcmV0dXJucyB7RmxpY2tpdHkuQ2VsbH0gaXRlbVxuXHQgKi9cblx0cHJvdG8uZ2V0Q2VsbCA9IGZ1bmN0aW9uKCBlbGVtICkge1xuXHQgIC8vIGxvb3AgdGhyb3VnaCBjZWxscyB0byBnZXQgdGhlIG9uZSB0aGF0IG1hdGNoZXNcblx0ICBmb3IgKCB2YXIgaT0wOyBpIDwgdGhpcy5jZWxscy5sZW5ndGg7IGkrKyApIHtcblx0ICAgIHZhciBjZWxsID0gdGhpcy5jZWxsc1tpXTtcblx0ICAgIGlmICggY2VsbC5lbGVtZW50ID09IGVsZW0gKSB7XG5cdCAgICAgIHJldHVybiBjZWxsO1xuXHQgICAgfVxuXHQgIH1cblx0fTtcblx0XG5cdC8qKlxuXHQgKiBnZXQgY29sbGVjdGlvbiBvZiBGbGlja2l0eS5DZWxscywgZ2l2ZW4gRWxlbWVudHNcblx0ICogQHBhcmFtIHtFbGVtZW50LCBBcnJheSwgTm9kZUxpc3R9IGVsZW1zXG5cdCAqIEByZXR1cm5zIHtBcnJheX0gY2VsbHMgLSBGbGlja2l0eS5DZWxsc1xuXHQgKi9cblx0cHJvdG8uZ2V0Q2VsbHMgPSBmdW5jdGlvbiggZWxlbXMgKSB7XG5cdCAgZWxlbXMgPSB1dGlscy5tYWtlQXJyYXkoIGVsZW1zICk7XG5cdCAgdmFyIGNlbGxzID0gW107XG5cdCAgZWxlbXMuZm9yRWFjaCggZnVuY3Rpb24oIGVsZW0gKSB7XG5cdCAgICB2YXIgY2VsbCA9IHRoaXMuZ2V0Q2VsbCggZWxlbSApO1xuXHQgICAgaWYgKCBjZWxsICkge1xuXHQgICAgICBjZWxscy5wdXNoKCBjZWxsICk7XG5cdCAgICB9XG5cdCAgfSwgdGhpcyApO1xuXHQgIHJldHVybiBjZWxscztcblx0fTtcblx0XG5cdC8qKlxuXHQgKiBnZXQgY2VsbCBlbGVtZW50c1xuXHQgKiBAcmV0dXJucyB7QXJyYXl9IGNlbGxFbGVtc1xuXHQgKi9cblx0cHJvdG8uZ2V0Q2VsbEVsZW1lbnRzID0gZnVuY3Rpb24oKSB7XG5cdCAgcmV0dXJuIHRoaXMuY2VsbHMubWFwKCBmdW5jdGlvbiggY2VsbCApIHtcblx0ICAgIHJldHVybiBjZWxsLmVsZW1lbnQ7XG5cdCAgfSk7XG5cdH07XG5cdFxuXHQvKipcblx0ICogZ2V0IHBhcmVudCBjZWxsIGZyb20gYW4gZWxlbWVudFxuXHQgKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1cblx0ICogQHJldHVybnMge0ZsaWNraXQuQ2VsbH0gY2VsbFxuXHQgKi9cblx0cHJvdG8uZ2V0UGFyZW50Q2VsbCA9IGZ1bmN0aW9uKCBlbGVtICkge1xuXHQgIC8vIGZpcnN0IGNoZWNrIGlmIGVsZW0gaXMgY2VsbFxuXHQgIHZhciBjZWxsID0gdGhpcy5nZXRDZWxsKCBlbGVtICk7XG5cdCAgaWYgKCBjZWxsICkge1xuXHQgICAgcmV0dXJuIGNlbGw7XG5cdCAgfVxuXHQgIC8vIHRyeSB0byBnZXQgcGFyZW50IGNlbGwgZWxlbVxuXHQgIGVsZW0gPSB1dGlscy5nZXRQYXJlbnQoIGVsZW0sICcuZmxpY2tpdHktc2xpZGVyID4gKicgKTtcblx0ICByZXR1cm4gdGhpcy5nZXRDZWxsKCBlbGVtICk7XG5cdH07XG5cdFxuXHQvKipcblx0ICogZ2V0IGNlbGxzIGFkamFjZW50IHRvIGEgc2xpZGVcblx0ICogQHBhcmFtIHtJbnRlZ2VyfSBhZGpDb3VudCAtIG51bWJlciBvZiBhZGphY2VudCBzbGlkZXNcblx0ICogQHBhcmFtIHtJbnRlZ2VyfSBpbmRleCAtIGluZGV4IG9mIHNsaWRlIHRvIHN0YXJ0XG5cdCAqIEByZXR1cm5zIHtBcnJheX0gY2VsbHMgLSBhcnJheSBvZiBGbGlja2l0eS5DZWxsc1xuXHQgKi9cblx0cHJvdG8uZ2V0QWRqYWNlbnRDZWxsRWxlbWVudHMgPSBmdW5jdGlvbiggYWRqQ291bnQsIGluZGV4ICkge1xuXHQgIGlmICggIWFkakNvdW50ICkge1xuXHQgICAgcmV0dXJuIHRoaXMuc2VsZWN0ZWRTbGlkZS5nZXRDZWxsRWxlbWVudHMoKTtcblx0ICB9XG5cdCAgaW5kZXggPSBpbmRleCA9PT0gdW5kZWZpbmVkID8gdGhpcy5zZWxlY3RlZEluZGV4IDogaW5kZXg7XG5cdFxuXHQgIHZhciBsZW4gPSB0aGlzLnNsaWRlcy5sZW5ndGg7XG5cdCAgaWYgKCAxICsgKCBhZGpDb3VudCAqIDIgKSA+PSBsZW4gKSB7XG5cdCAgICByZXR1cm4gdGhpcy5nZXRDZWxsRWxlbWVudHMoKTtcblx0ICB9XG5cdFxuXHQgIHZhciBjZWxsRWxlbXMgPSBbXTtcblx0ICBmb3IgKCB2YXIgaSA9IGluZGV4IC0gYWRqQ291bnQ7IGkgPD0gaW5kZXggKyBhZGpDb3VudCA7IGkrKyApIHtcblx0ICAgIHZhciBzbGlkZUluZGV4ID0gdGhpcy5vcHRpb25zLndyYXBBcm91bmQgPyB1dGlscy5tb2R1bG8oIGksIGxlbiApIDogaTtcblx0ICAgIHZhciBzbGlkZSA9IHRoaXMuc2xpZGVzWyBzbGlkZUluZGV4IF07XG5cdCAgICBpZiAoIHNsaWRlICkge1xuXHQgICAgICBjZWxsRWxlbXMgPSBjZWxsRWxlbXMuY29uY2F0KCBzbGlkZS5nZXRDZWxsRWxlbWVudHMoKSApO1xuXHQgICAgfVxuXHQgIH1cblx0ICByZXR1cm4gY2VsbEVsZW1zO1xuXHR9O1xuXHRcblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gZXZlbnRzIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vXG5cdFxuXHRwcm90by51aUNoYW5nZSA9IGZ1bmN0aW9uKCkge1xuXHQgIHRoaXMuZW1pdEV2ZW50KCd1aUNoYW5nZScpO1xuXHR9O1xuXHRcblx0cHJvdG8uY2hpbGRVSVBvaW50ZXJEb3duID0gZnVuY3Rpb24oIGV2ZW50ICkge1xuXHQgIHRoaXMuZW1pdEV2ZW50KCAnY2hpbGRVSVBvaW50ZXJEb3duJywgWyBldmVudCBdICk7XG5cdH07XG5cdFxuXHQvLyAtLS0tLSByZXNpemUgLS0tLS0gLy9cblx0XG5cdHByb3RvLm9ucmVzaXplID0gZnVuY3Rpb24oKSB7XG5cdCAgdGhpcy53YXRjaENTUygpO1xuXHQgIHRoaXMucmVzaXplKCk7XG5cdH07XG5cdFxuXHR1dGlscy5kZWJvdW5jZU1ldGhvZCggRmxpY2tpdHksICdvbnJlc2l6ZScsIDE1MCApO1xuXHRcblx0cHJvdG8ucmVzaXplID0gZnVuY3Rpb24oKSB7XG5cdCAgaWYgKCAhdGhpcy5pc0FjdGl2ZSApIHtcblx0ICAgIHJldHVybjtcblx0ICB9XG5cdCAgdGhpcy5nZXRTaXplKCk7XG5cdCAgLy8gd3JhcCB2YWx1ZXNcblx0ICBpZiAoIHRoaXMub3B0aW9ucy53cmFwQXJvdW5kICkge1xuXHQgICAgdGhpcy54ID0gdXRpbHMubW9kdWxvKCB0aGlzLngsIHRoaXMuc2xpZGVhYmxlV2lkdGggKTtcblx0ICB9XG5cdCAgdGhpcy5wb3NpdGlvbkNlbGxzKCk7XG5cdCAgdGhpcy5fZ2V0V3JhcFNoaWZ0Q2VsbHMoKTtcblx0ICB0aGlzLnNldEdhbGxlcnlTaXplKCk7XG5cdCAgdGhpcy5lbWl0RXZlbnQoJ3Jlc2l6ZScpO1xuXHQgIC8vIHVwZGF0ZSBzZWxlY3RlZCBpbmRleCBmb3IgZ3JvdXAgc2xpZGVzLCBpbnN0YW50XG5cdCAgLy8gVE9ETzogcG9zaXRpb24gY2FuIGJlIGxvc3QgYmV0d2VlbiBncm91cHMgb2YgdmFyaW91cyBudW1iZXJzXG5cdCAgdmFyIHNlbGVjdGVkRWxlbWVudCA9IHRoaXMuc2VsZWN0ZWRFbGVtZW50cyAmJiB0aGlzLnNlbGVjdGVkRWxlbWVudHNbMF07XG5cdCAgdGhpcy5zZWxlY3RDZWxsKCBzZWxlY3RlZEVsZW1lbnQsIGZhbHNlLCB0cnVlICk7XG5cdH07XG5cdFxuXHQvLyB3YXRjaGVzIHRoZSA6YWZ0ZXIgcHJvcGVydHksIGFjdGl2YXRlcy9kZWFjdGl2YXRlc1xuXHRwcm90by53YXRjaENTUyA9IGZ1bmN0aW9uKCkge1xuXHQgIHZhciB3YXRjaE9wdGlvbiA9IHRoaXMub3B0aW9ucy53YXRjaENTUztcblx0ICBpZiAoICF3YXRjaE9wdGlvbiApIHtcblx0ICAgIHJldHVybjtcblx0ICB9XG5cdFxuXHQgIHZhciBhZnRlckNvbnRlbnQgPSBnZXRDb21wdXRlZFN0eWxlKCB0aGlzLmVsZW1lbnQsICc6YWZ0ZXInICkuY29udGVudDtcblx0ICAvLyBhY3RpdmF0ZSBpZiA6YWZ0ZXIgeyBjb250ZW50OiAnZmxpY2tpdHknIH1cblx0ICBpZiAoIGFmdGVyQ29udGVudC5pbmRleE9mKCdmbGlja2l0eScpICE9IC0xICkge1xuXHQgICAgdGhpcy5hY3RpdmF0ZSgpO1xuXHQgIH0gZWxzZSB7XG5cdCAgICB0aGlzLmRlYWN0aXZhdGUoKTtcblx0ICB9XG5cdH07XG5cdFxuXHQvLyAtLS0tLSBrZXlkb3duIC0tLS0tIC8vXG5cdFxuXHQvLyBnbyBwcmV2aW91cy9uZXh0IGlmIGxlZnQvcmlnaHQga2V5cyBwcmVzc2VkXG5cdHByb3RvLm9ua2V5ZG93biA9IGZ1bmN0aW9uKCBldmVudCApIHtcblx0ICAvLyBvbmx5IHdvcmsgaWYgZWxlbWVudCBpcyBpbiBmb2N1c1xuXHQgIGlmICggIXRoaXMub3B0aW9ucy5hY2Nlc3NpYmlsaXR5IHx8XG5cdCAgICAoIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgJiYgZG9jdW1lbnQuYWN0aXZlRWxlbWVudCAhPSB0aGlzLmVsZW1lbnQgKSApIHtcblx0ICAgIHJldHVybjtcblx0ICB9XG5cdFxuXHQgIGlmICggZXZlbnQua2V5Q29kZSA9PSAzNyApIHtcblx0ICAgIC8vIGdvIGxlZnRcblx0ICAgIHZhciBsZWZ0TWV0aG9kID0gdGhpcy5vcHRpb25zLnJpZ2h0VG9MZWZ0ID8gJ25leHQnIDogJ3ByZXZpb3VzJztcblx0ICAgIHRoaXMudWlDaGFuZ2UoKTtcblx0ICAgIHRoaXNbIGxlZnRNZXRob2QgXSgpO1xuXHQgIH0gZWxzZSBpZiAoIGV2ZW50LmtleUNvZGUgPT0gMzkgKSB7XG5cdCAgICAvLyBnbyByaWdodFxuXHQgICAgdmFyIHJpZ2h0TWV0aG9kID0gdGhpcy5vcHRpb25zLnJpZ2h0VG9MZWZ0ID8gJ3ByZXZpb3VzJyA6ICduZXh0Jztcblx0ICAgIHRoaXMudWlDaGFuZ2UoKTtcblx0ICAgIHRoaXNbIHJpZ2h0TWV0aG9kIF0oKTtcblx0ICB9XG5cdH07XG5cdFxuXHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBkZXN0cm95IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vXG5cdFxuXHQvLyBkZWFjdGl2YXRlIGFsbCBGbGlja2l0eSBmdW5jdGlvbmFsaXR5LCBidXQga2VlcCBzdHVmZiBhdmFpbGFibGVcblx0cHJvdG8uZGVhY3RpdmF0ZSA9IGZ1bmN0aW9uKCkge1xuXHQgIGlmICggIXRoaXMuaXNBY3RpdmUgKSB7XG5cdCAgICByZXR1cm47XG5cdCAgfVxuXHQgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdmbGlja2l0eS1lbmFibGVkJyk7XG5cdCAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2ZsaWNraXR5LXJ0bCcpO1xuXHQgIC8vIGRlc3Ryb3kgY2VsbHNcblx0ICB0aGlzLmNlbGxzLmZvckVhY2goIGZ1bmN0aW9uKCBjZWxsICkge1xuXHQgICAgY2VsbC5kZXN0cm95KCk7XG5cdCAgfSk7XG5cdCAgdGhpcy51bnNlbGVjdFNlbGVjdGVkU2xpZGUoKTtcblx0ICB0aGlzLmVsZW1lbnQucmVtb3ZlQ2hpbGQoIHRoaXMudmlld3BvcnQgKTtcblx0ICAvLyBtb3ZlIGNoaWxkIGVsZW1lbnRzIGJhY2sgaW50byBlbGVtZW50XG5cdCAgbW92ZUVsZW1lbnRzKCB0aGlzLnNsaWRlci5jaGlsZHJlbiwgdGhpcy5lbGVtZW50ICk7XG5cdCAgaWYgKCB0aGlzLm9wdGlvbnMuYWNjZXNzaWJpbGl0eSApIHtcblx0ICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ3RhYkluZGV4Jyk7XG5cdCAgICB0aGlzLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ2tleWRvd24nLCB0aGlzICk7XG5cdCAgfVxuXHQgIC8vIHNldCBmbGFnc1xuXHQgIHRoaXMuaXNBY3RpdmUgPSBmYWxzZTtcblx0ICB0aGlzLmVtaXRFdmVudCgnZGVhY3RpdmF0ZScpO1xuXHR9O1xuXHRcblx0cHJvdG8uZGVzdHJveSA9IGZ1bmN0aW9uKCkge1xuXHQgIHRoaXMuZGVhY3RpdmF0ZSgpO1xuXHQgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCAncmVzaXplJywgdGhpcyApO1xuXHQgIHRoaXMuZW1pdEV2ZW50KCdkZXN0cm95Jyk7XG5cdCAgaWYgKCBqUXVlcnkgJiYgdGhpcy4kZWxlbWVudCApIHtcblx0ICAgIGpRdWVyeS5yZW1vdmVEYXRhKCB0aGlzLmVsZW1lbnQsICdmbGlja2l0eScgKTtcblx0ICB9XG5cdCAgZGVsZXRlIHRoaXMuZWxlbWVudC5mbGlja2l0eUdVSUQ7XG5cdCAgZGVsZXRlIGluc3RhbmNlc1sgdGhpcy5ndWlkIF07XG5cdH07XG5cdFxuXHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBwcm90b3R5cGUgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cblx0XG5cdHV0aWxzLmV4dGVuZCggcHJvdG8sIGFuaW1hdGVQcm90b3R5cGUgKTtcblx0XG5cdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIGV4dHJhcyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvL1xuXHRcblx0LyoqXG5cdCAqIGdldCBGbGlja2l0eSBpbnN0YW5jZSBmcm9tIGVsZW1lbnRcblx0ICogQHBhcmFtIHtFbGVtZW50fSBlbGVtXG5cdCAqIEByZXR1cm5zIHtGbGlja2l0eX1cblx0ICovXG5cdEZsaWNraXR5LmRhdGEgPSBmdW5jdGlvbiggZWxlbSApIHtcblx0ICBlbGVtID0gdXRpbHMuZ2V0UXVlcnlFbGVtZW50KCBlbGVtICk7XG5cdCAgdmFyIGlkID0gZWxlbSAmJiBlbGVtLmZsaWNraXR5R1VJRDtcblx0ICByZXR1cm4gaWQgJiYgaW5zdGFuY2VzWyBpZCBdO1xuXHR9O1xuXHRcblx0dXRpbHMuaHRtbEluaXQoIEZsaWNraXR5LCAnZmxpY2tpdHknICk7XG5cdFxuXHRpZiAoIGpRdWVyeSAmJiBqUXVlcnkuYnJpZGdldCApIHtcblx0ICBqUXVlcnkuYnJpZGdldCggJ2ZsaWNraXR5JywgRmxpY2tpdHkgKTtcblx0fVxuXHRcblx0RmxpY2tpdHkuQ2VsbCA9IENlbGw7XG5cdFxuXHRyZXR1cm4gRmxpY2tpdHk7XG5cdFxuXHR9KSk7XG5cblxuLyoqKi8gfSxcbi8qIDUgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdHZhciBfX1dFQlBBQ0tfQU1EX0RFRklORV9GQUNUT1JZX18sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fOy8qKlxuXHQgKiBFdkVtaXR0ZXIgdjEuMC4zXG5cdCAqIExpbCcgZXZlbnQgZW1pdHRlclxuXHQgKiBNSVQgTGljZW5zZVxuXHQgKi9cblx0XG5cdC8qIGpzaGludCB1bnVzZWQ6IHRydWUsIHVuZGVmOiB0cnVlLCBzdHJpY3Q6IHRydWUgKi9cblx0XG5cdCggZnVuY3Rpb24oIGdsb2JhbCwgZmFjdG9yeSApIHtcblx0ICAvLyB1bml2ZXJzYWwgbW9kdWxlIGRlZmluaXRpb25cblx0ICAvKiBqc2hpbnQgc3RyaWN0OiBmYWxzZSAqLyAvKiBnbG9iYWxzIGRlZmluZSwgbW9kdWxlLCB3aW5kb3cgKi9cblx0ICBpZiAoIHRydWUgKSB7XG5cdCAgICAvLyBBTUQgLSBSZXF1aXJlSlNcblx0ICAgICEoX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fID0gKGZhY3RvcnkpLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyA9ICh0eXBlb2YgX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fID09PSAnZnVuY3Rpb24nID8gKF9fV0VCUEFDS19BTURfREVGSU5FX0ZBQ1RPUllfXy5jYWxsKGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18sIGV4cG9ydHMsIG1vZHVsZSkpIDogX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fKSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gIT09IHVuZGVmaW5lZCAmJiAobW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXykpO1xuXHQgIH0gZWxzZSBpZiAoIHR5cGVvZiBtb2R1bGUgPT0gJ29iamVjdCcgJiYgbW9kdWxlLmV4cG9ydHMgKSB7XG5cdCAgICAvLyBDb21tb25KUyAtIEJyb3dzZXJpZnksIFdlYnBhY2tcblx0ICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuXHQgIH0gZWxzZSB7XG5cdCAgICAvLyBCcm93c2VyIGdsb2JhbHNcblx0ICAgIGdsb2JhbC5FdkVtaXR0ZXIgPSBmYWN0b3J5KCk7XG5cdCAgfVxuXHRcblx0fSggdHlwZW9mIHdpbmRvdyAhPSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHRoaXMsIGZ1bmN0aW9uKCkge1xuXHRcblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdFxuXHRmdW5jdGlvbiBFdkVtaXR0ZXIoKSB7fVxuXHRcblx0dmFyIHByb3RvID0gRXZFbWl0dGVyLnByb3RvdHlwZTtcblx0XG5cdHByb3RvLm9uID0gZnVuY3Rpb24oIGV2ZW50TmFtZSwgbGlzdGVuZXIgKSB7XG5cdCAgaWYgKCAhZXZlbnROYW1lIHx8ICFsaXN0ZW5lciApIHtcblx0ICAgIHJldHVybjtcblx0ICB9XG5cdCAgLy8gc2V0IGV2ZW50cyBoYXNoXG5cdCAgdmFyIGV2ZW50cyA9IHRoaXMuX2V2ZW50cyA9IHRoaXMuX2V2ZW50cyB8fCB7fTtcblx0ICAvLyBzZXQgbGlzdGVuZXJzIGFycmF5XG5cdCAgdmFyIGxpc3RlbmVycyA9IGV2ZW50c1sgZXZlbnROYW1lIF0gPSBldmVudHNbIGV2ZW50TmFtZSBdIHx8IFtdO1xuXHQgIC8vIG9ubHkgYWRkIG9uY2Vcblx0ICBpZiAoIGxpc3RlbmVycy5pbmRleE9mKCBsaXN0ZW5lciApID09IC0xICkge1xuXHQgICAgbGlzdGVuZXJzLnB1c2goIGxpc3RlbmVyICk7XG5cdCAgfVxuXHRcblx0ICByZXR1cm4gdGhpcztcblx0fTtcblx0XG5cdHByb3RvLm9uY2UgPSBmdW5jdGlvbiggZXZlbnROYW1lLCBsaXN0ZW5lciApIHtcblx0ICBpZiAoICFldmVudE5hbWUgfHwgIWxpc3RlbmVyICkge1xuXHQgICAgcmV0dXJuO1xuXHQgIH1cblx0ICAvLyBhZGQgZXZlbnRcblx0ICB0aGlzLm9uKCBldmVudE5hbWUsIGxpc3RlbmVyICk7XG5cdCAgLy8gc2V0IG9uY2UgZmxhZ1xuXHQgIC8vIHNldCBvbmNlRXZlbnRzIGhhc2hcblx0ICB2YXIgb25jZUV2ZW50cyA9IHRoaXMuX29uY2VFdmVudHMgPSB0aGlzLl9vbmNlRXZlbnRzIHx8IHt9O1xuXHQgIC8vIHNldCBvbmNlTGlzdGVuZXJzIG9iamVjdFxuXHQgIHZhciBvbmNlTGlzdGVuZXJzID0gb25jZUV2ZW50c1sgZXZlbnROYW1lIF0gPSBvbmNlRXZlbnRzWyBldmVudE5hbWUgXSB8fCB7fTtcblx0ICAvLyBzZXQgZmxhZ1xuXHQgIG9uY2VMaXN0ZW5lcnNbIGxpc3RlbmVyIF0gPSB0cnVlO1xuXHRcblx0ICByZXR1cm4gdGhpcztcblx0fTtcblx0XG5cdHByb3RvLm9mZiA9IGZ1bmN0aW9uKCBldmVudE5hbWUsIGxpc3RlbmVyICkge1xuXHQgIHZhciBsaXN0ZW5lcnMgPSB0aGlzLl9ldmVudHMgJiYgdGhpcy5fZXZlbnRzWyBldmVudE5hbWUgXTtcblx0ICBpZiAoICFsaXN0ZW5lcnMgfHwgIWxpc3RlbmVycy5sZW5ndGggKSB7XG5cdCAgICByZXR1cm47XG5cdCAgfVxuXHQgIHZhciBpbmRleCA9IGxpc3RlbmVycy5pbmRleE9mKCBsaXN0ZW5lciApO1xuXHQgIGlmICggaW5kZXggIT0gLTEgKSB7XG5cdCAgICBsaXN0ZW5lcnMuc3BsaWNlKCBpbmRleCwgMSApO1xuXHQgIH1cblx0XG5cdCAgcmV0dXJuIHRoaXM7XG5cdH07XG5cdFxuXHRwcm90by5lbWl0RXZlbnQgPSBmdW5jdGlvbiggZXZlbnROYW1lLCBhcmdzICkge1xuXHQgIHZhciBsaXN0ZW5lcnMgPSB0aGlzLl9ldmVudHMgJiYgdGhpcy5fZXZlbnRzWyBldmVudE5hbWUgXTtcblx0ICBpZiAoICFsaXN0ZW5lcnMgfHwgIWxpc3RlbmVycy5sZW5ndGggKSB7XG5cdCAgICByZXR1cm47XG5cdCAgfVxuXHQgIHZhciBpID0gMDtcblx0ICB2YXIgbGlzdGVuZXIgPSBsaXN0ZW5lcnNbaV07XG5cdCAgYXJncyA9IGFyZ3MgfHwgW107XG5cdCAgLy8gb25jZSBzdHVmZlxuXHQgIHZhciBvbmNlTGlzdGVuZXJzID0gdGhpcy5fb25jZUV2ZW50cyAmJiB0aGlzLl9vbmNlRXZlbnRzWyBldmVudE5hbWUgXTtcblx0XG5cdCAgd2hpbGUgKCBsaXN0ZW5lciApIHtcblx0ICAgIHZhciBpc09uY2UgPSBvbmNlTGlzdGVuZXJzICYmIG9uY2VMaXN0ZW5lcnNbIGxpc3RlbmVyIF07XG5cdCAgICBpZiAoIGlzT25jZSApIHtcblx0ICAgICAgLy8gcmVtb3ZlIGxpc3RlbmVyXG5cdCAgICAgIC8vIHJlbW92ZSBiZWZvcmUgdHJpZ2dlciB0byBwcmV2ZW50IHJlY3Vyc2lvblxuXHQgICAgICB0aGlzLm9mZiggZXZlbnROYW1lLCBsaXN0ZW5lciApO1xuXHQgICAgICAvLyB1bnNldCBvbmNlIGZsYWdcblx0ICAgICAgZGVsZXRlIG9uY2VMaXN0ZW5lcnNbIGxpc3RlbmVyIF07XG5cdCAgICB9XG5cdCAgICAvLyB0cmlnZ2VyIGxpc3RlbmVyXG5cdCAgICBsaXN0ZW5lci5hcHBseSggdGhpcywgYXJncyApO1xuXHQgICAgLy8gZ2V0IG5leHQgbGlzdGVuZXJcblx0ICAgIGkgKz0gaXNPbmNlID8gMCA6IDE7XG5cdCAgICBsaXN0ZW5lciA9IGxpc3RlbmVyc1tpXTtcblx0ICB9XG5cdFxuXHQgIHJldHVybiB0aGlzO1xuXHR9O1xuXHRcblx0cmV0dXJuIEV2RW1pdHRlcjtcblx0XG5cdH0pKTtcblxuXG4vKioqLyB9LFxuLyogNiAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0dmFyIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fOy8qIVxuXHQgKiBnZXRTaXplIHYyLjAuMlxuXHQgKiBtZWFzdXJlIHNpemUgb2YgZWxlbWVudHNcblx0ICogTUlUIGxpY2Vuc2Vcblx0ICovXG5cdFxuXHQvKmpzaGludCBicm93c2VyOiB0cnVlLCBzdHJpY3Q6IHRydWUsIHVuZGVmOiB0cnVlLCB1bnVzZWQ6IHRydWUgKi9cblx0LypnbG9iYWwgZGVmaW5lOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSwgY29uc29sZTogZmFsc2UgKi9cblx0XG5cdCggZnVuY3Rpb24oIHdpbmRvdywgZmFjdG9yeSApIHtcblx0ICAndXNlIHN0cmljdCc7XG5cdFxuXHQgIGlmICggdHJ1ZSApIHtcblx0ICAgIC8vIEFNRFxuXHQgICAgIShfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICByZXR1cm4gZmFjdG9yeSgpO1xuXHQgICAgfS5jYWxsKGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18sIGV4cG9ydHMsIG1vZHVsZSksIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fICE9PSB1bmRlZmluZWQgJiYgKG1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18pKTtcblx0ICB9IGVsc2UgaWYgKCB0eXBlb2YgbW9kdWxlID09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzICkge1xuXHQgICAgLy8gQ29tbW9uSlNcblx0ICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuXHQgIH0gZWxzZSB7XG5cdCAgICAvLyBicm93c2VyIGdsb2JhbFxuXHQgICAgd2luZG93LmdldFNpemUgPSBmYWN0b3J5KCk7XG5cdCAgfVxuXHRcblx0fSkoIHdpbmRvdywgZnVuY3Rpb24gZmFjdG9yeSgpIHtcblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gaGVscGVycyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvL1xuXHRcblx0Ly8gZ2V0IGEgbnVtYmVyIGZyb20gYSBzdHJpbmcsIG5vdCBhIHBlcmNlbnRhZ2Vcblx0ZnVuY3Rpb24gZ2V0U3R5bGVTaXplKCB2YWx1ZSApIHtcblx0ICB2YXIgbnVtID0gcGFyc2VGbG9hdCggdmFsdWUgKTtcblx0ICAvLyBub3QgYSBwZXJjZW50IGxpa2UgJzEwMCUnLCBhbmQgYSBudW1iZXJcblx0ICB2YXIgaXNWYWxpZCA9IHZhbHVlLmluZGV4T2YoJyUnKSA9PSAtMSAmJiAhaXNOYU4oIG51bSApO1xuXHQgIHJldHVybiBpc1ZhbGlkICYmIG51bTtcblx0fVxuXHRcblx0ZnVuY3Rpb24gbm9vcCgpIHt9XG5cdFxuXHR2YXIgbG9nRXJyb3IgPSB0eXBlb2YgY29uc29sZSA9PSAndW5kZWZpbmVkJyA/IG5vb3AgOlxuXHQgIGZ1bmN0aW9uKCBtZXNzYWdlICkge1xuXHQgICAgY29uc29sZS5lcnJvciggbWVzc2FnZSApO1xuXHQgIH07XG5cdFxuXHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBtZWFzdXJlbWVudHMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cblx0XG5cdHZhciBtZWFzdXJlbWVudHMgPSBbXG5cdCAgJ3BhZGRpbmdMZWZ0Jyxcblx0ICAncGFkZGluZ1JpZ2h0Jyxcblx0ICAncGFkZGluZ1RvcCcsXG5cdCAgJ3BhZGRpbmdCb3R0b20nLFxuXHQgICdtYXJnaW5MZWZ0Jyxcblx0ICAnbWFyZ2luUmlnaHQnLFxuXHQgICdtYXJnaW5Ub3AnLFxuXHQgICdtYXJnaW5Cb3R0b20nLFxuXHQgICdib3JkZXJMZWZ0V2lkdGgnLFxuXHQgICdib3JkZXJSaWdodFdpZHRoJyxcblx0ICAnYm9yZGVyVG9wV2lkdGgnLFxuXHQgICdib3JkZXJCb3R0b21XaWR0aCdcblx0XTtcblx0XG5cdHZhciBtZWFzdXJlbWVudHNMZW5ndGggPSBtZWFzdXJlbWVudHMubGVuZ3RoO1xuXHRcblx0ZnVuY3Rpb24gZ2V0WmVyb1NpemUoKSB7XG5cdCAgdmFyIHNpemUgPSB7XG5cdCAgICB3aWR0aDogMCxcblx0ICAgIGhlaWdodDogMCxcblx0ICAgIGlubmVyV2lkdGg6IDAsXG5cdCAgICBpbm5lckhlaWdodDogMCxcblx0ICAgIG91dGVyV2lkdGg6IDAsXG5cdCAgICBvdXRlckhlaWdodDogMFxuXHQgIH07XG5cdCAgZm9yICggdmFyIGk9MDsgaSA8IG1lYXN1cmVtZW50c0xlbmd0aDsgaSsrICkge1xuXHQgICAgdmFyIG1lYXN1cmVtZW50ID0gbWVhc3VyZW1lbnRzW2ldO1xuXHQgICAgc2l6ZVsgbWVhc3VyZW1lbnQgXSA9IDA7XG5cdCAgfVxuXHQgIHJldHVybiBzaXplO1xuXHR9XG5cdFxuXHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBnZXRTdHlsZSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvL1xuXHRcblx0LyoqXG5cdCAqIGdldFN0eWxlLCBnZXQgc3R5bGUgb2YgZWxlbWVudCwgY2hlY2sgZm9yIEZpcmVmb3ggYnVnXG5cdCAqIGh0dHBzOi8vYnVnemlsbGEubW96aWxsYS5vcmcvc2hvd19idWcuY2dpP2lkPTU0ODM5N1xuXHQgKi9cblx0ZnVuY3Rpb24gZ2V0U3R5bGUoIGVsZW0gKSB7XG5cdCAgdmFyIHN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZSggZWxlbSApO1xuXHQgIGlmICggIXN0eWxlICkge1xuXHQgICAgbG9nRXJyb3IoICdTdHlsZSByZXR1cm5lZCAnICsgc3R5bGUgK1xuXHQgICAgICAnLiBBcmUgeW91IHJ1bm5pbmcgdGhpcyBjb2RlIGluIGEgaGlkZGVuIGlmcmFtZSBvbiBGaXJlZm94PyAnICtcblx0ICAgICAgJ1NlZSBodHRwOi8vYml0Lmx5L2dldHNpemVidWcxJyApO1xuXHQgIH1cblx0ICByZXR1cm4gc3R5bGU7XG5cdH1cblx0XG5cdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIHNldHVwIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vXG5cdFxuXHR2YXIgaXNTZXR1cCA9IGZhbHNlO1xuXHRcblx0dmFyIGlzQm94U2l6ZU91dGVyO1xuXHRcblx0LyoqXG5cdCAqIHNldHVwXG5cdCAqIGNoZWNrIGlzQm94U2l6ZXJPdXRlclxuXHQgKiBkbyBvbiBmaXJzdCBnZXRTaXplKCkgcmF0aGVyIHRoYW4gb24gcGFnZSBsb2FkIGZvciBGaXJlZm94IGJ1Z1xuXHQgKi9cblx0ZnVuY3Rpb24gc2V0dXAoKSB7XG5cdCAgLy8gc2V0dXAgb25jZVxuXHQgIGlmICggaXNTZXR1cCApIHtcblx0ICAgIHJldHVybjtcblx0ICB9XG5cdCAgaXNTZXR1cCA9IHRydWU7XG5cdFxuXHQgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIGJveCBzaXppbmcgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cblx0XG5cdCAgLyoqXG5cdCAgICogV2ViS2l0IG1lYXN1cmVzIHRoZSBvdXRlci13aWR0aCBvbiBzdHlsZS53aWR0aCBvbiBib3JkZXItYm94IGVsZW1zXG5cdCAgICogSUUgJiBGaXJlZm94PDI5IG1lYXN1cmVzIHRoZSBpbm5lci13aWR0aFxuXHQgICAqL1xuXHQgIHZhciBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0ICBkaXYuc3R5bGUud2lkdGggPSAnMjAwcHgnO1xuXHQgIGRpdi5zdHlsZS5wYWRkaW5nID0gJzFweCAycHggM3B4IDRweCc7XG5cdCAgZGl2LnN0eWxlLmJvcmRlclN0eWxlID0gJ3NvbGlkJztcblx0ICBkaXYuc3R5bGUuYm9yZGVyV2lkdGggPSAnMXB4IDJweCAzcHggNHB4Jztcblx0ICBkaXYuc3R5bGUuYm94U2l6aW5nID0gJ2JvcmRlci1ib3gnO1xuXHRcblx0ICB2YXIgYm9keSA9IGRvY3VtZW50LmJvZHkgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50O1xuXHQgIGJvZHkuYXBwZW5kQ2hpbGQoIGRpdiApO1xuXHQgIHZhciBzdHlsZSA9IGdldFN0eWxlKCBkaXYgKTtcblx0XG5cdCAgZ2V0U2l6ZS5pc0JveFNpemVPdXRlciA9IGlzQm94U2l6ZU91dGVyID0gZ2V0U3R5bGVTaXplKCBzdHlsZS53aWR0aCApID09IDIwMDtcblx0ICBib2R5LnJlbW92ZUNoaWxkKCBkaXYgKTtcblx0XG5cdH1cblx0XG5cdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIGdldFNpemUgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cblx0XG5cdGZ1bmN0aW9uIGdldFNpemUoIGVsZW0gKSB7XG5cdCAgc2V0dXAoKTtcblx0XG5cdCAgLy8gdXNlIHF1ZXJ5U2VsZXRvciBpZiBlbGVtIGlzIHN0cmluZ1xuXHQgIGlmICggdHlwZW9mIGVsZW0gPT0gJ3N0cmluZycgKSB7XG5cdCAgICBlbGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvciggZWxlbSApO1xuXHQgIH1cblx0XG5cdCAgLy8gZG8gbm90IHByb2NlZWQgb24gbm9uLW9iamVjdHNcblx0ICBpZiAoICFlbGVtIHx8IHR5cGVvZiBlbGVtICE9ICdvYmplY3QnIHx8ICFlbGVtLm5vZGVUeXBlICkge1xuXHQgICAgcmV0dXJuO1xuXHQgIH1cblx0XG5cdCAgdmFyIHN0eWxlID0gZ2V0U3R5bGUoIGVsZW0gKTtcblx0XG5cdCAgLy8gaWYgaGlkZGVuLCBldmVyeXRoaW5nIGlzIDBcblx0ICBpZiAoIHN0eWxlLmRpc3BsYXkgPT0gJ25vbmUnICkge1xuXHQgICAgcmV0dXJuIGdldFplcm9TaXplKCk7XG5cdCAgfVxuXHRcblx0ICB2YXIgc2l6ZSA9IHt9O1xuXHQgIHNpemUud2lkdGggPSBlbGVtLm9mZnNldFdpZHRoO1xuXHQgIHNpemUuaGVpZ2h0ID0gZWxlbS5vZmZzZXRIZWlnaHQ7XG5cdFxuXHQgIHZhciBpc0JvcmRlckJveCA9IHNpemUuaXNCb3JkZXJCb3ggPSBzdHlsZS5ib3hTaXppbmcgPT0gJ2JvcmRlci1ib3gnO1xuXHRcblx0ICAvLyBnZXQgYWxsIG1lYXN1cmVtZW50c1xuXHQgIGZvciAoIHZhciBpPTA7IGkgPCBtZWFzdXJlbWVudHNMZW5ndGg7IGkrKyApIHtcblx0ICAgIHZhciBtZWFzdXJlbWVudCA9IG1lYXN1cmVtZW50c1tpXTtcblx0ICAgIHZhciB2YWx1ZSA9IHN0eWxlWyBtZWFzdXJlbWVudCBdO1xuXHQgICAgdmFyIG51bSA9IHBhcnNlRmxvYXQoIHZhbHVlICk7XG5cdCAgICAvLyBhbnkgJ2F1dG8nLCAnbWVkaXVtJyB2YWx1ZSB3aWxsIGJlIDBcblx0ICAgIHNpemVbIG1lYXN1cmVtZW50IF0gPSAhaXNOYU4oIG51bSApID8gbnVtIDogMDtcblx0ICB9XG5cdFxuXHQgIHZhciBwYWRkaW5nV2lkdGggPSBzaXplLnBhZGRpbmdMZWZ0ICsgc2l6ZS5wYWRkaW5nUmlnaHQ7XG5cdCAgdmFyIHBhZGRpbmdIZWlnaHQgPSBzaXplLnBhZGRpbmdUb3AgKyBzaXplLnBhZGRpbmdCb3R0b207XG5cdCAgdmFyIG1hcmdpbldpZHRoID0gc2l6ZS5tYXJnaW5MZWZ0ICsgc2l6ZS5tYXJnaW5SaWdodDtcblx0ICB2YXIgbWFyZ2luSGVpZ2h0ID0gc2l6ZS5tYXJnaW5Ub3AgKyBzaXplLm1hcmdpbkJvdHRvbTtcblx0ICB2YXIgYm9yZGVyV2lkdGggPSBzaXplLmJvcmRlckxlZnRXaWR0aCArIHNpemUuYm9yZGVyUmlnaHRXaWR0aDtcblx0ICB2YXIgYm9yZGVySGVpZ2h0ID0gc2l6ZS5ib3JkZXJUb3BXaWR0aCArIHNpemUuYm9yZGVyQm90dG9tV2lkdGg7XG5cdFxuXHQgIHZhciBpc0JvcmRlckJveFNpemVPdXRlciA9IGlzQm9yZGVyQm94ICYmIGlzQm94U2l6ZU91dGVyO1xuXHRcblx0ICAvLyBvdmVyd3JpdGUgd2lkdGggYW5kIGhlaWdodCBpZiB3ZSBjYW4gZ2V0IGl0IGZyb20gc3R5bGVcblx0ICB2YXIgc3R5bGVXaWR0aCA9IGdldFN0eWxlU2l6ZSggc3R5bGUud2lkdGggKTtcblx0ICBpZiAoIHN0eWxlV2lkdGggIT09IGZhbHNlICkge1xuXHQgICAgc2l6ZS53aWR0aCA9IHN0eWxlV2lkdGggK1xuXHQgICAgICAvLyBhZGQgcGFkZGluZyBhbmQgYm9yZGVyIHVubGVzcyBpdCdzIGFscmVhZHkgaW5jbHVkaW5nIGl0XG5cdCAgICAgICggaXNCb3JkZXJCb3hTaXplT3V0ZXIgPyAwIDogcGFkZGluZ1dpZHRoICsgYm9yZGVyV2lkdGggKTtcblx0ICB9XG5cdFxuXHQgIHZhciBzdHlsZUhlaWdodCA9IGdldFN0eWxlU2l6ZSggc3R5bGUuaGVpZ2h0ICk7XG5cdCAgaWYgKCBzdHlsZUhlaWdodCAhPT0gZmFsc2UgKSB7XG5cdCAgICBzaXplLmhlaWdodCA9IHN0eWxlSGVpZ2h0ICtcblx0ICAgICAgLy8gYWRkIHBhZGRpbmcgYW5kIGJvcmRlciB1bmxlc3MgaXQncyBhbHJlYWR5IGluY2x1ZGluZyBpdFxuXHQgICAgICAoIGlzQm9yZGVyQm94U2l6ZU91dGVyID8gMCA6IHBhZGRpbmdIZWlnaHQgKyBib3JkZXJIZWlnaHQgKTtcblx0ICB9XG5cdFxuXHQgIHNpemUuaW5uZXJXaWR0aCA9IHNpemUud2lkdGggLSAoIHBhZGRpbmdXaWR0aCArIGJvcmRlcldpZHRoICk7XG5cdCAgc2l6ZS5pbm5lckhlaWdodCA9IHNpemUuaGVpZ2h0IC0gKCBwYWRkaW5nSGVpZ2h0ICsgYm9yZGVySGVpZ2h0ICk7XG5cdFxuXHQgIHNpemUub3V0ZXJXaWR0aCA9IHNpemUud2lkdGggKyBtYXJnaW5XaWR0aDtcblx0ICBzaXplLm91dGVySGVpZ2h0ID0gc2l6ZS5oZWlnaHQgKyBtYXJnaW5IZWlnaHQ7XG5cdFxuXHQgIHJldHVybiBzaXplO1xuXHR9XG5cdFxuXHRyZXR1cm4gZ2V0U2l6ZTtcblx0XG5cdH0pO1xuXG5cbi8qKiovIH0sXG4vKiA3ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHR2YXIgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXywgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX187LyoqXG5cdCAqIEZpenp5IFVJIHV0aWxzIHYyLjAuM1xuXHQgKiBNSVQgbGljZW5zZVxuXHQgKi9cblx0XG5cdC8qanNoaW50IGJyb3dzZXI6IHRydWUsIHVuZGVmOiB0cnVlLCB1bnVzZWQ6IHRydWUsIHN0cmljdDogdHJ1ZSAqL1xuXHRcblx0KCBmdW5jdGlvbiggd2luZG93LCBmYWN0b3J5ICkge1xuXHQgIC8vIHVuaXZlcnNhbCBtb2R1bGUgZGVmaW5pdGlvblxuXHQgIC8qanNoaW50IHN0cmljdDogZmFsc2UgKi8gLypnbG9iYWxzIGRlZmluZSwgbW9kdWxlLCByZXF1aXJlICovXG5cdFxuXHQgIGlmICggdHJ1ZSApIHtcblx0ICAgIC8vIEFNRFxuXHQgICAgIShfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fID0gW1xuXHQgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpXG5cdCAgICBdLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyA9IGZ1bmN0aW9uKCBtYXRjaGVzU2VsZWN0b3IgKSB7XG5cdCAgICAgIHJldHVybiBmYWN0b3J5KCB3aW5kb3csIG1hdGNoZXNTZWxlY3RvciApO1xuXHQgICAgfS5hcHBseShleHBvcnRzLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fKSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gIT09IHVuZGVmaW5lZCAmJiAobW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXykpO1xuXHQgIH0gZWxzZSBpZiAoIHR5cGVvZiBtb2R1bGUgPT0gJ29iamVjdCcgJiYgbW9kdWxlLmV4cG9ydHMgKSB7XG5cdCAgICAvLyBDb21tb25KU1xuXHQgICAgbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KFxuXHQgICAgICB3aW5kb3csXG5cdCAgICAgIHJlcXVpcmUoJ2Rlc2FuZHJvLW1hdGNoZXMtc2VsZWN0b3InKVxuXHQgICAgKTtcblx0ICB9IGVsc2Uge1xuXHQgICAgLy8gYnJvd3NlciBnbG9iYWxcblx0ICAgIHdpbmRvdy5maXp6eVVJVXRpbHMgPSBmYWN0b3J5KFxuXHQgICAgICB3aW5kb3csXG5cdCAgICAgIHdpbmRvdy5tYXRjaGVzU2VsZWN0b3Jcblx0ICAgICk7XG5cdCAgfVxuXHRcblx0fSggd2luZG93LCBmdW5jdGlvbiBmYWN0b3J5KCB3aW5kb3csIG1hdGNoZXNTZWxlY3RvciApIHtcblx0XG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdHZhciB1dGlscyA9IHt9O1xuXHRcblx0Ly8gLS0tLS0gZXh0ZW5kIC0tLS0tIC8vXG5cdFxuXHQvLyBleHRlbmRzIG9iamVjdHNcblx0dXRpbHMuZXh0ZW5kID0gZnVuY3Rpb24oIGEsIGIgKSB7XG5cdCAgZm9yICggdmFyIHByb3AgaW4gYiApIHtcblx0ICAgIGFbIHByb3AgXSA9IGJbIHByb3AgXTtcblx0ICB9XG5cdCAgcmV0dXJuIGE7XG5cdH07XG5cdFxuXHQvLyAtLS0tLSBtb2R1bG8gLS0tLS0gLy9cblx0XG5cdHV0aWxzLm1vZHVsbyA9IGZ1bmN0aW9uKCBudW0sIGRpdiApIHtcblx0ICByZXR1cm4gKCAoIG51bSAlIGRpdiApICsgZGl2ICkgJSBkaXY7XG5cdH07XG5cdFxuXHQvLyAtLS0tLSBtYWtlQXJyYXkgLS0tLS0gLy9cblx0XG5cdC8vIHR1cm4gZWxlbWVudCBvciBub2RlTGlzdCBpbnRvIGFuIGFycmF5XG5cdHV0aWxzLm1ha2VBcnJheSA9IGZ1bmN0aW9uKCBvYmogKSB7XG5cdCAgdmFyIGFyeSA9IFtdO1xuXHQgIGlmICggQXJyYXkuaXNBcnJheSggb2JqICkgKSB7XG5cdCAgICAvLyB1c2Ugb2JqZWN0IGlmIGFscmVhZHkgYW4gYXJyYXlcblx0ICAgIGFyeSA9IG9iajtcblx0ICB9IGVsc2UgaWYgKCBvYmogJiYgdHlwZW9mIG9iai5sZW5ndGggPT0gJ251bWJlcicgKSB7XG5cdCAgICAvLyBjb252ZXJ0IG5vZGVMaXN0IHRvIGFycmF5XG5cdCAgICBmb3IgKCB2YXIgaT0wOyBpIDwgb2JqLmxlbmd0aDsgaSsrICkge1xuXHQgICAgICBhcnkucHVzaCggb2JqW2ldICk7XG5cdCAgICB9XG5cdCAgfSBlbHNlIHtcblx0ICAgIC8vIGFycmF5IG9mIHNpbmdsZSBpbmRleFxuXHQgICAgYXJ5LnB1c2goIG9iaiApO1xuXHQgIH1cblx0ICByZXR1cm4gYXJ5O1xuXHR9O1xuXHRcblx0Ly8gLS0tLS0gcmVtb3ZlRnJvbSAtLS0tLSAvL1xuXHRcblx0dXRpbHMucmVtb3ZlRnJvbSA9IGZ1bmN0aW9uKCBhcnksIG9iaiApIHtcblx0ICB2YXIgaW5kZXggPSBhcnkuaW5kZXhPZiggb2JqICk7XG5cdCAgaWYgKCBpbmRleCAhPSAtMSApIHtcblx0ICAgIGFyeS5zcGxpY2UoIGluZGV4LCAxICk7XG5cdCAgfVxuXHR9O1xuXHRcblx0Ly8gLS0tLS0gZ2V0UGFyZW50IC0tLS0tIC8vXG5cdFxuXHR1dGlscy5nZXRQYXJlbnQgPSBmdW5jdGlvbiggZWxlbSwgc2VsZWN0b3IgKSB7XG5cdCAgd2hpbGUgKCBlbGVtICE9IGRvY3VtZW50LmJvZHkgKSB7XG5cdCAgICBlbGVtID0gZWxlbS5wYXJlbnROb2RlO1xuXHQgICAgaWYgKCBtYXRjaGVzU2VsZWN0b3IoIGVsZW0sIHNlbGVjdG9yICkgKSB7XG5cdCAgICAgIHJldHVybiBlbGVtO1xuXHQgICAgfVxuXHQgIH1cblx0fTtcblx0XG5cdC8vIC0tLS0tIGdldFF1ZXJ5RWxlbWVudCAtLS0tLSAvL1xuXHRcblx0Ly8gdXNlIGVsZW1lbnQgYXMgc2VsZWN0b3Igc3RyaW5nXG5cdHV0aWxzLmdldFF1ZXJ5RWxlbWVudCA9IGZ1bmN0aW9uKCBlbGVtICkge1xuXHQgIGlmICggdHlwZW9mIGVsZW0gPT0gJ3N0cmluZycgKSB7XG5cdCAgICByZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3RvciggZWxlbSApO1xuXHQgIH1cblx0ICByZXR1cm4gZWxlbTtcblx0fTtcblx0XG5cdC8vIC0tLS0tIGhhbmRsZUV2ZW50IC0tLS0tIC8vXG5cdFxuXHQvLyBlbmFibGUgLm9udHlwZSB0byB0cmlnZ2VyIGZyb20gLmFkZEV2ZW50TGlzdGVuZXIoIGVsZW0sICd0eXBlJyApXG5cdHV0aWxzLmhhbmRsZUV2ZW50ID0gZnVuY3Rpb24oIGV2ZW50ICkge1xuXHQgIHZhciBtZXRob2QgPSAnb24nICsgZXZlbnQudHlwZTtcblx0ICBpZiAoIHRoaXNbIG1ldGhvZCBdICkge1xuXHQgICAgdGhpc1sgbWV0aG9kIF0oIGV2ZW50ICk7XG5cdCAgfVxuXHR9O1xuXHRcblx0Ly8gLS0tLS0gZmlsdGVyRmluZEVsZW1lbnRzIC0tLS0tIC8vXG5cdFxuXHR1dGlscy5maWx0ZXJGaW5kRWxlbWVudHMgPSBmdW5jdGlvbiggZWxlbXMsIHNlbGVjdG9yICkge1xuXHQgIC8vIG1ha2UgYXJyYXkgb2YgZWxlbXNcblx0ICBlbGVtcyA9IHV0aWxzLm1ha2VBcnJheSggZWxlbXMgKTtcblx0ICB2YXIgZmZFbGVtcyA9IFtdO1xuXHRcblx0ICBlbGVtcy5mb3JFYWNoKCBmdW5jdGlvbiggZWxlbSApIHtcblx0ICAgIC8vIGNoZWNrIHRoYXQgZWxlbSBpcyBhbiBhY3R1YWwgZWxlbWVudFxuXHQgICAgaWYgKCAhKCBlbGVtIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQgKSApIHtcblx0ICAgICAgcmV0dXJuO1xuXHQgICAgfVxuXHQgICAgLy8gYWRkIGVsZW0gaWYgbm8gc2VsZWN0b3Jcblx0ICAgIGlmICggIXNlbGVjdG9yICkge1xuXHQgICAgICBmZkVsZW1zLnB1c2goIGVsZW0gKTtcblx0ICAgICAgcmV0dXJuO1xuXHQgICAgfVxuXHQgICAgLy8gZmlsdGVyICYgZmluZCBpdGVtcyBpZiB3ZSBoYXZlIGEgc2VsZWN0b3Jcblx0ICAgIC8vIGZpbHRlclxuXHQgICAgaWYgKCBtYXRjaGVzU2VsZWN0b3IoIGVsZW0sIHNlbGVjdG9yICkgKSB7XG5cdCAgICAgIGZmRWxlbXMucHVzaCggZWxlbSApO1xuXHQgICAgfVxuXHQgICAgLy8gZmluZCBjaGlsZHJlblxuXHQgICAgdmFyIGNoaWxkRWxlbXMgPSBlbGVtLnF1ZXJ5U2VsZWN0b3JBbGwoIHNlbGVjdG9yICk7XG5cdCAgICAvLyBjb25jYXQgY2hpbGRFbGVtcyB0byBmaWx0ZXJGb3VuZCBhcnJheVxuXHQgICAgZm9yICggdmFyIGk9MDsgaSA8IGNoaWxkRWxlbXMubGVuZ3RoOyBpKysgKSB7XG5cdCAgICAgIGZmRWxlbXMucHVzaCggY2hpbGRFbGVtc1tpXSApO1xuXHQgICAgfVxuXHQgIH0pO1xuXHRcblx0ICByZXR1cm4gZmZFbGVtcztcblx0fTtcblx0XG5cdC8vIC0tLS0tIGRlYm91bmNlTWV0aG9kIC0tLS0tIC8vXG5cdFxuXHR1dGlscy5kZWJvdW5jZU1ldGhvZCA9IGZ1bmN0aW9uKCBfY2xhc3MsIG1ldGhvZE5hbWUsIHRocmVzaG9sZCApIHtcblx0ICAvLyBvcmlnaW5hbCBtZXRob2Rcblx0ICB2YXIgbWV0aG9kID0gX2NsYXNzLnByb3RvdHlwZVsgbWV0aG9kTmFtZSBdO1xuXHQgIHZhciB0aW1lb3V0TmFtZSA9IG1ldGhvZE5hbWUgKyAnVGltZW91dCc7XG5cdFxuXHQgIF9jbGFzcy5wcm90b3R5cGVbIG1ldGhvZE5hbWUgXSA9IGZ1bmN0aW9uKCkge1xuXHQgICAgdmFyIHRpbWVvdXQgPSB0aGlzWyB0aW1lb3V0TmFtZSBdO1xuXHQgICAgaWYgKCB0aW1lb3V0ICkge1xuXHQgICAgICBjbGVhclRpbWVvdXQoIHRpbWVvdXQgKTtcblx0ICAgIH1cblx0ICAgIHZhciBhcmdzID0gYXJndW1lbnRzO1xuXHRcblx0ICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cdCAgICB0aGlzWyB0aW1lb3V0TmFtZSBdID0gc2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG5cdCAgICAgIG1ldGhvZC5hcHBseSggX3RoaXMsIGFyZ3MgKTtcblx0ICAgICAgZGVsZXRlIF90aGlzWyB0aW1lb3V0TmFtZSBdO1xuXHQgICAgfSwgdGhyZXNob2xkIHx8IDEwMCApO1xuXHQgIH07XG5cdH07XG5cdFxuXHQvLyAtLS0tLSBkb2NSZWFkeSAtLS0tLSAvL1xuXHRcblx0dXRpbHMuZG9jUmVhZHkgPSBmdW5jdGlvbiggY2FsbGJhY2sgKSB7XG5cdCAgdmFyIHJlYWR5U3RhdGUgPSBkb2N1bWVudC5yZWFkeVN0YXRlO1xuXHQgIGlmICggcmVhZHlTdGF0ZSA9PSAnY29tcGxldGUnIHx8IHJlYWR5U3RhdGUgPT0gJ2ludGVyYWN0aXZlJyApIHtcblx0ICAgIC8vIGRvIGFzeW5jIHRvIGFsbG93IGZvciBvdGhlciBzY3JpcHRzIHRvIHJ1bi4gbWV0YWZpenp5L2ZsaWNraXR5IzQ0MVxuXHQgICAgc2V0VGltZW91dCggY2FsbGJhY2sgKTtcblx0ICB9IGVsc2Uge1xuXHQgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ0RPTUNvbnRlbnRMb2FkZWQnLCBjYWxsYmFjayApO1xuXHQgIH1cblx0fTtcblx0XG5cdC8vIC0tLS0tIGh0bWxJbml0IC0tLS0tIC8vXG5cdFxuXHQvLyBodHRwOi8vamFtZXNyb2JlcnRzLm5hbWUvYmxvZy8yMDEwLzAyLzIyL3N0cmluZy1mdW5jdGlvbnMtZm9yLWphdmFzY3JpcHQtdHJpbS10by1jYW1lbC1jYXNlLXRvLWRhc2hlZC1hbmQtdG8tdW5kZXJzY29yZS9cblx0dXRpbHMudG9EYXNoZWQgPSBmdW5jdGlvbiggc3RyICkge1xuXHQgIHJldHVybiBzdHIucmVwbGFjZSggLyguKShbQS1aXSkvZywgZnVuY3Rpb24oIG1hdGNoLCAkMSwgJDIgKSB7XG5cdCAgICByZXR1cm4gJDEgKyAnLScgKyAkMjtcblx0ICB9KS50b0xvd2VyQ2FzZSgpO1xuXHR9O1xuXHRcblx0dmFyIGNvbnNvbGUgPSB3aW5kb3cuY29uc29sZTtcblx0LyoqXG5cdCAqIGFsbG93IHVzZXIgdG8gaW5pdGlhbGl6ZSBjbGFzc2VzIHZpYSBbZGF0YS1uYW1lc3BhY2VdIG9yIC5qcy1uYW1lc3BhY2UgY2xhc3Ncblx0ICogaHRtbEluaXQoIFdpZGdldCwgJ3dpZGdldE5hbWUnIClcblx0ICogb3B0aW9ucyBhcmUgcGFyc2VkIGZyb20gZGF0YS1uYW1lc3BhY2Utb3B0aW9uc1xuXHQgKi9cblx0dXRpbHMuaHRtbEluaXQgPSBmdW5jdGlvbiggV2lkZ2V0Q2xhc3MsIG5hbWVzcGFjZSApIHtcblx0ICB1dGlscy5kb2NSZWFkeSggZnVuY3Rpb24oKSB7XG5cdCAgICB2YXIgZGFzaGVkTmFtZXNwYWNlID0gdXRpbHMudG9EYXNoZWQoIG5hbWVzcGFjZSApO1xuXHQgICAgdmFyIGRhdGFBdHRyID0gJ2RhdGEtJyArIGRhc2hlZE5hbWVzcGFjZTtcblx0ICAgIHZhciBkYXRhQXR0ckVsZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCggJ1snICsgZGF0YUF0dHIgKyAnXScgKTtcblx0ICAgIHZhciBqc0Rhc2hFbGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoICcuanMtJyArIGRhc2hlZE5hbWVzcGFjZSApO1xuXHQgICAgdmFyIGVsZW1zID0gdXRpbHMubWFrZUFycmF5KCBkYXRhQXR0ckVsZW1zIClcblx0ICAgICAgLmNvbmNhdCggdXRpbHMubWFrZUFycmF5KCBqc0Rhc2hFbGVtcyApICk7XG5cdCAgICB2YXIgZGF0YU9wdGlvbnNBdHRyID0gZGF0YUF0dHIgKyAnLW9wdGlvbnMnO1xuXHQgICAgdmFyIGpRdWVyeSA9IHdpbmRvdy5qUXVlcnk7XG5cdFxuXHQgICAgZWxlbXMuZm9yRWFjaCggZnVuY3Rpb24oIGVsZW0gKSB7XG5cdCAgICAgIHZhciBhdHRyID0gZWxlbS5nZXRBdHRyaWJ1dGUoIGRhdGFBdHRyICkgfHxcblx0ICAgICAgICBlbGVtLmdldEF0dHJpYnV0ZSggZGF0YU9wdGlvbnNBdHRyICk7XG5cdCAgICAgIHZhciBvcHRpb25zO1xuXHQgICAgICB0cnkge1xuXHQgICAgICAgIG9wdGlvbnMgPSBhdHRyICYmIEpTT04ucGFyc2UoIGF0dHIgKTtcblx0ICAgICAgfSBjYXRjaCAoIGVycm9yICkge1xuXHQgICAgICAgIC8vIGxvZyBlcnJvciwgZG8gbm90IGluaXRpYWxpemVcblx0ICAgICAgICBpZiAoIGNvbnNvbGUgKSB7XG5cdCAgICAgICAgICBjb25zb2xlLmVycm9yKCAnRXJyb3IgcGFyc2luZyAnICsgZGF0YUF0dHIgKyAnIG9uICcgKyBlbGVtLmNsYXNzTmFtZSArXG5cdCAgICAgICAgICAnOiAnICsgZXJyb3IgKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgcmV0dXJuO1xuXHQgICAgICB9XG5cdCAgICAgIC8vIGluaXRpYWxpemVcblx0ICAgICAgdmFyIGluc3RhbmNlID0gbmV3IFdpZGdldENsYXNzKCBlbGVtLCBvcHRpb25zICk7XG5cdCAgICAgIC8vIG1ha2UgYXZhaWxhYmxlIHZpYSAkKCkuZGF0YSgnbmFtZXNwYWNlJylcblx0ICAgICAgaWYgKCBqUXVlcnkgKSB7XG5cdCAgICAgICAgalF1ZXJ5LmRhdGEoIGVsZW0sIG5hbWVzcGFjZSwgaW5zdGFuY2UgKTtcblx0ICAgICAgfVxuXHQgICAgfSk7XG5cdFxuXHQgIH0pO1xuXHR9O1xuXHRcblx0Ly8gLS0tLS0gIC0tLS0tIC8vXG5cdFxuXHRyZXR1cm4gdXRpbHM7XG5cdFxuXHR9KSk7XG5cblxuLyoqKi8gfSxcbi8qIDggKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdHZhciBfX1dFQlBBQ0tfQU1EX0RFRklORV9GQUNUT1JZX18sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fOy8qKlxuXHQgKiBtYXRjaGVzU2VsZWN0b3IgdjIuMC4xXG5cdCAqIG1hdGNoZXNTZWxlY3RvciggZWxlbWVudCwgJy5zZWxlY3RvcicgKVxuXHQgKiBNSVQgbGljZW5zZVxuXHQgKi9cblx0XG5cdC8qanNoaW50IGJyb3dzZXI6IHRydWUsIHN0cmljdDogdHJ1ZSwgdW5kZWY6IHRydWUsIHVudXNlZDogdHJ1ZSAqL1xuXHRcblx0KCBmdW5jdGlvbiggd2luZG93LCBmYWN0b3J5ICkge1xuXHQgIC8qZ2xvYmFsIGRlZmluZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblx0ICAndXNlIHN0cmljdCc7XG5cdCAgLy8gdW5pdmVyc2FsIG1vZHVsZSBkZWZpbml0aW9uXG5cdCAgaWYgKCB0cnVlICkge1xuXHQgICAgLy8gQU1EXG5cdCAgICAhKF9fV0VCUEFDS19BTURfREVGSU5FX0ZBQ1RPUllfXyA9IChmYWN0b3J5KSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gPSAodHlwZW9mIF9fV0VCUEFDS19BTURfREVGSU5FX0ZBQ1RPUllfXyA9PT0gJ2Z1bmN0aW9uJyA/IChfX1dFQlBBQ0tfQU1EX0RFRklORV9GQUNUT1JZX18uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fLCBleHBvcnRzLCBtb2R1bGUpKSA6IF9fV0VCUEFDS19BTURfREVGSU5FX0ZBQ1RPUllfXyksIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fICE9PSB1bmRlZmluZWQgJiYgKG1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18pKTtcblx0ICB9IGVsc2UgaWYgKCB0eXBlb2YgbW9kdWxlID09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzICkge1xuXHQgICAgLy8gQ29tbW9uSlNcblx0ICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuXHQgIH0gZWxzZSB7XG5cdCAgICAvLyBicm93c2VyIGdsb2JhbFxuXHQgICAgd2luZG93Lm1hdGNoZXNTZWxlY3RvciA9IGZhY3RvcnkoKTtcblx0ICB9XG5cdFxuXHR9KCB3aW5kb3csIGZ1bmN0aW9uIGZhY3RvcnkoKSB7XG5cdCAgJ3VzZSBzdHJpY3QnO1xuXHRcblx0ICB2YXIgbWF0Y2hlc01ldGhvZCA9ICggZnVuY3Rpb24oKSB7XG5cdCAgICB2YXIgRWxlbVByb3RvID0gRWxlbWVudC5wcm90b3R5cGU7XG5cdCAgICAvLyBjaGVjayBmb3IgdGhlIHN0YW5kYXJkIG1ldGhvZCBuYW1lIGZpcnN0XG5cdCAgICBpZiAoIEVsZW1Qcm90by5tYXRjaGVzICkge1xuXHQgICAgICByZXR1cm4gJ21hdGNoZXMnO1xuXHQgICAgfVxuXHQgICAgLy8gY2hlY2sgdW4tcHJlZml4ZWRcblx0ICAgIGlmICggRWxlbVByb3RvLm1hdGNoZXNTZWxlY3RvciApIHtcblx0ICAgICAgcmV0dXJuICdtYXRjaGVzU2VsZWN0b3InO1xuXHQgICAgfVxuXHQgICAgLy8gY2hlY2sgdmVuZG9yIHByZWZpeGVzXG5cdCAgICB2YXIgcHJlZml4ZXMgPSBbICd3ZWJraXQnLCAnbW96JywgJ21zJywgJ28nIF07XG5cdFxuXHQgICAgZm9yICggdmFyIGk9MDsgaSA8IHByZWZpeGVzLmxlbmd0aDsgaSsrICkge1xuXHQgICAgICB2YXIgcHJlZml4ID0gcHJlZml4ZXNbaV07XG5cdCAgICAgIHZhciBtZXRob2QgPSBwcmVmaXggKyAnTWF0Y2hlc1NlbGVjdG9yJztcblx0ICAgICAgaWYgKCBFbGVtUHJvdG9bIG1ldGhvZCBdICkge1xuXHQgICAgICAgIHJldHVybiBtZXRob2Q7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICB9KSgpO1xuXHRcblx0ICByZXR1cm4gZnVuY3Rpb24gbWF0Y2hlc1NlbGVjdG9yKCBlbGVtLCBzZWxlY3RvciApIHtcblx0ICAgIHJldHVybiBlbGVtWyBtYXRjaGVzTWV0aG9kIF0oIHNlbGVjdG9yICk7XG5cdCAgfTtcblx0XG5cdH0pKTtcblxuXG4vKioqLyB9LFxuLyogOSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0dmFyIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fOy8vIEZsaWNraXR5LkNlbGxcblx0KCBmdW5jdGlvbiggd2luZG93LCBmYWN0b3J5ICkge1xuXHQgIC8vIHVuaXZlcnNhbCBtb2R1bGUgZGVmaW5pdGlvblxuXHQgIC8qIGpzaGludCBzdHJpY3Q6IGZhbHNlICovXG5cdCAgaWYgKCB0cnVlICkge1xuXHQgICAgLy8gQU1EXG5cdCAgICAhKF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18gPSBbXG5cdCAgICAgIF9fd2VicGFja19yZXF1aXJlX18oNilcblx0ICAgIF0sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fID0gZnVuY3Rpb24oIGdldFNpemUgKSB7XG5cdCAgICAgIHJldHVybiBmYWN0b3J5KCB3aW5kb3csIGdldFNpemUgKTtcblx0ICAgIH0uYXBwbHkoZXhwb3J0cywgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXyksIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fICE9PSB1bmRlZmluZWQgJiYgKG1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18pKTtcblx0ICB9IGVsc2UgaWYgKCB0eXBlb2YgbW9kdWxlID09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzICkge1xuXHQgICAgLy8gQ29tbW9uSlNcblx0ICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShcblx0ICAgICAgd2luZG93LFxuXHQgICAgICByZXF1aXJlKCdnZXQtc2l6ZScpXG5cdCAgICApO1xuXHQgIH0gZWxzZSB7XG5cdCAgICAvLyBicm93c2VyIGdsb2JhbFxuXHQgICAgd2luZG93LkZsaWNraXR5ID0gd2luZG93LkZsaWNraXR5IHx8IHt9O1xuXHQgICAgd2luZG93LkZsaWNraXR5LkNlbGwgPSBmYWN0b3J5KFxuXHQgICAgICB3aW5kb3csXG5cdCAgICAgIHdpbmRvdy5nZXRTaXplXG5cdCAgICApO1xuXHQgIH1cblx0XG5cdH0oIHdpbmRvdywgZnVuY3Rpb24gZmFjdG9yeSggd2luZG93LCBnZXRTaXplICkge1xuXHRcblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0ZnVuY3Rpb24gQ2VsbCggZWxlbSwgcGFyZW50ICkge1xuXHQgIHRoaXMuZWxlbWVudCA9IGVsZW07XG5cdCAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG5cdFxuXHQgIHRoaXMuY3JlYXRlKCk7XG5cdH1cblx0XG5cdHZhciBwcm90byA9IENlbGwucHJvdG90eXBlO1xuXHRcblx0cHJvdG8uY3JlYXRlID0gZnVuY3Rpb24oKSB7XG5cdCAgdGhpcy5lbGVtZW50LnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcblx0ICB0aGlzLnggPSAwO1xuXHQgIHRoaXMuc2hpZnQgPSAwO1xuXHR9O1xuXHRcblx0cHJvdG8uZGVzdHJveSA9IGZ1bmN0aW9uKCkge1xuXHQgIC8vIHJlc2V0IHN0eWxlXG5cdCAgdGhpcy5lbGVtZW50LnN0eWxlLnBvc2l0aW9uID0gJyc7XG5cdCAgdmFyIHNpZGUgPSB0aGlzLnBhcmVudC5vcmlnaW5TaWRlO1xuXHQgIHRoaXMuZWxlbWVudC5zdHlsZVsgc2lkZSBdID0gJyc7XG5cdH07XG5cdFxuXHRwcm90by5nZXRTaXplID0gZnVuY3Rpb24oKSB7XG5cdCAgdGhpcy5zaXplID0gZ2V0U2l6ZSggdGhpcy5lbGVtZW50ICk7XG5cdH07XG5cdFxuXHRwcm90by5zZXRQb3NpdGlvbiA9IGZ1bmN0aW9uKCB4ICkge1xuXHQgIHRoaXMueCA9IHg7XG5cdCAgdGhpcy51cGRhdGVUYXJnZXQoKTtcblx0ICB0aGlzLnJlbmRlclBvc2l0aW9uKCB4ICk7XG5cdH07XG5cdFxuXHQvLyBzZXREZWZhdWx0VGFyZ2V0IHYxIG1ldGhvZCwgYmFja3dhcmRzIGNvbXBhdGliaWxpdHksIHJlbW92ZSBpbiB2M1xuXHRwcm90by51cGRhdGVUYXJnZXQgPSBwcm90by5zZXREZWZhdWx0VGFyZ2V0ID0gZnVuY3Rpb24oKSB7XG5cdCAgdmFyIG1hcmdpblByb3BlcnR5ID0gdGhpcy5wYXJlbnQub3JpZ2luU2lkZSA9PSAnbGVmdCcgPyAnbWFyZ2luTGVmdCcgOiAnbWFyZ2luUmlnaHQnO1xuXHQgIHRoaXMudGFyZ2V0ID0gdGhpcy54ICsgdGhpcy5zaXplWyBtYXJnaW5Qcm9wZXJ0eSBdICtcblx0ICAgIHRoaXMuc2l6ZS53aWR0aCAqIHRoaXMucGFyZW50LmNlbGxBbGlnbjtcblx0fTtcblx0XG5cdHByb3RvLnJlbmRlclBvc2l0aW9uID0gZnVuY3Rpb24oIHggKSB7XG5cdCAgLy8gcmVuZGVyIHBvc2l0aW9uIG9mIGNlbGwgd2l0aCBpbiBzbGlkZXJcblx0ICB2YXIgc2lkZSA9IHRoaXMucGFyZW50Lm9yaWdpblNpZGU7XG5cdCAgdGhpcy5lbGVtZW50LnN0eWxlWyBzaWRlIF0gPSB0aGlzLnBhcmVudC5nZXRQb3NpdGlvblZhbHVlKCB4ICk7XG5cdH07XG5cdFxuXHQvKipcblx0ICogQHBhcmFtIHtJbnRlZ2VyfSBmYWN0b3IgLSAwLCAxLCBvciAtMVxuXHQqKi9cblx0cHJvdG8ud3JhcFNoaWZ0ID0gZnVuY3Rpb24oIHNoaWZ0ICkge1xuXHQgIHRoaXMuc2hpZnQgPSBzaGlmdDtcblx0ICB0aGlzLnJlbmRlclBvc2l0aW9uKCB0aGlzLnggKyB0aGlzLnBhcmVudC5zbGlkZWFibGVXaWR0aCAqIHNoaWZ0ICk7XG5cdH07XG5cdFxuXHRwcm90by5yZW1vdmUgPSBmdW5jdGlvbigpIHtcblx0ICB0aGlzLmVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCggdGhpcy5lbGVtZW50ICk7XG5cdH07XG5cdFxuXHRyZXR1cm4gQ2VsbDtcblx0XG5cdH0pKTtcblxuXG4vKioqLyB9LFxuLyogMTAgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdHZhciBfX1dFQlBBQ0tfQU1EX0RFRklORV9GQUNUT1JZX18sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fOy8vIHNsaWRlXG5cdCggZnVuY3Rpb24oIHdpbmRvdywgZmFjdG9yeSApIHtcblx0ICAvLyB1bml2ZXJzYWwgbW9kdWxlIGRlZmluaXRpb25cblx0ICAvKiBqc2hpbnQgc3RyaWN0OiBmYWxzZSAqL1xuXHQgIGlmICggdHJ1ZSApIHtcblx0ICAgIC8vIEFNRFxuXHQgICAgIShfX1dFQlBBQ0tfQU1EX0RFRklORV9GQUNUT1JZX18gPSAoZmFjdG9yeSksIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fID0gKHR5cGVvZiBfX1dFQlBBQ0tfQU1EX0RFRklORV9GQUNUT1JZX18gPT09ICdmdW5jdGlvbicgPyAoX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fLmNhbGwoZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXywgZXhwb3J0cywgbW9kdWxlKSkgOiBfX1dFQlBBQ0tfQU1EX0RFRklORV9GQUNUT1JZX18pLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyAhPT0gdW5kZWZpbmVkICYmIChtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fKSk7XG5cdCAgfSBlbHNlIGlmICggdHlwZW9mIG1vZHVsZSA9PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cyApIHtcblx0ICAgIC8vIENvbW1vbkpTXG5cdCAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ICB9IGVsc2Uge1xuXHQgICAgLy8gYnJvd3NlciBnbG9iYWxcblx0ICAgIHdpbmRvdy5GbGlja2l0eSA9IHdpbmRvdy5GbGlja2l0eSB8fCB7fTtcblx0ICAgIHdpbmRvdy5GbGlja2l0eS5TbGlkZSA9IGZhY3RvcnkoKTtcblx0ICB9XG5cdFxuXHR9KCB3aW5kb3csIGZ1bmN0aW9uIGZhY3RvcnkoKSB7XG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdGZ1bmN0aW9uIFNsaWRlKCBwYXJlbnQgKSB7XG5cdCAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG5cdCAgdGhpcy5pc09yaWdpbkxlZnQgPSBwYXJlbnQub3JpZ2luU2lkZSA9PSAnbGVmdCc7XG5cdCAgdGhpcy5jZWxscyA9IFtdO1xuXHQgIHRoaXMub3V0ZXJXaWR0aCA9IDA7XG5cdCAgdGhpcy5oZWlnaHQgPSAwO1xuXHR9XG5cdFxuXHR2YXIgcHJvdG8gPSBTbGlkZS5wcm90b3R5cGU7XG5cdFxuXHRwcm90by5hZGRDZWxsID0gZnVuY3Rpb24oIGNlbGwgKSB7XG5cdCAgdGhpcy5jZWxscy5wdXNoKCBjZWxsICk7XG5cdCAgdGhpcy5vdXRlcldpZHRoICs9IGNlbGwuc2l6ZS5vdXRlcldpZHRoO1xuXHQgIHRoaXMuaGVpZ2h0ID0gTWF0aC5tYXgoIGNlbGwuc2l6ZS5vdXRlckhlaWdodCwgdGhpcy5oZWlnaHQgKTtcblx0ICAvLyBmaXJzdCBjZWxsIHN0dWZmXG5cdCAgaWYgKCB0aGlzLmNlbGxzLmxlbmd0aCA9PSAxICkge1xuXHQgICAgdGhpcy54ID0gY2VsbC54OyAvLyB4IGNvbWVzIGZyb20gZmlyc3QgY2VsbFxuXHQgICAgdmFyIGJlZ2luTWFyZ2luID0gdGhpcy5pc09yaWdpbkxlZnQgPyAnbWFyZ2luTGVmdCcgOiAnbWFyZ2luUmlnaHQnO1xuXHQgICAgdGhpcy5maXJzdE1hcmdpbiA9IGNlbGwuc2l6ZVsgYmVnaW5NYXJnaW4gXTtcblx0ICB9XG5cdH07XG5cdFxuXHRwcm90by51cGRhdGVUYXJnZXQgPSBmdW5jdGlvbigpIHtcblx0ICB2YXIgZW5kTWFyZ2luID0gdGhpcy5pc09yaWdpbkxlZnQgPyAnbWFyZ2luUmlnaHQnIDogJ21hcmdpbkxlZnQnO1xuXHQgIHZhciBsYXN0Q2VsbCA9IHRoaXMuZ2V0TGFzdENlbGwoKTtcblx0ICB2YXIgbGFzdE1hcmdpbiA9IGxhc3RDZWxsID8gbGFzdENlbGwuc2l6ZVsgZW5kTWFyZ2luIF0gOiAwO1xuXHQgIHZhciBzbGlkZVdpZHRoID0gdGhpcy5vdXRlcldpZHRoIC0gKCB0aGlzLmZpcnN0TWFyZ2luICsgbGFzdE1hcmdpbiApO1xuXHQgIHRoaXMudGFyZ2V0ID0gdGhpcy54ICsgdGhpcy5maXJzdE1hcmdpbiArIHNsaWRlV2lkdGggKiB0aGlzLnBhcmVudC5jZWxsQWxpZ247XG5cdH07XG5cdFxuXHRwcm90by5nZXRMYXN0Q2VsbCA9IGZ1bmN0aW9uKCkge1xuXHQgIHJldHVybiB0aGlzLmNlbGxzWyB0aGlzLmNlbGxzLmxlbmd0aCAtIDEgXTtcblx0fTtcblx0XG5cdHByb3RvLnNlbGVjdCA9IGZ1bmN0aW9uKCkge1xuXHQgIHRoaXMuY2hhbmdlU2VsZWN0ZWRDbGFzcygnYWRkJyk7XG5cdH07XG5cdFxuXHRwcm90by51bnNlbGVjdCA9IGZ1bmN0aW9uKCkge1xuXHQgIHRoaXMuY2hhbmdlU2VsZWN0ZWRDbGFzcygncmVtb3ZlJyk7XG5cdH07XG5cdFxuXHRwcm90by5jaGFuZ2VTZWxlY3RlZENsYXNzID0gZnVuY3Rpb24oIG1ldGhvZCApIHtcblx0ICB0aGlzLmNlbGxzLmZvckVhY2goIGZ1bmN0aW9uKCBjZWxsICkge1xuXHQgICAgY2VsbC5lbGVtZW50LmNsYXNzTGlzdFsgbWV0aG9kIF0oJ2lzLXNlbGVjdGVkJyk7XG5cdCAgfSk7XG5cdH07XG5cdFxuXHRwcm90by5nZXRDZWxsRWxlbWVudHMgPSBmdW5jdGlvbigpIHtcblx0ICByZXR1cm4gdGhpcy5jZWxscy5tYXAoIGZ1bmN0aW9uKCBjZWxsICkge1xuXHQgICAgcmV0dXJuIGNlbGwuZWxlbWVudDtcblx0ICB9KTtcblx0fTtcblx0XG5cdHJldHVybiBTbGlkZTtcblx0XG5cdH0pKTtcblxuXG4vKioqLyB9LFxuLyogMTEgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdHZhciBfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXzsvLyBhbmltYXRlXG5cdCggZnVuY3Rpb24oIHdpbmRvdywgZmFjdG9yeSApIHtcblx0ICAvLyB1bml2ZXJzYWwgbW9kdWxlIGRlZmluaXRpb25cblx0ICAvKiBqc2hpbnQgc3RyaWN0OiBmYWxzZSAqL1xuXHQgIGlmICggdHJ1ZSApIHtcblx0ICAgIC8vIEFNRFxuXHQgICAgIShfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fID0gW1xuXHQgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpXG5cdCAgICBdLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyA9IGZ1bmN0aW9uKCB1dGlscyApIHtcblx0ICAgICAgcmV0dXJuIGZhY3RvcnkoIHdpbmRvdywgdXRpbHMgKTtcblx0ICAgIH0uYXBwbHkoZXhwb3J0cywgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXyksIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fICE9PSB1bmRlZmluZWQgJiYgKG1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18pKTtcblx0ICB9IGVsc2UgaWYgKCB0eXBlb2YgbW9kdWxlID09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzICkge1xuXHQgICAgLy8gQ29tbW9uSlNcblx0ICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShcblx0ICAgICAgd2luZG93LFxuXHQgICAgICByZXF1aXJlKCdmaXp6eS11aS11dGlscycpXG5cdCAgICApO1xuXHQgIH0gZWxzZSB7XG5cdCAgICAvLyBicm93c2VyIGdsb2JhbFxuXHQgICAgd2luZG93LkZsaWNraXR5ID0gd2luZG93LkZsaWNraXR5IHx8IHt9O1xuXHQgICAgd2luZG93LkZsaWNraXR5LmFuaW1hdGVQcm90b3R5cGUgPSBmYWN0b3J5KFxuXHQgICAgICB3aW5kb3csXG5cdCAgICAgIHdpbmRvdy5maXp6eVVJVXRpbHNcblx0ICAgICk7XG5cdCAgfVxuXHRcblx0fSggd2luZG93LCBmdW5jdGlvbiBmYWN0b3J5KCB3aW5kb3csIHV0aWxzICkge1xuXHRcblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vXG5cdFxuXHQvLyBnZXQgckFGLCBwcmVmaXhlZCwgaWYgcHJlc2VudFxuXHR2YXIgcmVxdWVzdEFuaW1hdGlvbkZyYW1lID0gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSB8fFxuXHQgIHdpbmRvdy53ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWU7XG5cdFxuXHQvLyBmYWxsYmFjayB0byBzZXRUaW1lb3V0XG5cdHZhciBsYXN0VGltZSA9IDA7XG5cdGlmICggIXJlcXVlc3RBbmltYXRpb25GcmFtZSApICB7XG5cdCAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lID0gZnVuY3Rpb24oIGNhbGxiYWNrICkge1xuXHQgICAgdmFyIGN1cnJUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG5cdCAgICB2YXIgdGltZVRvQ2FsbCA9IE1hdGgubWF4KCAwLCAxNiAtICggY3VyclRpbWUgLSBsYXN0VGltZSApICk7XG5cdCAgICB2YXIgaWQgPSBzZXRUaW1lb3V0KCBjYWxsYmFjaywgdGltZVRvQ2FsbCApO1xuXHQgICAgbGFzdFRpbWUgPSBjdXJyVGltZSArIHRpbWVUb0NhbGw7XG5cdCAgICByZXR1cm4gaWQ7XG5cdCAgfTtcblx0fVxuXHRcblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gYW5pbWF0ZSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvL1xuXHRcblx0dmFyIHByb3RvID0ge307XG5cdFxuXHRwcm90by5zdGFydEFuaW1hdGlvbiA9IGZ1bmN0aW9uKCkge1xuXHQgIGlmICggdGhpcy5pc0FuaW1hdGluZyApIHtcblx0ICAgIHJldHVybjtcblx0ICB9XG5cdFxuXHQgIHRoaXMuaXNBbmltYXRpbmcgPSB0cnVlO1xuXHQgIHRoaXMucmVzdGluZ0ZyYW1lcyA9IDA7XG5cdCAgdGhpcy5hbmltYXRlKCk7XG5cdH07XG5cdFxuXHRwcm90by5hbmltYXRlID0gZnVuY3Rpb24oKSB7XG5cdCAgdGhpcy5hcHBseURyYWdGb3JjZSgpO1xuXHQgIHRoaXMuYXBwbHlTZWxlY3RlZEF0dHJhY3Rpb24oKTtcblx0XG5cdCAgdmFyIHByZXZpb3VzWCA9IHRoaXMueDtcblx0XG5cdCAgdGhpcy5pbnRlZ3JhdGVQaHlzaWNzKCk7XG5cdCAgdGhpcy5wb3NpdGlvblNsaWRlcigpO1xuXHQgIHRoaXMuc2V0dGxlKCBwcmV2aW91c1ggKTtcblx0ICAvLyBhbmltYXRlIG5leHQgZnJhbWVcblx0ICBpZiAoIHRoaXMuaXNBbmltYXRpbmcgKSB7XG5cdCAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXHQgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCBmdW5jdGlvbiBhbmltYXRlRnJhbWUoKSB7XG5cdCAgICAgIF90aGlzLmFuaW1hdGUoKTtcblx0ICAgIH0pO1xuXHQgIH1cblx0fTtcblx0XG5cdFxuXHR2YXIgdHJhbnNmb3JtUHJvcGVydHkgPSAoIGZ1bmN0aW9uICgpIHtcblx0ICB2YXIgc3R5bGUgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGU7XG5cdCAgaWYgKCB0eXBlb2Ygc3R5bGUudHJhbnNmb3JtID09ICdzdHJpbmcnICkge1xuXHQgICAgcmV0dXJuICd0cmFuc2Zvcm0nO1xuXHQgIH1cblx0ICByZXR1cm4gJ1dlYmtpdFRyYW5zZm9ybSc7XG5cdH0pKCk7XG5cdFxuXHRwcm90by5wb3NpdGlvblNsaWRlciA9IGZ1bmN0aW9uKCkge1xuXHQgIHZhciB4ID0gdGhpcy54O1xuXHQgIC8vIHdyYXAgcG9zaXRpb24gYXJvdW5kXG5cdCAgaWYgKCB0aGlzLm9wdGlvbnMud3JhcEFyb3VuZCAmJiB0aGlzLmNlbGxzLmxlbmd0aCA+IDEgKSB7XG5cdCAgICB4ID0gdXRpbHMubW9kdWxvKCB4LCB0aGlzLnNsaWRlYWJsZVdpZHRoICk7XG5cdCAgICB4ID0geCAtIHRoaXMuc2xpZGVhYmxlV2lkdGg7XG5cdCAgICB0aGlzLnNoaWZ0V3JhcENlbGxzKCB4ICk7XG5cdCAgfVxuXHRcblx0ICB4ID0geCArIHRoaXMuY3Vyc29yUG9zaXRpb247XG5cdCAgLy8gcmV2ZXJzZSBpZiByaWdodC10by1sZWZ0IGFuZCB1c2luZyB0cmFuc2Zvcm1cblx0ICB4ID0gdGhpcy5vcHRpb25zLnJpZ2h0VG9MZWZ0ICYmIHRyYW5zZm9ybVByb3BlcnR5ID8gLXggOiB4O1xuXHQgIHZhciB2YWx1ZSA9IHRoaXMuZ2V0UG9zaXRpb25WYWx1ZSggeCApO1xuXHQgIC8vIHVzZSAzRCB0cmFuZm9ybXMgZm9yIGhhcmR3YXJlIGFjY2VsZXJhdGlvbiBvbiBpT1Ncblx0ICAvLyBidXQgdXNlIDJEIHdoZW4gc2V0dGxlZCwgZm9yIGJldHRlciBmb250LXJlbmRlcmluZ1xuXHQgIHRoaXMuc2xpZGVyLnN0eWxlWyB0cmFuc2Zvcm1Qcm9wZXJ0eSBdID0gdGhpcy5pc0FuaW1hdGluZyA/XG5cdCAgICAndHJhbnNsYXRlM2QoJyArIHZhbHVlICsgJywwLDApJyA6ICd0cmFuc2xhdGVYKCcgKyB2YWx1ZSArICcpJztcblx0XG5cdCAgLy8gc2Nyb2xsIGV2ZW50XG5cdCAgdmFyIGZpcnN0U2xpZGUgPSB0aGlzLnNsaWRlc1swXTtcblx0ICBpZiAoIGZpcnN0U2xpZGUgKSB7XG5cdCAgICB2YXIgcG9zaXRpb25YID0gLXRoaXMueCAtIGZpcnN0U2xpZGUudGFyZ2V0O1xuXHQgICAgdmFyIHByb2dyZXNzID0gcG9zaXRpb25YIC8gdGhpcy5zbGlkZXNXaWR0aDtcblx0ICAgIHRoaXMuZGlzcGF0Y2hFdmVudCggJ3Njcm9sbCcsIG51bGwsIFsgcHJvZ3Jlc3MsIHBvc2l0aW9uWCBdICk7XG5cdCAgfVxuXHR9O1xuXHRcblx0cHJvdG8ucG9zaXRpb25TbGlkZXJBdFNlbGVjdGVkID0gZnVuY3Rpb24oKSB7XG5cdCAgaWYgKCAhdGhpcy5jZWxscy5sZW5ndGggKSB7XG5cdCAgICByZXR1cm47XG5cdCAgfVxuXHQgIHRoaXMueCA9IC10aGlzLnNlbGVjdGVkU2xpZGUudGFyZ2V0O1xuXHQgIHRoaXMucG9zaXRpb25TbGlkZXIoKTtcblx0fTtcblx0XG5cdHByb3RvLmdldFBvc2l0aW9uVmFsdWUgPSBmdW5jdGlvbiggcG9zaXRpb24gKSB7XG5cdCAgaWYgKCB0aGlzLm9wdGlvbnMucGVyY2VudFBvc2l0aW9uICkge1xuXHQgICAgLy8gcGVyY2VudCBwb3NpdGlvbiwgcm91bmQgdG8gMiBkaWdpdHMsIGxpa2UgMTIuMzQlXG5cdCAgICByZXR1cm4gKCBNYXRoLnJvdW5kKCAoIHBvc2l0aW9uIC8gdGhpcy5zaXplLmlubmVyV2lkdGggKSAqIDEwMDAwICkgKiAwLjAxICkrICclJztcblx0ICB9IGVsc2Uge1xuXHQgICAgLy8gcGl4ZWwgcG9zaXRpb25pbmdcblx0ICAgIHJldHVybiBNYXRoLnJvdW5kKCBwb3NpdGlvbiApICsgJ3B4Jztcblx0ICB9XG5cdH07XG5cdFxuXHRwcm90by5zZXR0bGUgPSBmdW5jdGlvbiggcHJldmlvdXNYICkge1xuXHQgIC8vIGtlZXAgdHJhY2sgb2YgZnJhbWVzIHdoZXJlIHggaGFzbid0IG1vdmVkXG5cdCAgaWYgKCAhdGhpcy5pc1BvaW50ZXJEb3duICYmIE1hdGgucm91bmQoIHRoaXMueCAqIDEwMCApID09IE1hdGgucm91bmQoIHByZXZpb3VzWCAqIDEwMCApICkge1xuXHQgICAgdGhpcy5yZXN0aW5nRnJhbWVzKys7XG5cdCAgfVxuXHQgIC8vIHN0b3AgYW5pbWF0aW5nIGlmIHJlc3RpbmcgZm9yIDMgb3IgbW9yZSBmcmFtZXNcblx0ICBpZiAoIHRoaXMucmVzdGluZ0ZyYW1lcyA+IDIgKSB7XG5cdCAgICB0aGlzLmlzQW5pbWF0aW5nID0gZmFsc2U7XG5cdCAgICBkZWxldGUgdGhpcy5pc0ZyZWVTY3JvbGxpbmc7XG5cdCAgICAvLyByZW5kZXIgcG9zaXRpb24gd2l0aCB0cmFuc2xhdGVYIHdoZW4gc2V0dGxlZFxuXHQgICAgdGhpcy5wb3NpdGlvblNsaWRlcigpO1xuXHQgICAgdGhpcy5kaXNwYXRjaEV2ZW50KCdzZXR0bGUnKTtcblx0ICB9XG5cdH07XG5cdFxuXHRwcm90by5zaGlmdFdyYXBDZWxscyA9IGZ1bmN0aW9uKCB4ICkge1xuXHQgIC8vIHNoaWZ0IGJlZm9yZSBjZWxsc1xuXHQgIHZhciBiZWZvcmVHYXAgPSB0aGlzLmN1cnNvclBvc2l0aW9uICsgeDtcblx0ICB0aGlzLl9zaGlmdENlbGxzKCB0aGlzLmJlZm9yZVNoaWZ0Q2VsbHMsIGJlZm9yZUdhcCwgLTEgKTtcblx0ICAvLyBzaGlmdCBhZnRlciBjZWxsc1xuXHQgIHZhciBhZnRlckdhcCA9IHRoaXMuc2l6ZS5pbm5lcldpZHRoIC0gKCB4ICsgdGhpcy5zbGlkZWFibGVXaWR0aCArIHRoaXMuY3Vyc29yUG9zaXRpb24gKTtcblx0ICB0aGlzLl9zaGlmdENlbGxzKCB0aGlzLmFmdGVyU2hpZnRDZWxscywgYWZ0ZXJHYXAsIDEgKTtcblx0fTtcblx0XG5cdHByb3RvLl9zaGlmdENlbGxzID0gZnVuY3Rpb24oIGNlbGxzLCBnYXAsIHNoaWZ0ICkge1xuXHQgIGZvciAoIHZhciBpPTA7IGkgPCBjZWxscy5sZW5ndGg7IGkrKyApIHtcblx0ICAgIHZhciBjZWxsID0gY2VsbHNbaV07XG5cdCAgICB2YXIgY2VsbFNoaWZ0ID0gZ2FwID4gMCA/IHNoaWZ0IDogMDtcblx0ICAgIGNlbGwud3JhcFNoaWZ0KCBjZWxsU2hpZnQgKTtcblx0ICAgIGdhcCAtPSBjZWxsLnNpemUub3V0ZXJXaWR0aDtcblx0ICB9XG5cdH07XG5cdFxuXHRwcm90by5fdW5zaGlmdENlbGxzID0gZnVuY3Rpb24oIGNlbGxzICkge1xuXHQgIGlmICggIWNlbGxzIHx8ICFjZWxscy5sZW5ndGggKSB7XG5cdCAgICByZXR1cm47XG5cdCAgfVxuXHQgIGZvciAoIHZhciBpPTA7IGkgPCBjZWxscy5sZW5ndGg7IGkrKyApIHtcblx0ICAgIGNlbGxzW2ldLndyYXBTaGlmdCggMCApO1xuXHQgIH1cblx0fTtcblx0XG5cdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIHBoeXNpY3MgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cblx0XG5cdHByb3RvLmludGVncmF0ZVBoeXNpY3MgPSBmdW5jdGlvbigpIHtcblx0ICB0aGlzLnggKz0gdGhpcy52ZWxvY2l0eTtcblx0ICB0aGlzLnZlbG9jaXR5ICo9IHRoaXMuZ2V0RnJpY3Rpb25GYWN0b3IoKTtcblx0fTtcblx0XG5cdHByb3RvLmFwcGx5Rm9yY2UgPSBmdW5jdGlvbiggZm9yY2UgKSB7XG5cdCAgdGhpcy52ZWxvY2l0eSArPSBmb3JjZTtcblx0fTtcblx0XG5cdHByb3RvLmdldEZyaWN0aW9uRmFjdG9yID0gZnVuY3Rpb24oKSB7XG5cdCAgcmV0dXJuIDEgLSB0aGlzLm9wdGlvbnNbIHRoaXMuaXNGcmVlU2Nyb2xsaW5nID8gJ2ZyZWVTY3JvbGxGcmljdGlvbicgOiAnZnJpY3Rpb24nIF07XG5cdH07XG5cdFxuXHRwcm90by5nZXRSZXN0aW5nUG9zaXRpb24gPSBmdW5jdGlvbigpIHtcblx0ICAvLyBteSB0aGFua3MgdG8gU3RldmVuIFdpdHRlbnMsIHdobyBzaW1wbGlmaWVkIHRoaXMgbWF0aCBncmVhdGx5XG5cdCAgcmV0dXJuIHRoaXMueCArIHRoaXMudmVsb2NpdHkgLyAoIDEgLSB0aGlzLmdldEZyaWN0aW9uRmFjdG9yKCkgKTtcblx0fTtcblx0XG5cdHByb3RvLmFwcGx5RHJhZ0ZvcmNlID0gZnVuY3Rpb24oKSB7XG5cdCAgaWYgKCAhdGhpcy5pc1BvaW50ZXJEb3duICkge1xuXHQgICAgcmV0dXJuO1xuXHQgIH1cblx0ICAvLyBjaGFuZ2UgdGhlIHBvc2l0aW9uIHRvIGRyYWcgcG9zaXRpb24gYnkgYXBwbHlpbmcgZm9yY2Vcblx0ICB2YXIgZHJhZ1ZlbG9jaXR5ID0gdGhpcy5kcmFnWCAtIHRoaXMueDtcblx0ICB2YXIgZHJhZ0ZvcmNlID0gZHJhZ1ZlbG9jaXR5IC0gdGhpcy52ZWxvY2l0eTtcblx0ICB0aGlzLmFwcGx5Rm9yY2UoIGRyYWdGb3JjZSApO1xuXHR9O1xuXHRcblx0cHJvdG8uYXBwbHlTZWxlY3RlZEF0dHJhY3Rpb24gPSBmdW5jdGlvbigpIHtcblx0ICAvLyBkbyBub3QgYXR0cmFjdCBpZiBwb2ludGVyIGRvd24gb3Igbm8gY2VsbHNcblx0ICBpZiAoIHRoaXMuaXNQb2ludGVyRG93biB8fCB0aGlzLmlzRnJlZVNjcm9sbGluZyB8fCAhdGhpcy5jZWxscy5sZW5ndGggKSB7XG5cdCAgICByZXR1cm47XG5cdCAgfVxuXHQgIHZhciBkaXN0YW5jZSA9IHRoaXMuc2VsZWN0ZWRTbGlkZS50YXJnZXQgKiAtMSAtIHRoaXMueDtcblx0ICB2YXIgZm9yY2UgPSBkaXN0YW5jZSAqIHRoaXMub3B0aW9ucy5zZWxlY3RlZEF0dHJhY3Rpb247XG5cdCAgdGhpcy5hcHBseUZvcmNlKCBmb3JjZSApO1xuXHR9O1xuXHRcblx0cmV0dXJuIHByb3RvO1xuXHRcblx0fSkpO1xuXG5cbi8qKiovIH0sXG4vKiAxMiAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0dmFyIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fOy8vIGRyYWdcblx0KCBmdW5jdGlvbiggd2luZG93LCBmYWN0b3J5ICkge1xuXHQgIC8vIHVuaXZlcnNhbCBtb2R1bGUgZGVmaW5pdGlvblxuXHQgIC8qIGpzaGludCBzdHJpY3Q6IGZhbHNlICovXG5cdCAgaWYgKCB0cnVlICkge1xuXHQgICAgLy8gQU1EXG5cdCAgICAhKF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18gPSBbXG5cdCAgICAgIF9fd2VicGFja19yZXF1aXJlX18oNCksXG5cdCAgICAgIF9fd2VicGFja19yZXF1aXJlX18oMTMpLFxuXHQgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpXG5cdCAgICBdLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyA9IGZ1bmN0aW9uKCBGbGlja2l0eSwgVW5pZHJhZ2dlciwgdXRpbHMgKSB7XG5cdCAgICAgIHJldHVybiBmYWN0b3J5KCB3aW5kb3csIEZsaWNraXR5LCBVbmlkcmFnZ2VyLCB1dGlscyApO1xuXHQgICAgfS5hcHBseShleHBvcnRzLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fKSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gIT09IHVuZGVmaW5lZCAmJiAobW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXykpO1xuXHQgIH0gZWxzZSBpZiAoIHR5cGVvZiBtb2R1bGUgPT0gJ29iamVjdCcgJiYgbW9kdWxlLmV4cG9ydHMgKSB7XG5cdCAgICAvLyBDb21tb25KU1xuXHQgICAgbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KFxuXHQgICAgICB3aW5kb3csXG5cdCAgICAgIHJlcXVpcmUoJy4vZmxpY2tpdHknKSxcblx0ICAgICAgcmVxdWlyZSgndW5pZHJhZ2dlcicpLFxuXHQgICAgICByZXF1aXJlKCdmaXp6eS11aS11dGlscycpXG5cdCAgICApO1xuXHQgIH0gZWxzZSB7XG5cdCAgICAvLyBicm93c2VyIGdsb2JhbFxuXHQgICAgd2luZG93LkZsaWNraXR5ID0gZmFjdG9yeShcblx0ICAgICAgd2luZG93LFxuXHQgICAgICB3aW5kb3cuRmxpY2tpdHksXG5cdCAgICAgIHdpbmRvdy5VbmlkcmFnZ2VyLFxuXHQgICAgICB3aW5kb3cuZml6enlVSVV0aWxzXG5cdCAgICApO1xuXHQgIH1cblx0XG5cdH0oIHdpbmRvdywgZnVuY3Rpb24gZmFjdG9yeSggd2luZG93LCBGbGlja2l0eSwgVW5pZHJhZ2dlciwgdXRpbHMgKSB7XG5cdFxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHQvLyAtLS0tLSBkZWZhdWx0cyAtLS0tLSAvL1xuXHRcblx0dXRpbHMuZXh0ZW5kKCBGbGlja2l0eS5kZWZhdWx0cywge1xuXHQgIGRyYWdnYWJsZTogdHJ1ZSxcblx0ICBkcmFnVGhyZXNob2xkOiAzLFxuXHR9KTtcblx0XG5cdC8vIC0tLS0tIGNyZWF0ZSAtLS0tLSAvL1xuXHRcblx0RmxpY2tpdHkuY3JlYXRlTWV0aG9kcy5wdXNoKCdfY3JlYXRlRHJhZycpO1xuXHRcblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gZHJhZyBwcm90b3R5cGUgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cblx0XG5cdHZhciBwcm90byA9IEZsaWNraXR5LnByb3RvdHlwZTtcblx0dXRpbHMuZXh0ZW5kKCBwcm90bywgVW5pZHJhZ2dlci5wcm90b3R5cGUgKTtcblx0XG5cdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvL1xuXHRcblx0cHJvdG8uX2NyZWF0ZURyYWcgPSBmdW5jdGlvbigpIHtcblx0ICB0aGlzLm9uKCAnYWN0aXZhdGUnLCB0aGlzLmJpbmREcmFnICk7XG5cdCAgdGhpcy5vbiggJ3VpQ2hhbmdlJywgdGhpcy5fdWlDaGFuZ2VEcmFnICk7XG5cdCAgdGhpcy5vbiggJ2NoaWxkVUlQb2ludGVyRG93bicsIHRoaXMuX2NoaWxkVUlQb2ludGVyRG93bkRyYWcgKTtcblx0ICB0aGlzLm9uKCAnZGVhY3RpdmF0ZScsIHRoaXMudW5iaW5kRHJhZyApO1xuXHR9O1xuXHRcblx0cHJvdG8uYmluZERyYWcgPSBmdW5jdGlvbigpIHtcblx0ICBpZiAoICF0aGlzLm9wdGlvbnMuZHJhZ2dhYmxlIHx8IHRoaXMuaXNEcmFnQm91bmQgKSB7XG5cdCAgICByZXR1cm47XG5cdCAgfVxuXHQgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdpcy1kcmFnZ2FibGUnKTtcblx0ICB0aGlzLmhhbmRsZXMgPSBbIHRoaXMudmlld3BvcnQgXTtcblx0ICB0aGlzLmJpbmRIYW5kbGVzKCk7XG5cdCAgdGhpcy5pc0RyYWdCb3VuZCA9IHRydWU7XG5cdH07XG5cdFxuXHRwcm90by51bmJpbmREcmFnID0gZnVuY3Rpb24oKSB7XG5cdCAgaWYgKCAhdGhpcy5pc0RyYWdCb3VuZCApIHtcblx0ICAgIHJldHVybjtcblx0ICB9XG5cdCAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWRyYWdnYWJsZScpO1xuXHQgIHRoaXMudW5iaW5kSGFuZGxlcygpO1xuXHQgIGRlbGV0ZSB0aGlzLmlzRHJhZ0JvdW5kO1xuXHR9O1xuXHRcblx0cHJvdG8uX3VpQ2hhbmdlRHJhZyA9IGZ1bmN0aW9uKCkge1xuXHQgIGRlbGV0ZSB0aGlzLmlzRnJlZVNjcm9sbGluZztcblx0fTtcblx0XG5cdHByb3RvLl9jaGlsZFVJUG9pbnRlckRvd25EcmFnID0gZnVuY3Rpb24oIGV2ZW50ICkge1xuXHQgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdCAgdGhpcy5wb2ludGVyRG93bkZvY3VzKCBldmVudCApO1xuXHR9O1xuXHRcblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gcG9pbnRlciBldmVudHMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cblx0XG5cdC8vIG5vZGVzIHRoYXQgaGF2ZSB0ZXh0IGZpZWxkc1xuXHR2YXIgY3Vyc29yTm9kZXMgPSB7XG5cdCAgVEVYVEFSRUE6IHRydWUsXG5cdCAgSU5QVVQ6IHRydWUsXG5cdCAgT1BUSU9OOiB0cnVlLFxuXHR9O1xuXHRcblx0Ly8gaW5wdXQgdHlwZXMgdGhhdCBkbyBub3QgaGF2ZSB0ZXh0IGZpZWxkc1xuXHR2YXIgY2xpY2tUeXBlcyA9IHtcblx0ICByYWRpbzogdHJ1ZSxcblx0ICBjaGVja2JveDogdHJ1ZSxcblx0ICBidXR0b246IHRydWUsXG5cdCAgc3VibWl0OiB0cnVlLFxuXHQgIGltYWdlOiB0cnVlLFxuXHQgIGZpbGU6IHRydWUsXG5cdH07XG5cdFxuXHRwcm90by5wb2ludGVyRG93biA9IGZ1bmN0aW9uKCBldmVudCwgcG9pbnRlciApIHtcblx0ICAvLyBkaXNtaXNzIGlucHV0cyB3aXRoIHRleHQgZmllbGRzLiAjNDAzLCAjNDA0XG5cdCAgdmFyIGlzQ3Vyc29ySW5wdXQgPSBjdXJzb3JOb2Rlc1sgZXZlbnQudGFyZ2V0Lm5vZGVOYW1lIF0gJiZcblx0ICAgICFjbGlja1R5cGVzWyBldmVudC50YXJnZXQudHlwZSBdO1xuXHQgIGlmICggaXNDdXJzb3JJbnB1dCApIHtcblx0ICAgIC8vIHJlc2V0IHBvaW50ZXJEb3duIGxvZ2ljXG5cdCAgICB0aGlzLmlzUG9pbnRlckRvd24gPSBmYWxzZTtcblx0ICAgIGRlbGV0ZSB0aGlzLnBvaW50ZXJJZGVudGlmaWVyO1xuXHQgICAgcmV0dXJuO1xuXHQgIH1cblx0XG5cdCAgdGhpcy5fZHJhZ1BvaW50ZXJEb3duKCBldmVudCwgcG9pbnRlciApO1xuXHRcblx0ICAvLyBrbHVkZ2UgdG8gYmx1ciBmb2N1c2VkIGlucHV0cyBpbiBkcmFnZ2VyXG5cdCAgdmFyIGZvY3VzZWQgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50O1xuXHQgIGlmICggZm9jdXNlZCAmJiBmb2N1c2VkLmJsdXIgJiYgZm9jdXNlZCAhPSB0aGlzLmVsZW1lbnQgJiZcblx0ICAgIC8vIGRvIG5vdCBibHVyIGJvZHkgZm9yIElFOSAmIDEwLCAjMTE3XG5cdCAgICBmb2N1c2VkICE9IGRvY3VtZW50LmJvZHkgKSB7XG5cdCAgICBmb2N1c2VkLmJsdXIoKTtcblx0ICB9XG5cdCAgdGhpcy5wb2ludGVyRG93bkZvY3VzKCBldmVudCApO1xuXHQgIC8vIHN0b3AgaWYgaXQgd2FzIG1vdmluZ1xuXHQgIHRoaXMuZHJhZ1ggPSB0aGlzLng7XG5cdCAgdGhpcy52aWV3cG9ydC5jbGFzc0xpc3QuYWRkKCdpcy1wb2ludGVyLWRvd24nKTtcblx0ICAvLyBiaW5kIG1vdmUgYW5kIGVuZCBldmVudHNcblx0ICB0aGlzLl9iaW5kUG9zdFN0YXJ0RXZlbnRzKCBldmVudCApO1xuXHQgIC8vIHRyYWNrIHNjcm9sbGluZ1xuXHQgIHRoaXMucG9pbnRlckRvd25TY3JvbGwgPSBnZXRTY3JvbGxQb3NpdGlvbigpO1xuXHQgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCAnc2Nyb2xsJywgdGhpcyApO1xuXHRcblx0ICB0aGlzLmRpc3BhdGNoRXZlbnQoICdwb2ludGVyRG93bicsIGV2ZW50LCBbIHBvaW50ZXIgXSApO1xuXHR9O1xuXHRcblx0dmFyIHRvdWNoU3RhcnRFdmVudHMgPSB7XG5cdCAgdG91Y2hzdGFydDogdHJ1ZSxcblx0ICBNU1BvaW50ZXJEb3duOiB0cnVlXG5cdH07XG5cdFxuXHR2YXIgZm9jdXNOb2RlcyA9IHtcblx0ICBJTlBVVDogdHJ1ZSxcblx0ICBTRUxFQ1Q6IHRydWVcblx0fTtcblx0XG5cdHByb3RvLnBvaW50ZXJEb3duRm9jdXMgPSBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdCAgLy8gZm9jdXMgZWxlbWVudCwgaWYgbm90IHRvdWNoLCBhbmQgaXRzIG5vdCBhbiBpbnB1dCBvciBzZWxlY3Rcblx0ICBpZiAoICF0aGlzLm9wdGlvbnMuYWNjZXNzaWJpbGl0eSB8fCB0b3VjaFN0YXJ0RXZlbnRzWyBldmVudC50eXBlIF0gfHxcblx0ICAgICAgZm9jdXNOb2Rlc1sgZXZlbnQudGFyZ2V0Lm5vZGVOYW1lIF0gKSB7XG5cdCAgICByZXR1cm47XG5cdCAgfVxuXHQgIHZhciBwcmV2U2Nyb2xsWSA9IHdpbmRvdy5wYWdlWU9mZnNldDtcblx0ICB0aGlzLmVsZW1lbnQuZm9jdXMoKTtcblx0ICAvLyBoYWNrIHRvIGZpeCBzY3JvbGwganVtcCBhZnRlciBmb2N1cywgIzc2XG5cdCAgaWYgKCB3aW5kb3cucGFnZVlPZmZzZXQgIT0gcHJldlNjcm9sbFkgKSB7XG5cdCAgICB3aW5kb3cuc2Nyb2xsVG8oIHdpbmRvdy5wYWdlWE9mZnNldCwgcHJldlNjcm9sbFkgKTtcblx0ICB9XG5cdH07XG5cdFxuXHRwcm90by5jYW5QcmV2ZW50RGVmYXVsdE9uUG9pbnRlckRvd24gPSBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdCAgLy8gcHJldmVudCBkZWZhdWx0LCB1bmxlc3MgdG91Y2hzdGFydCBvciA8c2VsZWN0PlxuXHQgIHZhciBpc1RvdWNoc3RhcnQgPSBldmVudC50eXBlID09ICd0b3VjaHN0YXJ0Jztcblx0ICB2YXIgdGFyZ2V0Tm9kZU5hbWUgPSBldmVudC50YXJnZXQubm9kZU5hbWU7XG5cdCAgcmV0dXJuICFpc1RvdWNoc3RhcnQgJiYgdGFyZ2V0Tm9kZU5hbWUgIT0gJ1NFTEVDVCc7XG5cdH07XG5cdFxuXHQvLyAtLS0tLSBtb3ZlIC0tLS0tIC8vXG5cdFxuXHRwcm90by5oYXNEcmFnU3RhcnRlZCA9IGZ1bmN0aW9uKCBtb3ZlVmVjdG9yICkge1xuXHQgIHJldHVybiBNYXRoLmFicyggbW92ZVZlY3Rvci54ICkgPiB0aGlzLm9wdGlvbnMuZHJhZ1RocmVzaG9sZDtcblx0fTtcblx0XG5cdC8vIC0tLS0tIHVwIC0tLS0tIC8vXG5cdFxuXHRwcm90by5wb2ludGVyVXAgPSBmdW5jdGlvbiggZXZlbnQsIHBvaW50ZXIgKSB7XG5cdCAgZGVsZXRlIHRoaXMuaXNUb3VjaFNjcm9sbGluZztcblx0ICB0aGlzLnZpZXdwb3J0LmNsYXNzTGlzdC5yZW1vdmUoJ2lzLXBvaW50ZXItZG93bicpO1xuXHQgIHRoaXMuZGlzcGF0Y2hFdmVudCggJ3BvaW50ZXJVcCcsIGV2ZW50LCBbIHBvaW50ZXIgXSApO1xuXHQgIHRoaXMuX2RyYWdQb2ludGVyVXAoIGV2ZW50LCBwb2ludGVyICk7XG5cdH07XG5cdFxuXHRwcm90by5wb2ludGVyRG9uZSA9IGZ1bmN0aW9uKCkge1xuXHQgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCAnc2Nyb2xsJywgdGhpcyApO1xuXHQgIGRlbGV0ZSB0aGlzLnBvaW50ZXJEb3duU2Nyb2xsO1xuXHR9O1xuXHRcblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gZHJhZ2dpbmcgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cblx0XG5cdHByb3RvLmRyYWdTdGFydCA9IGZ1bmN0aW9uKCBldmVudCwgcG9pbnRlciApIHtcblx0ICB0aGlzLmRyYWdTdGFydFBvc2l0aW9uID0gdGhpcy54O1xuXHQgIHRoaXMuc3RhcnRBbmltYXRpb24oKTtcblx0ICB0aGlzLmRpc3BhdGNoRXZlbnQoICdkcmFnU3RhcnQnLCBldmVudCwgWyBwb2ludGVyIF0gKTtcblx0fTtcblx0XG5cdHByb3RvLnBvaW50ZXJNb3ZlID0gZnVuY3Rpb24oIGV2ZW50LCBwb2ludGVyICkge1xuXHQgIHZhciBtb3ZlVmVjdG9yID0gdGhpcy5fZHJhZ1BvaW50ZXJNb3ZlKCBldmVudCwgcG9pbnRlciApO1xuXHQgIHRoaXMuZGlzcGF0Y2hFdmVudCggJ3BvaW50ZXJNb3ZlJywgZXZlbnQsIFsgcG9pbnRlciwgbW92ZVZlY3RvciBdICk7XG5cdCAgdGhpcy5fZHJhZ01vdmUoIGV2ZW50LCBwb2ludGVyLCBtb3ZlVmVjdG9yICk7XG5cdH07XG5cdFxuXHRwcm90by5kcmFnTW92ZSA9IGZ1bmN0aW9uKCBldmVudCwgcG9pbnRlciwgbW92ZVZlY3RvciApIHtcblx0ICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcblx0ICB0aGlzLnByZXZpb3VzRHJhZ1ggPSB0aGlzLmRyYWdYO1xuXHQgIC8vIHJldmVyc2UgaWYgcmlnaHQtdG8tbGVmdFxuXHQgIHZhciBkaXJlY3Rpb24gPSB0aGlzLm9wdGlvbnMucmlnaHRUb0xlZnQgPyAtMSA6IDE7XG5cdCAgdmFyIGRyYWdYID0gdGhpcy5kcmFnU3RhcnRQb3NpdGlvbiArIG1vdmVWZWN0b3IueCAqIGRpcmVjdGlvbjtcblx0XG5cdCAgaWYgKCAhdGhpcy5vcHRpb25zLndyYXBBcm91bmQgJiYgdGhpcy5zbGlkZXMubGVuZ3RoICkge1xuXHQgICAgLy8gc2xvdyBkcmFnXG5cdCAgICB2YXIgb3JpZ2luQm91bmQgPSBNYXRoLm1heCggLXRoaXMuc2xpZGVzWzBdLnRhcmdldCwgdGhpcy5kcmFnU3RhcnRQb3NpdGlvbiApO1xuXHQgICAgZHJhZ1ggPSBkcmFnWCA+IG9yaWdpbkJvdW5kID8gKCBkcmFnWCArIG9yaWdpbkJvdW5kICkgKiAwLjUgOiBkcmFnWDtcblx0ICAgIHZhciBlbmRCb3VuZCA9IE1hdGgubWluKCAtdGhpcy5nZXRMYXN0U2xpZGUoKS50YXJnZXQsIHRoaXMuZHJhZ1N0YXJ0UG9zaXRpb24gKTtcblx0ICAgIGRyYWdYID0gZHJhZ1ggPCBlbmRCb3VuZCA/ICggZHJhZ1ggKyBlbmRCb3VuZCApICogMC41IDogZHJhZ1g7XG5cdCAgfVxuXHRcblx0ICB0aGlzLmRyYWdYID0gZHJhZ1g7XG5cdFxuXHQgIHRoaXMuZHJhZ01vdmVUaW1lID0gbmV3IERhdGUoKTtcblx0ICB0aGlzLmRpc3BhdGNoRXZlbnQoICdkcmFnTW92ZScsIGV2ZW50LCBbIHBvaW50ZXIsIG1vdmVWZWN0b3IgXSApO1xuXHR9O1xuXHRcblx0cHJvdG8uZHJhZ0VuZCA9IGZ1bmN0aW9uKCBldmVudCwgcG9pbnRlciApIHtcblx0ICBpZiAoIHRoaXMub3B0aW9ucy5mcmVlU2Nyb2xsICkge1xuXHQgICAgdGhpcy5pc0ZyZWVTY3JvbGxpbmcgPSB0cnVlO1xuXHQgIH1cblx0ICAvLyBzZXQgc2VsZWN0ZWRJbmRleCBiYXNlZCBvbiB3aGVyZSBmbGljayB3aWxsIGVuZCB1cFxuXHQgIHZhciBpbmRleCA9IHRoaXMuZHJhZ0VuZFJlc3RpbmdTZWxlY3QoKTtcblx0XG5cdCAgaWYgKCB0aGlzLm9wdGlvbnMuZnJlZVNjcm9sbCAmJiAhdGhpcy5vcHRpb25zLndyYXBBcm91bmQgKSB7XG5cdCAgICAvLyBpZiBmcmVlLXNjcm9sbCAmIG5vdCB3cmFwIGFyb3VuZFxuXHQgICAgLy8gZG8gbm90IGZyZWUtc2Nyb2xsIGlmIGdvaW5nIG91dHNpZGUgb2YgYm91bmRpbmcgc2xpZGVzXG5cdCAgICAvLyBzbyBib3VuZGluZyBzbGlkZXMgY2FuIGF0dHJhY3Qgc2xpZGVyLCBhbmQga2VlcCBpdCBpbiBib3VuZHNcblx0ICAgIHZhciByZXN0aW5nWCA9IHRoaXMuZ2V0UmVzdGluZ1Bvc2l0aW9uKCk7XG5cdCAgICB0aGlzLmlzRnJlZVNjcm9sbGluZyA9IC1yZXN0aW5nWCA+IHRoaXMuc2xpZGVzWzBdLnRhcmdldCAmJlxuXHQgICAgICAtcmVzdGluZ1ggPCB0aGlzLmdldExhc3RTbGlkZSgpLnRhcmdldDtcblx0ICB9IGVsc2UgaWYgKCAhdGhpcy5vcHRpb25zLmZyZWVTY3JvbGwgJiYgaW5kZXggPT0gdGhpcy5zZWxlY3RlZEluZGV4ICkge1xuXHQgICAgLy8gYm9vc3Qgc2VsZWN0aW9uIGlmIHNlbGVjdGVkIGluZGV4IGhhcyBub3QgY2hhbmdlZFxuXHQgICAgaW5kZXggKz0gdGhpcy5kcmFnRW5kQm9vc3RTZWxlY3QoKTtcblx0ICB9XG5cdCAgZGVsZXRlIHRoaXMucHJldmlvdXNEcmFnWDtcblx0ICAvLyBhcHBseSBzZWxlY3Rpb25cblx0ICAvLyBUT0RPIHJlZmFjdG9yIHRoaXMsIHNlbGVjdGluZyBoZXJlIGZlZWxzIHdlaXJkXG5cdCAgLy8gSEFDSywgc2V0IGZsYWcgc28gZHJhZ2dpbmcgc3RheXMgaW4gY29ycmVjdCBkaXJlY3Rpb25cblx0ICB0aGlzLmlzRHJhZ1NlbGVjdCA9IHRoaXMub3B0aW9ucy53cmFwQXJvdW5kO1xuXHQgIHRoaXMuc2VsZWN0KCBpbmRleCApO1xuXHQgIGRlbGV0ZSB0aGlzLmlzRHJhZ1NlbGVjdDtcblx0ICB0aGlzLmRpc3BhdGNoRXZlbnQoICdkcmFnRW5kJywgZXZlbnQsIFsgcG9pbnRlciBdICk7XG5cdH07XG5cdFxuXHRwcm90by5kcmFnRW5kUmVzdGluZ1NlbGVjdCA9IGZ1bmN0aW9uKCkge1xuXHQgIHZhciByZXN0aW5nWCA9IHRoaXMuZ2V0UmVzdGluZ1Bvc2l0aW9uKCk7XG5cdCAgLy8gaG93IGZhciBhd2F5IGZyb20gc2VsZWN0ZWQgc2xpZGVcblx0ICB2YXIgZGlzdGFuY2UgPSBNYXRoLmFicyggdGhpcy5nZXRTbGlkZURpc3RhbmNlKCAtcmVzdGluZ1gsIHRoaXMuc2VsZWN0ZWRJbmRleCApICk7XG5cdCAgLy8gZ2V0IGNsb3NldCByZXN0aW5nIGdvaW5nIHVwIGFuZCBnb2luZyBkb3duXG5cdCAgdmFyIHBvc2l0aXZlUmVzdGluZyA9IHRoaXMuX2dldENsb3Nlc3RSZXN0aW5nKCByZXN0aW5nWCwgZGlzdGFuY2UsIDEgKTtcblx0ICB2YXIgbmVnYXRpdmVSZXN0aW5nID0gdGhpcy5fZ2V0Q2xvc2VzdFJlc3RpbmcoIHJlc3RpbmdYLCBkaXN0YW5jZSwgLTEgKTtcblx0ICAvLyB1c2UgY2xvc2VyIHJlc3RpbmcgZm9yIHdyYXAtYXJvdW5kXG5cdCAgdmFyIGluZGV4ID0gcG9zaXRpdmVSZXN0aW5nLmRpc3RhbmNlIDwgbmVnYXRpdmVSZXN0aW5nLmRpc3RhbmNlID9cblx0ICAgIHBvc2l0aXZlUmVzdGluZy5pbmRleCA6IG5lZ2F0aXZlUmVzdGluZy5pbmRleDtcblx0ICByZXR1cm4gaW5kZXg7XG5cdH07XG5cdFxuXHQvKipcblx0ICogZ2l2ZW4gcmVzdGluZyBYIGFuZCBkaXN0YW5jZSB0byBzZWxlY3RlZCBjZWxsXG5cdCAqIGdldCB0aGUgZGlzdGFuY2UgYW5kIGluZGV4IG9mIHRoZSBjbG9zZXN0IGNlbGxcblx0ICogQHBhcmFtIHtOdW1iZXJ9IHJlc3RpbmdYIC0gZXN0aW1hdGVkIHBvc3QtZmxpY2sgcmVzdGluZyBwb3NpdGlvblxuXHQgKiBAcGFyYW0ge051bWJlcn0gZGlzdGFuY2UgLSBkaXN0YW5jZSB0byBzZWxlY3RlZCBjZWxsXG5cdCAqIEBwYXJhbSB7SW50ZWdlcn0gaW5jcmVtZW50IC0gKzEgb3IgLTEsIGdvaW5nIHVwIG9yIGRvd25cblx0ICogQHJldHVybnMge09iamVjdH0gLSB7IGRpc3RhbmNlOiB7TnVtYmVyfSwgaW5kZXg6IHtJbnRlZ2VyfSB9XG5cdCAqL1xuXHRwcm90by5fZ2V0Q2xvc2VzdFJlc3RpbmcgPSBmdW5jdGlvbiggcmVzdGluZ1gsIGRpc3RhbmNlLCBpbmNyZW1lbnQgKSB7XG5cdCAgdmFyIGluZGV4ID0gdGhpcy5zZWxlY3RlZEluZGV4O1xuXHQgIHZhciBtaW5EaXN0YW5jZSA9IEluZmluaXR5O1xuXHQgIHZhciBjb25kaXRpb24gPSB0aGlzLm9wdGlvbnMuY29udGFpbiAmJiAhdGhpcy5vcHRpb25zLndyYXBBcm91bmQgP1xuXHQgICAgLy8gaWYgY29udGFpbiwga2VlcCBnb2luZyBpZiBkaXN0YW5jZSBpcyBlcXVhbCB0byBtaW5EaXN0YW5jZVxuXHQgICAgZnVuY3Rpb24oIGQsIG1kICkgeyByZXR1cm4gZCA8PSBtZDsgfSA6IGZ1bmN0aW9uKCBkLCBtZCApIHsgcmV0dXJuIGQgPCBtZDsgfTtcblx0ICB3aGlsZSAoIGNvbmRpdGlvbiggZGlzdGFuY2UsIG1pbkRpc3RhbmNlICkgKSB7XG5cdCAgICAvLyBtZWFzdXJlIGRpc3RhbmNlIHRvIG5leHQgY2VsbFxuXHQgICAgaW5kZXggKz0gaW5jcmVtZW50O1xuXHQgICAgbWluRGlzdGFuY2UgPSBkaXN0YW5jZTtcblx0ICAgIGRpc3RhbmNlID0gdGhpcy5nZXRTbGlkZURpc3RhbmNlKCAtcmVzdGluZ1gsIGluZGV4ICk7XG5cdCAgICBpZiAoIGRpc3RhbmNlID09PSBudWxsICkge1xuXHQgICAgICBicmVhaztcblx0ICAgIH1cblx0ICAgIGRpc3RhbmNlID0gTWF0aC5hYnMoIGRpc3RhbmNlICk7XG5cdCAgfVxuXHQgIHJldHVybiB7XG5cdCAgICBkaXN0YW5jZTogbWluRGlzdGFuY2UsXG5cdCAgICAvLyBzZWxlY3RlZCB3YXMgcHJldmlvdXMgaW5kZXhcblx0ICAgIGluZGV4OiBpbmRleCAtIGluY3JlbWVudFxuXHQgIH07XG5cdH07XG5cdFxuXHQvKipcblx0ICogbWVhc3VyZSBkaXN0YW5jZSBiZXR3ZWVuIHggYW5kIGEgc2xpZGUgdGFyZ2V0XG5cdCAqIEBwYXJhbSB7TnVtYmVyfSB4XG5cdCAqIEBwYXJhbSB7SW50ZWdlcn0gaW5kZXggLSBzbGlkZSBpbmRleFxuXHQgKi9cblx0cHJvdG8uZ2V0U2xpZGVEaXN0YW5jZSA9IGZ1bmN0aW9uKCB4LCBpbmRleCApIHtcblx0ICB2YXIgbGVuID0gdGhpcy5zbGlkZXMubGVuZ3RoO1xuXHQgIC8vIHdyYXAgYXJvdW5kIGlmIGF0IGxlYXN0IDIgc2xpZGVzXG5cdCAgdmFyIGlzV3JhcEFyb3VuZCA9IHRoaXMub3B0aW9ucy53cmFwQXJvdW5kICYmIGxlbiA+IDE7XG5cdCAgdmFyIHNsaWRlSW5kZXggPSBpc1dyYXBBcm91bmQgPyB1dGlscy5tb2R1bG8oIGluZGV4LCBsZW4gKSA6IGluZGV4O1xuXHQgIHZhciBzbGlkZSA9IHRoaXMuc2xpZGVzWyBzbGlkZUluZGV4IF07XG5cdCAgaWYgKCAhc2xpZGUgKSB7XG5cdCAgICByZXR1cm4gbnVsbDtcblx0ICB9XG5cdCAgLy8gYWRkIGRpc3RhbmNlIGZvciB3cmFwLWFyb3VuZCBzbGlkZXNcblx0ICB2YXIgd3JhcCA9IGlzV3JhcEFyb3VuZCA/IHRoaXMuc2xpZGVhYmxlV2lkdGggKiBNYXRoLmZsb29yKCBpbmRleCAvIGxlbiApIDogMDtcblx0ICByZXR1cm4geCAtICggc2xpZGUudGFyZ2V0ICsgd3JhcCApO1xuXHR9O1xuXHRcblx0cHJvdG8uZHJhZ0VuZEJvb3N0U2VsZWN0ID0gZnVuY3Rpb24oKSB7XG5cdCAgLy8gZG8gbm90IGJvb3N0IGlmIG5vIHByZXZpb3VzRHJhZ1ggb3IgZHJhZ01vdmVUaW1lXG5cdCAgaWYgKCB0aGlzLnByZXZpb3VzRHJhZ1ggPT09IHVuZGVmaW5lZCB8fCAhdGhpcy5kcmFnTW92ZVRpbWUgfHxcblx0ICAgIC8vIG9yIGlmIGRyYWcgd2FzIGhlbGQgZm9yIDEwMCBtc1xuXHQgICAgbmV3IERhdGUoKSAtIHRoaXMuZHJhZ01vdmVUaW1lID4gMTAwICkge1xuXHQgICAgcmV0dXJuIDA7XG5cdCAgfVxuXHRcblx0ICB2YXIgZGlzdGFuY2UgPSB0aGlzLmdldFNsaWRlRGlzdGFuY2UoIC10aGlzLmRyYWdYLCB0aGlzLnNlbGVjdGVkSW5kZXggKTtcblx0ICB2YXIgZGVsdGEgPSB0aGlzLnByZXZpb3VzRHJhZ1ggLSB0aGlzLmRyYWdYO1xuXHQgIGlmICggZGlzdGFuY2UgPiAwICYmIGRlbHRhID4gMCApIHtcblx0ICAgIC8vIGJvb3N0IHRvIG5leHQgaWYgbW92aW5nIHRvd2FyZHMgdGhlIHJpZ2h0LCBhbmQgcG9zaXRpdmUgdmVsb2NpdHlcblx0ICAgIHJldHVybiAxO1xuXHQgIH0gZWxzZSBpZiAoIGRpc3RhbmNlIDwgMCAmJiBkZWx0YSA8IDAgKSB7XG5cdCAgICAvLyBib29zdCB0byBwcmV2aW91cyBpZiBtb3ZpbmcgdG93YXJkcyB0aGUgbGVmdCwgYW5kIG5lZ2F0aXZlIHZlbG9jaXR5XG5cdCAgICByZXR1cm4gLTE7XG5cdCAgfVxuXHQgIHJldHVybiAwO1xuXHR9O1xuXHRcblx0Ly8gLS0tLS0gc3RhdGljQ2xpY2sgLS0tLS0gLy9cblx0XG5cdHByb3RvLnN0YXRpY0NsaWNrID0gZnVuY3Rpb24oIGV2ZW50LCBwb2ludGVyICkge1xuXHQgIC8vIGdldCBjbGlja2VkQ2VsbCwgaWYgY2VsbCB3YXMgY2xpY2tlZFxuXHQgIHZhciBjbGlja2VkQ2VsbCA9IHRoaXMuZ2V0UGFyZW50Q2VsbCggZXZlbnQudGFyZ2V0ICk7XG5cdCAgdmFyIGNlbGxFbGVtID0gY2xpY2tlZENlbGwgJiYgY2xpY2tlZENlbGwuZWxlbWVudDtcblx0ICB2YXIgY2VsbEluZGV4ID0gY2xpY2tlZENlbGwgJiYgdGhpcy5jZWxscy5pbmRleE9mKCBjbGlja2VkQ2VsbCApO1xuXHQgIHRoaXMuZGlzcGF0Y2hFdmVudCggJ3N0YXRpY0NsaWNrJywgZXZlbnQsIFsgcG9pbnRlciwgY2VsbEVsZW0sIGNlbGxJbmRleCBdICk7XG5cdH07XG5cdFxuXHQvLyAtLS0tLSBzY3JvbGwgLS0tLS0gLy9cblx0XG5cdHByb3RvLm9uc2Nyb2xsID0gZnVuY3Rpb24oKSB7XG5cdCAgdmFyIHNjcm9sbCA9IGdldFNjcm9sbFBvc2l0aW9uKCk7XG5cdCAgdmFyIHNjcm9sbE1vdmVYID0gdGhpcy5wb2ludGVyRG93blNjcm9sbC54IC0gc2Nyb2xsLng7XG5cdCAgdmFyIHNjcm9sbE1vdmVZID0gdGhpcy5wb2ludGVyRG93blNjcm9sbC55IC0gc2Nyb2xsLnk7XG5cdCAgLy8gY2FuY2VsIGNsaWNrL3RhcCBpZiBzY3JvbGwgaXMgdG9vIG11Y2hcblx0ICBpZiAoIE1hdGguYWJzKCBzY3JvbGxNb3ZlWCApID4gMyB8fCBNYXRoLmFicyggc2Nyb2xsTW92ZVkgKSA+IDMgKSB7XG5cdCAgICB0aGlzLl9wb2ludGVyRG9uZSgpO1xuXHQgIH1cblx0fTtcblx0XG5cdC8vIC0tLS0tIHV0aWxzIC0tLS0tIC8vXG5cdFxuXHRmdW5jdGlvbiBnZXRTY3JvbGxQb3NpdGlvbigpIHtcblx0ICByZXR1cm4ge1xuXHQgICAgeDogd2luZG93LnBhZ2VYT2Zmc2V0LFxuXHQgICAgeTogd2luZG93LnBhZ2VZT2Zmc2V0XG5cdCAgfTtcblx0fVxuXHRcblx0Ly8gLS0tLS0gIC0tLS0tIC8vXG5cdFxuXHRyZXR1cm4gRmxpY2tpdHk7XG5cdFxuXHR9KSk7XG5cblxuLyoqKi8gfSxcbi8qIDEzICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHR2YXIgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXywgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX187LyohXG5cdCAqIFVuaWRyYWdnZXIgdjIuMS4wXG5cdCAqIERyYWdnYWJsZSBiYXNlIGNsYXNzXG5cdCAqIE1JVCBsaWNlbnNlXG5cdCAqL1xuXHRcblx0Lypqc2hpbnQgYnJvd3NlcjogdHJ1ZSwgdW51c2VkOiB0cnVlLCB1bmRlZjogdHJ1ZSwgc3RyaWN0OiB0cnVlICovXG5cdFxuXHQoIGZ1bmN0aW9uKCB3aW5kb3csIGZhY3RvcnkgKSB7XG5cdCAgLy8gdW5pdmVyc2FsIG1vZHVsZSBkZWZpbml0aW9uXG5cdCAgLypqc2hpbnQgc3RyaWN0OiBmYWxzZSAqLyAvKmdsb2JhbHMgZGVmaW5lLCBtb2R1bGUsIHJlcXVpcmUgKi9cblx0XG5cdCAgaWYgKCB0cnVlICkge1xuXHQgICAgLy8gQU1EXG5cdCAgICAhKF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18gPSBbXG5cdCAgICAgIF9fd2VicGFja19yZXF1aXJlX18oMTQpXG5cdCAgICBdLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyA9IGZ1bmN0aW9uKCBVbmlwb2ludGVyICkge1xuXHQgICAgICByZXR1cm4gZmFjdG9yeSggd2luZG93LCBVbmlwb2ludGVyICk7XG5cdCAgICB9LmFwcGx5KGV4cG9ydHMsIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18pLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyAhPT0gdW5kZWZpbmVkICYmIChtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fKSk7XG5cdCAgfSBlbHNlIGlmICggdHlwZW9mIG1vZHVsZSA9PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cyApIHtcblx0ICAgIC8vIENvbW1vbkpTXG5cdCAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoXG5cdCAgICAgIHdpbmRvdyxcblx0ICAgICAgcmVxdWlyZSgndW5pcG9pbnRlcicpXG5cdCAgICApO1xuXHQgIH0gZWxzZSB7XG5cdCAgICAvLyBicm93c2VyIGdsb2JhbFxuXHQgICAgd2luZG93LlVuaWRyYWdnZXIgPSBmYWN0b3J5KFxuXHQgICAgICB3aW5kb3csXG5cdCAgICAgIHdpbmRvdy5Vbmlwb2ludGVyXG5cdCAgICApO1xuXHQgIH1cblx0XG5cdH0oIHdpbmRvdywgZnVuY3Rpb24gZmFjdG9yeSggd2luZG93LCBVbmlwb2ludGVyICkge1xuXHRcblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0Ly8gLS0tLS0gIC0tLS0tIC8vXG5cdFxuXHRmdW5jdGlvbiBub29wKCkge31cblx0XG5cdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFVuaWRyYWdnZXIgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cblx0XG5cdGZ1bmN0aW9uIFVuaWRyYWdnZXIoKSB7fVxuXHRcblx0Ly8gaW5oZXJpdCBVbmlwb2ludGVyICYgRXZFbWl0dGVyXG5cdHZhciBwcm90byA9IFVuaWRyYWdnZXIucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZSggVW5pcG9pbnRlci5wcm90b3R5cGUgKTtcblx0XG5cdC8vIC0tLS0tIGJpbmQgc3RhcnQgLS0tLS0gLy9cblx0XG5cdHByb3RvLmJpbmRIYW5kbGVzID0gZnVuY3Rpb24oKSB7XG5cdCAgdGhpcy5fYmluZEhhbmRsZXMoIHRydWUgKTtcblx0fTtcblx0XG5cdHByb3RvLnVuYmluZEhhbmRsZXMgPSBmdW5jdGlvbigpIHtcblx0ICB0aGlzLl9iaW5kSGFuZGxlcyggZmFsc2UgKTtcblx0fTtcblx0XG5cdHZhciBuYXZpZ2F0b3IgPSB3aW5kb3cubmF2aWdhdG9yO1xuXHQvKipcblx0ICogd29ya3MgYXMgdW5iaW5kZXIsIGFzIHlvdSBjYW4gLmJpbmRIYW5kbGVzKCBmYWxzZSApIHRvIHVuYmluZFxuXHQgKiBAcGFyYW0ge0Jvb2xlYW59IGlzQmluZCAtIHdpbGwgdW5iaW5kIGlmIGZhbHNleVxuXHQgKi9cblx0cHJvdG8uX2JpbmRIYW5kbGVzID0gZnVuY3Rpb24oIGlzQmluZCApIHtcblx0ICAvLyBtdW5nZSBpc0JpbmQsIGRlZmF1bHQgdG8gdHJ1ZVxuXHQgIGlzQmluZCA9IGlzQmluZCA9PT0gdW5kZWZpbmVkID8gdHJ1ZSA6ICEhaXNCaW5kO1xuXHQgIC8vIGV4dHJhIGJpbmQgbG9naWNcblx0ICB2YXIgYmluZGVyRXh0cmE7XG5cdCAgaWYgKCBuYXZpZ2F0b3IucG9pbnRlckVuYWJsZWQgKSB7XG5cdCAgICBiaW5kZXJFeHRyYSA9IGZ1bmN0aW9uKCBoYW5kbGUgKSB7XG5cdCAgICAgIC8vIGRpc2FibGUgc2Nyb2xsaW5nIG9uIHRoZSBlbGVtZW50XG5cdCAgICAgIGhhbmRsZS5zdHlsZS50b3VjaEFjdGlvbiA9IGlzQmluZCA/ICdub25lJyA6ICcnO1xuXHQgICAgfTtcblx0ICB9IGVsc2UgaWYgKCBuYXZpZ2F0b3IubXNQb2ludGVyRW5hYmxlZCApIHtcblx0ICAgIGJpbmRlckV4dHJhID0gZnVuY3Rpb24oIGhhbmRsZSApIHtcblx0ICAgICAgLy8gZGlzYWJsZSBzY3JvbGxpbmcgb24gdGhlIGVsZW1lbnRcblx0ICAgICAgaGFuZGxlLnN0eWxlLm1zVG91Y2hBY3Rpb24gPSBpc0JpbmQgPyAnbm9uZScgOiAnJztcblx0ICAgIH07XG5cdCAgfSBlbHNlIHtcblx0ICAgIGJpbmRlckV4dHJhID0gbm9vcDtcblx0ICB9XG5cdCAgLy8gYmluZCBlYWNoIGhhbmRsZVxuXHQgIHZhciBiaW5kTWV0aG9kID0gaXNCaW5kID8gJ2FkZEV2ZW50TGlzdGVuZXInIDogJ3JlbW92ZUV2ZW50TGlzdGVuZXInO1xuXHQgIGZvciAoIHZhciBpPTA7IGkgPCB0aGlzLmhhbmRsZXMubGVuZ3RoOyBpKysgKSB7XG5cdCAgICB2YXIgaGFuZGxlID0gdGhpcy5oYW5kbGVzW2ldO1xuXHQgICAgdGhpcy5fYmluZFN0YXJ0RXZlbnQoIGhhbmRsZSwgaXNCaW5kICk7XG5cdCAgICBiaW5kZXJFeHRyYSggaGFuZGxlICk7XG5cdCAgICBoYW5kbGVbIGJpbmRNZXRob2QgXSggJ2NsaWNrJywgdGhpcyApO1xuXHQgIH1cblx0fTtcblx0XG5cdC8vIC0tLS0tIHN0YXJ0IGV2ZW50IC0tLS0tIC8vXG5cdFxuXHQvKipcblx0ICogcG9pbnRlciBzdGFydFxuXHQgKiBAcGFyYW0ge0V2ZW50fSBldmVudFxuXHQgKiBAcGFyYW0ge0V2ZW50IG9yIFRvdWNofSBwb2ludGVyXG5cdCAqL1xuXHRwcm90by5wb2ludGVyRG93biA9IGZ1bmN0aW9uKCBldmVudCwgcG9pbnRlciApIHtcblx0ICAvLyBkaXNtaXNzIHJhbmdlIHNsaWRlcnNcblx0ICBpZiAoIGV2ZW50LnRhcmdldC5ub2RlTmFtZSA9PSAnSU5QVVQnICYmIGV2ZW50LnRhcmdldC50eXBlID09ICdyYW5nZScgKSB7XG5cdCAgICAvLyByZXNldCBwb2ludGVyRG93biBsb2dpY1xuXHQgICAgdGhpcy5pc1BvaW50ZXJEb3duID0gZmFsc2U7XG5cdCAgICBkZWxldGUgdGhpcy5wb2ludGVySWRlbnRpZmllcjtcblx0ICAgIHJldHVybjtcblx0ICB9XG5cdFxuXHQgIHRoaXMuX2RyYWdQb2ludGVyRG93biggZXZlbnQsIHBvaW50ZXIgKTtcblx0ICAvLyBrbHVkZ2UgdG8gYmx1ciBmb2N1c2VkIGlucHV0cyBpbiBkcmFnZ2VyXG5cdCAgdmFyIGZvY3VzZWQgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50O1xuXHQgIGlmICggZm9jdXNlZCAmJiBmb2N1c2VkLmJsdXIgKSB7XG5cdCAgICBmb2N1c2VkLmJsdXIoKTtcblx0ICB9XG5cdCAgLy8gYmluZCBtb3ZlIGFuZCBlbmQgZXZlbnRzXG5cdCAgdGhpcy5fYmluZFBvc3RTdGFydEV2ZW50cyggZXZlbnQgKTtcblx0ICB0aGlzLmVtaXRFdmVudCggJ3BvaW50ZXJEb3duJywgWyBldmVudCwgcG9pbnRlciBdICk7XG5cdH07XG5cdFxuXHQvLyBiYXNlIHBvaW50ZXIgZG93biBsb2dpY1xuXHRwcm90by5fZHJhZ1BvaW50ZXJEb3duID0gZnVuY3Rpb24oIGV2ZW50LCBwb2ludGVyICkge1xuXHQgIC8vIHRyYWNrIHRvIHNlZSB3aGVuIGRyYWdnaW5nIHN0YXJ0c1xuXHQgIHRoaXMucG9pbnRlckRvd25Qb2ludCA9IFVuaXBvaW50ZXIuZ2V0UG9pbnRlclBvaW50KCBwb2ludGVyICk7XG5cdFxuXHQgIHZhciBjYW5QcmV2ZW50RGVmYXVsdCA9IHRoaXMuY2FuUHJldmVudERlZmF1bHRPblBvaW50ZXJEb3duKCBldmVudCwgcG9pbnRlciApO1xuXHQgIGlmICggY2FuUHJldmVudERlZmF1bHQgKSB7XG5cdCAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHQgIH1cblx0fTtcblx0XG5cdC8vIG92ZXJ3cml0ZWFibGUgbWV0aG9kIHNvIEZsaWNraXR5IGNhbiBwcmV2ZW50IGZvciBzY3JvbGxpbmdcblx0cHJvdG8uY2FuUHJldmVudERlZmF1bHRPblBvaW50ZXJEb3duID0gZnVuY3Rpb24oIGV2ZW50ICkge1xuXHQgIC8vIHByZXZlbnQgZGVmYXVsdCwgdW5sZXNzIHRvdWNoc3RhcnQgb3IgPHNlbGVjdD5cblx0ICByZXR1cm4gZXZlbnQudGFyZ2V0Lm5vZGVOYW1lICE9ICdTRUxFQ1QnO1xuXHR9O1xuXHRcblx0Ly8gLS0tLS0gbW92ZSBldmVudCAtLS0tLSAvL1xuXHRcblx0LyoqXG5cdCAqIGRyYWcgbW92ZVxuXHQgKiBAcGFyYW0ge0V2ZW50fSBldmVudFxuXHQgKiBAcGFyYW0ge0V2ZW50IG9yIFRvdWNofSBwb2ludGVyXG5cdCAqL1xuXHRwcm90by5wb2ludGVyTW92ZSA9IGZ1bmN0aW9uKCBldmVudCwgcG9pbnRlciApIHtcblx0ICB2YXIgbW92ZVZlY3RvciA9IHRoaXMuX2RyYWdQb2ludGVyTW92ZSggZXZlbnQsIHBvaW50ZXIgKTtcblx0ICB0aGlzLmVtaXRFdmVudCggJ3BvaW50ZXJNb3ZlJywgWyBldmVudCwgcG9pbnRlciwgbW92ZVZlY3RvciBdICk7XG5cdCAgdGhpcy5fZHJhZ01vdmUoIGV2ZW50LCBwb2ludGVyLCBtb3ZlVmVjdG9yICk7XG5cdH07XG5cdFxuXHQvLyBiYXNlIHBvaW50ZXIgbW92ZSBsb2dpY1xuXHRwcm90by5fZHJhZ1BvaW50ZXJNb3ZlID0gZnVuY3Rpb24oIGV2ZW50LCBwb2ludGVyICkge1xuXHQgIHZhciBtb3ZlUG9pbnQgPSBVbmlwb2ludGVyLmdldFBvaW50ZXJQb2ludCggcG9pbnRlciApO1xuXHQgIHZhciBtb3ZlVmVjdG9yID0ge1xuXHQgICAgeDogbW92ZVBvaW50LnggLSB0aGlzLnBvaW50ZXJEb3duUG9pbnQueCxcblx0ICAgIHk6IG1vdmVQb2ludC55IC0gdGhpcy5wb2ludGVyRG93blBvaW50Lnlcblx0ICB9O1xuXHQgIC8vIHN0YXJ0IGRyYWcgaWYgcG9pbnRlciBoYXMgbW92ZWQgZmFyIGVub3VnaCB0byBzdGFydCBkcmFnXG5cdCAgaWYgKCAhdGhpcy5pc0RyYWdnaW5nICYmIHRoaXMuaGFzRHJhZ1N0YXJ0ZWQoIG1vdmVWZWN0b3IgKSApIHtcblx0ICAgIHRoaXMuX2RyYWdTdGFydCggZXZlbnQsIHBvaW50ZXIgKTtcblx0ICB9XG5cdCAgcmV0dXJuIG1vdmVWZWN0b3I7XG5cdH07XG5cdFxuXHQvLyBjb25kaXRpb24gaWYgcG9pbnRlciBoYXMgbW92ZWQgZmFyIGVub3VnaCB0byBzdGFydCBkcmFnXG5cdHByb3RvLmhhc0RyYWdTdGFydGVkID0gZnVuY3Rpb24oIG1vdmVWZWN0b3IgKSB7XG5cdCAgcmV0dXJuIE1hdGguYWJzKCBtb3ZlVmVjdG9yLnggKSA+IDMgfHwgTWF0aC5hYnMoIG1vdmVWZWN0b3IueSApID4gMztcblx0fTtcblx0XG5cdFxuXHQvLyAtLS0tLSBlbmQgZXZlbnQgLS0tLS0gLy9cblx0XG5cdC8qKlxuXHQgKiBwb2ludGVyIHVwXG5cdCAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50XG5cdCAqIEBwYXJhbSB7RXZlbnQgb3IgVG91Y2h9IHBvaW50ZXJcblx0ICovXG5cdHByb3RvLnBvaW50ZXJVcCA9IGZ1bmN0aW9uKCBldmVudCwgcG9pbnRlciApIHtcblx0ICB0aGlzLmVtaXRFdmVudCggJ3BvaW50ZXJVcCcsIFsgZXZlbnQsIHBvaW50ZXIgXSApO1xuXHQgIHRoaXMuX2RyYWdQb2ludGVyVXAoIGV2ZW50LCBwb2ludGVyICk7XG5cdH07XG5cdFxuXHRwcm90by5fZHJhZ1BvaW50ZXJVcCA9IGZ1bmN0aW9uKCBldmVudCwgcG9pbnRlciApIHtcblx0ICBpZiAoIHRoaXMuaXNEcmFnZ2luZyApIHtcblx0ICAgIHRoaXMuX2RyYWdFbmQoIGV2ZW50LCBwb2ludGVyICk7XG5cdCAgfSBlbHNlIHtcblx0ICAgIC8vIHBvaW50ZXIgZGlkbid0IG1vdmUgZW5vdWdoIGZvciBkcmFnIHRvIHN0YXJ0XG5cdCAgICB0aGlzLl9zdGF0aWNDbGljayggZXZlbnQsIHBvaW50ZXIgKTtcblx0ICB9XG5cdH07XG5cdFxuXHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBkcmFnIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vXG5cdFxuXHQvLyBkcmFnU3RhcnRcblx0cHJvdG8uX2RyYWdTdGFydCA9IGZ1bmN0aW9uKCBldmVudCwgcG9pbnRlciApIHtcblx0ICB0aGlzLmlzRHJhZ2dpbmcgPSB0cnVlO1xuXHQgIHRoaXMuZHJhZ1N0YXJ0UG9pbnQgPSBVbmlwb2ludGVyLmdldFBvaW50ZXJQb2ludCggcG9pbnRlciApO1xuXHQgIC8vIHByZXZlbnQgY2xpY2tzXG5cdCAgdGhpcy5pc1ByZXZlbnRpbmdDbGlja3MgPSB0cnVlO1xuXHRcblx0ICB0aGlzLmRyYWdTdGFydCggZXZlbnQsIHBvaW50ZXIgKTtcblx0fTtcblx0XG5cdHByb3RvLmRyYWdTdGFydCA9IGZ1bmN0aW9uKCBldmVudCwgcG9pbnRlciApIHtcblx0ICB0aGlzLmVtaXRFdmVudCggJ2RyYWdTdGFydCcsIFsgZXZlbnQsIHBvaW50ZXIgXSApO1xuXHR9O1xuXHRcblx0Ly8gZHJhZ01vdmVcblx0cHJvdG8uX2RyYWdNb3ZlID0gZnVuY3Rpb24oIGV2ZW50LCBwb2ludGVyLCBtb3ZlVmVjdG9yICkge1xuXHQgIC8vIGRvIG5vdCBkcmFnIGlmIG5vdCBkcmFnZ2luZyB5ZXRcblx0ICBpZiAoICF0aGlzLmlzRHJhZ2dpbmcgKSB7XG5cdCAgICByZXR1cm47XG5cdCAgfVxuXHRcblx0ICB0aGlzLmRyYWdNb3ZlKCBldmVudCwgcG9pbnRlciwgbW92ZVZlY3RvciApO1xuXHR9O1xuXHRcblx0cHJvdG8uZHJhZ01vdmUgPSBmdW5jdGlvbiggZXZlbnQsIHBvaW50ZXIsIG1vdmVWZWN0b3IgKSB7XG5cdCAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0ICB0aGlzLmVtaXRFdmVudCggJ2RyYWdNb3ZlJywgWyBldmVudCwgcG9pbnRlciwgbW92ZVZlY3RvciBdICk7XG5cdH07XG5cdFxuXHQvLyBkcmFnRW5kXG5cdHByb3RvLl9kcmFnRW5kID0gZnVuY3Rpb24oIGV2ZW50LCBwb2ludGVyICkge1xuXHQgIC8vIHNldCBmbGFnc1xuXHQgIHRoaXMuaXNEcmFnZ2luZyA9IGZhbHNlO1xuXHQgIC8vIHJlLWVuYWJsZSBjbGlja2luZyBhc3luY1xuXHQgIHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuXHQgICAgZGVsZXRlIHRoaXMuaXNQcmV2ZW50aW5nQ2xpY2tzO1xuXHQgIH0uYmluZCggdGhpcyApICk7XG5cdFxuXHQgIHRoaXMuZHJhZ0VuZCggZXZlbnQsIHBvaW50ZXIgKTtcblx0fTtcblx0XG5cdHByb3RvLmRyYWdFbmQgPSBmdW5jdGlvbiggZXZlbnQsIHBvaW50ZXIgKSB7XG5cdCAgdGhpcy5lbWl0RXZlbnQoICdkcmFnRW5kJywgWyBldmVudCwgcG9pbnRlciBdICk7XG5cdH07XG5cdFxuXHQvLyAtLS0tLSBvbmNsaWNrIC0tLS0tIC8vXG5cdFxuXHQvLyBoYW5kbGUgYWxsIGNsaWNrcyBhbmQgcHJldmVudCBjbGlja3Mgd2hlbiBkcmFnZ2luZ1xuXHRwcm90by5vbmNsaWNrID0gZnVuY3Rpb24oIGV2ZW50ICkge1xuXHQgIGlmICggdGhpcy5pc1ByZXZlbnRpbmdDbGlja3MgKSB7XG5cdCAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHQgIH1cblx0fTtcblx0XG5cdC8vIC0tLS0tIHN0YXRpY0NsaWNrIC0tLS0tIC8vXG5cdFxuXHQvLyB0cmlnZ2VyZWQgYWZ0ZXIgcG9pbnRlciBkb3duICYgdXAgd2l0aCBuby90aW55IG1vdmVtZW50XG5cdHByb3RvLl9zdGF0aWNDbGljayA9IGZ1bmN0aW9uKCBldmVudCwgcG9pbnRlciApIHtcblx0ICAvLyBpZ25vcmUgZW11bGF0ZWQgbW91c2UgdXAgY2xpY2tzXG5cdCAgaWYgKCB0aGlzLmlzSWdub3JpbmdNb3VzZVVwICYmIGV2ZW50LnR5cGUgPT0gJ21vdXNldXAnICkge1xuXHQgICAgcmV0dXJuO1xuXHQgIH1cblx0XG5cdCAgLy8gYWxsb3cgY2xpY2sgaW4gPGlucHV0PnMgYW5kIDx0ZXh0YXJlYT5zXG5cdCAgdmFyIG5vZGVOYW1lID0gZXZlbnQudGFyZ2V0Lm5vZGVOYW1lO1xuXHQgIGlmICggbm9kZU5hbWUgPT0gJ0lOUFVUJyB8fCBub2RlTmFtZSA9PSAnVEVYVEFSRUEnICkge1xuXHQgICAgZXZlbnQudGFyZ2V0LmZvY3VzKCk7XG5cdCAgfVxuXHQgIHRoaXMuc3RhdGljQ2xpY2soIGV2ZW50LCBwb2ludGVyICk7XG5cdFxuXHQgIC8vIHNldCBmbGFnIGZvciBlbXVsYXRlZCBjbGlja3MgMzAwbXMgYWZ0ZXIgdG91Y2hlbmRcblx0ICBpZiAoIGV2ZW50LnR5cGUgIT0gJ21vdXNldXAnICkge1xuXHQgICAgdGhpcy5pc0lnbm9yaW5nTW91c2VVcCA9IHRydWU7XG5cdCAgICAvLyByZXNldCBmbGFnIGFmdGVyIDMwMG1zXG5cdCAgICBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcblx0ICAgICAgZGVsZXRlIHRoaXMuaXNJZ25vcmluZ01vdXNlVXA7XG5cdCAgICB9LmJpbmQoIHRoaXMgKSwgNDAwICk7XG5cdCAgfVxuXHR9O1xuXHRcblx0cHJvdG8uc3RhdGljQ2xpY2sgPSBmdW5jdGlvbiggZXZlbnQsIHBvaW50ZXIgKSB7XG5cdCAgdGhpcy5lbWl0RXZlbnQoICdzdGF0aWNDbGljaycsIFsgZXZlbnQsIHBvaW50ZXIgXSApO1xuXHR9O1xuXHRcblx0Ly8gLS0tLS0gdXRpbHMgLS0tLS0gLy9cblx0XG5cdFVuaWRyYWdnZXIuZ2V0UG9pbnRlclBvaW50ID0gVW5pcG9pbnRlci5nZXRQb2ludGVyUG9pbnQ7XG5cdFxuXHQvLyAtLS0tLSAgLS0tLS0gLy9cblx0XG5cdHJldHVybiBVbmlkcmFnZ2VyO1xuXHRcblx0fSkpO1xuXG5cbi8qKiovIH0sXG4vKiAxNCAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0dmFyIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fOy8qIVxuXHQgKiBVbmlwb2ludGVyIHYyLjEuMFxuXHQgKiBiYXNlIGNsYXNzIGZvciBkb2luZyBvbmUgdGhpbmcgd2l0aCBwb2ludGVyIGV2ZW50XG5cdCAqIE1JVCBsaWNlbnNlXG5cdCAqL1xuXHRcblx0Lypqc2hpbnQgYnJvd3NlcjogdHJ1ZSwgdW5kZWY6IHRydWUsIHVudXNlZDogdHJ1ZSwgc3RyaWN0OiB0cnVlICovXG5cdFxuXHQoIGZ1bmN0aW9uKCB3aW5kb3csIGZhY3RvcnkgKSB7XG5cdCAgLy8gdW5pdmVyc2FsIG1vZHVsZSBkZWZpbml0aW9uXG5cdCAgLyoganNoaW50IHN0cmljdDogZmFsc2UgKi8gLypnbG9iYWwgZGVmaW5lLCBtb2R1bGUsIHJlcXVpcmUgKi9cblx0ICBpZiAoIHRydWUgKSB7XG5cdCAgICAvLyBBTURcblx0ICAgICEoX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXyA9IFtcblx0ICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg1KVxuXHQgICAgXSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gPSBmdW5jdGlvbiggRXZFbWl0dGVyICkge1xuXHQgICAgICByZXR1cm4gZmFjdG9yeSggd2luZG93LCBFdkVtaXR0ZXIgKTtcblx0ICAgIH0uYXBwbHkoZXhwb3J0cywgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXyksIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fICE9PSB1bmRlZmluZWQgJiYgKG1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18pKTtcblx0ICB9IGVsc2UgaWYgKCB0eXBlb2YgbW9kdWxlID09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzICkge1xuXHQgICAgLy8gQ29tbW9uSlNcblx0ICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShcblx0ICAgICAgd2luZG93LFxuXHQgICAgICByZXF1aXJlKCdldi1lbWl0dGVyJylcblx0ICAgICk7XG5cdCAgfSBlbHNlIHtcblx0ICAgIC8vIGJyb3dzZXIgZ2xvYmFsXG5cdCAgICB3aW5kb3cuVW5pcG9pbnRlciA9IGZhY3RvcnkoXG5cdCAgICAgIHdpbmRvdyxcblx0ICAgICAgd2luZG93LkV2RW1pdHRlclxuXHQgICAgKTtcblx0ICB9XG5cdFxuXHR9KCB3aW5kb3csIGZ1bmN0aW9uIGZhY3RvcnkoIHdpbmRvdywgRXZFbWl0dGVyICkge1xuXHRcblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0ZnVuY3Rpb24gbm9vcCgpIHt9XG5cdFxuXHRmdW5jdGlvbiBVbmlwb2ludGVyKCkge31cblx0XG5cdC8vIGluaGVyaXQgRXZFbWl0dGVyXG5cdHZhciBwcm90byA9IFVuaXBvaW50ZXIucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZSggRXZFbWl0dGVyLnByb3RvdHlwZSApO1xuXHRcblx0cHJvdG8uYmluZFN0YXJ0RXZlbnQgPSBmdW5jdGlvbiggZWxlbSApIHtcblx0ICB0aGlzLl9iaW5kU3RhcnRFdmVudCggZWxlbSwgdHJ1ZSApO1xuXHR9O1xuXHRcblx0cHJvdG8udW5iaW5kU3RhcnRFdmVudCA9IGZ1bmN0aW9uKCBlbGVtICkge1xuXHQgIHRoaXMuX2JpbmRTdGFydEV2ZW50KCBlbGVtLCBmYWxzZSApO1xuXHR9O1xuXHRcblx0LyoqXG5cdCAqIHdvcmtzIGFzIHVuYmluZGVyLCBhcyB5b3UgY2FuIC5fYmluZFN0YXJ0KCBmYWxzZSApIHRvIHVuYmluZFxuXHQgKiBAcGFyYW0ge0Jvb2xlYW59IGlzQmluZCAtIHdpbGwgdW5iaW5kIGlmIGZhbHNleVxuXHQgKi9cblx0cHJvdG8uX2JpbmRTdGFydEV2ZW50ID0gZnVuY3Rpb24oIGVsZW0sIGlzQmluZCApIHtcblx0ICAvLyBtdW5nZSBpc0JpbmQsIGRlZmF1bHQgdG8gdHJ1ZVxuXHQgIGlzQmluZCA9IGlzQmluZCA9PT0gdW5kZWZpbmVkID8gdHJ1ZSA6ICEhaXNCaW5kO1xuXHQgIHZhciBiaW5kTWV0aG9kID0gaXNCaW5kID8gJ2FkZEV2ZW50TGlzdGVuZXInIDogJ3JlbW92ZUV2ZW50TGlzdGVuZXInO1xuXHRcblx0ICBpZiAoIHdpbmRvdy5uYXZpZ2F0b3IucG9pbnRlckVuYWJsZWQgKSB7XG5cdCAgICAvLyBXM0MgUG9pbnRlciBFdmVudHMsIElFMTEuIFNlZSBodHRwczovL2NvZGVyd2FsbC5jb20vcC9tZnJlY2Fcblx0ICAgIGVsZW1bIGJpbmRNZXRob2QgXSggJ3BvaW50ZXJkb3duJywgdGhpcyApO1xuXHQgIH0gZWxzZSBpZiAoIHdpbmRvdy5uYXZpZ2F0b3IubXNQb2ludGVyRW5hYmxlZCApIHtcblx0ICAgIC8vIElFMTAgUG9pbnRlciBFdmVudHNcblx0ICAgIGVsZW1bIGJpbmRNZXRob2QgXSggJ01TUG9pbnRlckRvd24nLCB0aGlzICk7XG5cdCAgfSBlbHNlIHtcblx0ICAgIC8vIGxpc3RlbiBmb3IgYm90aCwgZm9yIGRldmljZXMgbGlrZSBDaHJvbWUgUGl4ZWxcblx0ICAgIGVsZW1bIGJpbmRNZXRob2QgXSggJ21vdXNlZG93bicsIHRoaXMgKTtcblx0ICAgIGVsZW1bIGJpbmRNZXRob2QgXSggJ3RvdWNoc3RhcnQnLCB0aGlzICk7XG5cdCAgfVxuXHR9O1xuXHRcblx0Ly8gdHJpZ2dlciBoYW5kbGVyIG1ldGhvZHMgZm9yIGV2ZW50c1xuXHRwcm90by5oYW5kbGVFdmVudCA9IGZ1bmN0aW9uKCBldmVudCApIHtcblx0ICB2YXIgbWV0aG9kID0gJ29uJyArIGV2ZW50LnR5cGU7XG5cdCAgaWYgKCB0aGlzWyBtZXRob2QgXSApIHtcblx0ICAgIHRoaXNbIG1ldGhvZCBdKCBldmVudCApO1xuXHQgIH1cblx0fTtcblx0XG5cdC8vIHJldHVybnMgdGhlIHRvdWNoIHRoYXQgd2UncmUga2VlcGluZyB0cmFjayBvZlxuXHRwcm90by5nZXRUb3VjaCA9IGZ1bmN0aW9uKCB0b3VjaGVzICkge1xuXHQgIGZvciAoIHZhciBpPTA7IGkgPCB0b3VjaGVzLmxlbmd0aDsgaSsrICkge1xuXHQgICAgdmFyIHRvdWNoID0gdG91Y2hlc1tpXTtcblx0ICAgIGlmICggdG91Y2guaWRlbnRpZmllciA9PSB0aGlzLnBvaW50ZXJJZGVudGlmaWVyICkge1xuXHQgICAgICByZXR1cm4gdG91Y2g7XG5cdCAgICB9XG5cdCAgfVxuXHR9O1xuXHRcblx0Ly8gLS0tLS0gc3RhcnQgZXZlbnQgLS0tLS0gLy9cblx0XG5cdHByb3RvLm9ubW91c2Vkb3duID0gZnVuY3Rpb24oIGV2ZW50ICkge1xuXHQgIC8vIGRpc21pc3MgY2xpY2tzIGZyb20gcmlnaHQgb3IgbWlkZGxlIGJ1dHRvbnNcblx0ICB2YXIgYnV0dG9uID0gZXZlbnQuYnV0dG9uO1xuXHQgIGlmICggYnV0dG9uICYmICggYnV0dG9uICE9PSAwICYmIGJ1dHRvbiAhPT0gMSApICkge1xuXHQgICAgcmV0dXJuO1xuXHQgIH1cblx0ICB0aGlzLl9wb2ludGVyRG93biggZXZlbnQsIGV2ZW50ICk7XG5cdH07XG5cdFxuXHRwcm90by5vbnRvdWNoc3RhcnQgPSBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdCAgdGhpcy5fcG9pbnRlckRvd24oIGV2ZW50LCBldmVudC5jaGFuZ2VkVG91Y2hlc1swXSApO1xuXHR9O1xuXHRcblx0cHJvdG8ub25NU1BvaW50ZXJEb3duID1cblx0cHJvdG8ub25wb2ludGVyZG93biA9IGZ1bmN0aW9uKCBldmVudCApIHtcblx0ICB0aGlzLl9wb2ludGVyRG93biggZXZlbnQsIGV2ZW50ICk7XG5cdH07XG5cdFxuXHQvKipcblx0ICogcG9pbnRlciBzdGFydFxuXHQgKiBAcGFyYW0ge0V2ZW50fSBldmVudFxuXHQgKiBAcGFyYW0ge0V2ZW50IG9yIFRvdWNofSBwb2ludGVyXG5cdCAqL1xuXHRwcm90by5fcG9pbnRlckRvd24gPSBmdW5jdGlvbiggZXZlbnQsIHBvaW50ZXIgKSB7XG5cdCAgLy8gZGlzbWlzcyBvdGhlciBwb2ludGVyc1xuXHQgIGlmICggdGhpcy5pc1BvaW50ZXJEb3duICkge1xuXHQgICAgcmV0dXJuO1xuXHQgIH1cblx0XG5cdCAgdGhpcy5pc1BvaW50ZXJEb3duID0gdHJ1ZTtcblx0ICAvLyBzYXZlIHBvaW50ZXIgaWRlbnRpZmllciB0byBtYXRjaCB1cCB0b3VjaCBldmVudHNcblx0ICB0aGlzLnBvaW50ZXJJZGVudGlmaWVyID0gcG9pbnRlci5wb2ludGVySWQgIT09IHVuZGVmaW5lZCA/XG5cdCAgICAvLyBwb2ludGVySWQgZm9yIHBvaW50ZXIgZXZlbnRzLCB0b3VjaC5pbmRlbnRpZmllciBmb3IgdG91Y2ggZXZlbnRzXG5cdCAgICBwb2ludGVyLnBvaW50ZXJJZCA6IHBvaW50ZXIuaWRlbnRpZmllcjtcblx0XG5cdCAgdGhpcy5wb2ludGVyRG93biggZXZlbnQsIHBvaW50ZXIgKTtcblx0fTtcblx0XG5cdHByb3RvLnBvaW50ZXJEb3duID0gZnVuY3Rpb24oIGV2ZW50LCBwb2ludGVyICkge1xuXHQgIHRoaXMuX2JpbmRQb3N0U3RhcnRFdmVudHMoIGV2ZW50ICk7XG5cdCAgdGhpcy5lbWl0RXZlbnQoICdwb2ludGVyRG93bicsIFsgZXZlbnQsIHBvaW50ZXIgXSApO1xuXHR9O1xuXHRcblx0Ly8gaGFzaCBvZiBldmVudHMgdG8gYmUgYm91bmQgYWZ0ZXIgc3RhcnQgZXZlbnRcblx0dmFyIHBvc3RTdGFydEV2ZW50cyA9IHtcblx0ICBtb3VzZWRvd246IFsgJ21vdXNlbW92ZScsICdtb3VzZXVwJyBdLFxuXHQgIHRvdWNoc3RhcnQ6IFsgJ3RvdWNobW92ZScsICd0b3VjaGVuZCcsICd0b3VjaGNhbmNlbCcgXSxcblx0ICBwb2ludGVyZG93bjogWyAncG9pbnRlcm1vdmUnLCAncG9pbnRlcnVwJywgJ3BvaW50ZXJjYW5jZWwnIF0sXG5cdCAgTVNQb2ludGVyRG93bjogWyAnTVNQb2ludGVyTW92ZScsICdNU1BvaW50ZXJVcCcsICdNU1BvaW50ZXJDYW5jZWwnIF1cblx0fTtcblx0XG5cdHByb3RvLl9iaW5kUG9zdFN0YXJ0RXZlbnRzID0gZnVuY3Rpb24oIGV2ZW50ICkge1xuXHQgIGlmICggIWV2ZW50ICkge1xuXHQgICAgcmV0dXJuO1xuXHQgIH1cblx0ICAvLyBnZXQgcHJvcGVyIGV2ZW50cyB0byBtYXRjaCBzdGFydCBldmVudFxuXHQgIHZhciBldmVudHMgPSBwb3N0U3RhcnRFdmVudHNbIGV2ZW50LnR5cGUgXTtcblx0ICAvLyBiaW5kIGV2ZW50cyB0byBub2RlXG5cdCAgZXZlbnRzLmZvckVhY2goIGZ1bmN0aW9uKCBldmVudE5hbWUgKSB7XG5cdCAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciggZXZlbnROYW1lLCB0aGlzICk7XG5cdCAgfSwgdGhpcyApO1xuXHQgIC8vIHNhdmUgdGhlc2UgYXJndW1lbnRzXG5cdCAgdGhpcy5fYm91bmRQb2ludGVyRXZlbnRzID0gZXZlbnRzO1xuXHR9O1xuXHRcblx0cHJvdG8uX3VuYmluZFBvc3RTdGFydEV2ZW50cyA9IGZ1bmN0aW9uKCkge1xuXHQgIC8vIGNoZWNrIGZvciBfYm91bmRFdmVudHMsIGluIGNhc2UgZHJhZ0VuZCB0cmlnZ2VyZWQgdHdpY2UgKG9sZCBJRTggYnVnKVxuXHQgIGlmICggIXRoaXMuX2JvdW5kUG9pbnRlckV2ZW50cyApIHtcblx0ICAgIHJldHVybjtcblx0ICB9XG5cdCAgdGhpcy5fYm91bmRQb2ludGVyRXZlbnRzLmZvckVhY2goIGZ1bmN0aW9uKCBldmVudE5hbWUgKSB7XG5cdCAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lciggZXZlbnROYW1lLCB0aGlzICk7XG5cdCAgfSwgdGhpcyApO1xuXHRcblx0ICBkZWxldGUgdGhpcy5fYm91bmRQb2ludGVyRXZlbnRzO1xuXHR9O1xuXHRcblx0Ly8gLS0tLS0gbW92ZSBldmVudCAtLS0tLSAvL1xuXHRcblx0cHJvdG8ub25tb3VzZW1vdmUgPSBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdCAgdGhpcy5fcG9pbnRlck1vdmUoIGV2ZW50LCBldmVudCApO1xuXHR9O1xuXHRcblx0cHJvdG8ub25NU1BvaW50ZXJNb3ZlID1cblx0cHJvdG8ub25wb2ludGVybW92ZSA9IGZ1bmN0aW9uKCBldmVudCApIHtcblx0ICBpZiAoIGV2ZW50LnBvaW50ZXJJZCA9PSB0aGlzLnBvaW50ZXJJZGVudGlmaWVyICkge1xuXHQgICAgdGhpcy5fcG9pbnRlck1vdmUoIGV2ZW50LCBldmVudCApO1xuXHQgIH1cblx0fTtcblx0XG5cdHByb3RvLm9udG91Y2htb3ZlID0gZnVuY3Rpb24oIGV2ZW50ICkge1xuXHQgIHZhciB0b3VjaCA9IHRoaXMuZ2V0VG91Y2goIGV2ZW50LmNoYW5nZWRUb3VjaGVzICk7XG5cdCAgaWYgKCB0b3VjaCApIHtcblx0ICAgIHRoaXMuX3BvaW50ZXJNb3ZlKCBldmVudCwgdG91Y2ggKTtcblx0ICB9XG5cdH07XG5cdFxuXHQvKipcblx0ICogcG9pbnRlciBtb3ZlXG5cdCAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50XG5cdCAqIEBwYXJhbSB7RXZlbnQgb3IgVG91Y2h9IHBvaW50ZXJcblx0ICogQHByaXZhdGVcblx0ICovXG5cdHByb3RvLl9wb2ludGVyTW92ZSA9IGZ1bmN0aW9uKCBldmVudCwgcG9pbnRlciApIHtcblx0ICB0aGlzLnBvaW50ZXJNb3ZlKCBldmVudCwgcG9pbnRlciApO1xuXHR9O1xuXHRcblx0Ly8gcHVibGljXG5cdHByb3RvLnBvaW50ZXJNb3ZlID0gZnVuY3Rpb24oIGV2ZW50LCBwb2ludGVyICkge1xuXHQgIHRoaXMuZW1pdEV2ZW50KCAncG9pbnRlck1vdmUnLCBbIGV2ZW50LCBwb2ludGVyIF0gKTtcblx0fTtcblx0XG5cdC8vIC0tLS0tIGVuZCBldmVudCAtLS0tLSAvL1xuXHRcblx0XG5cdHByb3RvLm9ubW91c2V1cCA9IGZ1bmN0aW9uKCBldmVudCApIHtcblx0ICB0aGlzLl9wb2ludGVyVXAoIGV2ZW50LCBldmVudCApO1xuXHR9O1xuXHRcblx0cHJvdG8ub25NU1BvaW50ZXJVcCA9XG5cdHByb3RvLm9ucG9pbnRlcnVwID0gZnVuY3Rpb24oIGV2ZW50ICkge1xuXHQgIGlmICggZXZlbnQucG9pbnRlcklkID09IHRoaXMucG9pbnRlcklkZW50aWZpZXIgKSB7XG5cdCAgICB0aGlzLl9wb2ludGVyVXAoIGV2ZW50LCBldmVudCApO1xuXHQgIH1cblx0fTtcblx0XG5cdHByb3RvLm9udG91Y2hlbmQgPSBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdCAgdmFyIHRvdWNoID0gdGhpcy5nZXRUb3VjaCggZXZlbnQuY2hhbmdlZFRvdWNoZXMgKTtcblx0ICBpZiAoIHRvdWNoICkge1xuXHQgICAgdGhpcy5fcG9pbnRlclVwKCBldmVudCwgdG91Y2ggKTtcblx0ICB9XG5cdH07XG5cdFxuXHQvKipcblx0ICogcG9pbnRlciB1cFxuXHQgKiBAcGFyYW0ge0V2ZW50fSBldmVudFxuXHQgKiBAcGFyYW0ge0V2ZW50IG9yIFRvdWNofSBwb2ludGVyXG5cdCAqIEBwcml2YXRlXG5cdCAqL1xuXHRwcm90by5fcG9pbnRlclVwID0gZnVuY3Rpb24oIGV2ZW50LCBwb2ludGVyICkge1xuXHQgIHRoaXMuX3BvaW50ZXJEb25lKCk7XG5cdCAgdGhpcy5wb2ludGVyVXAoIGV2ZW50LCBwb2ludGVyICk7XG5cdH07XG5cdFxuXHQvLyBwdWJsaWNcblx0cHJvdG8ucG9pbnRlclVwID0gZnVuY3Rpb24oIGV2ZW50LCBwb2ludGVyICkge1xuXHQgIHRoaXMuZW1pdEV2ZW50KCAncG9pbnRlclVwJywgWyBldmVudCwgcG9pbnRlciBdICk7XG5cdH07XG5cdFxuXHQvLyAtLS0tLSBwb2ludGVyIGRvbmUgLS0tLS0gLy9cblx0XG5cdC8vIHRyaWdnZXJlZCBvbiBwb2ludGVyIHVwICYgcG9pbnRlciBjYW5jZWxcblx0cHJvdG8uX3BvaW50ZXJEb25lID0gZnVuY3Rpb24oKSB7XG5cdCAgLy8gcmVzZXQgcHJvcGVydGllc1xuXHQgIHRoaXMuaXNQb2ludGVyRG93biA9IGZhbHNlO1xuXHQgIGRlbGV0ZSB0aGlzLnBvaW50ZXJJZGVudGlmaWVyO1xuXHQgIC8vIHJlbW92ZSBldmVudHNcblx0ICB0aGlzLl91bmJpbmRQb3N0U3RhcnRFdmVudHMoKTtcblx0ICB0aGlzLnBvaW50ZXJEb25lKCk7XG5cdH07XG5cdFxuXHRwcm90by5wb2ludGVyRG9uZSA9IG5vb3A7XG5cdFxuXHQvLyAtLS0tLSBwb2ludGVyIGNhbmNlbCAtLS0tLSAvL1xuXHRcblx0cHJvdG8ub25NU1BvaW50ZXJDYW5jZWwgPVxuXHRwcm90by5vbnBvaW50ZXJjYW5jZWwgPSBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdCAgaWYgKCBldmVudC5wb2ludGVySWQgPT0gdGhpcy5wb2ludGVySWRlbnRpZmllciApIHtcblx0ICAgIHRoaXMuX3BvaW50ZXJDYW5jZWwoIGV2ZW50LCBldmVudCApO1xuXHQgIH1cblx0fTtcblx0XG5cdHByb3RvLm9udG91Y2hjYW5jZWwgPSBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdCAgdmFyIHRvdWNoID0gdGhpcy5nZXRUb3VjaCggZXZlbnQuY2hhbmdlZFRvdWNoZXMgKTtcblx0ICBpZiAoIHRvdWNoICkge1xuXHQgICAgdGhpcy5fcG9pbnRlckNhbmNlbCggZXZlbnQsIHRvdWNoICk7XG5cdCAgfVxuXHR9O1xuXHRcblx0LyoqXG5cdCAqIHBvaW50ZXIgY2FuY2VsXG5cdCAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50XG5cdCAqIEBwYXJhbSB7RXZlbnQgb3IgVG91Y2h9IHBvaW50ZXJcblx0ICogQHByaXZhdGVcblx0ICovXG5cdHByb3RvLl9wb2ludGVyQ2FuY2VsID0gZnVuY3Rpb24oIGV2ZW50LCBwb2ludGVyICkge1xuXHQgIHRoaXMuX3BvaW50ZXJEb25lKCk7XG5cdCAgdGhpcy5wb2ludGVyQ2FuY2VsKCBldmVudCwgcG9pbnRlciApO1xuXHR9O1xuXHRcblx0Ly8gcHVibGljXG5cdHByb3RvLnBvaW50ZXJDYW5jZWwgPSBmdW5jdGlvbiggZXZlbnQsIHBvaW50ZXIgKSB7XG5cdCAgdGhpcy5lbWl0RXZlbnQoICdwb2ludGVyQ2FuY2VsJywgWyBldmVudCwgcG9pbnRlciBdICk7XG5cdH07XG5cdFxuXHQvLyAtLS0tLSAgLS0tLS0gLy9cblx0XG5cdC8vIHV0aWxpdHkgZnVuY3Rpb24gZm9yIGdldHRpbmcgeC95IGNvb3JkcyBmcm9tIGV2ZW50XG5cdFVuaXBvaW50ZXIuZ2V0UG9pbnRlclBvaW50ID0gZnVuY3Rpb24oIHBvaW50ZXIgKSB7XG5cdCAgcmV0dXJuIHtcblx0ICAgIHg6IHBvaW50ZXIucGFnZVgsXG5cdCAgICB5OiBwb2ludGVyLnBhZ2VZXG5cdCAgfTtcblx0fTtcblx0XG5cdC8vIC0tLS0tICAtLS0tLSAvL1xuXHRcblx0cmV0dXJuIFVuaXBvaW50ZXI7XG5cdFxuXHR9KSk7XG5cblxuLyoqKi8gfSxcbi8qIDE1ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHR2YXIgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXywgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX187Ly8gcHJldi9uZXh0IGJ1dHRvbnNcblx0KCBmdW5jdGlvbiggd2luZG93LCBmYWN0b3J5ICkge1xuXHQgIC8vIHVuaXZlcnNhbCBtb2R1bGUgZGVmaW5pdGlvblxuXHQgIC8qIGpzaGludCBzdHJpY3Q6IGZhbHNlICovXG5cdCAgaWYgKCB0cnVlICkge1xuXHQgICAgLy8gQU1EXG5cdCAgICAhKF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18gPSBbXG5cdCAgICAgIF9fd2VicGFja19yZXF1aXJlX18oNCksXG5cdCAgICAgIF9fd2VicGFja19yZXF1aXJlX18oMTYpLFxuXHQgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpXG5cdCAgICBdLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyA9IGZ1bmN0aW9uKCBGbGlja2l0eSwgVGFwTGlzdGVuZXIsIHV0aWxzICkge1xuXHQgICAgICByZXR1cm4gZmFjdG9yeSggd2luZG93LCBGbGlja2l0eSwgVGFwTGlzdGVuZXIsIHV0aWxzICk7XG5cdCAgICB9LmFwcGx5KGV4cG9ydHMsIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18pLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyAhPT0gdW5kZWZpbmVkICYmIChtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fKSk7XG5cdCAgfSBlbHNlIGlmICggdHlwZW9mIG1vZHVsZSA9PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cyApIHtcblx0ICAgIC8vIENvbW1vbkpTXG5cdCAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoXG5cdCAgICAgIHdpbmRvdyxcblx0ICAgICAgcmVxdWlyZSgnLi9mbGlja2l0eScpLFxuXHQgICAgICByZXF1aXJlKCd0YXAtbGlzdGVuZXInKSxcblx0ICAgICAgcmVxdWlyZSgnZml6enktdWktdXRpbHMnKVxuXHQgICAgKTtcblx0ICB9IGVsc2Uge1xuXHQgICAgLy8gYnJvd3NlciBnbG9iYWxcblx0ICAgIGZhY3RvcnkoXG5cdCAgICAgIHdpbmRvdyxcblx0ICAgICAgd2luZG93LkZsaWNraXR5LFxuXHQgICAgICB3aW5kb3cuVGFwTGlzdGVuZXIsXG5cdCAgICAgIHdpbmRvdy5maXp6eVVJVXRpbHNcblx0ICAgICk7XG5cdCAgfVxuXHRcblx0fSggd2luZG93LCBmdW5jdGlvbiBmYWN0b3J5KCB3aW5kb3csIEZsaWNraXR5LCBUYXBMaXN0ZW5lciwgdXRpbHMgKSB7XG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdHZhciBzdmdVUkkgPSAnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnO1xuXHRcblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gUHJldk5leHRCdXR0b24gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cblx0XG5cdGZ1bmN0aW9uIFByZXZOZXh0QnV0dG9uKCBkaXJlY3Rpb24sIHBhcmVudCApIHtcblx0ICB0aGlzLmRpcmVjdGlvbiA9IGRpcmVjdGlvbjtcblx0ICB0aGlzLnBhcmVudCA9IHBhcmVudDtcblx0ICB0aGlzLl9jcmVhdGUoKTtcblx0fVxuXHRcblx0UHJldk5leHRCdXR0b24ucHJvdG90eXBlID0gbmV3IFRhcExpc3RlbmVyKCk7XG5cdFxuXHRQcmV2TmV4dEJ1dHRvbi5wcm90b3R5cGUuX2NyZWF0ZSA9IGZ1bmN0aW9uKCkge1xuXHQgIC8vIHByb3BlcnRpZXNcblx0ICB0aGlzLmlzRW5hYmxlZCA9IHRydWU7XG5cdCAgdGhpcy5pc1ByZXZpb3VzID0gdGhpcy5kaXJlY3Rpb24gPT0gLTE7XG5cdCAgdmFyIGxlZnREaXJlY3Rpb24gPSB0aGlzLnBhcmVudC5vcHRpb25zLnJpZ2h0VG9MZWZ0ID8gMSA6IC0xO1xuXHQgIHRoaXMuaXNMZWZ0ID0gdGhpcy5kaXJlY3Rpb24gPT0gbGVmdERpcmVjdGlvbjtcblx0XG5cdCAgdmFyIGVsZW1lbnQgPSB0aGlzLmVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcblx0ICBlbGVtZW50LmNsYXNzTmFtZSA9ICdmbGlja2l0eS1wcmV2LW5leHQtYnV0dG9uJztcblx0ICBlbGVtZW50LmNsYXNzTmFtZSArPSB0aGlzLmlzUHJldmlvdXMgPyAnIHByZXZpb3VzJyA6ICcgbmV4dCc7XG5cdCAgLy8gcHJldmVudCBidXR0b24gZnJvbSBzdWJtaXR0aW5nIGZvcm0gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMTA4MzYwNzYvMTgyMTgzXG5cdCAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoICd0eXBlJywgJ2J1dHRvbicgKTtcblx0ICAvLyBpbml0IGFzIGRpc2FibGVkXG5cdCAgdGhpcy5kaXNhYmxlKCk7XG5cdFxuXHQgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCAnYXJpYS1sYWJlbCcsIHRoaXMuaXNQcmV2aW91cyA/ICdwcmV2aW91cycgOiAnbmV4dCcgKTtcblx0XG5cdCAgLy8gY3JlYXRlIGFycm93XG5cdCAgdmFyIHN2ZyA9IHRoaXMuY3JlYXRlU1ZHKCk7XG5cdCAgZWxlbWVudC5hcHBlbmRDaGlsZCggc3ZnICk7XG5cdCAgLy8gdXBkYXRlIG9uIHNlbGVjdFxuXHQgIHRoaXMucGFyZW50Lm9uKCAnc2VsZWN0JywgZnVuY3Rpb24oKSB7XG5cdCAgICB0aGlzLnVwZGF0ZSgpO1xuXHQgIH0uYmluZCggdGhpcyApKTtcblx0ICAvLyB0YXBcblx0ICB0aGlzLm9uKCAndGFwJywgdGhpcy5vblRhcCApO1xuXHQgIC8vIHBvaW50ZXJEb3duXG5cdCAgdGhpcy5vbiggJ3BvaW50ZXJEb3duJywgZnVuY3Rpb24gb25Qb2ludGVyRG93biggYnV0dG9uLCBldmVudCApIHtcblx0ICAgIHRoaXMucGFyZW50LmNoaWxkVUlQb2ludGVyRG93biggZXZlbnQgKTtcblx0ICB9LmJpbmQoIHRoaXMgKSk7XG5cdH07XG5cdFxuXHRQcmV2TmV4dEJ1dHRvbi5wcm90b3R5cGUuYWN0aXZhdGUgPSBmdW5jdGlvbigpIHtcblx0ICB0aGlzLmJpbmRUYXAoIHRoaXMuZWxlbWVudCApO1xuXHQgIC8vIGNsaWNrIGV2ZW50cyBmcm9tIGtleWJvYXJkXG5cdCAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoICdjbGljaycsIHRoaXMgKTtcblx0ICAvLyBhZGQgdG8gRE9NXG5cdCAgdGhpcy5wYXJlbnQuZWxlbWVudC5hcHBlbmRDaGlsZCggdGhpcy5lbGVtZW50ICk7XG5cdH07XG5cdFxuXHRQcmV2TmV4dEJ1dHRvbi5wcm90b3R5cGUuZGVhY3RpdmF0ZSA9IGZ1bmN0aW9uKCkge1xuXHQgIC8vIHJlbW92ZSBmcm9tIERPTVxuXHQgIHRoaXMucGFyZW50LmVsZW1lbnQucmVtb3ZlQ2hpbGQoIHRoaXMuZWxlbWVudCApO1xuXHQgIC8vIGRvIHJlZ3VsYXIgVGFwTGlzdGVuZXIgZGVzdHJveVxuXHQgIFRhcExpc3RlbmVyLnByb3RvdHlwZS5kZXN0cm95LmNhbGwoIHRoaXMgKTtcblx0ICAvLyBjbGljayBldmVudHMgZnJvbSBrZXlib2FyZFxuXHQgIHRoaXMuZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAnY2xpY2snLCB0aGlzICk7XG5cdH07XG5cdFxuXHRQcmV2TmV4dEJ1dHRvbi5wcm90b3R5cGUuY3JlYXRlU1ZHID0gZnVuY3Rpb24oKSB7XG5cdCAgdmFyIHN2ZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyggc3ZnVVJJLCAnc3ZnJyk7XG5cdCAgc3ZnLnNldEF0dHJpYnV0ZSggJ3ZpZXdCb3gnLCAnMCAwIDEwMCAxMDAnICk7XG5cdCAgdmFyIHBhdGggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoIHN2Z1VSSSwgJ3BhdGgnKTtcblx0ICB2YXIgcGF0aE1vdmVtZW50cyA9IGdldEFycm93TW92ZW1lbnRzKCB0aGlzLnBhcmVudC5vcHRpb25zLmFycm93U2hhcGUgKTtcblx0ICBwYXRoLnNldEF0dHJpYnV0ZSggJ2QnLCBwYXRoTW92ZW1lbnRzICk7XG5cdCAgcGF0aC5zZXRBdHRyaWJ1dGUoICdjbGFzcycsICdhcnJvdycgKTtcblx0ICAvLyByb3RhdGUgYXJyb3dcblx0ICBpZiAoICF0aGlzLmlzTGVmdCApIHtcblx0ICAgIHBhdGguc2V0QXR0cmlidXRlKCAndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZSgxMDAsIDEwMCkgcm90YXRlKDE4MCkgJyApO1xuXHQgIH1cblx0ICBzdmcuYXBwZW5kQ2hpbGQoIHBhdGggKTtcblx0ICByZXR1cm4gc3ZnO1xuXHR9O1xuXHRcblx0Ly8gZ2V0IFNWRyBwYXRoIG1vdm1lbWVudFxuXHRmdW5jdGlvbiBnZXRBcnJvd01vdmVtZW50cyggc2hhcGUgKSB7XG5cdCAgLy8gdXNlIHNoYXBlIGFzIG1vdmVtZW50IGlmIHN0cmluZ1xuXHQgIGlmICggdHlwZW9mIHNoYXBlID09ICdzdHJpbmcnICkge1xuXHQgICAgcmV0dXJuIHNoYXBlO1xuXHQgIH1cblx0ICAvLyBjcmVhdGUgbW92ZW1lbnQgc3RyaW5nXG5cdCAgcmV0dXJuICdNICcgKyBzaGFwZS54MCArICcsNTAnICtcblx0ICAgICcgTCAnICsgc2hhcGUueDEgKyAnLCcgKyAoIHNoYXBlLnkxICsgNTAgKSArXG5cdCAgICAnIEwgJyArIHNoYXBlLngyICsgJywnICsgKCBzaGFwZS55MiArIDUwICkgK1xuXHQgICAgJyBMICcgKyBzaGFwZS54MyArICcsNTAgJyArXG5cdCAgICAnIEwgJyArIHNoYXBlLngyICsgJywnICsgKCA1MCAtIHNoYXBlLnkyICkgK1xuXHQgICAgJyBMICcgKyBzaGFwZS54MSArICcsJyArICggNTAgLSBzaGFwZS55MSApICtcblx0ICAgICcgWic7XG5cdH1cblx0XG5cdFByZXZOZXh0QnV0dG9uLnByb3RvdHlwZS5vblRhcCA9IGZ1bmN0aW9uKCkge1xuXHQgIGlmICggIXRoaXMuaXNFbmFibGVkICkge1xuXHQgICAgcmV0dXJuO1xuXHQgIH1cblx0ICB0aGlzLnBhcmVudC51aUNoYW5nZSgpO1xuXHQgIHZhciBtZXRob2QgPSB0aGlzLmlzUHJldmlvdXMgPyAncHJldmlvdXMnIDogJ25leHQnO1xuXHQgIHRoaXMucGFyZW50WyBtZXRob2QgXSgpO1xuXHR9O1xuXHRcblx0UHJldk5leHRCdXR0b24ucHJvdG90eXBlLmhhbmRsZUV2ZW50ID0gdXRpbHMuaGFuZGxlRXZlbnQ7XG5cdFxuXHRQcmV2TmV4dEJ1dHRvbi5wcm90b3R5cGUub25jbGljayA9IGZ1bmN0aW9uKCkge1xuXHQgIC8vIG9ubHkgYWxsb3cgY2xpY2tzIGZyb20ga2V5Ym9hcmRcblx0ICB2YXIgZm9jdXNlZCA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7XG5cdCAgaWYgKCBmb2N1c2VkICYmIGZvY3VzZWQgPT0gdGhpcy5lbGVtZW50ICkge1xuXHQgICAgdGhpcy5vblRhcCgpO1xuXHQgIH1cblx0fTtcblx0XG5cdC8vIC0tLS0tICAtLS0tLSAvL1xuXHRcblx0UHJldk5leHRCdXR0b24ucHJvdG90eXBlLmVuYWJsZSA9IGZ1bmN0aW9uKCkge1xuXHQgIGlmICggdGhpcy5pc0VuYWJsZWQgKSB7XG5cdCAgICByZXR1cm47XG5cdCAgfVxuXHQgIHRoaXMuZWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xuXHQgIHRoaXMuaXNFbmFibGVkID0gdHJ1ZTtcblx0fTtcblx0XG5cdFByZXZOZXh0QnV0dG9uLnByb3RvdHlwZS5kaXNhYmxlID0gZnVuY3Rpb24oKSB7XG5cdCAgaWYgKCAhdGhpcy5pc0VuYWJsZWQgKSB7XG5cdCAgICByZXR1cm47XG5cdCAgfVxuXHQgIHRoaXMuZWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XG5cdCAgdGhpcy5pc0VuYWJsZWQgPSBmYWxzZTtcblx0fTtcblx0XG5cdFByZXZOZXh0QnV0dG9uLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHtcblx0ICAvLyBpbmRleCBvZiBmaXJzdCBvciBsYXN0IHNsaWRlLCBpZiBwcmV2aW91cyBvciBuZXh0XG5cdCAgdmFyIHNsaWRlcyA9IHRoaXMucGFyZW50LnNsaWRlcztcblx0ICAvLyBlbmFibGUgaXMgd3JhcEFyb3VuZCBhbmQgYXQgbGVhc3QgMiBzbGlkZXNcblx0ICBpZiAoIHRoaXMucGFyZW50Lm9wdGlvbnMud3JhcEFyb3VuZCAmJiBzbGlkZXMubGVuZ3RoID4gMSApIHtcblx0ICAgIHRoaXMuZW5hYmxlKCk7XG5cdCAgICByZXR1cm47XG5cdCAgfVxuXHQgIHZhciBsYXN0SW5kZXggPSBzbGlkZXMubGVuZ3RoID8gc2xpZGVzLmxlbmd0aCAtIDEgOiAwO1xuXHQgIHZhciBib3VuZEluZGV4ID0gdGhpcy5pc1ByZXZpb3VzID8gMCA6IGxhc3RJbmRleDtcblx0ICB2YXIgbWV0aG9kID0gdGhpcy5wYXJlbnQuc2VsZWN0ZWRJbmRleCA9PSBib3VuZEluZGV4ID8gJ2Rpc2FibGUnIDogJ2VuYWJsZSc7XG5cdCAgdGhpc1sgbWV0aG9kIF0oKTtcblx0fTtcblx0XG5cdFByZXZOZXh0QnV0dG9uLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24oKSB7XG5cdCAgdGhpcy5kZWFjdGl2YXRlKCk7XG5cdH07XG5cdFxuXHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBGbGlja2l0eSBwcm90b3R5cGUgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cblx0XG5cdHV0aWxzLmV4dGVuZCggRmxpY2tpdHkuZGVmYXVsdHMsIHtcblx0ICBwcmV2TmV4dEJ1dHRvbnM6IHRydWUsXG5cdCAgYXJyb3dTaGFwZToge1xuXHQgICAgeDA6IDEwLFxuXHQgICAgeDE6IDYwLCB5MTogNTAsXG5cdCAgICB4MjogNzAsIHkyOiA0MCxcblx0ICAgIHgzOiAzMFxuXHQgIH1cblx0fSk7XG5cdFxuXHRGbGlja2l0eS5jcmVhdGVNZXRob2RzLnB1c2goJ19jcmVhdGVQcmV2TmV4dEJ1dHRvbnMnKTtcblx0dmFyIHByb3RvID0gRmxpY2tpdHkucHJvdG90eXBlO1xuXHRcblx0cHJvdG8uX2NyZWF0ZVByZXZOZXh0QnV0dG9ucyA9IGZ1bmN0aW9uKCkge1xuXHQgIGlmICggIXRoaXMub3B0aW9ucy5wcmV2TmV4dEJ1dHRvbnMgKSB7XG5cdCAgICByZXR1cm47XG5cdCAgfVxuXHRcblx0ICB0aGlzLnByZXZCdXR0b24gPSBuZXcgUHJldk5leHRCdXR0b24oIC0xLCB0aGlzICk7XG5cdCAgdGhpcy5uZXh0QnV0dG9uID0gbmV3IFByZXZOZXh0QnV0dG9uKCAxLCB0aGlzICk7XG5cdFxuXHQgIHRoaXMub24oICdhY3RpdmF0ZScsIHRoaXMuYWN0aXZhdGVQcmV2TmV4dEJ1dHRvbnMgKTtcblx0fTtcblx0XG5cdHByb3RvLmFjdGl2YXRlUHJldk5leHRCdXR0b25zID0gZnVuY3Rpb24oKSB7XG5cdCAgdGhpcy5wcmV2QnV0dG9uLmFjdGl2YXRlKCk7XG5cdCAgdGhpcy5uZXh0QnV0dG9uLmFjdGl2YXRlKCk7XG5cdCAgdGhpcy5vbiggJ2RlYWN0aXZhdGUnLCB0aGlzLmRlYWN0aXZhdGVQcmV2TmV4dEJ1dHRvbnMgKTtcblx0fTtcblx0XG5cdHByb3RvLmRlYWN0aXZhdGVQcmV2TmV4dEJ1dHRvbnMgPSBmdW5jdGlvbigpIHtcblx0ICB0aGlzLnByZXZCdXR0b24uZGVhY3RpdmF0ZSgpO1xuXHQgIHRoaXMubmV4dEJ1dHRvbi5kZWFjdGl2YXRlKCk7XG5cdCAgdGhpcy5vZmYoICdkZWFjdGl2YXRlJywgdGhpcy5kZWFjdGl2YXRlUHJldk5leHRCdXR0b25zICk7XG5cdH07XG5cdFxuXHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cblx0XG5cdEZsaWNraXR5LlByZXZOZXh0QnV0dG9uID0gUHJldk5leHRCdXR0b247XG5cdFxuXHRyZXR1cm4gRmxpY2tpdHk7XG5cdFxuXHR9KSk7XG5cblxuLyoqKi8gfSxcbi8qIDE2ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHR2YXIgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXywgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX187LyohXG5cdCAqIFRhcCBsaXN0ZW5lciB2Mi4wLjBcblx0ICogbGlzdGVucyB0byB0YXBzXG5cdCAqIE1JVCBsaWNlbnNlXG5cdCAqL1xuXHRcblx0Lypqc2hpbnQgYnJvd3NlcjogdHJ1ZSwgdW51c2VkOiB0cnVlLCB1bmRlZjogdHJ1ZSwgc3RyaWN0OiB0cnVlICovXG5cdFxuXHQoIGZ1bmN0aW9uKCB3aW5kb3csIGZhY3RvcnkgKSB7XG5cdCAgLy8gdW5pdmVyc2FsIG1vZHVsZSBkZWZpbml0aW9uXG5cdCAgLypqc2hpbnQgc3RyaWN0OiBmYWxzZSovIC8qZ2xvYmFscyBkZWZpbmUsIG1vZHVsZSwgcmVxdWlyZSAqL1xuXHRcblx0ICBpZiAoIHRydWUgKSB7XG5cdCAgICAvLyBBTURcblx0ICAgICEoX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXyA9IFtcblx0ICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxNClcblx0ICAgIF0sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fID0gZnVuY3Rpb24oIFVuaXBvaW50ZXIgKSB7XG5cdCAgICAgIHJldHVybiBmYWN0b3J5KCB3aW5kb3csIFVuaXBvaW50ZXIgKTtcblx0ICAgIH0uYXBwbHkoZXhwb3J0cywgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXyksIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fICE9PSB1bmRlZmluZWQgJiYgKG1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18pKTtcblx0ICB9IGVsc2UgaWYgKCB0eXBlb2YgbW9kdWxlID09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzICkge1xuXHQgICAgLy8gQ29tbW9uSlNcblx0ICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShcblx0ICAgICAgd2luZG93LFxuXHQgICAgICByZXF1aXJlKCd1bmlwb2ludGVyJylcblx0ICAgICk7XG5cdCAgfSBlbHNlIHtcblx0ICAgIC8vIGJyb3dzZXIgZ2xvYmFsXG5cdCAgICB3aW5kb3cuVGFwTGlzdGVuZXIgPSBmYWN0b3J5KFxuXHQgICAgICB3aW5kb3csXG5cdCAgICAgIHdpbmRvdy5Vbmlwb2ludGVyXG5cdCAgICApO1xuXHQgIH1cblx0XG5cdH0oIHdpbmRvdywgZnVuY3Rpb24gZmFjdG9yeSggd2luZG93LCBVbmlwb2ludGVyICkge1xuXHRcblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gIFRhcExpc3RlbmVyIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vXG5cdFxuXHRmdW5jdGlvbiBUYXBMaXN0ZW5lciggZWxlbSApIHtcblx0ICB0aGlzLmJpbmRUYXAoIGVsZW0gKTtcblx0fVxuXHRcblx0Ly8gaW5oZXJpdCBVbmlwb2ludGVyICYgRXZlbnRFbWl0dGVyXG5cdHZhciBwcm90byA9IFRhcExpc3RlbmVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoIFVuaXBvaW50ZXIucHJvdG90eXBlICk7XG5cdFxuXHQvKipcblx0ICogYmluZCB0YXAgZXZlbnQgdG8gZWxlbWVudFxuXHQgKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1cblx0ICovXG5cdHByb3RvLmJpbmRUYXAgPSBmdW5jdGlvbiggZWxlbSApIHtcblx0ICBpZiAoICFlbGVtICkge1xuXHQgICAgcmV0dXJuO1xuXHQgIH1cblx0ICB0aGlzLnVuYmluZFRhcCgpO1xuXHQgIHRoaXMudGFwRWxlbWVudCA9IGVsZW07XG5cdCAgdGhpcy5fYmluZFN0YXJ0RXZlbnQoIGVsZW0sIHRydWUgKTtcblx0fTtcblx0XG5cdHByb3RvLnVuYmluZFRhcCA9IGZ1bmN0aW9uKCkge1xuXHQgIGlmICggIXRoaXMudGFwRWxlbWVudCApIHtcblx0ICAgIHJldHVybjtcblx0ICB9XG5cdCAgdGhpcy5fYmluZFN0YXJ0RXZlbnQoIHRoaXMudGFwRWxlbWVudCwgdHJ1ZSApO1xuXHQgIGRlbGV0ZSB0aGlzLnRhcEVsZW1lbnQ7XG5cdH07XG5cdFxuXHQvKipcblx0ICogcG9pbnRlciB1cFxuXHQgKiBAcGFyYW0ge0V2ZW50fSBldmVudFxuXHQgKiBAcGFyYW0ge0V2ZW50IG9yIFRvdWNofSBwb2ludGVyXG5cdCAqL1xuXHRwcm90by5wb2ludGVyVXAgPSBmdW5jdGlvbiggZXZlbnQsIHBvaW50ZXIgKSB7XG5cdCAgLy8gaWdub3JlIGVtdWxhdGVkIG1vdXNlIHVwIGNsaWNrc1xuXHQgIGlmICggdGhpcy5pc0lnbm9yaW5nTW91c2VVcCAmJiBldmVudC50eXBlID09ICdtb3VzZXVwJyApIHtcblx0ICAgIHJldHVybjtcblx0ICB9XG5cdFxuXHQgIHZhciBwb2ludGVyUG9pbnQgPSBVbmlwb2ludGVyLmdldFBvaW50ZXJQb2ludCggcG9pbnRlciApO1xuXHQgIHZhciBib3VuZGluZ1JlY3QgPSB0aGlzLnRhcEVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cdCAgdmFyIHNjcm9sbFggPSB3aW5kb3cucGFnZVhPZmZzZXQ7XG5cdCAgdmFyIHNjcm9sbFkgPSB3aW5kb3cucGFnZVlPZmZzZXQ7XG5cdCAgLy8gY2FsY3VsYXRlIGlmIHBvaW50ZXIgaXMgaW5zaWRlIHRhcEVsZW1lbnRcblx0ICB2YXIgaXNJbnNpZGUgPSBwb2ludGVyUG9pbnQueCA+PSBib3VuZGluZ1JlY3QubGVmdCArIHNjcm9sbFggJiZcblx0ICAgIHBvaW50ZXJQb2ludC54IDw9IGJvdW5kaW5nUmVjdC5yaWdodCArIHNjcm9sbFggJiZcblx0ICAgIHBvaW50ZXJQb2ludC55ID49IGJvdW5kaW5nUmVjdC50b3AgKyBzY3JvbGxZICYmXG5cdCAgICBwb2ludGVyUG9pbnQueSA8PSBib3VuZGluZ1JlY3QuYm90dG9tICsgc2Nyb2xsWTtcblx0ICAvLyB0cmlnZ2VyIGNhbGxiYWNrIGlmIHBvaW50ZXIgaXMgaW5zaWRlIGVsZW1lbnRcblx0ICBpZiAoIGlzSW5zaWRlICkge1xuXHQgICAgdGhpcy5lbWl0RXZlbnQoICd0YXAnLCBbIGV2ZW50LCBwb2ludGVyIF0gKTtcblx0ICB9XG5cdFxuXHQgIC8vIHNldCBmbGFnIGZvciBlbXVsYXRlZCBjbGlja3MgMzAwbXMgYWZ0ZXIgdG91Y2hlbmRcblx0ICBpZiAoIGV2ZW50LnR5cGUgIT0gJ21vdXNldXAnICkge1xuXHQgICAgdGhpcy5pc0lnbm9yaW5nTW91c2VVcCA9IHRydWU7XG5cdCAgICAvLyByZXNldCBmbGFnIGFmdGVyIDMwMG1zXG5cdCAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXHQgICAgc2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG5cdCAgICAgIGRlbGV0ZSBfdGhpcy5pc0lnbm9yaW5nTW91c2VVcDtcblx0ICAgIH0sIDQwMCApO1xuXHQgIH1cblx0fTtcblx0XG5cdHByb3RvLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcblx0ICB0aGlzLnBvaW50ZXJEb25lKCk7XG5cdCAgdGhpcy51bmJpbmRUYXAoKTtcblx0fTtcblx0XG5cdC8vIC0tLS0tICAtLS0tLSAvL1xuXHRcblx0cmV0dXJuIFRhcExpc3RlbmVyO1xuXHRcblx0fSkpO1xuXG5cbi8qKiovIH0sXG4vKiAxNyAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0dmFyIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fOy8vIHBhZ2UgZG90c1xuXHQoIGZ1bmN0aW9uKCB3aW5kb3csIGZhY3RvcnkgKSB7XG5cdCAgLy8gdW5pdmVyc2FsIG1vZHVsZSBkZWZpbml0aW9uXG5cdCAgLyoganNoaW50IHN0cmljdDogZmFsc2UgKi9cblx0ICBpZiAoIHRydWUgKSB7XG5cdCAgICAvLyBBTURcblx0ICAgICEoX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXyA9IFtcblx0ICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg0KSxcblx0ICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxNiksXG5cdCAgICAgIF9fd2VicGFja19yZXF1aXJlX18oNylcblx0ICAgIF0sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fID0gZnVuY3Rpb24oIEZsaWNraXR5LCBUYXBMaXN0ZW5lciwgdXRpbHMgKSB7XG5cdCAgICAgIHJldHVybiBmYWN0b3J5KCB3aW5kb3csIEZsaWNraXR5LCBUYXBMaXN0ZW5lciwgdXRpbHMgKTtcblx0ICAgIH0uYXBwbHkoZXhwb3J0cywgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXyksIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fICE9PSB1bmRlZmluZWQgJiYgKG1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18pKTtcblx0ICB9IGVsc2UgaWYgKCB0eXBlb2YgbW9kdWxlID09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzICkge1xuXHQgICAgLy8gQ29tbW9uSlNcblx0ICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShcblx0ICAgICAgd2luZG93LFxuXHQgICAgICByZXF1aXJlKCcuL2ZsaWNraXR5JyksXG5cdCAgICAgIHJlcXVpcmUoJ3RhcC1saXN0ZW5lcicpLFxuXHQgICAgICByZXF1aXJlKCdmaXp6eS11aS11dGlscycpXG5cdCAgICApO1xuXHQgIH0gZWxzZSB7XG5cdCAgICAvLyBicm93c2VyIGdsb2JhbFxuXHQgICAgZmFjdG9yeShcblx0ICAgICAgd2luZG93LFxuXHQgICAgICB3aW5kb3cuRmxpY2tpdHksXG5cdCAgICAgIHdpbmRvdy5UYXBMaXN0ZW5lcixcblx0ICAgICAgd2luZG93LmZpenp5VUlVdGlsc1xuXHQgICAgKTtcblx0ICB9XG5cdFxuXHR9KCB3aW5kb3csIGZ1bmN0aW9uIGZhY3RvcnkoIHdpbmRvdywgRmxpY2tpdHksIFRhcExpc3RlbmVyLCB1dGlscyApIHtcblx0XG5cdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFBhZ2VEb3RzIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vXG5cdFxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRmdW5jdGlvbiBQYWdlRG90cyggcGFyZW50ICkge1xuXHQgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuXHQgIHRoaXMuX2NyZWF0ZSgpO1xuXHR9XG5cdFxuXHRQYWdlRG90cy5wcm90b3R5cGUgPSBuZXcgVGFwTGlzdGVuZXIoKTtcblx0XG5cdFBhZ2VEb3RzLnByb3RvdHlwZS5fY3JlYXRlID0gZnVuY3Rpb24oKSB7XG5cdCAgLy8gY3JlYXRlIGhvbGRlciBlbGVtZW50XG5cdCAgdGhpcy5ob2xkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvbCcpO1xuXHQgIHRoaXMuaG9sZGVyLmNsYXNzTmFtZSA9ICdmbGlja2l0eS1wYWdlLWRvdHMnO1xuXHQgIC8vIGNyZWF0ZSBkb3RzLCBhcnJheSBvZiBlbGVtZW50c1xuXHQgIHRoaXMuZG90cyA9IFtdO1xuXHQgIC8vIHRhcFxuXHQgIHRoaXMub24oICd0YXAnLCB0aGlzLm9uVGFwICk7XG5cdFxuXHR9O1xuXHRcblx0UGFnZURvdHMucHJvdG90eXBlLmFjdGl2YXRlID0gZnVuY3Rpb24oKSB7XG5cdCAgdGhpcy5zZXREb3RzKCk7XG5cdCAgdGhpcy5iaW5kVGFwKCB0aGlzLmhvbGRlciApO1xuXHQgIC8vIGFkZCB0byBET01cblx0ICB0aGlzLnBhcmVudC5lbGVtZW50LmFwcGVuZENoaWxkKCB0aGlzLmhvbGRlciApO1xuXHR9O1xuXHRcblx0UGFnZURvdHMucHJvdG90eXBlLmRlYWN0aXZhdGUgPSBmdW5jdGlvbigpIHtcblx0ICAvLyByZW1vdmUgZnJvbSBET01cblx0ICB0aGlzLnBhcmVudC5lbGVtZW50LnJlbW92ZUNoaWxkKCB0aGlzLmhvbGRlciApO1xuXHQgIFRhcExpc3RlbmVyLnByb3RvdHlwZS5kZXN0cm95LmNhbGwoIHRoaXMgKTtcblx0fTtcblx0XG5cdFBhZ2VEb3RzLnByb3RvdHlwZS5zZXREb3RzID0gZnVuY3Rpb24oKSB7XG5cdCAgLy8gZ2V0IGRpZmZlcmVuY2UgYmV0d2VlbiBudW1iZXIgb2Ygc2xpZGVzIGFuZCBudW1iZXIgb2YgZG90c1xuXHQgIHZhciBkZWx0YSA9IHRoaXMucGFyZW50LnNsaWRlcy5sZW5ndGggLSB0aGlzLmRvdHMubGVuZ3RoO1xuXHQgIGlmICggZGVsdGEgPiAwICkge1xuXHQgICAgdGhpcy5hZGREb3RzKCBkZWx0YSApO1xuXHQgIH0gZWxzZSBpZiAoIGRlbHRhIDwgMCApIHtcblx0ICAgIHRoaXMucmVtb3ZlRG90cyggLWRlbHRhICk7XG5cdCAgfVxuXHR9O1xuXHRcblx0UGFnZURvdHMucHJvdG90eXBlLmFkZERvdHMgPSBmdW5jdGlvbiggY291bnQgKSB7XG5cdCAgdmFyIGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuXHQgIHZhciBuZXdEb3RzID0gW107XG5cdCAgd2hpbGUgKCBjb3VudCApIHtcblx0ICAgIHZhciBkb3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xuXHQgICAgZG90LmNsYXNzTmFtZSA9ICdkb3QnO1xuXHQgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQoIGRvdCApO1xuXHQgICAgbmV3RG90cy5wdXNoKCBkb3QgKTtcblx0ICAgIGNvdW50LS07XG5cdCAgfVxuXHQgIHRoaXMuaG9sZGVyLmFwcGVuZENoaWxkKCBmcmFnbWVudCApO1xuXHQgIHRoaXMuZG90cyA9IHRoaXMuZG90cy5jb25jYXQoIG5ld0RvdHMgKTtcblx0fTtcblx0XG5cdFBhZ2VEb3RzLnByb3RvdHlwZS5yZW1vdmVEb3RzID0gZnVuY3Rpb24oIGNvdW50ICkge1xuXHQgIC8vIHJlbW92ZSBmcm9tIHRoaXMuZG90cyBjb2xsZWN0aW9uXG5cdCAgdmFyIHJlbW92ZURvdHMgPSB0aGlzLmRvdHMuc3BsaWNlKCB0aGlzLmRvdHMubGVuZ3RoIC0gY291bnQsIGNvdW50ICk7XG5cdCAgLy8gcmVtb3ZlIGZyb20gRE9NXG5cdCAgcmVtb3ZlRG90cy5mb3JFYWNoKCBmdW5jdGlvbiggZG90ICkge1xuXHQgICAgdGhpcy5ob2xkZXIucmVtb3ZlQ2hpbGQoIGRvdCApO1xuXHQgIH0sIHRoaXMgKTtcblx0fTtcblx0XG5cdFBhZ2VEb3RzLnByb3RvdHlwZS51cGRhdGVTZWxlY3RlZCA9IGZ1bmN0aW9uKCkge1xuXHQgIC8vIHJlbW92ZSBzZWxlY3RlZCBjbGFzcyBvbiBwcmV2aW91c1xuXHQgIGlmICggdGhpcy5zZWxlY3RlZERvdCApIHtcblx0ICAgIHRoaXMuc2VsZWN0ZWREb3QuY2xhc3NOYW1lID0gJ2RvdCc7XG5cdCAgfVxuXHQgIC8vIGRvbid0IHByb2NlZWQgaWYgbm8gZG90c1xuXHQgIGlmICggIXRoaXMuZG90cy5sZW5ndGggKSB7XG5cdCAgICByZXR1cm47XG5cdCAgfVxuXHQgIHRoaXMuc2VsZWN0ZWREb3QgPSB0aGlzLmRvdHNbIHRoaXMucGFyZW50LnNlbGVjdGVkSW5kZXggXTtcblx0ICB0aGlzLnNlbGVjdGVkRG90LmNsYXNzTmFtZSA9ICdkb3QgaXMtc2VsZWN0ZWQnO1xuXHR9O1xuXHRcblx0UGFnZURvdHMucHJvdG90eXBlLm9uVGFwID0gZnVuY3Rpb24oIGV2ZW50ICkge1xuXHQgIHZhciB0YXJnZXQgPSBldmVudC50YXJnZXQ7XG5cdCAgLy8gb25seSBjYXJlIGFib3V0IGRvdCBjbGlja3Ncblx0ICBpZiAoIHRhcmdldC5ub2RlTmFtZSAhPSAnTEknICkge1xuXHQgICAgcmV0dXJuO1xuXHQgIH1cblx0XG5cdCAgdGhpcy5wYXJlbnQudWlDaGFuZ2UoKTtcblx0ICB2YXIgaW5kZXggPSB0aGlzLmRvdHMuaW5kZXhPZiggdGFyZ2V0ICk7XG5cdCAgdGhpcy5wYXJlbnQuc2VsZWN0KCBpbmRleCApO1xuXHR9O1xuXHRcblx0UGFnZURvdHMucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcblx0ICB0aGlzLmRlYWN0aXZhdGUoKTtcblx0fTtcblx0XG5cdEZsaWNraXR5LlBhZ2VEb3RzID0gUGFnZURvdHM7XG5cdFxuXHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBGbGlja2l0eSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvL1xuXHRcblx0dXRpbHMuZXh0ZW5kKCBGbGlja2l0eS5kZWZhdWx0cywge1xuXHQgIHBhZ2VEb3RzOiB0cnVlXG5cdH0pO1xuXHRcblx0RmxpY2tpdHkuY3JlYXRlTWV0aG9kcy5wdXNoKCdfY3JlYXRlUGFnZURvdHMnKTtcblx0XG5cdHZhciBwcm90byA9IEZsaWNraXR5LnByb3RvdHlwZTtcblx0XG5cdHByb3RvLl9jcmVhdGVQYWdlRG90cyA9IGZ1bmN0aW9uKCkge1xuXHQgIGlmICggIXRoaXMub3B0aW9ucy5wYWdlRG90cyApIHtcblx0ICAgIHJldHVybjtcblx0ICB9XG5cdCAgdGhpcy5wYWdlRG90cyA9IG5ldyBQYWdlRG90cyggdGhpcyApO1xuXHQgIC8vIGV2ZW50c1xuXHQgIHRoaXMub24oICdhY3RpdmF0ZScsIHRoaXMuYWN0aXZhdGVQYWdlRG90cyApO1xuXHQgIHRoaXMub24oICdzZWxlY3QnLCB0aGlzLnVwZGF0ZVNlbGVjdGVkUGFnZURvdHMgKTtcblx0ICB0aGlzLm9uKCAnY2VsbENoYW5nZScsIHRoaXMudXBkYXRlUGFnZURvdHMgKTtcblx0ICB0aGlzLm9uKCAncmVzaXplJywgdGhpcy51cGRhdGVQYWdlRG90cyApO1xuXHQgIHRoaXMub24oICdkZWFjdGl2YXRlJywgdGhpcy5kZWFjdGl2YXRlUGFnZURvdHMgKTtcblx0XG5cdCAgdGhpcy5wYWdlRG90cy5vbiggJ3BvaW50ZXJEb3duJywgZnVuY3Rpb24oIGV2ZW50ICkge1xuXHQgICAgdGhpcy5jaGlsZFVJUG9pbnRlckRvd24oIGV2ZW50ICk7XG5cdCAgfS5iaW5kKCB0aGlzICkpO1xuXHR9O1xuXHRcblx0cHJvdG8uYWN0aXZhdGVQYWdlRG90cyA9IGZ1bmN0aW9uKCkge1xuXHQgIHRoaXMucGFnZURvdHMuYWN0aXZhdGUoKTtcblx0fTtcblx0XG5cdHByb3RvLnVwZGF0ZVNlbGVjdGVkUGFnZURvdHMgPSBmdW5jdGlvbigpIHtcblx0ICB0aGlzLnBhZ2VEb3RzLnVwZGF0ZVNlbGVjdGVkKCk7XG5cdH07XG5cdFxuXHRwcm90by51cGRhdGVQYWdlRG90cyA9IGZ1bmN0aW9uKCkge1xuXHQgIHRoaXMucGFnZURvdHMuc2V0RG90cygpO1xuXHR9O1xuXHRcblx0cHJvdG8uZGVhY3RpdmF0ZVBhZ2VEb3RzID0gZnVuY3Rpb24oKSB7XG5cdCAgdGhpcy5wYWdlRG90cy5kZWFjdGl2YXRlKCk7XG5cdH07XG5cdFxuXHQvLyAtLS0tLSAgLS0tLS0gLy9cblx0XG5cdEZsaWNraXR5LlBhZ2VEb3RzID0gUGFnZURvdHM7XG5cdFxuXHRyZXR1cm4gRmxpY2tpdHk7XG5cdFxuXHR9KSk7XG5cblxuLyoqKi8gfSxcbi8qIDE4ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHR2YXIgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXywgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX187Ly8gcGxheWVyICYgYXV0b1BsYXlcblx0KCBmdW5jdGlvbiggd2luZG93LCBmYWN0b3J5ICkge1xuXHQgIC8vIHVuaXZlcnNhbCBtb2R1bGUgZGVmaW5pdGlvblxuXHQgIC8qIGpzaGludCBzdHJpY3Q6IGZhbHNlICovXG5cdCAgaWYgKCB0cnVlICkge1xuXHQgICAgLy8gQU1EXG5cdCAgICAhKF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18gPSBbXG5cdCAgICAgIF9fd2VicGFja19yZXF1aXJlX18oNSksXG5cdCAgICAgIF9fd2VicGFja19yZXF1aXJlX18oNyksXG5cdCAgICAgIF9fd2VicGFja19yZXF1aXJlX18oNClcblx0ICAgIF0sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fID0gZnVuY3Rpb24oIEV2RW1pdHRlciwgdXRpbHMsIEZsaWNraXR5ICkge1xuXHQgICAgICByZXR1cm4gZmFjdG9yeSggRXZFbWl0dGVyLCB1dGlscywgRmxpY2tpdHkgKTtcblx0ICAgIH0uYXBwbHkoZXhwb3J0cywgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXyksIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fICE9PSB1bmRlZmluZWQgJiYgKG1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18pKTtcblx0ICB9IGVsc2UgaWYgKCB0eXBlb2YgbW9kdWxlID09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzICkge1xuXHQgICAgLy8gQ29tbW9uSlNcblx0ICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShcblx0ICAgICAgcmVxdWlyZSgnZXYtZW1pdHRlcicpLFxuXHQgICAgICByZXF1aXJlKCdmaXp6eS11aS11dGlscycpLFxuXHQgICAgICByZXF1aXJlKCcuL2ZsaWNraXR5Jylcblx0ICAgICk7XG5cdCAgfSBlbHNlIHtcblx0ICAgIC8vIGJyb3dzZXIgZ2xvYmFsXG5cdCAgICBmYWN0b3J5KFxuXHQgICAgICB3aW5kb3cuRXZFbWl0dGVyLFxuXHQgICAgICB3aW5kb3cuZml6enlVSVV0aWxzLFxuXHQgICAgICB3aW5kb3cuRmxpY2tpdHlcblx0ICAgICk7XG5cdCAgfVxuXHRcblx0fSggd2luZG93LCBmdW5jdGlvbiBmYWN0b3J5KCBFdkVtaXR0ZXIsIHV0aWxzLCBGbGlja2l0eSApIHtcblx0XG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFBhZ2UgVmlzaWJpbGl0eSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvL1xuXHQvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9HdWlkZS9Vc2VyX2V4cGVyaWVuY2UvVXNpbmdfdGhlX1BhZ2VfVmlzaWJpbGl0eV9BUElcblx0XG5cdHZhciBoaWRkZW5Qcm9wZXJ0eSwgdmlzaWJpbGl0eUV2ZW50O1xuXHRpZiAoICdoaWRkZW4nIGluIGRvY3VtZW50ICkge1xuXHQgIGhpZGRlblByb3BlcnR5ID0gJ2hpZGRlbic7XG5cdCAgdmlzaWJpbGl0eUV2ZW50ID0gJ3Zpc2liaWxpdHljaGFuZ2UnO1xuXHR9IGVsc2UgaWYgKCAnd2Via2l0SGlkZGVuJyBpbiBkb2N1bWVudCApIHtcblx0ICBoaWRkZW5Qcm9wZXJ0eSA9ICd3ZWJraXRIaWRkZW4nO1xuXHQgIHZpc2liaWxpdHlFdmVudCA9ICd3ZWJraXR2aXNpYmlsaXR5Y2hhbmdlJztcblx0fVxuXHRcblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gUGxheWVyIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vXG5cdFxuXHRmdW5jdGlvbiBQbGF5ZXIoIHBhcmVudCApIHtcblx0ICB0aGlzLnBhcmVudCA9IHBhcmVudDtcblx0ICB0aGlzLnN0YXRlID0gJ3N0b3BwZWQnO1xuXHQgIC8vIHZpc2liaWxpdHkgY2hhbmdlIGV2ZW50IGhhbmRsZXJcblx0ICBpZiAoIHZpc2liaWxpdHlFdmVudCApIHtcblx0ICAgIHRoaXMub25WaXNpYmlsaXR5Q2hhbmdlID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgIHRoaXMudmlzaWJpbGl0eUNoYW5nZSgpO1xuXHQgICAgfS5iaW5kKCB0aGlzICk7XG5cdCAgICB0aGlzLm9uVmlzaWJpbGl0eVBsYXkgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgdGhpcy52aXNpYmlsaXR5UGxheSgpO1xuXHQgICAgfS5iaW5kKCB0aGlzICk7XG5cdCAgfVxuXHR9XG5cdFxuXHRQbGF5ZXIucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZSggRXZFbWl0dGVyLnByb3RvdHlwZSApO1xuXHRcblx0Ly8gc3RhcnQgcGxheVxuXHRQbGF5ZXIucHJvdG90eXBlLnBsYXkgPSBmdW5jdGlvbigpIHtcblx0ICBpZiAoIHRoaXMuc3RhdGUgPT0gJ3BsYXlpbmcnICkge1xuXHQgICAgcmV0dXJuO1xuXHQgIH1cblx0ICAvLyBkbyBub3QgcGxheSBpZiBwYWdlIGlzIGhpZGRlbiwgc3RhcnQgcGxheWluZyB3aGVuIHBhZ2UgaXMgdmlzaWJsZVxuXHQgIHZhciBpc1BhZ2VIaWRkZW4gPSBkb2N1bWVudFsgaGlkZGVuUHJvcGVydHkgXTtcblx0ICBpZiAoIHZpc2liaWxpdHlFdmVudCAmJiBpc1BhZ2VIaWRkZW4gKSB7XG5cdCAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCB2aXNpYmlsaXR5RXZlbnQsIHRoaXMub25WaXNpYmlsaXR5UGxheSApO1xuXHQgICAgcmV0dXJuO1xuXHQgIH1cblx0XG5cdCAgdGhpcy5zdGF0ZSA9ICdwbGF5aW5nJztcblx0ICAvLyBsaXN0ZW4gdG8gdmlzaWJpbGl0eSBjaGFuZ2Vcblx0ICBpZiAoIHZpc2liaWxpdHlFdmVudCApIHtcblx0ICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIHZpc2liaWxpdHlFdmVudCwgdGhpcy5vblZpc2liaWxpdHlDaGFuZ2UgKTtcblx0ICB9XG5cdCAgLy8gc3RhcnQgdGlja2luZ1xuXHQgIHRoaXMudGljaygpO1xuXHR9O1xuXHRcblx0UGxheWVyLnByb3RvdHlwZS50aWNrID0gZnVuY3Rpb24oKSB7XG5cdCAgLy8gZG8gbm90IHRpY2sgaWYgbm90IHBsYXlpbmdcblx0ICBpZiAoIHRoaXMuc3RhdGUgIT0gJ3BsYXlpbmcnICkge1xuXHQgICAgcmV0dXJuO1xuXHQgIH1cblx0XG5cdCAgdmFyIHRpbWUgPSB0aGlzLnBhcmVudC5vcHRpb25zLmF1dG9QbGF5O1xuXHQgIC8vIGRlZmF1bHQgdG8gMyBzZWNvbmRzXG5cdCAgdGltZSA9IHR5cGVvZiB0aW1lID09ICdudW1iZXInID8gdGltZSA6IDMwMDA7XG5cdCAgdmFyIF90aGlzID0gdGhpcztcblx0ICAvLyBIQUNLOiByZXNldCB0aWNrcyBpZiBzdG9wcGVkIGFuZCBzdGFydGVkIHdpdGhpbiBpbnRlcnZhbFxuXHQgIHRoaXMuY2xlYXIoKTtcblx0ICB0aGlzLnRpbWVvdXQgPSBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcblx0ICAgIF90aGlzLnBhcmVudC5uZXh0KCB0cnVlICk7XG5cdCAgICBfdGhpcy50aWNrKCk7XG5cdCAgfSwgdGltZSApO1xuXHR9O1xuXHRcblx0UGxheWVyLnByb3RvdHlwZS5zdG9wID0gZnVuY3Rpb24oKSB7XG5cdCAgdGhpcy5zdGF0ZSA9ICdzdG9wcGVkJztcblx0ICB0aGlzLmNsZWFyKCk7XG5cdCAgLy8gcmVtb3ZlIHZpc2liaWxpdHkgY2hhbmdlIGV2ZW50XG5cdCAgaWYgKCB2aXNpYmlsaXR5RXZlbnQgKSB7XG5cdCAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCB2aXNpYmlsaXR5RXZlbnQsIHRoaXMub25WaXNpYmlsaXR5Q2hhbmdlICk7XG5cdCAgfVxuXHR9O1xuXHRcblx0UGxheWVyLnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uKCkge1xuXHQgIGNsZWFyVGltZW91dCggdGhpcy50aW1lb3V0ICk7XG5cdH07XG5cdFxuXHRQbGF5ZXIucHJvdG90eXBlLnBhdXNlID0gZnVuY3Rpb24oKSB7XG5cdCAgaWYgKCB0aGlzLnN0YXRlID09ICdwbGF5aW5nJyApIHtcblx0ICAgIHRoaXMuc3RhdGUgPSAncGF1c2VkJztcblx0ICAgIHRoaXMuY2xlYXIoKTtcblx0ICB9XG5cdH07XG5cdFxuXHRQbGF5ZXIucHJvdG90eXBlLnVucGF1c2UgPSBmdW5jdGlvbigpIHtcblx0ICAvLyByZS1zdGFydCBwbGF5IGlmIHBhdXNlZFxuXHQgIGlmICggdGhpcy5zdGF0ZSA9PSAncGF1c2VkJyApIHtcblx0ICAgIHRoaXMucGxheSgpO1xuXHQgIH1cblx0fTtcblx0XG5cdC8vIHBhdXNlIGlmIHBhZ2UgdmlzaWJpbGl0eSBpcyBoaWRkZW4sIHVucGF1c2UgaWYgdmlzaWJsZVxuXHRQbGF5ZXIucHJvdG90eXBlLnZpc2liaWxpdHlDaGFuZ2UgPSBmdW5jdGlvbigpIHtcblx0ICB2YXIgaXNQYWdlSGlkZGVuID0gZG9jdW1lbnRbIGhpZGRlblByb3BlcnR5IF07XG5cdCAgdGhpc1sgaXNQYWdlSGlkZGVuID8gJ3BhdXNlJyA6ICd1bnBhdXNlJyBdKCk7XG5cdH07XG5cdFxuXHRQbGF5ZXIucHJvdG90eXBlLnZpc2liaWxpdHlQbGF5ID0gZnVuY3Rpb24oKSB7XG5cdCAgdGhpcy5wbGF5KCk7XG5cdCAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggdmlzaWJpbGl0eUV2ZW50LCB0aGlzLm9uVmlzaWJpbGl0eVBsYXkgKTtcblx0fTtcblx0XG5cdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIEZsaWNraXR5IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vXG5cdFxuXHR1dGlscy5leHRlbmQoIEZsaWNraXR5LmRlZmF1bHRzLCB7XG5cdCAgcGF1c2VBdXRvUGxheU9uSG92ZXI6IHRydWVcblx0fSk7XG5cdFxuXHRGbGlja2l0eS5jcmVhdGVNZXRob2RzLnB1c2goJ19jcmVhdGVQbGF5ZXInKTtcblx0dmFyIHByb3RvID0gRmxpY2tpdHkucHJvdG90eXBlO1xuXHRcblx0cHJvdG8uX2NyZWF0ZVBsYXllciA9IGZ1bmN0aW9uKCkge1xuXHQgIHRoaXMucGxheWVyID0gbmV3IFBsYXllciggdGhpcyApO1xuXHRcblx0ICB0aGlzLm9uKCAnYWN0aXZhdGUnLCB0aGlzLmFjdGl2YXRlUGxheWVyICk7XG5cdCAgdGhpcy5vbiggJ3VpQ2hhbmdlJywgdGhpcy5zdG9wUGxheWVyICk7XG5cdCAgdGhpcy5vbiggJ3BvaW50ZXJEb3duJywgdGhpcy5zdG9wUGxheWVyICk7XG5cdCAgdGhpcy5vbiggJ2RlYWN0aXZhdGUnLCB0aGlzLmRlYWN0aXZhdGVQbGF5ZXIgKTtcblx0fTtcblx0XG5cdHByb3RvLmFjdGl2YXRlUGxheWVyID0gZnVuY3Rpb24oKSB7XG5cdCAgaWYgKCAhdGhpcy5vcHRpb25zLmF1dG9QbGF5ICkge1xuXHQgICAgcmV0dXJuO1xuXHQgIH1cblx0ICB0aGlzLnBsYXllci5wbGF5KCk7XG5cdCAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoICdtb3VzZWVudGVyJywgdGhpcyApO1xuXHR9O1xuXHRcblx0Ly8gUGxheWVyIEFQSSwgZG9uJ3QgaGF0ZSB0aGUgLi4uIHRoYW5rcyBJIGtub3cgd2hlcmUgdGhlIGRvb3IgaXNcblx0XG5cdHByb3RvLnBsYXlQbGF5ZXIgPSBmdW5jdGlvbigpIHtcblx0ICB0aGlzLnBsYXllci5wbGF5KCk7XG5cdH07XG5cdFxuXHRwcm90by5zdG9wUGxheWVyID0gZnVuY3Rpb24oKSB7XG5cdCAgdGhpcy5wbGF5ZXIuc3RvcCgpO1xuXHR9O1xuXHRcblx0cHJvdG8ucGF1c2VQbGF5ZXIgPSBmdW5jdGlvbigpIHtcblx0ICB0aGlzLnBsYXllci5wYXVzZSgpO1xuXHR9O1xuXHRcblx0cHJvdG8udW5wYXVzZVBsYXllciA9IGZ1bmN0aW9uKCkge1xuXHQgIHRoaXMucGxheWVyLnVucGF1c2UoKTtcblx0fTtcblx0XG5cdHByb3RvLmRlYWN0aXZhdGVQbGF5ZXIgPSBmdW5jdGlvbigpIHtcblx0ICB0aGlzLnBsYXllci5zdG9wKCk7XG5cdCAgdGhpcy5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoICdtb3VzZWVudGVyJywgdGhpcyApO1xuXHR9O1xuXHRcblx0Ly8gLS0tLS0gbW91c2VlbnRlci9sZWF2ZSAtLS0tLSAvL1xuXHRcblx0Ly8gcGF1c2UgYXV0by1wbGF5IG9uIGhvdmVyXG5cdHByb3RvLm9ubW91c2VlbnRlciA9IGZ1bmN0aW9uKCkge1xuXHQgIGlmICggIXRoaXMub3B0aW9ucy5wYXVzZUF1dG9QbGF5T25Ib3ZlciApIHtcblx0ICAgIHJldHVybjtcblx0ICB9XG5cdCAgdGhpcy5wbGF5ZXIucGF1c2UoKTtcblx0ICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ21vdXNlbGVhdmUnLCB0aGlzICk7XG5cdH07XG5cdFxuXHQvLyByZXN1bWUgYXV0by1wbGF5IG9uIGhvdmVyIG9mZlxuXHRwcm90by5vbm1vdXNlbGVhdmUgPSBmdW5jdGlvbigpIHtcblx0ICB0aGlzLnBsYXllci51bnBhdXNlKCk7XG5cdCAgdGhpcy5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoICdtb3VzZWxlYXZlJywgdGhpcyApO1xuXHR9O1xuXHRcblx0Ly8gLS0tLS0gIC0tLS0tIC8vXG5cdFxuXHRGbGlja2l0eS5QbGF5ZXIgPSBQbGF5ZXI7XG5cdFxuXHRyZXR1cm4gRmxpY2tpdHk7XG5cdFxuXHR9KSk7XG5cblxuLyoqKi8gfSxcbi8qIDE5ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHR2YXIgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXywgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX187Ly8gYWRkLCByZW1vdmUgY2VsbFxuXHQoIGZ1bmN0aW9uKCB3aW5kb3csIGZhY3RvcnkgKSB7XG5cdCAgLy8gdW5pdmVyc2FsIG1vZHVsZSBkZWZpbml0aW9uXG5cdCAgLyoganNoaW50IHN0cmljdDogZmFsc2UgKi9cblx0ICBpZiAoIHRydWUgKSB7XG5cdCAgICAvLyBBTURcblx0ICAgICEoX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXyA9IFtcblx0ICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg0KSxcblx0ICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg3KVxuXHQgICAgXSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gPSBmdW5jdGlvbiggRmxpY2tpdHksIHV0aWxzICkge1xuXHQgICAgICByZXR1cm4gZmFjdG9yeSggd2luZG93LCBGbGlja2l0eSwgdXRpbHMgKTtcblx0ICAgIH0uYXBwbHkoZXhwb3J0cywgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXyksIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fICE9PSB1bmRlZmluZWQgJiYgKG1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18pKTtcblx0ICB9IGVsc2UgaWYgKCB0eXBlb2YgbW9kdWxlID09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzICkge1xuXHQgICAgLy8gQ29tbW9uSlNcblx0ICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShcblx0ICAgICAgd2luZG93LFxuXHQgICAgICByZXF1aXJlKCcuL2ZsaWNraXR5JyksXG5cdCAgICAgIHJlcXVpcmUoJ2Zpenp5LXVpLXV0aWxzJylcblx0ICAgICk7XG5cdCAgfSBlbHNlIHtcblx0ICAgIC8vIGJyb3dzZXIgZ2xvYmFsXG5cdCAgICBmYWN0b3J5KFxuXHQgICAgICB3aW5kb3csXG5cdCAgICAgIHdpbmRvdy5GbGlja2l0eSxcblx0ICAgICAgd2luZG93LmZpenp5VUlVdGlsc1xuXHQgICAgKTtcblx0ICB9XG5cdFxuXHR9KCB3aW5kb3csIGZ1bmN0aW9uIGZhY3RvcnkoIHdpbmRvdywgRmxpY2tpdHksIHV0aWxzICkge1xuXHRcblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0Ly8gYXBwZW5kIGNlbGxzIHRvIGEgZG9jdW1lbnQgZnJhZ21lbnRcblx0ZnVuY3Rpb24gZ2V0Q2VsbHNGcmFnbWVudCggY2VsbHMgKSB7XG5cdCAgdmFyIGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuXHQgIGNlbGxzLmZvckVhY2goIGZ1bmN0aW9uKCBjZWxsICkge1xuXHQgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQoIGNlbGwuZWxlbWVudCApO1xuXHQgIH0pO1xuXHQgIHJldHVybiBmcmFnbWVudDtcblx0fVxuXHRcblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gYWRkL3JlbW92ZSBjZWxsIHByb3RvdHlwZSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvL1xuXHRcblx0dmFyIHByb3RvID0gRmxpY2tpdHkucHJvdG90eXBlO1xuXHRcblx0LyoqXG5cdCAqIEluc2VydCwgcHJlcGVuZCwgb3IgYXBwZW5kIGNlbGxzXG5cdCAqIEBwYXJhbSB7RWxlbWVudCwgQXJyYXksIE5vZGVMaXN0fSBlbGVtc1xuXHQgKiBAcGFyYW0ge0ludGVnZXJ9IGluZGV4XG5cdCAqL1xuXHRwcm90by5pbnNlcnQgPSBmdW5jdGlvbiggZWxlbXMsIGluZGV4ICkge1xuXHQgIHZhciBjZWxscyA9IHRoaXMuX21ha2VDZWxscyggZWxlbXMgKTtcblx0ICBpZiAoICFjZWxscyB8fCAhY2VsbHMubGVuZ3RoICkge1xuXHQgICAgcmV0dXJuO1xuXHQgIH1cblx0ICB2YXIgbGVuID0gdGhpcy5jZWxscy5sZW5ndGg7XG5cdCAgLy8gZGVmYXVsdCB0byBhcHBlbmRcblx0ICBpbmRleCA9IGluZGV4ID09PSB1bmRlZmluZWQgPyBsZW4gOiBpbmRleDtcblx0ICAvLyBhZGQgY2VsbHMgd2l0aCBkb2N1bWVudCBmcmFnbWVudFxuXHQgIHZhciBmcmFnbWVudCA9IGdldENlbGxzRnJhZ21lbnQoIGNlbGxzICk7XG5cdCAgLy8gYXBwZW5kIHRvIHNsaWRlclxuXHQgIHZhciBpc0FwcGVuZCA9IGluZGV4ID09IGxlbjtcblx0ICBpZiAoIGlzQXBwZW5kICkge1xuXHQgICAgdGhpcy5zbGlkZXIuYXBwZW5kQ2hpbGQoIGZyYWdtZW50ICk7XG5cdCAgfSBlbHNlIHtcblx0ICAgIHZhciBpbnNlcnRDZWxsRWxlbWVudCA9IHRoaXMuY2VsbHNbIGluZGV4IF0uZWxlbWVudDtcblx0ICAgIHRoaXMuc2xpZGVyLmluc2VydEJlZm9yZSggZnJhZ21lbnQsIGluc2VydENlbGxFbGVtZW50ICk7XG5cdCAgfVxuXHQgIC8vIGFkZCB0byB0aGlzLmNlbGxzXG5cdCAgaWYgKCBpbmRleCA9PT0gMCApIHtcblx0ICAgIC8vIHByZXBlbmQsIGFkZCB0byBzdGFydFxuXHQgICAgdGhpcy5jZWxscyA9IGNlbGxzLmNvbmNhdCggdGhpcy5jZWxscyApO1xuXHQgIH0gZWxzZSBpZiAoIGlzQXBwZW5kICkge1xuXHQgICAgLy8gYXBwZW5kLCBhZGQgdG8gZW5kXG5cdCAgICB0aGlzLmNlbGxzID0gdGhpcy5jZWxscy5jb25jYXQoIGNlbGxzICk7XG5cdCAgfSBlbHNlIHtcblx0ICAgIC8vIGluc2VydCBpbiB0aGlzLmNlbGxzXG5cdCAgICB2YXIgZW5kQ2VsbHMgPSB0aGlzLmNlbGxzLnNwbGljZSggaW5kZXgsIGxlbiAtIGluZGV4ICk7XG5cdCAgICB0aGlzLmNlbGxzID0gdGhpcy5jZWxscy5jb25jYXQoIGNlbGxzICkuY29uY2F0KCBlbmRDZWxscyApO1xuXHQgIH1cblx0XG5cdCAgdGhpcy5fc2l6ZUNlbGxzKCBjZWxscyApO1xuXHRcblx0ICB2YXIgc2VsZWN0ZWRJbmRleERlbHRhID0gaW5kZXggPiB0aGlzLnNlbGVjdGVkSW5kZXggPyAwIDogY2VsbHMubGVuZ3RoO1xuXHQgIHRoaXMuX2NlbGxBZGRlZFJlbW92ZWQoIGluZGV4LCBzZWxlY3RlZEluZGV4RGVsdGEgKTtcblx0fTtcblx0XG5cdHByb3RvLmFwcGVuZCA9IGZ1bmN0aW9uKCBlbGVtcyApIHtcblx0ICB0aGlzLmluc2VydCggZWxlbXMsIHRoaXMuY2VsbHMubGVuZ3RoICk7XG5cdH07XG5cdFxuXHRwcm90by5wcmVwZW5kID0gZnVuY3Rpb24oIGVsZW1zICkge1xuXHQgIHRoaXMuaW5zZXJ0KCBlbGVtcywgMCApO1xuXHR9O1xuXHRcblx0LyoqXG5cdCAqIFJlbW92ZSBjZWxsc1xuXHQgKiBAcGFyYW0ge0VsZW1lbnQsIEFycmF5LCBOb2RlTGlzdH0gZWxlbXNcblx0ICovXG5cdHByb3RvLnJlbW92ZSA9IGZ1bmN0aW9uKCBlbGVtcyApIHtcblx0ICB2YXIgY2VsbHMgPSB0aGlzLmdldENlbGxzKCBlbGVtcyApO1xuXHQgIHZhciBzZWxlY3RlZEluZGV4RGVsdGEgPSAwO1xuXHQgIHZhciBsZW4gPSBjZWxscy5sZW5ndGg7XG5cdCAgdmFyIGksIGNlbGw7XG5cdCAgLy8gY2FsY3VsYXRlIHNlbGVjdGVkSW5kZXhEZWx0YSwgZWFzaWVyIGlmIGRvbmUgaW4gc2VwZXJhdGUgbG9vcFxuXHQgIGZvciAoIGk9MDsgaSA8IGxlbjsgaSsrICkge1xuXHQgICAgY2VsbCA9IGNlbGxzW2ldO1xuXHQgICAgdmFyIHdhc0JlZm9yZSA9IHRoaXMuY2VsbHMuaW5kZXhPZiggY2VsbCApIDwgdGhpcy5zZWxlY3RlZEluZGV4O1xuXHQgICAgc2VsZWN0ZWRJbmRleERlbHRhIC09IHdhc0JlZm9yZSA/IDEgOiAwO1xuXHQgIH1cblx0XG5cdCAgZm9yICggaT0wOyBpIDwgbGVuOyBpKysgKSB7XG5cdCAgICBjZWxsID0gY2VsbHNbaV07XG5cdCAgICBjZWxsLnJlbW92ZSgpO1xuXHQgICAgLy8gcmVtb3ZlIGl0ZW0gZnJvbSBjb2xsZWN0aW9uXG5cdCAgICB1dGlscy5yZW1vdmVGcm9tKCB0aGlzLmNlbGxzLCBjZWxsICk7XG5cdCAgfVxuXHRcblx0ICBpZiAoIGNlbGxzLmxlbmd0aCApIHtcblx0ICAgIC8vIHVwZGF0ZSBzdHVmZlxuXHQgICAgdGhpcy5fY2VsbEFkZGVkUmVtb3ZlZCggMCwgc2VsZWN0ZWRJbmRleERlbHRhICk7XG5cdCAgfVxuXHR9O1xuXHRcblx0Ly8gdXBkYXRlcyB3aGVuIGNlbGxzIGFyZSBhZGRlZCBvciByZW1vdmVkXG5cdHByb3RvLl9jZWxsQWRkZWRSZW1vdmVkID0gZnVuY3Rpb24oIGNoYW5nZWRDZWxsSW5kZXgsIHNlbGVjdGVkSW5kZXhEZWx0YSApIHtcblx0ICAvLyBUT0RPIHRoaXMgbWF0aCBpc24ndCBwZXJmZWN0IHdpdGggZ3JvdXBlZCBzbGlkZXNcblx0ICBzZWxlY3RlZEluZGV4RGVsdGEgPSBzZWxlY3RlZEluZGV4RGVsdGEgfHwgMDtcblx0ICB0aGlzLnNlbGVjdGVkSW5kZXggKz0gc2VsZWN0ZWRJbmRleERlbHRhO1xuXHQgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IE1hdGgubWF4KCAwLCBNYXRoLm1pbiggdGhpcy5zbGlkZXMubGVuZ3RoIC0gMSwgdGhpcy5zZWxlY3RlZEluZGV4ICkgKTtcblx0XG5cdCAgdGhpcy5jZWxsQ2hhbmdlKCBjaGFuZ2VkQ2VsbEluZGV4LCB0cnVlICk7XG5cdCAgLy8gYmFja3dhcmRzIGNvbXBhdGliaWxpdHlcblx0ICB0aGlzLmVtaXRFdmVudCggJ2NlbGxBZGRlZFJlbW92ZWQnLCBbIGNoYW5nZWRDZWxsSW5kZXgsIHNlbGVjdGVkSW5kZXhEZWx0YSBdICk7XG5cdH07XG5cdFxuXHQvKipcblx0ICogbG9naWMgdG8gYmUgcnVuIGFmdGVyIGEgY2VsbCdzIHNpemUgY2hhbmdlc1xuXHQgKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW0gLSBjZWxsJ3MgZWxlbWVudFxuXHQgKi9cblx0cHJvdG8uY2VsbFNpemVDaGFuZ2UgPSBmdW5jdGlvbiggZWxlbSApIHtcblx0ICB2YXIgY2VsbCA9IHRoaXMuZ2V0Q2VsbCggZWxlbSApO1xuXHQgIGlmICggIWNlbGwgKSB7XG5cdCAgICByZXR1cm47XG5cdCAgfVxuXHQgIGNlbGwuZ2V0U2l6ZSgpO1xuXHRcblx0ICB2YXIgaW5kZXggPSB0aGlzLmNlbGxzLmluZGV4T2YoIGNlbGwgKTtcblx0ICB0aGlzLmNlbGxDaGFuZ2UoIGluZGV4ICk7XG5cdH07XG5cdFxuXHQvKipcblx0ICogbG9naWMgYW55IHRpbWUgYSBjZWxsIGlzIGNoYW5nZWQ6IGFkZGVkLCByZW1vdmVkLCBvciBzaXplIGNoYW5nZWRcblx0ICogQHBhcmFtIHtJbnRlZ2VyfSBjaGFuZ2VkQ2VsbEluZGV4IC0gaW5kZXggb2YgdGhlIGNoYW5nZWQgY2VsbCwgb3B0aW9uYWxcblx0ICovXG5cdHByb3RvLmNlbGxDaGFuZ2UgPSBmdW5jdGlvbiggY2hhbmdlZENlbGxJbmRleCwgaXNQb3NpdGlvbmluZ1NsaWRlciApIHtcblx0ICB2YXIgcHJldlNsaWRlYWJsZVdpZHRoID0gdGhpcy5zbGlkZWFibGVXaWR0aDtcblx0ICB0aGlzLl9wb3NpdGlvbkNlbGxzKCBjaGFuZ2VkQ2VsbEluZGV4ICk7XG5cdCAgdGhpcy5fZ2V0V3JhcFNoaWZ0Q2VsbHMoKTtcblx0ICB0aGlzLnNldEdhbGxlcnlTaXplKCk7XG5cdCAgdGhpcy5lbWl0RXZlbnQoICdjZWxsQ2hhbmdlJywgWyBjaGFuZ2VkQ2VsbEluZGV4IF0gKTtcblx0ICAvLyBwb3NpdGlvbiBzbGlkZXJcblx0ICBpZiAoIHRoaXMub3B0aW9ucy5mcmVlU2Nyb2xsICkge1xuXHQgICAgLy8gc2hpZnQgeCBieSBjaGFuZ2UgaW4gc2xpZGVhYmxlV2lkdGhcblx0ICAgIC8vIFRPRE8gZml4IHBvc2l0aW9uIHNoaWZ0cyB3aGVuIHByZXBlbmRpbmcgdy8gZnJlZVNjcm9sbFxuXHQgICAgdmFyIGRlbHRhWCA9IHByZXZTbGlkZWFibGVXaWR0aCAtIHRoaXMuc2xpZGVhYmxlV2lkdGg7XG5cdCAgICB0aGlzLnggKz0gZGVsdGFYICogdGhpcy5jZWxsQWxpZ247XG5cdCAgICB0aGlzLnBvc2l0aW9uU2xpZGVyKCk7XG5cdCAgfSBlbHNlIHtcblx0ICAgIC8vIGRvIG5vdCBwb3NpdGlvbiBzbGlkZXIgYWZ0ZXIgbGF6eSBsb2FkXG5cdCAgICBpZiAoIGlzUG9zaXRpb25pbmdTbGlkZXIgKSB7XG5cdCAgICAgIHRoaXMucG9zaXRpb25TbGlkZXJBdFNlbGVjdGVkKCk7XG5cdCAgICB9XG5cdCAgICB0aGlzLnNlbGVjdCggdGhpcy5zZWxlY3RlZEluZGV4ICk7XG5cdCAgfVxuXHR9O1xuXHRcblx0Ly8gLS0tLS0gIC0tLS0tIC8vXG5cdFxuXHRyZXR1cm4gRmxpY2tpdHk7XG5cdFxuXHR9KSk7XG5cblxuLyoqKi8gfSxcbi8qIDIwICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHR2YXIgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXywgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX187Ly8gbGF6eWxvYWRcblx0KCBmdW5jdGlvbiggd2luZG93LCBmYWN0b3J5ICkge1xuXHQgIC8vIHVuaXZlcnNhbCBtb2R1bGUgZGVmaW5pdGlvblxuXHQgIC8qIGpzaGludCBzdHJpY3Q6IGZhbHNlICovXG5cdCAgaWYgKCB0cnVlICkge1xuXHQgICAgLy8gQU1EXG5cdCAgICAhKF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18gPSBbXG5cdCAgICAgIF9fd2VicGFja19yZXF1aXJlX18oNCksXG5cdCAgICAgIF9fd2VicGFja19yZXF1aXJlX18oNylcblx0ICAgIF0sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fID0gZnVuY3Rpb24oIEZsaWNraXR5LCB1dGlscyApIHtcblx0ICAgICAgcmV0dXJuIGZhY3RvcnkoIHdpbmRvdywgRmxpY2tpdHksIHV0aWxzICk7XG5cdCAgICB9LmFwcGx5KGV4cG9ydHMsIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18pLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyAhPT0gdW5kZWZpbmVkICYmIChtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fKSk7XG5cdCAgfSBlbHNlIGlmICggdHlwZW9mIG1vZHVsZSA9PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cyApIHtcblx0ICAgIC8vIENvbW1vbkpTXG5cdCAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoXG5cdCAgICAgIHdpbmRvdyxcblx0ICAgICAgcmVxdWlyZSgnLi9mbGlja2l0eScpLFxuXHQgICAgICByZXF1aXJlKCdmaXp6eS11aS11dGlscycpXG5cdCAgICApO1xuXHQgIH0gZWxzZSB7XG5cdCAgICAvLyBicm93c2VyIGdsb2JhbFxuXHQgICAgZmFjdG9yeShcblx0ICAgICAgd2luZG93LFxuXHQgICAgICB3aW5kb3cuRmxpY2tpdHksXG5cdCAgICAgIHdpbmRvdy5maXp6eVVJVXRpbHNcblx0ICAgICk7XG5cdCAgfVxuXHRcblx0fSggd2luZG93LCBmdW5jdGlvbiBmYWN0b3J5KCB3aW5kb3csIEZsaWNraXR5LCB1dGlscyApIHtcblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0RmxpY2tpdHkuY3JlYXRlTWV0aG9kcy5wdXNoKCdfY3JlYXRlTGF6eWxvYWQnKTtcblx0dmFyIHByb3RvID0gRmxpY2tpdHkucHJvdG90eXBlO1xuXHRcblx0cHJvdG8uX2NyZWF0ZUxhenlsb2FkID0gZnVuY3Rpb24oKSB7XG5cdCAgdGhpcy5vbiggJ3NlbGVjdCcsIHRoaXMubGF6eUxvYWQgKTtcblx0fTtcblx0XG5cdHByb3RvLmxhenlMb2FkID0gZnVuY3Rpb24oKSB7XG5cdCAgdmFyIGxhenlMb2FkID0gdGhpcy5vcHRpb25zLmxhenlMb2FkO1xuXHQgIGlmICggIWxhenlMb2FkICkge1xuXHQgICAgcmV0dXJuO1xuXHQgIH1cblx0ICAvLyBnZXQgYWRqYWNlbnQgY2VsbHMsIHVzZSBsYXp5TG9hZCBvcHRpb24gZm9yIGFkamFjZW50IGNvdW50XG5cdCAgdmFyIGFkakNvdW50ID0gdHlwZW9mIGxhenlMb2FkID09ICdudW1iZXInID8gbGF6eUxvYWQgOiAwO1xuXHQgIHZhciBjZWxsRWxlbXMgPSB0aGlzLmdldEFkamFjZW50Q2VsbEVsZW1lbnRzKCBhZGpDb3VudCApO1xuXHQgIC8vIGdldCBsYXp5IGltYWdlcyBpbiB0aG9zZSBjZWxsc1xuXHQgIHZhciBsYXp5SW1hZ2VzID0gW107XG5cdCAgY2VsbEVsZW1zLmZvckVhY2goIGZ1bmN0aW9uKCBjZWxsRWxlbSApIHtcblx0ICAgIHZhciBsYXp5Q2VsbEltYWdlcyA9IGdldENlbGxMYXp5SW1hZ2VzKCBjZWxsRWxlbSApO1xuXHQgICAgbGF6eUltYWdlcyA9IGxhenlJbWFnZXMuY29uY2F0KCBsYXp5Q2VsbEltYWdlcyApO1xuXHQgIH0pO1xuXHQgIC8vIGxvYWQgbGF6eSBpbWFnZXNcblx0ICBsYXp5SW1hZ2VzLmZvckVhY2goIGZ1bmN0aW9uKCBpbWcgKSB7XG5cdCAgICBuZXcgTGF6eUxvYWRlciggaW1nLCB0aGlzICk7XG5cdCAgfSwgdGhpcyApO1xuXHR9O1xuXHRcblx0ZnVuY3Rpb24gZ2V0Q2VsbExhenlJbWFnZXMoIGNlbGxFbGVtICkge1xuXHQgIC8vIGNoZWNrIGlmIGNlbGwgZWxlbWVudCBpcyBsYXp5IGltYWdlXG5cdCAgaWYgKCBjZWxsRWxlbS5ub2RlTmFtZSA9PSAnSU1HJyAmJlxuXHQgICAgY2VsbEVsZW0uZ2V0QXR0cmlidXRlKCdkYXRhLWZsaWNraXR5LWxhenlsb2FkJykgKSB7XG5cdCAgICByZXR1cm4gWyBjZWxsRWxlbSBdO1xuXHQgIH1cblx0ICAvLyBzZWxlY3QgbGF6eSBpbWFnZXMgaW4gY2VsbFxuXHQgIHZhciBpbWdzID0gY2VsbEVsZW0ucXVlcnlTZWxlY3RvckFsbCgnaW1nW2RhdGEtZmxpY2tpdHktbGF6eWxvYWRdJyk7XG5cdCAgcmV0dXJuIHV0aWxzLm1ha2VBcnJheSggaW1ncyApO1xuXHR9XG5cdFxuXHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBMYXp5TG9hZGVyIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vXG5cdFxuXHQvKipcblx0ICogY2xhc3MgdG8gaGFuZGxlIGxvYWRpbmcgaW1hZ2VzXG5cdCAqL1xuXHRmdW5jdGlvbiBMYXp5TG9hZGVyKCBpbWcsIGZsaWNraXR5ICkge1xuXHQgIHRoaXMuaW1nID0gaW1nO1xuXHQgIHRoaXMuZmxpY2tpdHkgPSBmbGlja2l0eTtcblx0ICB0aGlzLmxvYWQoKTtcblx0fVxuXHRcblx0TGF6eUxvYWRlci5wcm90b3R5cGUuaGFuZGxlRXZlbnQgPSB1dGlscy5oYW5kbGVFdmVudDtcblx0XG5cdExhenlMb2FkZXIucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbigpIHtcblx0ICB0aGlzLmltZy5hZGRFdmVudExpc3RlbmVyKCAnbG9hZCcsIHRoaXMgKTtcblx0ICB0aGlzLmltZy5hZGRFdmVudExpc3RlbmVyKCAnZXJyb3InLCB0aGlzICk7XG5cdCAgLy8gbG9hZCBpbWFnZVxuXHQgIHRoaXMuaW1nLnNyYyA9IHRoaXMuaW1nLmdldEF0dHJpYnV0ZSgnZGF0YS1mbGlja2l0eS1sYXp5bG9hZCcpO1xuXHQgIC8vIHJlbW92ZSBhdHRyXG5cdCAgdGhpcy5pbWcucmVtb3ZlQXR0cmlidXRlKCdkYXRhLWZsaWNraXR5LWxhenlsb2FkJyk7XG5cdH07XG5cdFxuXHRMYXp5TG9hZGVyLnByb3RvdHlwZS5vbmxvYWQgPSBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdCAgdGhpcy5jb21wbGV0ZSggZXZlbnQsICdmbGlja2l0eS1sYXp5bG9hZGVkJyApO1xuXHR9O1xuXHRcblx0TGF6eUxvYWRlci5wcm90b3R5cGUub25lcnJvciA9IGZ1bmN0aW9uKCBldmVudCApIHtcblx0ICB0aGlzLmNvbXBsZXRlKCBldmVudCwgJ2ZsaWNraXR5LWxhenllcnJvcicgKTtcblx0fTtcblx0XG5cdExhenlMb2FkZXIucHJvdG90eXBlLmNvbXBsZXRlID0gZnVuY3Rpb24oIGV2ZW50LCBjbGFzc05hbWUgKSB7XG5cdCAgLy8gdW5iaW5kIGV2ZW50c1xuXHQgIHRoaXMuaW1nLnJlbW92ZUV2ZW50TGlzdGVuZXIoICdsb2FkJywgdGhpcyApO1xuXHQgIHRoaXMuaW1nLnJlbW92ZUV2ZW50TGlzdGVuZXIoICdlcnJvcicsIHRoaXMgKTtcblx0XG5cdCAgdmFyIGNlbGwgPSB0aGlzLmZsaWNraXR5LmdldFBhcmVudENlbGwoIHRoaXMuaW1nICk7XG5cdCAgdmFyIGNlbGxFbGVtID0gY2VsbCAmJiBjZWxsLmVsZW1lbnQ7XG5cdCAgdGhpcy5mbGlja2l0eS5jZWxsU2l6ZUNoYW5nZSggY2VsbEVsZW0gKTtcblx0XG5cdCAgdGhpcy5pbWcuY2xhc3NMaXN0LmFkZCggY2xhc3NOYW1lICk7XG5cdCAgdGhpcy5mbGlja2l0eS5kaXNwYXRjaEV2ZW50KCAnbGF6eUxvYWQnLCBldmVudCwgY2VsbEVsZW0gKTtcblx0fTtcblx0XG5cdC8vIC0tLS0tICAtLS0tLSAvL1xuXHRcblx0RmxpY2tpdHkuTGF6eUxvYWRlciA9IExhenlMb2FkZXI7XG5cdFxuXHRyZXR1cm4gRmxpY2tpdHk7XG5cdFxuXHR9KSk7XG5cblxuLyoqKi8gfSxcbi8qIDIxICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHR2YXIgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXywgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX187LyohXG5cdCAqIGltYWdlc0xvYWRlZCB2NC4xLjFcblx0ICogSmF2YVNjcmlwdCBpcyBhbGwgbGlrZSBcIllvdSBpbWFnZXMgYXJlIGRvbmUgeWV0IG9yIHdoYXQ/XCJcblx0ICogTUlUIExpY2Vuc2Vcblx0ICovXG5cdFxuXHQoIGZ1bmN0aW9uKCB3aW5kb3csIGZhY3RvcnkgKSB7ICd1c2Ugc3RyaWN0Jztcblx0ICAvLyB1bml2ZXJzYWwgbW9kdWxlIGRlZmluaXRpb25cblx0XG5cdCAgLypnbG9iYWwgZGVmaW5lOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSwgcmVxdWlyZTogZmFsc2UgKi9cblx0XG5cdCAgaWYgKCB0cnVlICkge1xuXHQgICAgLy8gQU1EXG5cdCAgICAhKF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18gPSBbXG5cdCAgICAgIF9fd2VicGFja19yZXF1aXJlX18oNSlcblx0ICAgIF0sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fID0gZnVuY3Rpb24oIEV2RW1pdHRlciApIHtcblx0ICAgICAgcmV0dXJuIGZhY3RvcnkoIHdpbmRvdywgRXZFbWl0dGVyICk7XG5cdCAgICB9LmFwcGx5KGV4cG9ydHMsIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18pLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyAhPT0gdW5kZWZpbmVkICYmIChtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fKSk7XG5cdCAgfSBlbHNlIGlmICggdHlwZW9mIG1vZHVsZSA9PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cyApIHtcblx0ICAgIC8vIENvbW1vbkpTXG5cdCAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoXG5cdCAgICAgIHdpbmRvdyxcblx0ICAgICAgcmVxdWlyZSgnZXYtZW1pdHRlcicpXG5cdCAgICApO1xuXHQgIH0gZWxzZSB7XG5cdCAgICAvLyBicm93c2VyIGdsb2JhbFxuXHQgICAgd2luZG93LmltYWdlc0xvYWRlZCA9IGZhY3RvcnkoXG5cdCAgICAgIHdpbmRvdyxcblx0ICAgICAgd2luZG93LkV2RW1pdHRlclxuXHQgICAgKTtcblx0ICB9XG5cdFxuXHR9KSggd2luZG93LFxuXHRcblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gIGZhY3RvcnkgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cblx0XG5cdGZ1bmN0aW9uIGZhY3RvcnkoIHdpbmRvdywgRXZFbWl0dGVyICkge1xuXHRcblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0dmFyICQgPSB3aW5kb3cualF1ZXJ5O1xuXHR2YXIgY29uc29sZSA9IHdpbmRvdy5jb25zb2xlO1xuXHRcblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gaGVscGVycyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvL1xuXHRcblx0Ly8gZXh0ZW5kIG9iamVjdHNcblx0ZnVuY3Rpb24gZXh0ZW5kKCBhLCBiICkge1xuXHQgIGZvciAoIHZhciBwcm9wIGluIGIgKSB7XG5cdCAgICBhWyBwcm9wIF0gPSBiWyBwcm9wIF07XG5cdCAgfVxuXHQgIHJldHVybiBhO1xuXHR9XG5cdFxuXHQvLyB0dXJuIGVsZW1lbnQgb3Igbm9kZUxpc3QgaW50byBhbiBhcnJheVxuXHRmdW5jdGlvbiBtYWtlQXJyYXkoIG9iaiApIHtcblx0ICB2YXIgYXJ5ID0gW107XG5cdCAgaWYgKCBBcnJheS5pc0FycmF5KCBvYmogKSApIHtcblx0ICAgIC8vIHVzZSBvYmplY3QgaWYgYWxyZWFkeSBhbiBhcnJheVxuXHQgICAgYXJ5ID0gb2JqO1xuXHQgIH0gZWxzZSBpZiAoIHR5cGVvZiBvYmoubGVuZ3RoID09ICdudW1iZXInICkge1xuXHQgICAgLy8gY29udmVydCBub2RlTGlzdCB0byBhcnJheVxuXHQgICAgZm9yICggdmFyIGk9MDsgaSA8IG9iai5sZW5ndGg7IGkrKyApIHtcblx0ICAgICAgYXJ5LnB1c2goIG9ialtpXSApO1xuXHQgICAgfVxuXHQgIH0gZWxzZSB7XG5cdCAgICAvLyBhcnJheSBvZiBzaW5nbGUgaW5kZXhcblx0ICAgIGFyeS5wdXNoKCBvYmogKTtcblx0ICB9XG5cdCAgcmV0dXJuIGFyeTtcblx0fVxuXHRcblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gaW1hZ2VzTG9hZGVkIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vXG5cdFxuXHQvKipcblx0ICogQHBhcmFtIHtBcnJheSwgRWxlbWVudCwgTm9kZUxpc3QsIFN0cmluZ30gZWxlbVxuXHQgKiBAcGFyYW0ge09iamVjdCBvciBGdW5jdGlvbn0gb3B0aW9ucyAtIGlmIGZ1bmN0aW9uLCB1c2UgYXMgY2FsbGJhY2tcblx0ICogQHBhcmFtIHtGdW5jdGlvbn0gb25BbHdheXMgLSBjYWxsYmFjayBmdW5jdGlvblxuXHQgKi9cblx0ZnVuY3Rpb24gSW1hZ2VzTG9hZGVkKCBlbGVtLCBvcHRpb25zLCBvbkFsd2F5cyApIHtcblx0ICAvLyBjb2VyY2UgSW1hZ2VzTG9hZGVkKCkgd2l0aG91dCBuZXcsIHRvIGJlIG5ldyBJbWFnZXNMb2FkZWQoKVxuXHQgIGlmICggISggdGhpcyBpbnN0YW5jZW9mIEltYWdlc0xvYWRlZCApICkge1xuXHQgICAgcmV0dXJuIG5ldyBJbWFnZXNMb2FkZWQoIGVsZW0sIG9wdGlvbnMsIG9uQWx3YXlzICk7XG5cdCAgfVxuXHQgIC8vIHVzZSBlbGVtIGFzIHNlbGVjdG9yIHN0cmluZ1xuXHQgIGlmICggdHlwZW9mIGVsZW0gPT0gJ3N0cmluZycgKSB7XG5cdCAgICBlbGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCggZWxlbSApO1xuXHQgIH1cblx0XG5cdCAgdGhpcy5lbGVtZW50cyA9IG1ha2VBcnJheSggZWxlbSApO1xuXHQgIHRoaXMub3B0aW9ucyA9IGV4dGVuZCgge30sIHRoaXMub3B0aW9ucyApO1xuXHRcblx0ICBpZiAoIHR5cGVvZiBvcHRpb25zID09ICdmdW5jdGlvbicgKSB7XG5cdCAgICBvbkFsd2F5cyA9IG9wdGlvbnM7XG5cdCAgfSBlbHNlIHtcblx0ICAgIGV4dGVuZCggdGhpcy5vcHRpb25zLCBvcHRpb25zICk7XG5cdCAgfVxuXHRcblx0ICBpZiAoIG9uQWx3YXlzICkge1xuXHQgICAgdGhpcy5vbiggJ2Fsd2F5cycsIG9uQWx3YXlzICk7XG5cdCAgfVxuXHRcblx0ICB0aGlzLmdldEltYWdlcygpO1xuXHRcblx0ICBpZiAoICQgKSB7XG5cdCAgICAvLyBhZGQgalF1ZXJ5IERlZmVycmVkIG9iamVjdFxuXHQgICAgdGhpcy5qcURlZmVycmVkID0gbmV3ICQuRGVmZXJyZWQoKTtcblx0ICB9XG5cdFxuXHQgIC8vIEhBQ0sgY2hlY2sgYXN5bmMgdG8gYWxsb3cgdGltZSB0byBiaW5kIGxpc3RlbmVyc1xuXHQgIHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuXHQgICAgdGhpcy5jaGVjaygpO1xuXHQgIH0uYmluZCggdGhpcyApKTtcblx0fVxuXHRcblx0SW1hZ2VzTG9hZGVkLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoIEV2RW1pdHRlci5wcm90b3R5cGUgKTtcblx0XG5cdEltYWdlc0xvYWRlZC5wcm90b3R5cGUub3B0aW9ucyA9IHt9O1xuXHRcblx0SW1hZ2VzTG9hZGVkLnByb3RvdHlwZS5nZXRJbWFnZXMgPSBmdW5jdGlvbigpIHtcblx0ICB0aGlzLmltYWdlcyA9IFtdO1xuXHRcblx0ICAvLyBmaWx0ZXIgJiBmaW5kIGl0ZW1zIGlmIHdlIGhhdmUgYW4gaXRlbSBzZWxlY3RvclxuXHQgIHRoaXMuZWxlbWVudHMuZm9yRWFjaCggdGhpcy5hZGRFbGVtZW50SW1hZ2VzLCB0aGlzICk7XG5cdH07XG5cdFxuXHQvKipcblx0ICogQHBhcmFtIHtOb2RlfSBlbGVtZW50XG5cdCAqL1xuXHRJbWFnZXNMb2FkZWQucHJvdG90eXBlLmFkZEVsZW1lbnRJbWFnZXMgPSBmdW5jdGlvbiggZWxlbSApIHtcblx0ICAvLyBmaWx0ZXIgc2libGluZ3Ncblx0ICBpZiAoIGVsZW0ubm9kZU5hbWUgPT0gJ0lNRycgKSB7XG5cdCAgICB0aGlzLmFkZEltYWdlKCBlbGVtICk7XG5cdCAgfVxuXHQgIC8vIGdldCBiYWNrZ3JvdW5kIGltYWdlIG9uIGVsZW1lbnRcblx0ICBpZiAoIHRoaXMub3B0aW9ucy5iYWNrZ3JvdW5kID09PSB0cnVlICkge1xuXHQgICAgdGhpcy5hZGRFbGVtZW50QmFja2dyb3VuZEltYWdlcyggZWxlbSApO1xuXHQgIH1cblx0XG5cdCAgLy8gZmluZCBjaGlsZHJlblxuXHQgIC8vIG5vIG5vbi1lbGVtZW50IG5vZGVzLCAjMTQzXG5cdCAgdmFyIG5vZGVUeXBlID0gZWxlbS5ub2RlVHlwZTtcblx0ICBpZiAoICFub2RlVHlwZSB8fCAhZWxlbWVudE5vZGVUeXBlc1sgbm9kZVR5cGUgXSApIHtcblx0ICAgIHJldHVybjtcblx0ICB9XG5cdCAgdmFyIGNoaWxkSW1ncyA9IGVsZW0ucXVlcnlTZWxlY3RvckFsbCgnaW1nJyk7XG5cdCAgLy8gY29uY2F0IGNoaWxkRWxlbXMgdG8gZmlsdGVyRm91bmQgYXJyYXlcblx0ICBmb3IgKCB2YXIgaT0wOyBpIDwgY2hpbGRJbWdzLmxlbmd0aDsgaSsrICkge1xuXHQgICAgdmFyIGltZyA9IGNoaWxkSW1nc1tpXTtcblx0ICAgIHRoaXMuYWRkSW1hZ2UoIGltZyApO1xuXHQgIH1cblx0XG5cdCAgLy8gZ2V0IGNoaWxkIGJhY2tncm91bmQgaW1hZ2VzXG5cdCAgaWYgKCB0eXBlb2YgdGhpcy5vcHRpb25zLmJhY2tncm91bmQgPT0gJ3N0cmluZycgKSB7XG5cdCAgICB2YXIgY2hpbGRyZW4gPSBlbGVtLnF1ZXJ5U2VsZWN0b3JBbGwoIHRoaXMub3B0aW9ucy5iYWNrZ3JvdW5kICk7XG5cdCAgICBmb3IgKCBpPTA7IGkgPCBjaGlsZHJlbi5sZW5ndGg7IGkrKyApIHtcblx0ICAgICAgdmFyIGNoaWxkID0gY2hpbGRyZW5baV07XG5cdCAgICAgIHRoaXMuYWRkRWxlbWVudEJhY2tncm91bmRJbWFnZXMoIGNoaWxkICk7XG5cdCAgICB9XG5cdCAgfVxuXHR9O1xuXHRcblx0dmFyIGVsZW1lbnROb2RlVHlwZXMgPSB7XG5cdCAgMTogdHJ1ZSxcblx0ICA5OiB0cnVlLFxuXHQgIDExOiB0cnVlXG5cdH07XG5cdFxuXHRJbWFnZXNMb2FkZWQucHJvdG90eXBlLmFkZEVsZW1lbnRCYWNrZ3JvdW5kSW1hZ2VzID0gZnVuY3Rpb24oIGVsZW0gKSB7XG5cdCAgdmFyIHN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZSggZWxlbSApO1xuXHQgIGlmICggIXN0eWxlICkge1xuXHQgICAgLy8gRmlyZWZveCByZXR1cm5zIG51bGwgaWYgaW4gYSBoaWRkZW4gaWZyYW1lIGh0dHBzOi8vYnVnemlsLmxhLzU0ODM5N1xuXHQgICAgcmV0dXJuO1xuXHQgIH1cblx0ICAvLyBnZXQgdXJsIGluc2lkZSB1cmwoXCIuLi5cIilcblx0ICB2YXIgcmVVUkwgPSAvdXJsXFwoKFsnXCJdKT8oLio/KVxcMVxcKS9naTtcblx0ICB2YXIgbWF0Y2hlcyA9IHJlVVJMLmV4ZWMoIHN0eWxlLmJhY2tncm91bmRJbWFnZSApO1xuXHQgIHdoaWxlICggbWF0Y2hlcyAhPT0gbnVsbCApIHtcblx0ICAgIHZhciB1cmwgPSBtYXRjaGVzICYmIG1hdGNoZXNbMl07XG5cdCAgICBpZiAoIHVybCApIHtcblx0ICAgICAgdGhpcy5hZGRCYWNrZ3JvdW5kKCB1cmwsIGVsZW0gKTtcblx0ICAgIH1cblx0ICAgIG1hdGNoZXMgPSByZVVSTC5leGVjKCBzdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgKTtcblx0ICB9XG5cdH07XG5cdFxuXHQvKipcblx0ICogQHBhcmFtIHtJbWFnZX0gaW1nXG5cdCAqL1xuXHRJbWFnZXNMb2FkZWQucHJvdG90eXBlLmFkZEltYWdlID0gZnVuY3Rpb24oIGltZyApIHtcblx0ICB2YXIgbG9hZGluZ0ltYWdlID0gbmV3IExvYWRpbmdJbWFnZSggaW1nICk7XG5cdCAgdGhpcy5pbWFnZXMucHVzaCggbG9hZGluZ0ltYWdlICk7XG5cdH07XG5cdFxuXHRJbWFnZXNMb2FkZWQucHJvdG90eXBlLmFkZEJhY2tncm91bmQgPSBmdW5jdGlvbiggdXJsLCBlbGVtICkge1xuXHQgIHZhciBiYWNrZ3JvdW5kID0gbmV3IEJhY2tncm91bmQoIHVybCwgZWxlbSApO1xuXHQgIHRoaXMuaW1hZ2VzLnB1c2goIGJhY2tncm91bmQgKTtcblx0fTtcblx0XG5cdEltYWdlc0xvYWRlZC5wcm90b3R5cGUuY2hlY2sgPSBmdW5jdGlvbigpIHtcblx0ICB2YXIgX3RoaXMgPSB0aGlzO1xuXHQgIHRoaXMucHJvZ3Jlc3NlZENvdW50ID0gMDtcblx0ICB0aGlzLmhhc0FueUJyb2tlbiA9IGZhbHNlO1xuXHQgIC8vIGNvbXBsZXRlIGlmIG5vIGltYWdlc1xuXHQgIGlmICggIXRoaXMuaW1hZ2VzLmxlbmd0aCApIHtcblx0ICAgIHRoaXMuY29tcGxldGUoKTtcblx0ICAgIHJldHVybjtcblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIG9uUHJvZ3Jlc3MoIGltYWdlLCBlbGVtLCBtZXNzYWdlICkge1xuXHQgICAgLy8gSEFDSyAtIENocm9tZSB0cmlnZ2VycyBldmVudCBiZWZvcmUgb2JqZWN0IHByb3BlcnRpZXMgaGF2ZSBjaGFuZ2VkLiAjODNcblx0ICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuXHQgICAgICBfdGhpcy5wcm9ncmVzcyggaW1hZ2UsIGVsZW0sIG1lc3NhZ2UgKTtcblx0ICAgIH0pO1xuXHQgIH1cblx0XG5cdCAgdGhpcy5pbWFnZXMuZm9yRWFjaCggZnVuY3Rpb24oIGxvYWRpbmdJbWFnZSApIHtcblx0ICAgIGxvYWRpbmdJbWFnZS5vbmNlKCAncHJvZ3Jlc3MnLCBvblByb2dyZXNzICk7XG5cdCAgICBsb2FkaW5nSW1hZ2UuY2hlY2soKTtcblx0ICB9KTtcblx0fTtcblx0XG5cdEltYWdlc0xvYWRlZC5wcm90b3R5cGUucHJvZ3Jlc3MgPSBmdW5jdGlvbiggaW1hZ2UsIGVsZW0sIG1lc3NhZ2UgKSB7XG5cdCAgdGhpcy5wcm9ncmVzc2VkQ291bnQrKztcblx0ICB0aGlzLmhhc0FueUJyb2tlbiA9IHRoaXMuaGFzQW55QnJva2VuIHx8ICFpbWFnZS5pc0xvYWRlZDtcblx0ICAvLyBwcm9ncmVzcyBldmVudFxuXHQgIHRoaXMuZW1pdEV2ZW50KCAncHJvZ3Jlc3MnLCBbIHRoaXMsIGltYWdlLCBlbGVtIF0gKTtcblx0ICBpZiAoIHRoaXMuanFEZWZlcnJlZCAmJiB0aGlzLmpxRGVmZXJyZWQubm90aWZ5ICkge1xuXHQgICAgdGhpcy5qcURlZmVycmVkLm5vdGlmeSggdGhpcywgaW1hZ2UgKTtcblx0ICB9XG5cdCAgLy8gY2hlY2sgaWYgY29tcGxldGVkXG5cdCAgaWYgKCB0aGlzLnByb2dyZXNzZWRDb3VudCA9PSB0aGlzLmltYWdlcy5sZW5ndGggKSB7XG5cdCAgICB0aGlzLmNvbXBsZXRlKCk7XG5cdCAgfVxuXHRcblx0ICBpZiAoIHRoaXMub3B0aW9ucy5kZWJ1ZyAmJiBjb25zb2xlICkge1xuXHQgICAgY29uc29sZS5sb2coICdwcm9ncmVzczogJyArIG1lc3NhZ2UsIGltYWdlLCBlbGVtICk7XG5cdCAgfVxuXHR9O1xuXHRcblx0SW1hZ2VzTG9hZGVkLnByb3RvdHlwZS5jb21wbGV0ZSA9IGZ1bmN0aW9uKCkge1xuXHQgIHZhciBldmVudE5hbWUgPSB0aGlzLmhhc0FueUJyb2tlbiA/ICdmYWlsJyA6ICdkb25lJztcblx0ICB0aGlzLmlzQ29tcGxldGUgPSB0cnVlO1xuXHQgIHRoaXMuZW1pdEV2ZW50KCBldmVudE5hbWUsIFsgdGhpcyBdICk7XG5cdCAgdGhpcy5lbWl0RXZlbnQoICdhbHdheXMnLCBbIHRoaXMgXSApO1xuXHQgIGlmICggdGhpcy5qcURlZmVycmVkICkge1xuXHQgICAgdmFyIGpxTWV0aG9kID0gdGhpcy5oYXNBbnlCcm9rZW4gPyAncmVqZWN0JyA6ICdyZXNvbHZlJztcblx0ICAgIHRoaXMuanFEZWZlcnJlZFsganFNZXRob2QgXSggdGhpcyApO1xuXHQgIH1cblx0fTtcblx0XG5cdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvL1xuXHRcblx0ZnVuY3Rpb24gTG9hZGluZ0ltYWdlKCBpbWcgKSB7XG5cdCAgdGhpcy5pbWcgPSBpbWc7XG5cdH1cblx0XG5cdExvYWRpbmdJbWFnZS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKCBFdkVtaXR0ZXIucHJvdG90eXBlICk7XG5cdFxuXHRMb2FkaW5nSW1hZ2UucHJvdG90eXBlLmNoZWNrID0gZnVuY3Rpb24oKSB7XG5cdCAgLy8gSWYgY29tcGxldGUgaXMgdHJ1ZSBhbmQgYnJvd3NlciBzdXBwb3J0cyBuYXR1cmFsIHNpemVzLFxuXHQgIC8vIHRyeSB0byBjaGVjayBmb3IgaW1hZ2Ugc3RhdHVzIG1hbnVhbGx5LlxuXHQgIHZhciBpc0NvbXBsZXRlID0gdGhpcy5nZXRJc0ltYWdlQ29tcGxldGUoKTtcblx0ICBpZiAoIGlzQ29tcGxldGUgKSB7XG5cdCAgICAvLyByZXBvcnQgYmFzZWQgb24gbmF0dXJhbFdpZHRoXG5cdCAgICB0aGlzLmNvbmZpcm0oIHRoaXMuaW1nLm5hdHVyYWxXaWR0aCAhPT0gMCwgJ25hdHVyYWxXaWR0aCcgKTtcblx0ICAgIHJldHVybjtcblx0ICB9XG5cdFxuXHQgIC8vIElmIG5vbmUgb2YgdGhlIGNoZWNrcyBhYm92ZSBtYXRjaGVkLCBzaW11bGF0ZSBsb2FkaW5nIG9uIGRldGFjaGVkIGVsZW1lbnQuXG5cdCAgdGhpcy5wcm94eUltYWdlID0gbmV3IEltYWdlKCk7XG5cdCAgdGhpcy5wcm94eUltYWdlLmFkZEV2ZW50TGlzdGVuZXIoICdsb2FkJywgdGhpcyApO1xuXHQgIHRoaXMucHJveHlJbWFnZS5hZGRFdmVudExpc3RlbmVyKCAnZXJyb3InLCB0aGlzICk7XG5cdCAgLy8gYmluZCB0byBpbWFnZSBhcyB3ZWxsIGZvciBGaXJlZm94LiAjMTkxXG5cdCAgdGhpcy5pbWcuYWRkRXZlbnRMaXN0ZW5lciggJ2xvYWQnLCB0aGlzICk7XG5cdCAgdGhpcy5pbWcuYWRkRXZlbnRMaXN0ZW5lciggJ2Vycm9yJywgdGhpcyApO1xuXHQgIHRoaXMucHJveHlJbWFnZS5zcmMgPSB0aGlzLmltZy5zcmM7XG5cdH07XG5cdFxuXHRMb2FkaW5nSW1hZ2UucHJvdG90eXBlLmdldElzSW1hZ2VDb21wbGV0ZSA9IGZ1bmN0aW9uKCkge1xuXHQgIHJldHVybiB0aGlzLmltZy5jb21wbGV0ZSAmJiB0aGlzLmltZy5uYXR1cmFsV2lkdGggIT09IHVuZGVmaW5lZDtcblx0fTtcblx0XG5cdExvYWRpbmdJbWFnZS5wcm90b3R5cGUuY29uZmlybSA9IGZ1bmN0aW9uKCBpc0xvYWRlZCwgbWVzc2FnZSApIHtcblx0ICB0aGlzLmlzTG9hZGVkID0gaXNMb2FkZWQ7XG5cdCAgdGhpcy5lbWl0RXZlbnQoICdwcm9ncmVzcycsIFsgdGhpcywgdGhpcy5pbWcsIG1lc3NhZ2UgXSApO1xuXHR9O1xuXHRcblx0Ly8gLS0tLS0gZXZlbnRzIC0tLS0tIC8vXG5cdFxuXHQvLyB0cmlnZ2VyIHNwZWNpZmllZCBoYW5kbGVyIGZvciBldmVudCB0eXBlXG5cdExvYWRpbmdJbWFnZS5wcm90b3R5cGUuaGFuZGxlRXZlbnQgPSBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdCAgdmFyIG1ldGhvZCA9ICdvbicgKyBldmVudC50eXBlO1xuXHQgIGlmICggdGhpc1sgbWV0aG9kIF0gKSB7XG5cdCAgICB0aGlzWyBtZXRob2QgXSggZXZlbnQgKTtcblx0ICB9XG5cdH07XG5cdFxuXHRMb2FkaW5nSW1hZ2UucHJvdG90eXBlLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuXHQgIHRoaXMuY29uZmlybSggdHJ1ZSwgJ29ubG9hZCcgKTtcblx0ICB0aGlzLnVuYmluZEV2ZW50cygpO1xuXHR9O1xuXHRcblx0TG9hZGluZ0ltYWdlLnByb3RvdHlwZS5vbmVycm9yID0gZnVuY3Rpb24oKSB7XG5cdCAgdGhpcy5jb25maXJtKCBmYWxzZSwgJ29uZXJyb3InICk7XG5cdCAgdGhpcy51bmJpbmRFdmVudHMoKTtcblx0fTtcblx0XG5cdExvYWRpbmdJbWFnZS5wcm90b3R5cGUudW5iaW5kRXZlbnRzID0gZnVuY3Rpb24oKSB7XG5cdCAgdGhpcy5wcm94eUltYWdlLnJlbW92ZUV2ZW50TGlzdGVuZXIoICdsb2FkJywgdGhpcyApO1xuXHQgIHRoaXMucHJveHlJbWFnZS5yZW1vdmVFdmVudExpc3RlbmVyKCAnZXJyb3InLCB0aGlzICk7XG5cdCAgdGhpcy5pbWcucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ2xvYWQnLCB0aGlzICk7XG5cdCAgdGhpcy5pbWcucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ2Vycm9yJywgdGhpcyApO1xuXHR9O1xuXHRcblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gQmFja2dyb3VuZCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvL1xuXHRcblx0ZnVuY3Rpb24gQmFja2dyb3VuZCggdXJsLCBlbGVtZW50ICkge1xuXHQgIHRoaXMudXJsID0gdXJsO1xuXHQgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG5cdCAgdGhpcy5pbWcgPSBuZXcgSW1hZ2UoKTtcblx0fVxuXHRcblx0Ly8gaW5oZXJpdCBMb2FkaW5nSW1hZ2UgcHJvdG90eXBlXG5cdEJhY2tncm91bmQucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZSggTG9hZGluZ0ltYWdlLnByb3RvdHlwZSApO1xuXHRcblx0QmFja2dyb3VuZC5wcm90b3R5cGUuY2hlY2sgPSBmdW5jdGlvbigpIHtcblx0ICB0aGlzLmltZy5hZGRFdmVudExpc3RlbmVyKCAnbG9hZCcsIHRoaXMgKTtcblx0ICB0aGlzLmltZy5hZGRFdmVudExpc3RlbmVyKCAnZXJyb3InLCB0aGlzICk7XG5cdCAgdGhpcy5pbWcuc3JjID0gdGhpcy51cmw7XG5cdCAgLy8gY2hlY2sgaWYgaW1hZ2UgaXMgYWxyZWFkeSBjb21wbGV0ZVxuXHQgIHZhciBpc0NvbXBsZXRlID0gdGhpcy5nZXRJc0ltYWdlQ29tcGxldGUoKTtcblx0ICBpZiAoIGlzQ29tcGxldGUgKSB7XG5cdCAgICB0aGlzLmNvbmZpcm0oIHRoaXMuaW1nLm5hdHVyYWxXaWR0aCAhPT0gMCwgJ25hdHVyYWxXaWR0aCcgKTtcblx0ICAgIHRoaXMudW5iaW5kRXZlbnRzKCk7XG5cdCAgfVxuXHR9O1xuXHRcblx0QmFja2dyb3VuZC5wcm90b3R5cGUudW5iaW5kRXZlbnRzID0gZnVuY3Rpb24oKSB7XG5cdCAgdGhpcy5pbWcucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ2xvYWQnLCB0aGlzICk7XG5cdCAgdGhpcy5pbWcucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ2Vycm9yJywgdGhpcyApO1xuXHR9O1xuXHRcblx0QmFja2dyb3VuZC5wcm90b3R5cGUuY29uZmlybSA9IGZ1bmN0aW9uKCBpc0xvYWRlZCwgbWVzc2FnZSApIHtcblx0ICB0aGlzLmlzTG9hZGVkID0gaXNMb2FkZWQ7XG5cdCAgdGhpcy5lbWl0RXZlbnQoICdwcm9ncmVzcycsIFsgdGhpcywgdGhpcy5lbGVtZW50LCBtZXNzYWdlIF0gKTtcblx0fTtcblx0XG5cdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIGpRdWVyeSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvL1xuXHRcblx0SW1hZ2VzTG9hZGVkLm1ha2VKUXVlcnlQbHVnaW4gPSBmdW5jdGlvbiggalF1ZXJ5ICkge1xuXHQgIGpRdWVyeSA9IGpRdWVyeSB8fCB3aW5kb3cualF1ZXJ5O1xuXHQgIGlmICggIWpRdWVyeSApIHtcblx0ICAgIHJldHVybjtcblx0ICB9XG5cdCAgLy8gc2V0IGxvY2FsIHZhcmlhYmxlXG5cdCAgJCA9IGpRdWVyeTtcblx0ICAvLyAkKCkuaW1hZ2VzTG9hZGVkKClcblx0ICAkLmZuLmltYWdlc0xvYWRlZCA9IGZ1bmN0aW9uKCBvcHRpb25zLCBjYWxsYmFjayApIHtcblx0ICAgIHZhciBpbnN0YW5jZSA9IG5ldyBJbWFnZXNMb2FkZWQoIHRoaXMsIG9wdGlvbnMsIGNhbGxiYWNrICk7XG5cdCAgICByZXR1cm4gaW5zdGFuY2UuanFEZWZlcnJlZC5wcm9taXNlKCAkKHRoaXMpICk7XG5cdCAgfTtcblx0fTtcblx0Ly8gdHJ5IG1ha2luZyBwbHVnaW5cblx0SW1hZ2VzTG9hZGVkLm1ha2VKUXVlcnlQbHVnaW4oKTtcblx0XG5cdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvL1xuXHRcblx0cmV0dXJuIEltYWdlc0xvYWRlZDtcblx0XG5cdH0pO1xuXG5cbi8qKiovIH0sXG4vKiAyMiAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0RmxpY2tpdHlEaXJlY3RpdmUuJGluamVjdCA9IFtcIiR0aW1lb3V0XCIsIFwiRmxpY2tpdHlTZXJ2aWNlXCJdO1xuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRleHBvcnRzLkZsaWNraXR5RGlyZWN0aXZlID0gRmxpY2tpdHlEaXJlY3RpdmU7XG5cdFxuXHR2YXIgX2ZsaWNraXR5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMyk7XG5cdFxuXHRmdW5jdGlvbiBGbGlja2l0eURpcmVjdGl2ZSgkdGltZW91dCwgRmxpY2tpdHlTZXJ2aWNlKSB7XG5cdCAgICAnbmdJbmplY3QnO1xuXHRcblx0ICAgIHByZUxpbmtGdW5jdGlvbi4kaW5qZWN0ID0gW1wiJHNjb3BlXCIsIFwiJGVsZW1lbnRcIiwgXCIkYXR0cnNcIiwgXCIkY29udHJvbGxlclwiXTtcblx0ICAgIHBvc3RMaW5rRnVuY3Rpb24uJGluamVjdCA9IFtcIiRzY29wZVwiLCBcIiRlbGVtZW50XCIsIFwiJGF0dHJzXCIsIFwiJGNvbnRyb2xsZXJcIl07XG5cdCAgICB2YXIgZGlyZWN0aXZlID0ge1xuXHQgICAgICAgIHJlc3RyaWN0OiAnQScsXG5cdCAgICAgICAgc2NvcGU6IHt9LFxuXHQgICAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHtcblx0ICAgICAgICAgICAgYmNGbGlja2l0eTogJ0A/Jyxcblx0ICAgICAgICAgICAgYmNGbGlja2l0eUlkOiAnQD8nXG5cdCAgICAgICAgfSxcblx0ICAgICAgICBjb21waWxlOiBmdW5jdGlvbiBjb21waWxlKCkge1xuXHQgICAgICAgICAgICByZXR1cm4ge1xuXHQgICAgICAgICAgICAgICAgcHJlOiBwcmVMaW5rRnVuY3Rpb24sXG5cdCAgICAgICAgICAgICAgICBwb3N0OiBwb3N0TGlua0Z1bmN0aW9uXG5cdCAgICAgICAgICAgIH07XG5cdCAgICAgICAgfSxcblx0ICAgICAgICBjb250cm9sbGVyOiBfZmxpY2tpdHkuRmxpY2tpdHlDb250cm9sbGVyLFxuXHQgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJ1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gZGlyZWN0aXZlO1xuXHRcblx0ICAgIGZ1bmN0aW9uIHByZUxpbmtGdW5jdGlvbigkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMsICRjb250cm9sbGVyKSB7XG5cdCAgICAgICAgJ25nSW5qZWN0Jztcblx0XG5cdCAgICAgICAgLy8gSWYgbm8gSUQgd2FzIHBhc3NlZCBpblxuXHRcblx0ICAgICAgICBpZiAoISRjb250cm9sbGVyLmJjRmxpY2tpdHlJZCkge1xuXHQgICAgICAgICAgICAvLyBVc2UgdGhlIGVsZW1lbnQncyBJRCBpZiBvbmUgZXhpc3RzXG5cdCAgICAgICAgICAgIGlmICgkYXR0cnMuaWQpIHtcblx0ICAgICAgICAgICAgICAgICRjb250cm9sbGVyLmJjRmxpY2tpdHlJZCA9ICRhdHRycy5pZDtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgIH1cblx0XG5cdCAgICAvKipcblx0ICAgICAqIFBvc3QgTGlua1xuXHQgICAgICovXG5cdCAgICBmdW5jdGlvbiBwb3N0TGlua0Z1bmN0aW9uKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycywgJGNvbnRyb2xsZXIpIHtcblx0ICAgICAgICAnbmdJbmplY3QnO1xuXHRcblx0ICAgICAgICAvLyBNYWtlIHN1cmUgdGhpcyBgY3JlYXRlKClgIGdldHMgcGlja2VkIHVwIGluIHRoZSBuZXh0IGRpZ2VzdCBjeWNsZVxuXHRcblx0ICAgICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFxuXHQgICAgICAgICAgICAvLyBJbml0aWFsaXplIEZsaWNraXR5XG5cdCAgICAgICAgICAgIEZsaWNraXR5U2VydmljZS5jcmVhdGUoJGVsZW1lbnRbMF0sICRjb250cm9sbGVyLmJjRmxpY2tpdHlJZCwgJGNvbnRyb2xsZXIub3B0aW9ucykudGhlbihmdW5jdGlvbiAoZmxpY2tpdHlJbnN0YW5jZSkge1xuXHRcblx0ICAgICAgICAgICAgICAgIC8vIEV4cG9zZSB0aGUgRmxpY2tpdHkgaW5zdGFuY2UgYW5kIElEXG5cdCAgICAgICAgICAgICAgICAkY29udHJvbGxlci5GbGlja2l0eSA9IGZsaWNraXR5SW5zdGFuY2UuaW5zdGFuY2U7XG5cdCAgICAgICAgICAgICAgICAkY29udHJvbGxlci5iY0ZsaWNraXR5SWQgPSBmbGlja2l0eUluc3RhbmNlLmlkO1xuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgLy8gV2hlbiB0aGUgZGlyZWN0aXZlIGlzIGJlaW5nIGRlc3Ryb3llZFxuXHQgICAgICAgIHZhciBvbkRlc3Ryb3kgPSAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uIChldmVudCkge1xuXHQgICAgICAgICAgICAvLyBNYWtlIHN1cmUgd2UgZGVzdHJveSB0aGUgRmxpY2tpdHkgaW5zdGFuY2Vcblx0ICAgICAgICAgICAgRmxpY2tpdHlTZXJ2aWNlLmRlc3Ryb3koJGNvbnRyb2xsZXIuYmNGbGlja2l0eUlkKTtcblx0ICAgICAgICB9KTtcblx0ICAgIH1cblx0fSAvKiBnbG9iYWwgRmxpY2tpdHkgKi9cblxuLyoqKi8gfSxcbi8qIDIzICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cdFxuXHR2YXIgRmxpY2tpdHlDb250cm9sbGVyID0gZXhwb3J0cy5GbGlja2l0eUNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICBGbGlja2l0eUNvbnRyb2xsZXIuJGluamVjdCA9IFtcIkZsaWNraXR5Q29uZmlnXCJdO1xuXHQgICAgZnVuY3Rpb24gRmxpY2tpdHlDb250cm9sbGVyKEZsaWNraXR5Q29uZmlnKSB7XG5cdCAgICAgICAgJ25nSW5qZWN0Jztcblx0XG5cdCAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEZsaWNraXR5Q29udHJvbGxlcik7XG5cdFxuXHQgICAgICAgIHRoaXMuRmxpY2tpdHlDb25maWcgPSBGbGlja2l0eUNvbmZpZztcblx0XG5cdCAgICAgICAgdGhpcy5fYWN0aXZhdGUoKTtcblx0ICAgIH1cblx0XG5cdCAgICBfY3JlYXRlQ2xhc3MoRmxpY2tpdHlDb250cm9sbGVyLCBbe1xuXHQgICAgICAgIGtleTogJ19hY3RpdmF0ZScsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9hY3RpdmF0ZSgpIHtcblx0XG5cdCAgICAgICAgICAgIC8vIEV4dGVuZCB0aGUgZGVmYXVsdCBvcHRpb25zIHdpdGggdXNlciBjb25maWd1cmF0aW9uXG5cdCAgICAgICAgICAgIHRoaXMub3B0aW9ucyA9IGFuZ3VsYXIuZXh0ZW5kKHt9LCB0aGlzLkZsaWNraXR5Q29uZmlnLCBhbmd1bGFyLmZyb21Kc29uKHRoaXMuYmNGbGlja2l0eSB8IHt9KSk7XG5cdCAgICAgICAgfVxuXHQgICAgfV0pO1xuXHRcblx0ICAgIHJldHVybiBGbGlja2l0eUNvbnRyb2xsZXI7XG5cdH0oKTtcblxuLyoqKi8gfSxcbi8qIDI0ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRGbGlja2l0eU5leHREaXJlY3RpdmUuJGluamVjdCA9IFtcIiRsb2dcIiwgXCIkdGltZW91dFwiLCBcIiRyb290U2NvcGVcIiwgXCJGbGlja2l0eUNvbmZpZ1wiLCBcIkZsaWNraXR5U2VydmljZVwiXTtcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG5cdCAgICB2YWx1ZTogdHJ1ZVxuXHR9KTtcblx0ZXhwb3J0cy5GbGlja2l0eU5leHREaXJlY3RpdmUgPSBGbGlja2l0eU5leHREaXJlY3RpdmU7XG5cdFxuXHR2YXIgX25leHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI1KTtcblx0XG5cdGZ1bmN0aW9uIEZsaWNraXR5TmV4dERpcmVjdGl2ZSgkbG9nLCAkdGltZW91dCwgJHJvb3RTY29wZSwgRmxpY2tpdHlDb25maWcsIEZsaWNraXR5U2VydmljZSkge1xuXHQgICAgJ25nSW5qZWN0Jztcblx0XG5cdCAgICBwcmVMaW5rRnVuY3Rpb24uJGluamVjdCA9IFtcIiRzY29wZVwiLCBcIiRlbGVtZW50XCIsIFwiJGF0dHJzXCIsIFwiJGNvbnRyb2xsZXJcIl07XG5cdCAgICB2YXIgZGlyZWN0aXZlID0ge1xuXHQgICAgICAgIHJlc3RyaWN0OiAnQScsXG5cdCAgICAgICAgc2NvcGU6IHt9LFxuXHQgICAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHtcblx0ICAgICAgICAgICAgYmNGbGlja2l0eU5leHQ6ICc9PycsXG5cdCAgICAgICAgICAgIGJjRmxpY2tpdHlJZDogJ0A/J1xuXHQgICAgICAgIH0sXG5cdCAgICAgICAgY29tcGlsZTogZnVuY3Rpb24gY29tcGlsZSgpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIHtcblx0ICAgICAgICAgICAgICAgIHByZTogcHJlTGlua0Z1bmN0aW9uXG5cdCAgICAgICAgICAgIH07XG5cdCAgICAgICAgfSxcblx0ICAgICAgICBjb250cm9sbGVyOiBfbmV4dC5OZXh0Q29udHJvbGxlcixcblx0ICAgICAgICBjb250cm9sbGVyQXM6ICd2bSdcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIGRpcmVjdGl2ZTtcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFByZSBMaW5rXG5cdCAgICAgKi9cblx0ICAgIGZ1bmN0aW9uIHByZUxpbmtGdW5jdGlvbigkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMsICRjb250cm9sbGVyKSB7XG5cdCAgICAgICAgJ25nSW5qZWN0Jztcblx0XG5cdCAgICAgICAgLy8gR2V0IHRoZSBJRFxuXHRcblx0ICAgICAgICB2YXIgSUQgPSAkY29udHJvbGxlci5mbGlja2l0eUlkO1xuXHRcblx0ICAgICAgICAvLyBEZWZpbmUgdGhlIGJyb2FkY2FzdCBuYW1lcyB0byBsaXN0ZW4gZm9yXG5cdCAgICAgICAgdmFyIHNlbGVjdEV2ZW50ID0gJ0ZsaWNraXR5OicgKyBJRCArICc6Y2VsbFNlbGVjdCc7XG5cdCAgICAgICAgdmFyIHNldHRsZUV2ZW50ID0gJ0ZsaWNraXR5OicgKyAkY29udHJvbGxlci5mbGlja2l0eUlkICsgJzpzZXR0bGUnO1xuXHRcblx0ICAgICAgICAvLyBMaXN0ZW5cblx0ICAgICAgICB2YXIgY2VsbFNlbGVjdCA9ICRyb290U2NvcGUuJG9uKHNlbGVjdEV2ZW50LCBmdW5jdGlvbiAoZXZlbnQsIGRhdGEpIHtcblx0ICAgICAgICAgICAgX2Rpc2FibGVCdXR0b25JZk5lZWRlZChkYXRhLmluc3RhbmNlLmNlbGxzLmxlbmd0aCwgZGF0YS5pbnN0YW5jZS5zZWxlY3RlZEluZGV4ICsgMSk7XG5cdCAgICAgICAgfSk7XG5cdCAgICAgICAgdmFyIHNldHRsZSA9ICRyb290U2NvcGUuJG9uKHNldHRsZUV2ZW50LCBmdW5jdGlvbiAoZXZlbnQsIGRhdGEpIHtcblx0ICAgICAgICAgICAgX2Rpc2FibGVCdXR0b25JZk5lZWRlZChkYXRhLmluc3RhbmNlLmNlbGxzLmxlbmd0aCwgZGF0YS5pbnN0YW5jZS5zZWxlY3RlZEluZGV4ICsgMSk7XG5cdCAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgICRlbGVtZW50Lm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcblx0XG5cdCAgICAgICAgICAgIC8vIE1vdmUgdG8gdGhlIG5leHQgY2VsbFxuXHQgICAgICAgICAgICBGbGlja2l0eVNlcnZpY2UubmV4dCgkY29udHJvbGxlci5mbGlja2l0eUlkLCAkY29udHJvbGxlci53cmFwQXJvdW5kKTtcblx0ICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogRGlzYWJsZSBidXR0b24gaWYgbmVlZGVkXG5cdCAgICAgICAgICpcblx0ICAgICAgICAgKiBAcGFyYW0ge0ludH0gaW5kZXhcblx0ICAgICAgICAgKi9cblx0ICAgICAgICBmdW5jdGlvbiBfZGlzYWJsZUJ1dHRvbklmTmVlZGVkKGluZGV4LCBjZWxsQ291bnQpIHtcblx0XG5cdCAgICAgICAgICAgIC8vIERpc2FibGUgYnV0dG9uIGlmIGF0IHRoZSBiZWdpbm5pbmcgYW5kIHdlIHNob3VsZG4ndCB3cmFwXG5cdCAgICAgICAgICAgIGlmICghJGNvbnRyb2xsZXIud3JhcEFyb3VuZCAmJiBpbmRleCA9PT0gY2VsbENvdW50KSB7XG5cdCAgICAgICAgICAgICAgICAkYXR0cnMuJHNldCgnZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTtcblx0ICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgICRhdHRycy4kc2V0KCdkaXNhYmxlZCcsIGZhbHNlKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgIH1cblx0fVxuXG4vKioqLyB9LFxuLyogMjUgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuXHQgICAgdmFsdWU6IHRydWVcblx0fSk7XG5cdFxuXHR2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXHRcblx0ZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblx0XG5cdHZhciBOZXh0Q29udHJvbGxlciA9IGV4cG9ydHMuTmV4dENvbnRyb2xsZXIgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICBOZXh0Q29udHJvbGxlci4kaW5qZWN0ID0gW1wiJGxvZ1wiLCBcIiRxXCIsIFwiJHRpbWVvdXRcIiwgXCJGbGlja2l0eUNvbmZpZ1wiLCBcIkZsaWNraXR5U2VydmljZVwiXTtcblx0ICAgIGZ1bmN0aW9uIE5leHRDb250cm9sbGVyKCRsb2csICRxLCAkdGltZW91dCwgRmxpY2tpdHlDb25maWcsIEZsaWNraXR5U2VydmljZSkge1xuXHQgICAgICAgICduZ0luamVjdCc7XG5cdFxuXHQgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBOZXh0Q29udHJvbGxlcik7XG5cdFxuXHQgICAgICAgIHRoaXMuJGxvZyA9ICRsb2c7XG5cdCAgICAgICAgdGhpcy4kcSA9ICRxO1xuXHQgICAgICAgIHRoaXMuJHRpbWVvdXQgPSAkdGltZW91dDtcblx0ICAgICAgICB0aGlzLkZsaWNraXR5Q29uZmlnID0gRmxpY2tpdHlDb25maWc7XG5cdCAgICAgICAgdGhpcy5GbGlja2l0eVNlcnZpY2UgPSBGbGlja2l0eVNlcnZpY2U7XG5cdFxuXHQgICAgICAgIHRoaXMuX2FjdGl2YXRlKCk7XG5cdCAgICB9XG5cdFxuXHQgICAgX2NyZWF0ZUNsYXNzKE5leHRDb250cm9sbGVyLCBbe1xuXHQgICAgICAgIGtleTogJ19hY3RpdmF0ZScsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9hY3RpdmF0ZSgpIHtcblx0ICAgICAgICAgICAgLy8gQXNzaWduIG9yIGZhbGwgYmFjayB0byBkZWZhdWx0XG5cdCAgICAgICAgICAgIHRoaXMud3JhcEFyb3VuZCA9IHRoaXMuYmNGbGlja2l0eU5leHQgfHwgdGhpcy5GbGlja2l0eUNvbmZpZy53cmFwQXJvdW5kO1xuXHQgICAgICAgICAgICB0aGlzLmZsaWNraXR5SWQgPSBudWxsO1xuXHRcblx0ICAgICAgICAgICAgLy8gTWFrZSBzdXJlIHdlIGhhdmUgYW4gSURcblx0ICAgICAgICAgICAgdGhpcy5fc2V0SWQoKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIFNldCBJRCB0byB3aGF0IGlzIGRlZmluZWQsIGZhbGxiYWNrIHRvIGZpcnN0IGluc3RhbmNlXG5cdCAgICAgICAgICpcblx0ICAgICAgICAgKiBAcmV0dXJuIHtTdHJpbmd9IGZsaWNraXR5SWRcblx0ICAgICAgICAgKi9cblx0XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnX3NldElkJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3NldElkKCkge1xuXHQgICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHEoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXHRcblx0ICAgICAgICAgICAgICAgIGlmIChfdGhpcy5iY0ZsaWNraXR5SWQpIHtcblx0ICAgICAgICAgICAgICAgICAgICBfdGhpcy5mbGlja2l0eUlkID0gX3RoaXMuYmNGbGlja2l0eUlkO1xuXHQgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoX3RoaXMuZmxpY2tpdHlJZCk7XG5cdCAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgICAgIF90aGlzLiR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuRmxpY2tpdHlTZXJ2aWNlLmdldEZpcnN0KCkudGhlbihmdW5jdGlvbiAoaW5zdGFuY2UpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmZsaWNraXR5SWQgPSBpbnN0YW5jZS5pZDtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoX3RoaXMuZmxpY2tpdHlJZCk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuJGxvZy53YXJuKGVycm9yKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICB9XG5cdCAgICB9XSk7XG5cdFxuXHQgICAgcmV0dXJuIE5leHRDb250cm9sbGVyO1xuXHR9KCk7XG5cbi8qKiovIH0sXG4vKiAyNiAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0RmxpY2tpdHlQcmV2aW91c0RpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJGxvZ1wiLCBcIiR0aW1lb3V0XCIsIFwiJHJvb3RTY29wZVwiLCBcIkZsaWNraXR5Q29uZmlnXCIsIFwiRmxpY2tpdHlTZXJ2aWNlXCJdO1xuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRleHBvcnRzLkZsaWNraXR5UHJldmlvdXNEaXJlY3RpdmUgPSBGbGlja2l0eVByZXZpb3VzRGlyZWN0aXZlO1xuXHRcblx0dmFyIF9wcmV2aW91cyA9IF9fd2VicGFja19yZXF1aXJlX18oMjcpO1xuXHRcblx0ZnVuY3Rpb24gRmxpY2tpdHlQcmV2aW91c0RpcmVjdGl2ZSgkbG9nLCAkdGltZW91dCwgJHJvb3RTY29wZSwgRmxpY2tpdHlDb25maWcsIEZsaWNraXR5U2VydmljZSkge1xuXHQgICAgJ25nSW5qZWN0Jztcblx0XG5cdCAgICBwcmVMaW5rRnVuY3Rpb24uJGluamVjdCA9IFtcIiRzY29wZVwiLCBcIiRlbGVtZW50XCIsIFwiJGF0dHJzXCIsIFwiJGNvbnRyb2xsZXJcIl07XG5cdCAgICB2YXIgZGlyZWN0aXZlID0ge1xuXHQgICAgICAgIHJlc3RyaWN0OiAnQScsXG5cdCAgICAgICAgc2NvcGU6IHt9LFxuXHQgICAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHtcblx0ICAgICAgICAgICAgYmNGbGlja2l0eVByZXZpb3VzOiAnPT8nLFxuXHQgICAgICAgICAgICBiY0ZsaWNraXR5SWQ6ICdAPydcblx0ICAgICAgICB9LFxuXHQgICAgICAgIGNvbXBpbGU6IGZ1bmN0aW9uIGNvbXBpbGUoKSB7XG5cdCAgICAgICAgICAgIHJldHVybiB7XG5cdCAgICAgICAgICAgICAgICBwcmU6IHByZUxpbmtGdW5jdGlvblxuXHQgICAgICAgICAgICB9O1xuXHQgICAgICAgIH0sXG5cdCAgICAgICAgY29udHJvbGxlcjogX3ByZXZpb3VzLlByZXZpb3VzQ29udHJvbGxlcixcblx0ICAgICAgICBjb250cm9sbGVyQXM6ICd2bSdcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIGRpcmVjdGl2ZTtcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFByZSBMaW5rXG5cdCAgICAgKi9cblx0ICAgIGZ1bmN0aW9uIHByZUxpbmtGdW5jdGlvbigkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMsICRjb250cm9sbGVyKSB7XG5cdCAgICAgICAgJ25nSW5qZWN0Jztcblx0XG5cdCAgICAgICAgLy8gR2V0IHRoZSBJRFxuXHRcblx0ICAgICAgICB2YXIgSUQgPSAkY29udHJvbGxlci5mbGlja2l0eUlkO1xuXHRcblx0ICAgICAgICAvLyBEZWZpbmUgdGhlIGJyb2FkY2FzdCBuYW1lcyB0byBsaXN0ZW4gZm9yXG5cdCAgICAgICAgdmFyIHNlbGVjdEV2ZW50ID0gJ0ZsaWNraXR5OicgKyBJRCArICc6Y2VsbFNlbGVjdCc7XG5cdCAgICAgICAgdmFyIHNldHRsZUV2ZW50ID0gJ0ZsaWNraXR5OicgKyAkY29udHJvbGxlci5mbGlja2l0eUlkICsgJzpzZXR0bGUnO1xuXHRcblx0ICAgICAgICAvLyBMaXN0ZW5cblx0ICAgICAgICB2YXIgY2VsbFNlbGVjdCA9ICRyb290U2NvcGUuJG9uKHNlbGVjdEV2ZW50LCBmdW5jdGlvbiAoZXZlbnQsIGRhdGEpIHtcblx0ICAgICAgICAgICAgX2Rpc2FibGVCdXR0b25JZk5lZWRlZChkYXRhLmluc3RhbmNlLnNlbGVjdGVkSW5kZXgpO1xuXHQgICAgICAgIH0pO1xuXHQgICAgICAgIHZhciBzZXR0bGUgPSAkcm9vdFNjb3BlLiRvbihzZXR0bGVFdmVudCwgZnVuY3Rpb24gKGV2ZW50LCBkYXRhKSB7XG5cdCAgICAgICAgICAgIF9kaXNhYmxlQnV0dG9uSWZOZWVkZWQoZGF0YS5pbnN0YW5jZS5zZWxlY3RlZEluZGV4KTtcblx0ICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgJGVsZW1lbnQub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuXHRcblx0ICAgICAgICAgICAgLy8gTW92ZSB0byB0aGUgbmV4dCBjZWxsXG5cdCAgICAgICAgICAgIEZsaWNraXR5U2VydmljZS5wcmV2aW91cygkY29udHJvbGxlci5mbGlja2l0eUlkLCAkY29udHJvbGxlci53cmFwQXJvdW5kKTtcblx0ICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogRGlzYWJsZSBidXR0b24gaWYgbmVlZGVkXG5cdCAgICAgICAgICpcblx0ICAgICAgICAgKiBAcGFyYW0ge0ludH0gaW5kZXhcblx0ICAgICAgICAgKi9cblx0ICAgICAgICBmdW5jdGlvbiBfZGlzYWJsZUJ1dHRvbklmTmVlZGVkKGluZGV4KSB7XG5cdCAgICAgICAgICAgIC8vIERpc2FibGUgYnV0dG9uIGlmIGF0IHRoZSBiZWdpbm5pbmcgYW5kIHdlIHNob3VsZG4ndCB3cmFwXG5cdCAgICAgICAgICAgIGlmICghJGNvbnRyb2xsZXIud3JhcEFyb3VuZCAmJiBpbmRleCA9PT0gMCkge1xuXHQgICAgICAgICAgICAgICAgJGF0dHJzLiRzZXQoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyk7XG5cdCAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICAkYXR0cnMuJHNldCgnZGlzYWJsZWQnLCBmYWxzZSk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICB9XG5cdH1cblxuLyoqKi8gfSxcbi8qIDI3ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cdFxuXHR2YXIgUHJldmlvdXNDb250cm9sbGVyID0gZXhwb3J0cy5QcmV2aW91c0NvbnRyb2xsZXIgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICBQcmV2aW91c0NvbnRyb2xsZXIuJGluamVjdCA9IFtcIiRsb2dcIiwgXCIkcVwiLCBcIiR0aW1lb3V0XCIsIFwiRmxpY2tpdHlDb25maWdcIiwgXCJGbGlja2l0eVNlcnZpY2VcIl07XG5cdCAgICBmdW5jdGlvbiBQcmV2aW91c0NvbnRyb2xsZXIoJGxvZywgJHEsICR0aW1lb3V0LCBGbGlja2l0eUNvbmZpZywgRmxpY2tpdHlTZXJ2aWNlKSB7XG5cdCAgICAgICAgJ25nSW5qZWN0Jztcblx0XG5cdCAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFByZXZpb3VzQ29udHJvbGxlcik7XG5cdFxuXHQgICAgICAgIHRoaXMuJGxvZyA9ICRsb2c7XG5cdCAgICAgICAgdGhpcy4kcSA9ICRxO1xuXHQgICAgICAgIHRoaXMuJHRpbWVvdXQgPSAkdGltZW91dDtcblx0ICAgICAgICB0aGlzLkZsaWNraXR5Q29uZmlnID0gRmxpY2tpdHlDb25maWc7XG5cdCAgICAgICAgdGhpcy5GbGlja2l0eVNlcnZpY2UgPSBGbGlja2l0eVNlcnZpY2U7XG5cdFxuXHQgICAgICAgIHRoaXMuX2FjdGl2YXRlKCk7XG5cdCAgICB9XG5cdFxuXHQgICAgX2NyZWF0ZUNsYXNzKFByZXZpb3VzQ29udHJvbGxlciwgW3tcblx0ICAgICAgICBrZXk6ICdfYWN0aXZhdGUnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfYWN0aXZhdGUoKSB7XG5cdCAgICAgICAgICAgIC8vIEFzc2lnbiBvciBmYWxsIGJhY2sgdG8gZGVmYXVsdFxuXHQgICAgICAgICAgICB0aGlzLndyYXBBcm91bmQgPSB0aGlzLmJjRmxpY2tpdHlQcmV2aW91cyB8fCB0aGlzLkZsaWNraXR5Q29uZmlnLndyYXBBcm91bmQ7XG5cdCAgICAgICAgICAgIHRoaXMuZmxpY2tpdHlJZCA9IG51bGw7XG5cdFxuXHQgICAgICAgICAgICAvLyBNYWtlIHN1cmUgd2UgaGF2ZSBhbiBJRFxuXHQgICAgICAgICAgICB0aGlzLl9zZXRJZCgpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogU2V0IElEIHRvIHdoYXQgaXMgZGVmaW5lZCwgZmFsbGJhY2sgdG8gZmlyc3QgaW5zdGFuY2Vcblx0ICAgICAgICAgKlxuXHQgICAgICAgICAqIEByZXR1cm4ge1N0cmluZ30gZmxpY2tpdHlJZFxuXHQgICAgICAgICAqL1xuXHRcblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdfc2V0SWQnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfc2V0SWQoKSB7XG5cdCAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cdFxuXHQgICAgICAgICAgICByZXR1cm4gdGhpcy4kcShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFxuXHQgICAgICAgICAgICAgICAgaWYgKF90aGlzLmJjRmxpY2tpdHlJZCkge1xuXHQgICAgICAgICAgICAgICAgICAgIF90aGlzLmZsaWNraXR5SWQgPSBfdGhpcy5iY0ZsaWNraXR5SWQ7XG5cdCAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShfdGhpcy5mbGlja2l0eUlkKTtcblx0ICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICAgICAgX3RoaXMuJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5GbGlja2l0eVNlcnZpY2UuZ2V0Rmlyc3QoKS50aGVuKGZ1bmN0aW9uIChpbnN0YW5jZSkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZmxpY2tpdHlJZCA9IGluc3RhbmNlLmlkO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShfdGhpcy5mbGlja2l0eUlkKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy4kbG9nLndhcm4oZXJyb3IpO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgIH1cblx0ICAgIH1dKTtcblx0XG5cdCAgICByZXR1cm4gUHJldmlvdXNDb250cm9sbGVyO1xuXHR9KCk7XG5cbi8qKiovIH1cbi8qKioqKiovIF0pXG59KTtcbjtcblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiBhbmd1bGFyLWZsaWNraXR5Lm1pbi5qc1xuICoqLyIsIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuXG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRleHBvcnRzOiB7fSxcbiBcdFx0XHRpZDogbW9kdWxlSWQsXG4gXHRcdFx0bG9hZGVkOiBmYWxzZVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogd2VicGFjay9ib290c3RyYXAgZDkxZjAzMGEzMWQzMGFjYmZkNzBcbiAqKi8iLCIndXNlIHN0cmljdCc7XG5cbnZhciBfZmxpY2tpdHkgPSByZXF1aXJlKCcuL2ZsaWNraXR5LnByb3ZpZGVyJyk7XG5cbnZhciBfZmxpY2tpdHkyID0gcmVxdWlyZSgnLi9mbGlja2l0eS5zZXJ2aWNlJyk7XG5cbnZhciBfZmxpY2tpdHkzID0gcmVxdWlyZSgnLi9mbGlja2l0eS5kaXJlY3RpdmUnKTtcblxudmFyIF9mbGlja2l0eU5leHQgPSByZXF1aXJlKCcuL25leHQvZmxpY2tpdHlOZXh0LmRpcmVjdGl2ZScpO1xuXG52YXIgX2ZsaWNraXR5UHJldmlvdXMgPSByZXF1aXJlKCcuL3ByZXZpb3VzL2ZsaWNraXR5UHJldmlvdXMuZGlyZWN0aXZlJyk7XG5cbmFuZ3VsYXIubW9kdWxlKCdiYy5GbGlja2l0eScsIFtdKS5wcm92aWRlcignRmxpY2tpdHlDb25maWcnLCBfZmxpY2tpdHkuRmxpY2tpdHlDb25maWdQcm92aWRlcikuc2VydmljZSgnRmxpY2tpdHlTZXJ2aWNlJywgX2ZsaWNraXR5Mi5GbGlja2l0eVNlcnZpY2UpLmRpcmVjdGl2ZSgnYmNGbGlja2l0eScsIF9mbGlja2l0eTMuRmxpY2tpdHlEaXJlY3RpdmUpLmRpcmVjdGl2ZSgnYmNGbGlja2l0eU5leHQnLCBfZmxpY2tpdHlOZXh0LkZsaWNraXR5TmV4dERpcmVjdGl2ZSkuZGlyZWN0aXZlKCdiY0ZsaWNraXR5UHJldmlvdXMnLCBfZmxpY2tpdHlQcmV2aW91cy5GbGlja2l0eVByZXZpb3VzRGlyZWN0aXZlKTtcblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9pbmRleC5qc1xuICoqLyIsImltcG9ydCB7IEZsaWNraXR5Q29uZmlnUHJvdmlkZXIgfSBmcm9tICcuL2ZsaWNraXR5LnByb3ZpZGVyJ1xuaW1wb3J0IHsgRmxpY2tpdHlTZXJ2aWNlIH0gZnJvbSAnLi9mbGlja2l0eS5zZXJ2aWNlJztcbmltcG9ydCB7IEZsaWNraXR5RGlyZWN0aXZlIH0gZnJvbSAnLi9mbGlja2l0eS5kaXJlY3RpdmUnO1xuaW1wb3J0IHsgRmxpY2tpdHlOZXh0RGlyZWN0aXZlIH0gZnJvbSAnLi9uZXh0L2ZsaWNraXR5TmV4dC5kaXJlY3RpdmUnO1xuaW1wb3J0IHsgRmxpY2tpdHlQcmV2aW91c0RpcmVjdGl2ZSB9IGZyb20gJy4vcHJldmlvdXMvZmxpY2tpdHlQcmV2aW91cy5kaXJlY3RpdmUnO1xuXG5hbmd1bGFyLm1vZHVsZSgnYmMuRmxpY2tpdHknLCBbXSlcbiAgICAucHJvdmlkZXIoJ0ZsaWNraXR5Q29uZmlnJywgRmxpY2tpdHlDb25maWdQcm92aWRlcilcbiAgICAuc2VydmljZSgnRmxpY2tpdHlTZXJ2aWNlJywgRmxpY2tpdHlTZXJ2aWNlKVxuICAgIC5kaXJlY3RpdmUoJ2JjRmxpY2tpdHknLCBGbGlja2l0eURpcmVjdGl2ZSlcbiAgICAuZGlyZWN0aXZlKCdiY0ZsaWNraXR5TmV4dCcsIEZsaWNraXR5TmV4dERpcmVjdGl2ZSlcbiAgICAuZGlyZWN0aXZlKCdiY0ZsaWNraXR5UHJldmlvdXMnLCBGbGlja2l0eVByZXZpb3VzRGlyZWN0aXZlKVxuO1xuXG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL34vZXNsaW50LWxvYWRlciEuL3NyYy9pbmRleC5qc1xuICoqLyIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG52YXIgRmxpY2tpdHlDb25maWdQcm92aWRlciA9IGV4cG9ydHMuRmxpY2tpdHlDb25maWdQcm92aWRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBGbGlja2l0eUNvbmZpZ1Byb3ZpZGVyKCkge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRmxpY2tpdHlDb25maWdQcm92aWRlcik7XG5cbiAgICAgICAgLy8gRGVmaW5lIEZsaWNraXR5IGRlZmF1bHRzXG4gICAgICAgIHRoaXMuYWNjZXNzaWJpbGl0eSA9IHRydWU7XG4gICAgICAgIHRoaXMuYWRhcHRpdmVIZWlnaHQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5hdXRvUGxheSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmNlbGxBbGlnbiA9ICdjZW50ZXInO1xuICAgICAgICB0aGlzLmNlbGxTZWxlY3RvciA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5jb250YWluID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZHJhZ2dhYmxlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5kcmFnVGhyZXNob2xkID0gMztcbiAgICAgICAgdGhpcy5mcmVlU2Nyb2xsID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZnJlZVNjcm9sbEZyaWN0aW9uID0gZmFsc2U7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRBdHRyYWN0aW9uID0gLjAyNTtcbiAgICAgICAgdGhpcy5mcmljdGlvbiA9IC4yODtcbiAgICAgICAgdGhpcy5ncm91cENlbGxzID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaW5pdGlhbEluZGV4ID0gMDtcbiAgICAgICAgdGhpcy5sYXp5TG9hZCA9IHRydWU7XG4gICAgICAgIHRoaXMucGVyY2VudFBvc2l0aW9uID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5wcmV2TmV4dEJ1dHRvbnMgPSB0cnVlO1xuICAgICAgICB0aGlzLnBhZ2VEb3RzID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5yZXNpemUgPSB0cnVlO1xuICAgICAgICB0aGlzLnJpZ2h0VG9MZWZ0ID0gZmFsc2U7XG4gICAgICAgIHRoaXMuc2V0R2FsbGVyeVNpemUgPSB0cnVlO1xuICAgICAgICB0aGlzLndhdGNoQ1NTID0gZmFsc2U7XG4gICAgICAgIHRoaXMud3JhcEFyb3VuZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmltYWdlc0xvYWRlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuYXNOYXZGb3IgPSB0cnVlO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhGbGlja2l0eUNvbmZpZ1Byb3ZpZGVyLCBbe1xuICAgICAgICBrZXk6ICckZ2V0JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uICRnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBGbGlja2l0eUNvbmZpZ1Byb3ZpZGVyO1xufSgpO1xuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2ZsaWNraXR5LnByb3ZpZGVyLmpzXG4gKiovIiwiZXhwb3J0IGNsYXNzIEZsaWNraXR5Q29uZmlnUHJvdmlkZXIge1xuXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIC8vIERlZmluZSBGbGlja2l0eSBkZWZhdWx0c1xuICAgICAgICB0aGlzLmFjY2Vzc2liaWxpdHkgICAgICA9IHRydWU7XG4gICAgICAgIHRoaXMuYWRhcHRpdmVIZWlnaHQgICAgID0gZmFsc2U7XG4gICAgICAgIHRoaXMuYXV0b1BsYXkgICAgICAgICAgID0gZmFsc2U7XG4gICAgICAgIHRoaXMuY2VsbEFsaWduICAgICAgICAgID0gJ2NlbnRlcic7XG4gICAgICAgIHRoaXMuY2VsbFNlbGVjdG9yICAgICAgID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmNvbnRhaW4gICAgICAgICAgICA9IGZhbHNlO1xuICAgICAgICB0aGlzLmRyYWdnYWJsZSAgICAgICAgICA9IHRydWU7XG4gICAgICAgIHRoaXMuZHJhZ1RocmVzaG9sZCAgICAgID0gMztcbiAgICAgICAgdGhpcy5mcmVlU2Nyb2xsICAgICAgICAgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5mcmVlU2Nyb2xsRnJpY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgdGhpcy5zZWxlY3RlZEF0dHJhY3Rpb24gPSAuMDI1O1xuICAgICAgICB0aGlzLmZyaWN0aW9uICAgICAgICAgICA9IC4yODtcbiAgICAgICAgdGhpcy5ncm91cENlbGxzICAgICAgICAgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5pbml0aWFsSW5kZXggICAgICAgPSAwO1xuICAgICAgICB0aGlzLmxhenlMb2FkICAgICAgICAgICA9IHRydWU7XG4gICAgICAgIHRoaXMucGVyY2VudFBvc2l0aW9uICAgID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5wcmV2TmV4dEJ1dHRvbnMgICAgPSB0cnVlO1xuICAgICAgICB0aGlzLnBhZ2VEb3RzICAgICAgICAgICA9IHRydWU7XG4gICAgICAgIHRoaXMucmVzaXplICAgICAgICAgICAgID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5yaWdodFRvTGVmdCAgICAgICAgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5zZXRHYWxsZXJ5U2l6ZSAgICAgPSB0cnVlO1xuICAgICAgICB0aGlzLndhdGNoQ1NTICAgICAgICAgICA9IGZhbHNlO1xuICAgICAgICB0aGlzLndyYXBBcm91bmQgICAgICAgICA9IGZhbHNlO1xuICAgICAgICB0aGlzLmltYWdlc0xvYWRlZCAgICAgICA9IHRydWU7XG4gICAgICAgIHRoaXMuYXNOYXZGb3IgICAgICAgICAgID0gdHJ1ZTtcbiAgICB9XG5cblxuXG5cbiAgICAkZ2V0KCkge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cblxufVxuXG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL34vZXNsaW50LWxvYWRlciEuL3NyYy9mbGlja2l0eS5wcm92aWRlci5qc1xuICoqLyIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5GbGlja2l0eVNlcnZpY2UgPSB1bmRlZmluZWQ7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbnZhciBfZmxpY2tpdHkgPSByZXF1aXJlKCdmbGlja2l0eScpO1xuXG52YXIgX2ZsaWNraXR5MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2ZsaWNraXR5KTtcblxucmVxdWlyZSgnaW1hZ2VzTG9hZGVkJyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciBGbGlja2l0eVNlcnZpY2UgPSBleHBvcnRzLkZsaWNraXR5U2VydmljZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBGbGlja2l0eVNlcnZpY2UoJHRpbWVvdXQsICRxLCAkcm9vdFNjb3BlLCAkbG9nKSB7XG4gICAgICAgICduZ0luamVjdCc7XG5cbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEZsaWNraXR5U2VydmljZSk7XG5cbiAgICAgICAgdGhpcy4kdGltZW91dCA9ICR0aW1lb3V0O1xuICAgICAgICB0aGlzLiRxID0gJHE7XG4gICAgICAgIHRoaXMuJHJvb3RTY29wZSA9ICRyb290U2NvcGU7XG4gICAgICAgIHRoaXMuJGxvZyA9ICRsb2c7XG5cbiAgICAgICAgdGhpcy5pbnN0YW5jZXMgPSBbXTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBuZXcgRmxpY2tpdHkgaW5zdGFuY2VcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBpZFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zXG4gICAgICogQHJldHVybiB7T2JqZWN0fSBpbnN0YW5jZVxuICAgICAqL1xuXG5cbiAgICBfY3JlYXRlQ2xhc3MoRmxpY2tpdHlTZXJ2aWNlLCBbe1xuICAgICAgICBrZXk6ICdjcmVhdGUnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlKGVsZW1lbnQpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAgICAgICAgIHZhciBpZCA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMSB8fCBhcmd1bWVudHNbMV0gPT09IHVuZGVmaW5lZCA/IHRoaXMuaW5zdGFuY2VzLmxlbmd0aCArIDEgOiBhcmd1bWVudHNbMV07XG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50c1syXTtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICAvLyBDaGVjayB0byBzZWUgaWYgdGhlIElEIGlzIGFscmVhZHkgaW4gdXNlXG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLl9maW5kT2JqZWN0QnlJZChfdGhpcy5pbnN0YW5jZXMsIGlkKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBfdGhpcy5fZ2V0RmxpY2tpdHlJbmRleChpZCk7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLiRsb2cuZXJyb3IoJ1RoaXMgSUQgaXMgYWxyZWFkeSBpbiB1c2U6ICcsIF90aGlzLmluc3RhbmNlc1tpbmRleF0pO1xuXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCgpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIERlZmluZSB0aGUgbmV3IGluc3RhbmNlXG4gICAgICAgICAgICAgICAgdmFyIGluc3RhbmNlID0ge1xuICAgICAgICAgICAgICAgICAgICBpZDogaWQsXG4gICAgICAgICAgICAgICAgICAgIGluc3RhbmNlOiBuZXcgX2ZsaWNraXR5Mi5kZWZhdWx0KGVsZW1lbnQsIG9wdGlvbnMpXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIC8vIFNhdmUgdGhpcyBpbnN0YW5jZSB0byB0aGUgYXJyYXlcbiAgICAgICAgICAgICAgICBfdGhpcy5pbnN0YW5jZXMucHVzaChpbnN0YW5jZSk7XG5cbiAgICAgICAgICAgICAgICAvLyBCaW5kIHRvIGFsbCBldmVudHNcbiAgICAgICAgICAgICAgICBfdGhpcy5fYmluZEV2ZW50cyhpZCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoaW5zdGFuY2UpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogRGVzdHJveSBhIEZsaWNraXR5IGluc3RhbmNlXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBpZFxuICAgICAgICAgKiBAcmV0dXJuIHtPYmplY3R9IGluc3RhbmNlXG4gICAgICAgICAqL1xuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdkZXN0cm95JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3koaWQpIHtcbiAgICAgICAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgIHZhciBmbGlja2l0eUluZGV4ID0gX3RoaXMyLl9nZXRGbGlja2l0eUluZGV4KGlkKTtcblxuICAgICAgICAgICAgICAgIGlmIChmbGlja2l0eUluZGV4IDwgMCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoJ0luc3RhbmNlICcgKyBpZCArICcgbm90IGZvdW5kJyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gRGVzdHJveSB0aGUgRmxpY2tpdHkgaW5zdGFuY2VcbiAgICAgICAgICAgICAgICBfdGhpczIuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLmRlc3Ryb3koKTtcblxuICAgICAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgaW5zdGFuY2UgZnJvbSB0aGUgYXJyYXlcbiAgICAgICAgICAgICAgICBfdGhpczIuaW5zdGFuY2VzLnNwbGljZShmbGlja2l0eUluZGV4LCAxKTtcblxuICAgICAgICAgICAgICAgIHJlc29sdmUoJ0luc3RhbmNlICcgKyBpZCArICcgZGVzdHJveWVkLicpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogTW92ZSB0byB0aGUgbmV4dCBzbGlkZVxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAgICAgICAgICogQHBhcmFtIHtCb29sfSBpc1dyYXBwZWRcbiAgICAgICAgICogQHBhcmFtIHtCb29sfSBpc0luc3RhbnRcbiAgICAgICAgICogQHJldHVybiB7T2JqZWN0fSBpbnN0YW5jZVxuICAgICAgICAgKi9cblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnbmV4dCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBuZXh0KGlkLCBpc1dyYXBwZWQsIGlzSW5zdGFudCkge1xuICAgICAgICAgICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLiRxKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICB2YXIgZmxpY2tpdHlJbmRleCA9IF90aGlzMy5fZ2V0RmxpY2tpdHlJbmRleChpZCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoZmxpY2tpdHlJbmRleCA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCdJbnN0YW5jZSAnICsgaWQgKyAnIG5vdCBmb3VuZCcpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIE1vdmUgdG8gdGhlIG5leHQgc2xpZGVcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMzLmluc3RhbmNlc1tmbGlja2l0eUluZGV4XS5pbnN0YW5jZS5uZXh0KGlzV3JhcHBlZCwgaXNJbnN0YW50KTtcblxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKF90aGlzMy5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIE1vdmUgdG8gdGhlIHByZXZpb3VzIHNsaWRlXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICAgICAgICAgKiBAcGFyYW0ge0Jvb2x9IGlzV3JhcHBlZFxuICAgICAgICAgKiBAcGFyYW0ge0Jvb2x9IGlzSW5zdGFudFxuICAgICAgICAgKiBAcmV0dXJuIHtPYmplY3R9IGluc3RhbmNlXG4gICAgICAgICAqL1xuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdwcmV2aW91cycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwcmV2aW91cyhpZCwgaXNXcmFwcGVkLCBpc0luc3RhbnQpIHtcbiAgICAgICAgICAgIHZhciBfdGhpczQgPSB0aGlzO1xuXG4gICAgICAgICAgICByZXR1cm4gdGhpcy4kcShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgdmFyIGZsaWNraXR5SW5kZXggPSBfdGhpczQuX2dldEZsaWNraXR5SW5kZXgoaWQpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGZsaWNraXR5SW5kZXggPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCgnSW5zdGFuY2UgJyArIGlkICsgJyBub3QgZm91bmQnKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBNb3ZlIHRvIHRoZSBwcmV2aW91cyBzbGlkZVxuICAgICAgICAgICAgICAgICAgICBfdGhpczQuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLnByZXZpb3VzKGlzV3JhcHBlZCwgaXNJbnN0YW50KTtcblxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKF90aGlzNC5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNlbGVjdCBhIHNsaWRlXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBpZFxuICAgICAgICAgKiBAcGFyYW0ge0ludGVnZXJ9IGluZGV4XG4gICAgICAgICAqIEBwYXJhbSB7Qm9vbH0gaXNXcmFwcGVkXG4gICAgICAgICAqIEBwYXJhbSB7Qm9vbH0gaXNJbnN0YW50XG4gICAgICAgICAqIEByZXR1cm4ge09iamVjdH0gaW5zdGFuY2VcbiAgICAgICAgICovXG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3NlbGVjdCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZWxlY3QoaWQsIGluZGV4KSB7XG4gICAgICAgICAgICB2YXIgX3RoaXM1ID0gdGhpcztcblxuICAgICAgICAgICAgdmFyIGlzV3JhcHBlZCA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMiB8fCBhcmd1bWVudHNbMl0gPT09IHVuZGVmaW5lZCA/IGZhbHNlIDogYXJndW1lbnRzWzJdO1xuICAgICAgICAgICAgdmFyIGlzSW5zdGFudCA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMyB8fCBhcmd1bWVudHNbM10gPT09IHVuZGVmaW5lZCA/IGZhbHNlIDogYXJndW1lbnRzWzNdO1xuXG4gICAgICAgICAgICByZXR1cm4gdGhpcy4kcShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgdmFyIGZsaWNraXR5SW5kZXggPSBfdGhpczUuX2dldEZsaWNraXR5SW5kZXgoaWQpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGZsaWNraXR5SW5kZXggPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCgnSW5zdGFuY2UgJyArIGlkICsgJyBub3QgZm91bmQnKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBNb3ZlIHRvIHRoZSBzZWxlY3RlZCBzbGlkZVxuICAgICAgICAgICAgICAgICAgICBfdGhpczUuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLnNlbGVjdChpbmRleCwgaXNXcmFwcGVkLCBpc0luc3RhbnQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoX3RoaXM1Lmluc3RhbmNlc1tmbGlja2l0eUluZGV4XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogU2VsZWN0IGEgc2xpZGUgb2YgYSBjZWxsXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBpZFxuICAgICAgICAgKiBAcGFyYW0ge0ludGVnZXJ8U3RyaW5nfSB2YWx1ZVxuICAgICAgICAgKiBAcGFyYW0ge0Jvb2x9IGlzV3JhcHBlZFxuICAgICAgICAgKiBAcGFyYW0ge0Jvb2x9IGlzSW5zdGFudFxuICAgICAgICAgKiBAcmV0dXJuIHtPYmplY3R9IGluc3RhbmNlXG4gICAgICAgICAqL1xuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdzZWxlY3RDZWxsJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNlbGVjdENlbGwoaWQsIHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXM2ID0gdGhpcztcblxuICAgICAgICAgICAgdmFyIGlzV3JhcHBlZCA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMiB8fCBhcmd1bWVudHNbMl0gPT09IHVuZGVmaW5lZCA/IGZhbHNlIDogYXJndW1lbnRzWzJdO1xuICAgICAgICAgICAgdmFyIGlzSW5zdGFudCA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMyB8fCBhcmd1bWVudHNbM10gPT09IHVuZGVmaW5lZCA/IGZhbHNlIDogYXJndW1lbnRzWzNdO1xuXG4gICAgICAgICAgICByZXR1cm4gdGhpcy4kcShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgdmFyIGZsaWNraXR5SW5kZXggPSBfdGhpczYuX2dldEZsaWNraXR5SW5kZXgoaWQpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGZsaWNraXR5SW5kZXggPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCgnSW5zdGFuY2UgJyArIGlkICsgJyBub3QgZm91bmQnKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBNb3ZlIHRvIHRoZSBzZWxlY3RlZCBzbGlkZVxuICAgICAgICAgICAgICAgICAgICBfdGhpczYuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLnNlbGVjdENlbGwodmFsdWUsIGlzV3JhcHBlZCwgaXNJbnN0YW50KTtcblxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKF90aGlzNi5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEdldCB0aGUgY3VycmVudCBzbGlkZSBpbmRleFxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gaWRcbiAgICAgICAgICogQHJldHVybiB7SW50ZWdlcn0gc2VsZWN0ZWRJbmRleFxuICAgICAgICAgKi9cblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnc2VsZWN0ZWRJbmRleCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZWxlY3RlZEluZGV4KGlkKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXM3ID0gdGhpcztcblxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHEoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgIHZhciBmbGlja2l0eUluZGV4ID0gX3RoaXM3Ll9nZXRGbGlja2l0eUluZGV4KGlkKTtcblxuICAgICAgICAgICAgICAgIGlmIChmbGlja2l0eUluZGV4IDwgMCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoJ0luc3RhbmNlICcgKyBpZCArICcgbm90IGZvdW5kJyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gUmV0dXJuIHRoZSBjdXJyZW50IGluZGV4XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoX3RoaXM3Lmluc3RhbmNlc1tmbGlja2l0eUluZGV4XS5pbnN0YW5jZS5zZWxlY3RlZEluZGV4KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZXNpemUgdGhlIGdhbGxlcnkgYW5kIHJlLXBvc2l0aW9uIGNlbGxzLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gaWRcbiAgICAgICAgICogQHJldHVybiB7T2JqZWN0fSBpbnN0YW5jZVxuICAgICAgICAgKi9cblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncmVzaXplJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlc2l6ZShpZCkge1xuICAgICAgICAgICAgdmFyIF90aGlzOCA9IHRoaXM7XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLiRxKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICB2YXIgZmxpY2tpdHlJbmRleCA9IF90aGlzOC5fZ2V0RmxpY2tpdHlJbmRleChpZCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoZmxpY2tpdHlJbmRleCA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCdJbnN0YW5jZSAnICsgaWQgKyAnIG5vdCBmb3VuZCcpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRyaWdnZXIgdGhlIHJlc2l6ZVxuICAgICAgICAgICAgICAgICAgICBfdGhpczguaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLnJlc2l6ZSgpO1xuXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoX3RoaXM4Lmluc3RhbmNlc1tmbGlja2l0eUluZGV4XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogUG9zaXRpb24gY2VsbHMgYXQgc2VsZWN0ZWQgcG9zaXRpb24uXG4gICAgICAgICAqIFRyaWdnZXIgcmVwb3NpdGlvbiBhZnRlciB0aGUgc2l6ZSBvZiBhIGNlbGwgaGFzIGJlZW4gY2hhbmdlZC5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IGlkXG4gICAgICAgICAqIEByZXR1cm4ge09iamVjdH0gaW5zdGFuY2VcbiAgICAgICAgICovXG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3JlcG9zaXRpb24nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVwb3NpdGlvbihpZCkge1xuICAgICAgICAgICAgdmFyIF90aGlzOSA9IHRoaXM7XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLiRxKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICB2YXIgZmxpY2tpdHlJbmRleCA9IF90aGlzOS5fZ2V0RmxpY2tpdHlJbmRleChpZCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoZmxpY2tpdHlJbmRleCA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCdJbnN0YW5jZSAnICsgaWQgKyAnIG5vdCBmb3VuZCcpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRyaWdnZXIgdGhlIHJlc2l6ZVxuICAgICAgICAgICAgICAgICAgICBfdGhpczkuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLnJlcG9zaXRpb24oKTtcblxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKF90aGlzOS5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlLWNvbGxlY3QgYWxsIGNlbGwgZWxlbWVudHMgaW4gYGZsaWNraXR5LXNsaWRlcmAuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBpZFxuICAgICAgICAgKiBAcmV0dXJuIHtPYmplY3R9IGluc3RhbmNlXG4gICAgICAgICAqL1xuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdyZWxvYWRDZWxscycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZWxvYWRDZWxscyhpZCkge1xuICAgICAgICAgICAgdmFyIF90aGlzMTAgPSB0aGlzO1xuXG4gICAgICAgICAgICByZXR1cm4gdGhpcy4kcShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgdmFyIGZsaWNraXR5SW5kZXggPSBfdGhpczEwLl9nZXRGbGlja2l0eUluZGV4KGlkKTtcblxuICAgICAgICAgICAgICAgIGlmIChmbGlja2l0eUluZGV4IDwgMCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoJ0luc3RhbmNlICcgKyBpZCArICcgbm90IGZvdW5kJyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gUmVsb2FkIGNlbGxzXG4gICAgICAgICAgICAgICAgICAgIF90aGlzMTAuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLnJlbG9hZENlbGxzKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShfdGhpczEwLmluc3RhbmNlc1tmbGlja2l0eUluZGV4XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogR2V0IHRoZSBGbGlja2l0eSBpbnN0YW5jZVxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gaWRcbiAgICAgICAgICogQHJldHVybiB7T2JqZWN0fSBpbnN0YW5jZVxuICAgICAgICAgKi9cblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZ2V0JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldChpZCkge1xuICAgICAgICAgICAgdmFyIF90aGlzMTEgPSB0aGlzO1xuXG4gICAgICAgICAgICByZXR1cm4gdGhpcy4kcShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgdmFyIGZsaWNraXR5SW5kZXggPSBfdGhpczExLl9nZXRGbGlja2l0eUluZGV4KGlkKTtcblxuICAgICAgICAgICAgICAgIGlmIChmbGlja2l0eUluZGV4IDwgMCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoJ0luc3RhbmNlICcgKyBpZCArICcgbm90IGZvdW5kJyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShfdGhpczExLmluc3RhbmNlc1tmbGlja2l0eUluZGV4XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogR2V0IHRoZSBmaXJzdCBGbGlja2l0eSBpbnN0YW5jZVxuICAgICAgICAgKlxuICAgICAgICAgKiBAcmV0dXJuIHtPYmplY3R9IGluc3RhbmNlXG4gICAgICAgICAqL1xuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdnZXRGaXJzdCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRGaXJzdCgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpczEyID0gdGhpcztcblxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHEoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgIGlmICghX3RoaXMxMi5pbnN0YW5jZXMgfHwgX3RoaXMxMi5pbnN0YW5jZXMubGVuZ3RoIDwgMSkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoJ05vIGluc3RhbmNlcyBleGlzdCcpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoX3RoaXMxMi5pbnN0YW5jZXNbMF0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEdldCB0aGUgRmxpY2tpdHkgaW5zdGFuY2VcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHtFbGVtZW50fSBlbGVtZW50XG4gICAgICAgICAqIEByZXR1cm4ge09iamVjdH0gaW5zdGFuY2VcbiAgICAgICAgICovXG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2dldEJ5RWxlbWVudCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRCeUVsZW1lbnQoZWxlbWVudCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHEoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgIHZhciBpbnN0YW5jZSA9IF9mbGlja2l0eTIuZGVmYXVsdC5kYXRhKGVsZW1lbnQpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGluc3RhbmNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoaW5zdGFuY2UpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCgnSW5zdGFuY2Ugbm90IGZvdW5kIGZvciAnICsgZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogUHJlcGVuZCBlbGVtZW50cyBhbmQgY3JlYXRlIGNlbGxzIHRvIHRoZSBiZWdpbm5pbmcgb2YgdGhlIGdhbGxlcnkuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBpZFxuICAgICAgICAgKiBAcGFyYW0geyp9IGVsZW1lbnQocykgLSBqUXVlcnkgb2JqZWN0LCBBcnJheSBvZiBFbGVtZW50cywgRWxlbWVudCwgb3IgTm9kZUxpc3RcbiAgICAgICAgICogQHJldHVybiB7T2JqZWN0fSBpbnN0YW5jZVxuICAgICAgICAgKi9cblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncHJlcGVuZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwcmVwZW5kKGlkLCBlbGVtZW50cykge1xuICAgICAgICAgICAgdmFyIF90aGlzMTMgPSB0aGlzO1xuXG4gICAgICAgICAgICByZXR1cm4gdGhpcy4kcShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgdmFyIGZsaWNraXR5SW5kZXggPSBfdGhpczEzLl9nZXRGbGlja2l0eUluZGV4KGlkKTtcblxuICAgICAgICAgICAgICAgIGlmIChmbGlja2l0eUluZGV4IDwgMCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoJ0luc3RhbmNlICcgKyBpZCArICcgbm90IGZvdW5kJyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gUHJlcGVuZCB0aGUgc2xpZGVzXG4gICAgICAgICAgICAgICAgICAgIF90aGlzMTMuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLnByZXBlbmQoZWxlbWVudHMpO1xuXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoX3RoaXMxMy5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEFwcGVuZCBlbGVtZW50cyBhbmQgY3JlYXRlIGNlbGxzIHRvIHRoZSBlbmQgb2YgdGhlIGdhbGxlcnkuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBpZFxuICAgICAgICAgKiBAcGFyYW0geyp9IGVsZW1lbnQocykgLSBqUXVlcnkgb2JqZWN0LCBBcnJheSBvZiBFbGVtZW50cywgRWxlbWVudCwgb3IgTm9kZUxpc3RcbiAgICAgICAgICogQHJldHVybiB7T2JqZWN0fSBpbnN0YW5jZVxuICAgICAgICAgKi9cblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnYXBwZW5kJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFwcGVuZChpZCwgZWxlbWVudHMpIHtcbiAgICAgICAgICAgIHZhciBfdGhpczE0ID0gdGhpcztcblxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHEoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgIHZhciBmbGlja2l0eUluZGV4ID0gX3RoaXMxNC5fZ2V0RmxpY2tpdHlJbmRleChpZCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoZmxpY2tpdHlJbmRleCA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCdJbnN0YW5jZSAnICsgaWQgKyAnIG5vdCBmb3VuZCcpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEFwcGVuZCB0aGUgc2xpZGVzXG4gICAgICAgICAgICAgICAgICAgIF90aGlzMTQuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLmFwcGVuZChlbGVtZW50cyk7XG5cbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShfdGhpczE0Lmluc3RhbmNlc1tmbGlja2l0eUluZGV4XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogSW5zZXJ0IGVsZW1lbnRzIGludG8gdGhlIGdhbGxlcnkgYW5kIGNyZWF0ZSBjZWxscyBhdCB0aGUgZGVzaXJlZCBpbmRleC5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IGlkXG4gICAgICAgICAqIEBwYXJhbSB7Kn0gZWxlbWVudChzKSAtIGpRdWVyeSBvYmplY3QsIEFycmF5IG9mIEVsZW1lbnRzLCBFbGVtZW50LCBvciBOb2RlTGlzdFxuICAgICAgICAgKiBAcGFyYW0ge0ludGVnZXJ9IGluZGV4IC0gWmVybyBiYXNlZCBpbmRleFxuICAgICAgICAgKiBAcmV0dXJuIHtPYmplY3R9IGluc3RhbmNlXG4gICAgICAgICAqL1xuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdpbnNlcnQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5zZXJ0KGlkLCBlbGVtZW50cywgaW5kZXgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpczE1ID0gdGhpcztcblxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHEoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgIHZhciBmbGlja2l0eUluZGV4ID0gX3RoaXMxNS5fZ2V0RmxpY2tpdHlJbmRleChpZCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoZmxpY2tpdHlJbmRleCA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCdJbnN0YW5jZSAnICsgaWQgKyAnIG5vdCBmb3VuZCcpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEluc2VydCB0aGUgc2xpZGVzXG4gICAgICAgICAgICAgICAgICAgIF90aGlzMTUuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLmluc2VydChlbGVtZW50cywgaW5kZXgpO1xuXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoX3RoaXMxNS5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEdldCB0aGUgZWxlbWVudHMgb2YgdGhlIGNlbGxzXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBpZFxuICAgICAgICAgKiBAcmV0dXJuIHtBcnJheX0gY2VsbEVsZW1lbnRzXG4gICAgICAgICAqL1xuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdnZXRDZWxsRWxlbWVudHMnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q2VsbEVsZW1lbnRzKGlkKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMxNiA9IHRoaXM7XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLiRxKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICB2YXIgZmxpY2tpdHlJbmRleCA9IF90aGlzMTYuX2dldEZsaWNraXR5SW5kZXgoaWQpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGZsaWNraXR5SW5kZXggPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCgnSW5zdGFuY2UgJyArIGlkICsgJyBub3QgZm91bmQnKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKF90aGlzMTYuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLmdldENlbGxFbGVtZW50cygpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHZXQgdGhlIGVsZW1lbnRzIG9mIHRoZSBjZWxsc1xuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gaWRcbiAgICAgICAgICogQHJldHVybiB7T2JqZWN0fSBpbnN0YW5jZVxuICAgICAgICAgKi9cblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncmVtb3ZlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZShpZCwgZWxlbWVudHMpIHtcbiAgICAgICAgICAgIHZhciBfdGhpczE3ID0gdGhpcztcblxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHEoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgIHZhciBmbGlja2l0eUluZGV4ID0gX3RoaXMxNy5fZ2V0RmxpY2tpdHlJbmRleChpZCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoZmxpY2tpdHlJbmRleCA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCdJbnN0YW5jZSAnICsgaWQgKyAnIG5vdCBmb3VuZCcpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMTcuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLnJlbW92ZShlbGVtZW50cyk7XG5cbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShfdGhpczE3Lmluc3RhbmNlc1tmbGlja2l0eUluZGV4XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogR2V0IHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgY2VsbCBlbGVtZW50XG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBpZFxuICAgICAgICAgKiBAcmV0dXJuIHtFbGVtZW50fSBzZWxlY3RlZENlbGxFbGVtZW50XG4gICAgICAgICAqL1xuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdzZWxlY3RlZEVsZW1lbnQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2VsZWN0ZWRFbGVtZW50KGlkKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMxOCA9IHRoaXM7XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLiRxKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICB2YXIgZmxpY2tpdHlJbmRleCA9IF90aGlzMTguX2dldEZsaWNraXR5SW5kZXgoaWQpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGZsaWNraXR5SW5kZXggPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCgnSW5zdGFuY2UgJyArIGlkICsgJyBub3QgZm91bmQnKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKF90aGlzMTguaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLnNlbGVjdGVkRWxlbWVudCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogR2V0IGFuIGFycmF5IG9mIGFsbCBjZWxsc1xuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gaWRcbiAgICAgICAgICogQHJldHVybiB7QXJyYXl9IGNlbGxzXG4gICAgICAgICAqL1xuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdjZWxscycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjZWxscyhpZCkge1xuICAgICAgICAgICAgdmFyIF90aGlzMTkgPSB0aGlzO1xuXG4gICAgICAgICAgICByZXR1cm4gdGhpcy4kcShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgdmFyIGZsaWNraXR5SW5kZXggPSBfdGhpczE5Ll9nZXRGbGlja2l0eUluZGV4KGlkKTtcblxuICAgICAgICAgICAgICAgIGlmIChmbGlja2l0eUluZGV4IDwgMCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoJ0luc3RhbmNlICcgKyBpZCArICcgbm90IGZvdW5kJyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShfdGhpczE5Lmluc3RhbmNlc1tmbGlja2l0eUluZGV4XS5pbnN0YW5jZS5jZWxscyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvL1xuICAgICAgICAvLyBIZWxwZXIgbWV0aG9kc1xuICAgICAgICAvL1xuXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpbmQgdGhlIGluZGV4IGZvciBhIEZsaWNraXR5IGluc3RhbmNlXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBpZFxuICAgICAgICAgKiBAcmV0dXJuIHtJbnRlZ2VyfSBmbGlja2l0eUluZGV4XG4gICAgICAgICAqL1xuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfZ2V0RmxpY2tpdHlJbmRleCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfZ2V0RmxpY2tpdHlJbmRleChpZCkge1xuICAgICAgICAgICAgdmFyIGZvdW5kSW5kZXggPSB2b2lkIDA7XG5cbiAgICAgICAgICAgIC8vIElmIG5vIGluc3RhbmNlcyBleGlzdFxuICAgICAgICAgICAgaWYgKCF0aGlzLmluc3RhbmNlcy5sZW5ndGgpIHtcblxuICAgICAgICAgICAgICAgIGZvdW5kSW5kZXggPSAtMTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gaWYgaW5zdGFuY2VzIGRvIGV4aXN0XG5cbiAgICAgICAgICAgICAgICAvLyBDaGVjayB0aGUgSUQgb2YgZWFjaCBpbnN0YW5jZVxuICAgICAgICAgICAgICAgIHRoaXMuaW5zdGFuY2VzLmZvckVhY2goZnVuY3Rpb24gKGluc3RhbmNlLCBpbmRleCkge1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIElmIGl0IG1hdGNoZXMgb3VyIElELCBzZXQgdGhlIGluZGV4XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbnN0YW5jZS5pZCA9PT0gaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kSW5kZXggPSBpbmRleDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gZm91bmRJbmRleDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX2JpbmRFdmVudHMnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2JpbmRFdmVudHMoaWQpIHtcbiAgICAgICAgICAgIHZhciBfdGhpczIwID0gdGhpcztcblxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHEoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgIHZhciBmbGlja2l0eUluZGV4ID0gX3RoaXMyMC5fZ2V0RmxpY2tpdHlJbmRleChpZCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoZmxpY2tpdHlJbmRleCA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIElEID0gX3RoaXMyMC5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0uaWQ7XG5cbiAgICAgICAgICAgICAgICBfdGhpczIwLmluc3RhbmNlc1tmbGlja2l0eUluZGV4XS5pbnN0YW5jZS5vbignc2VsZWN0JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpczIwLiRyb290U2NvcGUuJGVtaXQoJ0ZsaWNraXR5OicgKyBJRCArICc6c2VsZWN0JywgX3RoaXMyMC5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0pO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgX3RoaXMyMC5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0uaW5zdGFuY2Uub24oJ3NldHRsZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMyMC4kcm9vdFNjb3BlLiRlbWl0KCdGbGlja2l0eTonICsgSUQgKyAnOnNldHRsZScsIF90aGlzMjAuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIF90aGlzMjAuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLm9uKCdzY3JvbGwnLCBmdW5jdGlvbiAocHJvZ3Jlc3MsIHBvc2l0aW9uWCkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpczIwLiRyb290U2NvcGUuJGVtaXQoJ0ZsaWNraXR5OicgKyBJRCArICc6c2Nyb2xsJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3M6IHByb2dyZXNzLFxuICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25YOiBwb3NpdGlvblhcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBfdGhpczIwLmluc3RhbmNlc1tmbGlja2l0eUluZGV4XS5pbnN0YW5jZS5vbignZHJhZ1N0YXJ0JywgZnVuY3Rpb24gKGV2ZW50LCBwb2ludGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMjAuJHJvb3RTY29wZS4kZW1pdCgnRmxpY2tpdHk6JyArIElEICsgJzpkcmFnU3RhcnQnLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudDogZXZlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBwb2ludGVyOiBwb2ludGVyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgX3RoaXMyMC5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0uaW5zdGFuY2Uub24oJ2RyYWdNb3ZlJywgZnVuY3Rpb24gKGV2ZW50LCBwb2ludGVyLCBtb3ZlVmVjdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMjAuJHJvb3RTY29wZS4kZW1pdCgnRmxpY2tpdHk6JyArIElEICsgJzpkcmFnTW92ZScsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50OiBldmVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50ZXI6IHBvaW50ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBtb3ZlVmVjdG9yOiBtb3ZlVmVjdG9yXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgX3RoaXMyMC5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0uaW5zdGFuY2Uub24oJ2RyYWdFbmQnLCBmdW5jdGlvbiAoZXZlbnQsIHBvaW50ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMyMC4kcm9vdFNjb3BlLiRlbWl0KCdGbGlja2l0eTonICsgSUQgKyAnOmRyYWdFbmQnLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudDogZXZlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBwb2ludGVyOiBwb2ludGVyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgX3RoaXMyMC5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0uaW5zdGFuY2Uub24oJ3BvaW50ZXJEb3duJywgZnVuY3Rpb24gKGV2ZW50LCBwb2ludGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMjAuJHJvb3RTY29wZS4kZW1pdCgnRmxpY2tpdHk6JyArIElEICsgJzpwb2ludGVyRG93bicsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50OiBldmVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50ZXI6IHBvaW50ZXJcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBfdGhpczIwLmluc3RhbmNlc1tmbGlja2l0eUluZGV4XS5pbnN0YW5jZS5vbigncG9pbnRlck1vdmUnLCBmdW5jdGlvbiAoZXZlbnQsIHBvaW50ZXIsIG1vdmVWZWN0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMyMC4kcm9vdFNjb3BlLiRlbWl0KCdGbGlja2l0eTonICsgSUQgKyAnOnBvaW50ZXJNb3ZlJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQ6IGV2ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRlcjogcG9pbnRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vdmVWZWN0b3I6IG1vdmVWZWN0b3JcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBfdGhpczIwLmluc3RhbmNlc1tmbGlja2l0eUluZGV4XS5pbnN0YW5jZS5vbigncG9pbnRlclVwJywgZnVuY3Rpb24gKGV2ZW50LCBwb2ludGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMjAuJHJvb3RTY29wZS4kZW1pdCgnRmxpY2tpdHk6JyArIElEICsgJzpwb2ludGVyVXAnLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudDogZXZlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBwb2ludGVyOiBwb2ludGVyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgX3RoaXMyMC5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0uaW5zdGFuY2Uub24oJ3N0YXRpY0NsaWNrJywgZnVuY3Rpb24gKGV2ZW50LCBwb2ludGVyLCBjZWxsRWxlbWVudCwgY2VsbEluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMjAuJHJvb3RTY29wZS4kZW1pdCgnRmxpY2tpdHk6JyArIElEICsgJzpzdGF0aWNDbGljaycsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50OiBldmVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50ZXI6IHBvaW50ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBjZWxsRWxlbWVudDogY2VsbEVsZW1lbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBjZWxsSW5kZXg6IGNlbGxJbmRleFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIF90aGlzMjAuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLm9uKCdsYXp5TG9hZCcsIGZ1bmN0aW9uIChldmVudCwgY2VsbEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMyMC4kcm9vdFNjb3BlLiRlbWl0KCdGbGlja2l0eTonICsgSUQgKyAnOmxhenlMb2FkJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQ6IGV2ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgY2VsbEVsZW1lbnQ6IGNlbGxFbGVtZW50XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpbmQgYW4gb2JqZWN0IHdpdGhpbiBhbiBhcnJheSBieSBJRFxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0ge0FycmF5fSBzb3VyY2VcbiAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IGlkXG4gICAgICAgICAqIEByZXR1cm4ge09iamVjdH0gbWF0Y2hcbiAgICAgICAgICovXG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19maW5kT2JqZWN0QnlJZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfZmluZE9iamVjdEJ5SWQoc291cmNlLCBpZCkge1xuICAgICAgICAgICAgcmV0dXJuIHNvdXJjZS5maWx0ZXIoZnVuY3Rpb24gKG9iamVjdCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBvYmplY3QuaWQgPT09IGlkO1xuICAgICAgICAgICAgfSlbMF07XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gRmxpY2tpdHlTZXJ2aWNlO1xufSgpO1xuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2ZsaWNraXR5LnNlcnZpY2UuanNcbiAqKi8iLCJpbXBvcnQgRmxpY2tpdHkgZnJvbSAnZmxpY2tpdHknO1xuaW1wb3J0ICdpbWFnZXNMb2FkZWQnO1xuXG5leHBvcnQgY2xhc3MgRmxpY2tpdHlTZXJ2aWNlIHtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICAkdGltZW91dCwgJHEsICRyb290U2NvcGUsICRsb2dcbiAgICApIHtcbiAgICAgICAgJ25nSW5qZWN0JztcblxuICAgICAgICB0aGlzLiR0aW1lb3V0ID0gJHRpbWVvdXQ7XG4gICAgICAgIHRoaXMuJHEgPSAkcTtcbiAgICAgICAgdGhpcy4kcm9vdFNjb3BlID0gJHJvb3RTY29wZTtcbiAgICAgICAgdGhpcy4kbG9nID0gJGxvZztcblxuICAgICAgICB0aGlzLmluc3RhbmNlcyA9IFtdO1xuXG4gICAgfVxuXG5cblxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgbmV3IEZsaWNraXR5IGluc3RhbmNlXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnRcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gaWRcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9uc1xuICAgICAqIEByZXR1cm4ge09iamVjdH0gaW5zdGFuY2VcbiAgICAgKi9cbiAgICBjcmVhdGUoZWxlbWVudCwgaWQgPSB0aGlzLmluc3RhbmNlcy5sZW5ndGggKyAxLCBvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICAvLyBDaGVjayB0byBzZWUgaWYgdGhlIElEIGlzIGFscmVhZHkgaW4gdXNlXG4gICAgICAgICAgICBpZiAodGhpcy5fZmluZE9iamVjdEJ5SWQodGhpcy5pbnN0YW5jZXMsIGlkKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5fZ2V0RmxpY2tpdHlJbmRleChpZCk7XG4gICAgICAgICAgICAgICAgdGhpcy4kbG9nLmVycm9yKCdUaGlzIElEIGlzIGFscmVhZHkgaW4gdXNlOiAnLCB0aGlzLmluc3RhbmNlc1tpbmRleF0pO1xuXG4gICAgICAgICAgICAgICAgcmVqZWN0KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIERlZmluZSB0aGUgbmV3IGluc3RhbmNlXG4gICAgICAgICAgICBjb25zdCBpbnN0YW5jZSA9IHtcbiAgICAgICAgICAgICAgICBpZDogaWQsXG4gICAgICAgICAgICAgICAgaW5zdGFuY2U6IG5ldyBGbGlja2l0eShlbGVtZW50LCBvcHRpb25zKSxcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8vIFNhdmUgdGhpcyBpbnN0YW5jZSB0byB0aGUgYXJyYXlcbiAgICAgICAgICAgIHRoaXMuaW5zdGFuY2VzLnB1c2goaW5zdGFuY2UpO1xuXG4gICAgICAgICAgICAvLyBCaW5kIHRvIGFsbCBldmVudHNcbiAgICAgICAgICAgIHRoaXMuX2JpbmRFdmVudHMoaWQpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoaW5zdGFuY2UpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogRGVzdHJveSBhIEZsaWNraXR5IGluc3RhbmNlXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gaWRcbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IGluc3RhbmNlXG4gICAgICovXG4gICAgZGVzdHJveShpZCkge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZmxpY2tpdHlJbmRleCA9IHRoaXMuX2dldEZsaWNraXR5SW5kZXgoaWQpO1xuXG4gICAgICAgICAgICBpZiAoZmxpY2tpdHlJbmRleCA8IDApIHtcbiAgICAgICAgICAgICAgICByZWplY3QoJ0luc3RhbmNlICcgKyBpZCArICcgbm90IGZvdW5kJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIERlc3Ryb3kgdGhlIEZsaWNraXR5IGluc3RhbmNlXG4gICAgICAgICAgICB0aGlzLmluc3RhbmNlc1tmbGlja2l0eUluZGV4XS5pbnN0YW5jZS5kZXN0cm95KCk7XG5cbiAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgaW5zdGFuY2UgZnJvbSB0aGUgYXJyYXlcbiAgICAgICAgICAgIHRoaXMuaW5zdGFuY2VzLnNwbGljZShmbGlja2l0eUluZGV4LCAxKTtcblxuICAgICAgICAgICAgcmVzb2x2ZSgnSW5zdGFuY2UgJyArIGlkICsgJyBkZXN0cm95ZWQuJyk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogTW92ZSB0byB0aGUgbmV4dCBzbGlkZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGlkXG4gICAgICogQHBhcmFtIHtCb29sfSBpc1dyYXBwZWRcbiAgICAgKiBAcGFyYW0ge0Jvb2x9IGlzSW5zdGFudFxuICAgICAqIEByZXR1cm4ge09iamVjdH0gaW5zdGFuY2VcbiAgICAgKi9cbiAgICBuZXh0KGlkLCBpc1dyYXBwZWQsIGlzSW5zdGFudCkge1xuICAgICAgICByZXR1cm4gdGhpcy4kcSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBmbGlja2l0eUluZGV4ID0gdGhpcy5fZ2V0RmxpY2tpdHlJbmRleChpZCk7XG5cbiAgICAgICAgICAgIGlmIChmbGlja2l0eUluZGV4IDwgMCkge1xuICAgICAgICAgICAgICAgIHJlamVjdCgnSW5zdGFuY2UgJyArIGlkICsgJyBub3QgZm91bmQnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gTW92ZSB0byB0aGUgbmV4dCBzbGlkZVxuICAgICAgICAgICAgICAgIHRoaXMuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLm5leHQoaXNXcmFwcGVkLCBpc0luc3RhbnQpO1xuXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh0aGlzLmluc3RhbmNlc1tmbGlja2l0eUluZGV4XSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogTW92ZSB0byB0aGUgcHJldmlvdXMgc2xpZGVcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICAgICAqIEBwYXJhbSB7Qm9vbH0gaXNXcmFwcGVkXG4gICAgICogQHBhcmFtIHtCb29sfSBpc0luc3RhbnRcbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IGluc3RhbmNlXG4gICAgICovXG4gICAgcHJldmlvdXMoaWQsIGlzV3JhcHBlZCwgaXNJbnN0YW50KSB7XG4gICAgICAgIHJldHVybiB0aGlzLiRxKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGZsaWNraXR5SW5kZXggPSB0aGlzLl9nZXRGbGlja2l0eUluZGV4KGlkKTtcblxuICAgICAgICAgICAgaWYgKGZsaWNraXR5SW5kZXggPCAwKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KCdJbnN0YW5jZSAnICsgaWQgKyAnIG5vdCBmb3VuZCcpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBNb3ZlIHRvIHRoZSBwcmV2aW91cyBzbGlkZVxuICAgICAgICAgICAgICAgIHRoaXMuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLnByZXZpb3VzKGlzV3JhcHBlZCwgaXNJbnN0YW50KTtcblxuICAgICAgICAgICAgICAgIHJlc29sdmUodGhpcy5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIFNlbGVjdCBhIHNsaWRlXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gaWRcbiAgICAgKiBAcGFyYW0ge0ludGVnZXJ9IGluZGV4XG4gICAgICogQHBhcmFtIHtCb29sfSBpc1dyYXBwZWRcbiAgICAgKiBAcGFyYW0ge0Jvb2x9IGlzSW5zdGFudFxuICAgICAqIEByZXR1cm4ge09iamVjdH0gaW5zdGFuY2VcbiAgICAgKi9cbiAgICBzZWxlY3QoaWQsIGluZGV4LCBpc1dyYXBwZWQgPSBmYWxzZSwgaXNJbnN0YW50ID0gZmFsc2UpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuJHEoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZmxpY2tpdHlJbmRleCA9IHRoaXMuX2dldEZsaWNraXR5SW5kZXgoaWQpO1xuXG4gICAgICAgICAgICBpZiAoZmxpY2tpdHlJbmRleCA8IDApIHtcbiAgICAgICAgICAgICAgICByZWplY3QoJ0luc3RhbmNlICcgKyBpZCArICcgbm90IGZvdW5kJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIE1vdmUgdG8gdGhlIHNlbGVjdGVkIHNsaWRlXG4gICAgICAgICAgICAgICAgdGhpcy5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0uaW5zdGFuY2Uuc2VsZWN0KGluZGV4LCBpc1dyYXBwZWQsIGlzSW5zdGFudCk7XG5cbiAgICAgICAgICAgICAgICByZXNvbHZlKHRoaXMuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9KTtcbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIFNlbGVjdCBhIHNsaWRlIG9mIGEgY2VsbFxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGlkXG4gICAgICogQHBhcmFtIHtJbnRlZ2VyfFN0cmluZ30gdmFsdWVcbiAgICAgKiBAcGFyYW0ge0Jvb2x9IGlzV3JhcHBlZFxuICAgICAqIEBwYXJhbSB7Qm9vbH0gaXNJbnN0YW50XG4gICAgICogQHJldHVybiB7T2JqZWN0fSBpbnN0YW5jZVxuICAgICAqL1xuICAgIHNlbGVjdENlbGwoaWQsIHZhbHVlLCBpc1dyYXBwZWQgPSBmYWxzZSwgaXNJbnN0YW50ID0gZmFsc2UpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuJHEoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZmxpY2tpdHlJbmRleCA9IHRoaXMuX2dldEZsaWNraXR5SW5kZXgoaWQpO1xuXG4gICAgICAgICAgICBpZiAoZmxpY2tpdHlJbmRleCA8IDApIHtcbiAgICAgICAgICAgICAgICByZWplY3QoJ0luc3RhbmNlICcgKyBpZCArICcgbm90IGZvdW5kJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIE1vdmUgdG8gdGhlIHNlbGVjdGVkIHNsaWRlXG4gICAgICAgICAgICAgICAgdGhpcy5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0uaW5zdGFuY2Uuc2VsZWN0Q2VsbCh2YWx1ZSwgaXNXcmFwcGVkLCBpc0luc3RhbnQpO1xuXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh0aGlzLmluc3RhbmNlc1tmbGlja2l0eUluZGV4XSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSk7XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGN1cnJlbnQgc2xpZGUgaW5kZXhcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBpZFxuICAgICAqIEByZXR1cm4ge0ludGVnZXJ9IHNlbGVjdGVkSW5kZXhcbiAgICAgKi9cbiAgICBzZWxlY3RlZEluZGV4KGlkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLiRxKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGZsaWNraXR5SW5kZXggPSB0aGlzLl9nZXRGbGlja2l0eUluZGV4KGlkKTtcblxuICAgICAgICAgICAgaWYgKGZsaWNraXR5SW5kZXggPCAwKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KCdJbnN0YW5jZSAnICsgaWQgKyAnIG5vdCBmb3VuZCcpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBSZXR1cm4gdGhlIGN1cnJlbnQgaW5kZXhcbiAgICAgICAgICAgICAgICByZXNvbHZlKHRoaXMuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLnNlbGVjdGVkSW5kZXgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0pO1xuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogUmVzaXplIHRoZSBnYWxsZXJ5IGFuZCByZS1wb3NpdGlvbiBjZWxscy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBpZFxuICAgICAqIEByZXR1cm4ge09iamVjdH0gaW5zdGFuY2VcbiAgICAgKi9cbiAgICByZXNpemUoaWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuJHEoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZmxpY2tpdHlJbmRleCA9IHRoaXMuX2dldEZsaWNraXR5SW5kZXgoaWQpO1xuXG4gICAgICAgICAgICBpZiAoZmxpY2tpdHlJbmRleCA8IDApIHtcbiAgICAgICAgICAgICAgICByZWplY3QoJ0luc3RhbmNlICcgKyBpZCArICcgbm90IGZvdW5kJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIFRyaWdnZXIgdGhlIHJlc2l6ZVxuICAgICAgICAgICAgICAgIHRoaXMuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLnJlc2l6ZSgpO1xuXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh0aGlzLmluc3RhbmNlc1tmbGlja2l0eUluZGV4XSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogUG9zaXRpb24gY2VsbHMgYXQgc2VsZWN0ZWQgcG9zaXRpb24uXG4gICAgICogVHJpZ2dlciByZXBvc2l0aW9uIGFmdGVyIHRoZSBzaXplIG9mIGEgY2VsbCBoYXMgYmVlbiBjaGFuZ2VkLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGlkXG4gICAgICogQHJldHVybiB7T2JqZWN0fSBpbnN0YW5jZVxuICAgICAqL1xuICAgIHJlcG9zaXRpb24oaWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuJHEoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZmxpY2tpdHlJbmRleCA9IHRoaXMuX2dldEZsaWNraXR5SW5kZXgoaWQpO1xuXG4gICAgICAgICAgICBpZiAoZmxpY2tpdHlJbmRleCA8IDApIHtcbiAgICAgICAgICAgICAgICByZWplY3QoJ0luc3RhbmNlICcgKyBpZCArICcgbm90IGZvdW5kJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIFRyaWdnZXIgdGhlIHJlc2l6ZVxuICAgICAgICAgICAgICAgIHRoaXMuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLnJlcG9zaXRpb24oKTtcblxuICAgICAgICAgICAgICAgIHJlc29sdmUodGhpcy5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIFJlLWNvbGxlY3QgYWxsIGNlbGwgZWxlbWVudHMgaW4gYGZsaWNraXR5LXNsaWRlcmAuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gaWRcbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IGluc3RhbmNlXG4gICAgICovXG4gICAgcmVsb2FkQ2VsbHMoaWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuJHEoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZmxpY2tpdHlJbmRleCA9IHRoaXMuX2dldEZsaWNraXR5SW5kZXgoaWQpO1xuXG4gICAgICAgICAgICBpZiAoZmxpY2tpdHlJbmRleCA8IDApIHtcbiAgICAgICAgICAgICAgICByZWplY3QoJ0luc3RhbmNlICcgKyBpZCArICcgbm90IGZvdW5kJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIFJlbG9hZCBjZWxsc1xuICAgICAgICAgICAgICAgIHRoaXMuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLnJlbG9hZENlbGxzKCk7XG5cbiAgICAgICAgICAgICAgICByZXNvbHZlKHRoaXMuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIEZsaWNraXR5IGluc3RhbmNlXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gaWRcbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IGluc3RhbmNlXG4gICAgICovXG4gICAgZ2V0KGlkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLiRxKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGZsaWNraXR5SW5kZXggPSB0aGlzLl9nZXRGbGlja2l0eUluZGV4KGlkKTtcblxuICAgICAgICAgICAgaWYgKGZsaWNraXR5SW5kZXggPCAwKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KCdJbnN0YW5jZSAnICsgaWQgKyAnIG5vdCBmb3VuZCcpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHRoaXMuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGZpcnN0IEZsaWNraXR5IGluc3RhbmNlXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IGluc3RhbmNlXG4gICAgICovXG4gICAgZ2V0Rmlyc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLiRxKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIGlmICghdGhpcy5pbnN0YW5jZXMgfHwgdGhpcy5pbnN0YW5jZXMubGVuZ3RoIDwgMSkge1xuICAgICAgICAgICAgICAgIHJlamVjdCgnTm8gaW5zdGFuY2VzIGV4aXN0Jyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlc29sdmUodGhpcy5pbnN0YW5jZXNbMF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgRmxpY2tpdHkgaW5zdGFuY2VcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudFxuICAgICAqIEByZXR1cm4ge09iamVjdH0gaW5zdGFuY2VcbiAgICAgKi9cbiAgICBnZXRCeUVsZW1lbnQoZWxlbWVudCkge1xuICAgICAgICByZXR1cm4gdGhpcy4kcSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpbnN0YW5jZSA9IEZsaWNraXR5LmRhdGEoZWxlbWVudClcblxuICAgICAgICAgICAgaWYgKGluc3RhbmNlKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShpbnN0YW5jZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlamVjdCgnSW5zdGFuY2Ugbm90IGZvdW5kIGZvciAnICsgZWxlbWVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogUHJlcGVuZCBlbGVtZW50cyBhbmQgY3JlYXRlIGNlbGxzIHRvIHRoZSBiZWdpbm5pbmcgb2YgdGhlIGdhbGxlcnkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gaWRcbiAgICAgKiBAcGFyYW0geyp9IGVsZW1lbnQocykgLSBqUXVlcnkgb2JqZWN0LCBBcnJheSBvZiBFbGVtZW50cywgRWxlbWVudCwgb3IgTm9kZUxpc3RcbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IGluc3RhbmNlXG4gICAgICovXG4gICAgcHJlcGVuZChpZCwgZWxlbWVudHMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuJHEoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZmxpY2tpdHlJbmRleCA9IHRoaXMuX2dldEZsaWNraXR5SW5kZXgoaWQpO1xuXG4gICAgICAgICAgICBpZiAoZmxpY2tpdHlJbmRleCA8IDApIHtcbiAgICAgICAgICAgICAgICByZWplY3QoJ0luc3RhbmNlICcgKyBpZCArICcgbm90IGZvdW5kJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIFByZXBlbmQgdGhlIHNsaWRlc1xuICAgICAgICAgICAgICAgIHRoaXMuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLnByZXBlbmQoZWxlbWVudHMpO1xuXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh0aGlzLmluc3RhbmNlc1tmbGlja2l0eUluZGV4XSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogQXBwZW5kIGVsZW1lbnRzIGFuZCBjcmVhdGUgY2VsbHMgdG8gdGhlIGVuZCBvZiB0aGUgZ2FsbGVyeS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBpZFxuICAgICAqIEBwYXJhbSB7Kn0gZWxlbWVudChzKSAtIGpRdWVyeSBvYmplY3QsIEFycmF5IG9mIEVsZW1lbnRzLCBFbGVtZW50LCBvciBOb2RlTGlzdFxuICAgICAqIEByZXR1cm4ge09iamVjdH0gaW5zdGFuY2VcbiAgICAgKi9cbiAgICBhcHBlbmQoaWQsIGVsZW1lbnRzKSB7XG4gICAgICAgIHJldHVybiB0aGlzLiRxKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGZsaWNraXR5SW5kZXggPSB0aGlzLl9nZXRGbGlja2l0eUluZGV4KGlkKTtcblxuICAgICAgICAgICAgaWYgKGZsaWNraXR5SW5kZXggPCAwKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KCdJbnN0YW5jZSAnICsgaWQgKyAnIG5vdCBmb3VuZCcpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBBcHBlbmQgdGhlIHNsaWRlc1xuICAgICAgICAgICAgICAgIHRoaXMuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLmFwcGVuZChlbGVtZW50cyk7XG5cbiAgICAgICAgICAgICAgICByZXNvbHZlKHRoaXMuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBJbnNlcnQgZWxlbWVudHMgaW50byB0aGUgZ2FsbGVyeSBhbmQgY3JlYXRlIGNlbGxzIGF0IHRoZSBkZXNpcmVkIGluZGV4LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGlkXG4gICAgICogQHBhcmFtIHsqfSBlbGVtZW50KHMpIC0galF1ZXJ5IG9iamVjdCwgQXJyYXkgb2YgRWxlbWVudHMsIEVsZW1lbnQsIG9yIE5vZGVMaXN0XG4gICAgICogQHBhcmFtIHtJbnRlZ2VyfSBpbmRleCAtIFplcm8gYmFzZWQgaW5kZXhcbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IGluc3RhbmNlXG4gICAgICovXG4gICAgaW5zZXJ0KGlkLCBlbGVtZW50cywgaW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuJHEoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZmxpY2tpdHlJbmRleCA9IHRoaXMuX2dldEZsaWNraXR5SW5kZXgoaWQpO1xuXG4gICAgICAgICAgICBpZiAoZmxpY2tpdHlJbmRleCA8IDApIHtcbiAgICAgICAgICAgICAgICByZWplY3QoJ0luc3RhbmNlICcgKyBpZCArICcgbm90IGZvdW5kJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIEluc2VydCB0aGUgc2xpZGVzXG4gICAgICAgICAgICAgICAgdGhpcy5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0uaW5zdGFuY2UuaW5zZXJ0KGVsZW1lbnRzLCBpbmRleCk7XG5cbiAgICAgICAgICAgICAgICByZXNvbHZlKHRoaXMuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGVsZW1lbnRzIG9mIHRoZSBjZWxsc1xuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGlkXG4gICAgICogQHJldHVybiB7QXJyYXl9IGNlbGxFbGVtZW50c1xuICAgICAqL1xuICAgIGdldENlbGxFbGVtZW50cyhpZCkge1xuICAgICAgICByZXR1cm4gdGhpcy4kcSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBmbGlja2l0eUluZGV4ID0gdGhpcy5fZ2V0RmxpY2tpdHlJbmRleChpZCk7XG5cbiAgICAgICAgICAgIGlmIChmbGlja2l0eUluZGV4IDwgMCkge1xuICAgICAgICAgICAgICAgIHJlamVjdCgnSW5zdGFuY2UgJyArIGlkICsgJyBub3QgZm91bmQnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh0aGlzLmluc3RhbmNlc1tmbGlja2l0eUluZGV4XS5pbnN0YW5jZS5nZXRDZWxsRWxlbWVudHMoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBlbGVtZW50cyBvZiB0aGUgY2VsbHNcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBpZFxuICAgICAqIEByZXR1cm4ge09iamVjdH0gaW5zdGFuY2VcbiAgICAgKi9cbiAgICByZW1vdmUoaWQsIGVsZW1lbnRzKSB7XG4gICAgICAgIHJldHVybiB0aGlzLiRxKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGZsaWNraXR5SW5kZXggPSB0aGlzLl9nZXRGbGlja2l0eUluZGV4KGlkKTtcblxuICAgICAgICAgICAgaWYgKGZsaWNraXR5SW5kZXggPCAwKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KCdJbnN0YW5jZSAnICsgaWQgKyAnIG5vdCBmb3VuZCcpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmluc3RhbmNlc1tmbGlja2l0eUluZGV4XS5pbnN0YW5jZS5yZW1vdmUoZWxlbWVudHMpO1xuXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh0aGlzLmluc3RhbmNlc1tmbGlja2l0eUluZGV4XSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgY2VsbCBlbGVtZW50XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gaWRcbiAgICAgKiBAcmV0dXJuIHtFbGVtZW50fSBzZWxlY3RlZENlbGxFbGVtZW50XG4gICAgICovXG4gICAgc2VsZWN0ZWRFbGVtZW50KGlkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLiRxKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGZsaWNraXR5SW5kZXggPSB0aGlzLl9nZXRGbGlja2l0eUluZGV4KGlkKTtcblxuICAgICAgICAgICAgaWYgKGZsaWNraXR5SW5kZXggPCAwKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KCdJbnN0YW5jZSAnICsgaWQgKyAnIG5vdCBmb3VuZCcpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHRoaXMuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLnNlbGVjdGVkRWxlbWVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogR2V0IGFuIGFycmF5IG9mIGFsbCBjZWxsc1xuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGlkXG4gICAgICogQHJldHVybiB7QXJyYXl9IGNlbGxzXG4gICAgICovXG4gICAgY2VsbHMoaWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuJHEoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZmxpY2tpdHlJbmRleCA9IHRoaXMuX2dldEZsaWNraXR5SW5kZXgoaWQpO1xuXG4gICAgICAgICAgICBpZiAoZmxpY2tpdHlJbmRleCA8IDApIHtcbiAgICAgICAgICAgICAgICByZWplY3QoJ0luc3RhbmNlICcgKyBpZCArICcgbm90IGZvdW5kJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlc29sdmUodGhpcy5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0uaW5zdGFuY2UuY2VsbHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cblxuXG4gICAgLy9cbiAgICAvLyBIZWxwZXIgbWV0aG9kc1xuICAgIC8vXG5cblxuICAgIC8qKlxuICAgICAqIEZpbmQgdGhlIGluZGV4IGZvciBhIEZsaWNraXR5IGluc3RhbmNlXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gaWRcbiAgICAgKiBAcmV0dXJuIHtJbnRlZ2VyfSBmbGlja2l0eUluZGV4XG4gICAgICovXG4gICAgX2dldEZsaWNraXR5SW5kZXgoaWQpIHtcbiAgICAgICAgbGV0IGZvdW5kSW5kZXg7XG5cbiAgICAgICAgLy8gSWYgbm8gaW5zdGFuY2VzIGV4aXN0XG4gICAgICAgIGlmICghdGhpcy5pbnN0YW5jZXMubGVuZ3RoKSB7XG5cbiAgICAgICAgICAgIGZvdW5kSW5kZXggPSAtMTtcblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gaWYgaW5zdGFuY2VzIGRvIGV4aXN0XG5cbiAgICAgICAgICAgIC8vIENoZWNrIHRoZSBJRCBvZiBlYWNoIGluc3RhbmNlXG4gICAgICAgICAgICB0aGlzLmluc3RhbmNlcy5mb3JFYWNoKChpbnN0YW5jZSwgaW5kZXgpID0+IHtcblxuICAgICAgICAgICAgICAgIC8vIElmIGl0IG1hdGNoZXMgb3VyIElELCBzZXQgdGhlIGluZGV4XG4gICAgICAgICAgICAgICAgaWYgKGluc3RhbmNlLmlkID09PSBpZCkge1xuICAgICAgICAgICAgICAgICAgICBmb3VuZEluZGV4ID0gaW5kZXg7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZvdW5kSW5kZXg7XG5cbiAgICB9XG5cblxuICAgIF9iaW5kRXZlbnRzKGlkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLiRxKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGZsaWNraXR5SW5kZXggPSB0aGlzLl9nZXRGbGlja2l0eUluZGV4KGlkKTtcblxuICAgICAgICAgICAgaWYgKGZsaWNraXR5SW5kZXggPCAwKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IElEID0gdGhpcy5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0uaWQ7XG5cbiAgICAgICAgICAgIHRoaXMuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLm9uKCdzZWxlY3QnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy4kcm9vdFNjb3BlLiRlbWl0KCdGbGlja2l0eTonICsgSUQgKyAnOnNlbGVjdCcsIHRoaXMuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0aGlzLmluc3RhbmNlc1tmbGlja2l0eUluZGV4XS5pbnN0YW5jZS5vbignc2V0dGxlJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuJHJvb3RTY29wZS4kZW1pdCgnRmxpY2tpdHk6JyArIElEICsgJzpzZXR0bGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmluc3RhbmNlc1tmbGlja2l0eUluZGV4XSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdGhpcy5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0uaW5zdGFuY2Uub24oJ3Njcm9sbCcsIChwcm9ncmVzcywgcG9zaXRpb25YKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy4kcm9vdFNjb3BlLiRlbWl0KCdGbGlja2l0eTonICsgSUQgKyAnOnNjcm9sbCcsIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3M6IHByb2dyZXNzLFxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblg6IHBvc2l0aW9uWCxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0aGlzLmluc3RhbmNlc1tmbGlja2l0eUluZGV4XS5pbnN0YW5jZS5vbignZHJhZ1N0YXJ0JywgKGV2ZW50LCBwb2ludGVyKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy4kcm9vdFNjb3BlLiRlbWl0KCdGbGlja2l0eTonICsgSUQgKyAnOmRyYWdTdGFydCcsIHtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQ6IGV2ZW50LFxuICAgICAgICAgICAgICAgICAgICBwb2ludGVyOiBwb2ludGVyLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHRoaXMuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLm9uKCdkcmFnTW92ZScsIChldmVudCwgcG9pbnRlciwgbW92ZVZlY3RvcikgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuJHJvb3RTY29wZS4kZW1pdCgnRmxpY2tpdHk6JyArIElEICsgJzpkcmFnTW92ZScsIHtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQ6IGV2ZW50LFxuICAgICAgICAgICAgICAgICAgICBwb2ludGVyOiBwb2ludGVyLFxuICAgICAgICAgICAgICAgICAgICBtb3ZlVmVjdG9yOiBtb3ZlVmVjdG9yLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHRoaXMuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLm9uKCdkcmFnRW5kJywgKGV2ZW50LCBwb2ludGVyKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy4kcm9vdFNjb3BlLiRlbWl0KCdGbGlja2l0eTonICsgSUQgKyAnOmRyYWdFbmQnLCB7XG4gICAgICAgICAgICAgICAgICAgIGV2ZW50OiBldmVudCxcbiAgICAgICAgICAgICAgICAgICAgcG9pbnRlcjogcG9pbnRlcixcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0aGlzLmluc3RhbmNlc1tmbGlja2l0eUluZGV4XS5pbnN0YW5jZS5vbigncG9pbnRlckRvd24nLCAoZXZlbnQsIHBvaW50ZXIpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLiRyb290U2NvcGUuJGVtaXQoJ0ZsaWNraXR5OicgKyBJRCArICc6cG9pbnRlckRvd24nLCB7XG4gICAgICAgICAgICAgICAgICAgIGV2ZW50OiBldmVudCxcbiAgICAgICAgICAgICAgICAgICAgcG9pbnRlcjogcG9pbnRlcixcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0aGlzLmluc3RhbmNlc1tmbGlja2l0eUluZGV4XS5pbnN0YW5jZS5vbigncG9pbnRlck1vdmUnLChldmVudCwgcG9pbnRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vdmVWZWN0b3IpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLiRyb290U2NvcGUuJGVtaXQoJ0ZsaWNraXR5OicgKyBJRCArICc6cG9pbnRlck1vdmUnLCB7XG4gICAgICAgICAgICAgICAgICAgIGV2ZW50OiBldmVudCxcbiAgICAgICAgICAgICAgICAgICAgcG9pbnRlcjogcG9pbnRlcixcbiAgICAgICAgICAgICAgICAgICAgbW92ZVZlY3RvcjogbW92ZVZlY3RvcixcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0aGlzLmluc3RhbmNlc1tmbGlja2l0eUluZGV4XS5pbnN0YW5jZS5vbigncG9pbnRlclVwJywgKGV2ZW50LCBwb2ludGVyKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy4kcm9vdFNjb3BlLiRlbWl0KCdGbGlja2l0eTonICsgSUQgKyAnOnBvaW50ZXJVcCcsIHtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQ6IGV2ZW50LFxuICAgICAgICAgICAgICAgICAgICBwb2ludGVyOiBwb2ludGVyLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHRoaXMuaW5zdGFuY2VzW2ZsaWNraXR5SW5kZXhdLmluc3RhbmNlLm9uKCdzdGF0aWNDbGljaycsIChldmVudCwgcG9pbnRlciwgY2VsbEVsZW1lbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2VsbEluZGV4KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy4kcm9vdFNjb3BlLiRlbWl0KCdGbGlja2l0eTonICsgSUQgKyAnOnN0YXRpY0NsaWNrJywge1xuICAgICAgICAgICAgICAgICAgICBldmVudDogZXZlbnQsXG4gICAgICAgICAgICAgICAgICAgIHBvaW50ZXI6IHBvaW50ZXIsXG4gICAgICAgICAgICAgICAgICAgIGNlbGxFbGVtZW50OiBjZWxsRWxlbWVudCxcbiAgICAgICAgICAgICAgICAgICAgY2VsbEluZGV4OiBjZWxsSW5kZXgsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdGhpcy5pbnN0YW5jZXNbZmxpY2tpdHlJbmRleF0uaW5zdGFuY2Uub24oJ2xhenlMb2FkJywgKGV2ZW50LCBjZWxsRWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuJHJvb3RTY29wZS4kZW1pdCgnRmxpY2tpdHk6JyArIElEICsgJzpsYXp5TG9hZCcsIHtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQ6IGV2ZW50LFxuICAgICAgICAgICAgICAgICAgICBjZWxsRWxlbWVudDogY2VsbEVsZW1lbnQsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgfSk7XG5cbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIEZpbmQgYW4gb2JqZWN0IHdpdGhpbiBhbiBhcnJheSBieSBJRFxuICAgICAqXG4gICAgICogQHBhcmFtIHtBcnJheX0gc291cmNlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGlkXG4gICAgICogQHJldHVybiB7T2JqZWN0fSBtYXRjaFxuICAgICAqL1xuICAgIF9maW5kT2JqZWN0QnlJZChzb3VyY2UsIGlkKSB7XG4gICAgICAgIHJldHVybiBzb3VyY2UuZmlsdGVyKChvYmplY3QpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBvYmplY3QuaWQgPT09IGlkO1xuICAgICAgICB9KVswXTtcbiAgICB9XG5cblxufVxuXG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL34vZXNsaW50LWxvYWRlciEuL3NyYy9mbGlja2l0eS5zZXJ2aWNlLmpzXG4gKiovIiwiLyohXG4gKiBGbGlja2l0eSB2Mi4wLjNcbiAqIFRvdWNoLCByZXNwb25zaXZlLCBmbGlja2FibGUgY2Fyb3VzZWxzXG4gKlxuICogTGljZW5zZWQgR1BMdjMgZm9yIG9wZW4gc291cmNlIHVzZVxuICogb3IgRmxpY2tpdHkgQ29tbWVyY2lhbCBMaWNlbnNlIGZvciBjb21tZXJjaWFsIHVzZVxuICpcbiAqIGh0dHA6Ly9mbGlja2l0eS5tZXRhZml6enkuY29cbiAqIENvcHlyaWdodCAyMDE2IE1ldGFmaXp6eVxuICovXG5cbiggZnVuY3Rpb24oIHdpbmRvdywgZmFjdG9yeSApIHtcbiAgLy8gdW5pdmVyc2FsIG1vZHVsZSBkZWZpbml0aW9uXG4gIC8qIGpzaGludCBzdHJpY3Q6IGZhbHNlICovXG4gIGlmICggdHlwZW9mIGRlZmluZSA9PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgKSB7XG4gICAgLy8gQU1EXG4gICAgZGVmaW5lKCBbXG4gICAgICAnLi9mbGlja2l0eScsXG4gICAgICAnLi9kcmFnJyxcbiAgICAgICcuL3ByZXYtbmV4dC1idXR0b24nLFxuICAgICAgJy4vcGFnZS1kb3RzJyxcbiAgICAgICcuL3BsYXllcicsXG4gICAgICAnLi9hZGQtcmVtb3ZlLWNlbGwnLFxuICAgICAgJy4vbGF6eWxvYWQnXG4gICAgXSwgZmFjdG9yeSApO1xuICB9IGVsc2UgaWYgKCB0eXBlb2YgbW9kdWxlID09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzICkge1xuICAgIC8vIENvbW1vbkpTXG4gICAgbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KFxuICAgICAgcmVxdWlyZSgnLi9mbGlja2l0eScpLFxuICAgICAgcmVxdWlyZSgnLi9kcmFnJyksXG4gICAgICByZXF1aXJlKCcuL3ByZXYtbmV4dC1idXR0b24nKSxcbiAgICAgIHJlcXVpcmUoJy4vcGFnZS1kb3RzJyksXG4gICAgICByZXF1aXJlKCcuL3BsYXllcicpLFxuICAgICAgcmVxdWlyZSgnLi9hZGQtcmVtb3ZlLWNlbGwnKSxcbiAgICAgIHJlcXVpcmUoJy4vbGF6eWxvYWQnKVxuICAgICk7XG4gIH1cblxufSkoIHdpbmRvdywgZnVuY3Rpb24gZmFjdG9yeSggRmxpY2tpdHkgKSB7XG4gIC8qanNoaW50IHN0cmljdDogZmFsc2UqL1xuICByZXR1cm4gRmxpY2tpdHk7XG59KTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2ZsaWNraXR5L2pzL2luZGV4LmpzXG4gKiogbW9kdWxlIGlkID0gM1xuICoqIG1vZHVsZSBjaHVua3MgPSAwIDFcbiAqKi8iLCIvLyBGbGlja2l0eSBtYWluXG4oIGZ1bmN0aW9uKCB3aW5kb3csIGZhY3RvcnkgKSB7XG4gIC8vIHVuaXZlcnNhbCBtb2R1bGUgZGVmaW5pdGlvblxuICAvKiBqc2hpbnQgc3RyaWN0OiBmYWxzZSAqL1xuICBpZiAoIHR5cGVvZiBkZWZpbmUgPT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kICkge1xuICAgIC8vIEFNRFxuICAgIGRlZmluZSggW1xuICAgICAgJ2V2LWVtaXR0ZXIvZXYtZW1pdHRlcicsXG4gICAgICAnZ2V0LXNpemUvZ2V0LXNpemUnLFxuICAgICAgJ2Zpenp5LXVpLXV0aWxzL3V0aWxzJyxcbiAgICAgICcuL2NlbGwnLFxuICAgICAgJy4vc2xpZGUnLFxuICAgICAgJy4vYW5pbWF0ZSdcbiAgICBdLCBmdW5jdGlvbiggRXZFbWl0dGVyLCBnZXRTaXplLCB1dGlscywgQ2VsbCwgU2xpZGUsIGFuaW1hdGVQcm90b3R5cGUgKSB7XG4gICAgICByZXR1cm4gZmFjdG9yeSggd2luZG93LCBFdkVtaXR0ZXIsIGdldFNpemUsIHV0aWxzLCBDZWxsLCBTbGlkZSwgYW5pbWF0ZVByb3RvdHlwZSApO1xuICAgIH0pO1xuICB9IGVsc2UgaWYgKCB0eXBlb2YgbW9kdWxlID09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzICkge1xuICAgIC8vIENvbW1vbkpTXG4gICAgbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KFxuICAgICAgd2luZG93LFxuICAgICAgcmVxdWlyZSgnZXYtZW1pdHRlcicpLFxuICAgICAgcmVxdWlyZSgnZ2V0LXNpemUnKSxcbiAgICAgIHJlcXVpcmUoJ2Zpenp5LXVpLXV0aWxzJyksXG4gICAgICByZXF1aXJlKCcuL2NlbGwnKSxcbiAgICAgIHJlcXVpcmUoJy4vc2xpZGUnKSxcbiAgICAgIHJlcXVpcmUoJy4vYW5pbWF0ZScpXG4gICAgKTtcbiAgfSBlbHNlIHtcbiAgICAvLyBicm93c2VyIGdsb2JhbFxuICAgIHZhciBfRmxpY2tpdHkgPSB3aW5kb3cuRmxpY2tpdHk7XG5cbiAgICB3aW5kb3cuRmxpY2tpdHkgPSBmYWN0b3J5KFxuICAgICAgd2luZG93LFxuICAgICAgd2luZG93LkV2RW1pdHRlcixcbiAgICAgIHdpbmRvdy5nZXRTaXplLFxuICAgICAgd2luZG93LmZpenp5VUlVdGlscyxcbiAgICAgIF9GbGlja2l0eS5DZWxsLFxuICAgICAgX0ZsaWNraXR5LlNsaWRlLFxuICAgICAgX0ZsaWNraXR5LmFuaW1hdGVQcm90b3R5cGVcbiAgICApO1xuICB9XG5cbn0oIHdpbmRvdywgZnVuY3Rpb24gZmFjdG9yeSggd2luZG93LCBFdkVtaXR0ZXIsIGdldFNpemUsXG4gIHV0aWxzLCBDZWxsLCBTbGlkZSwgYW5pbWF0ZVByb3RvdHlwZSApIHtcblxuJ3VzZSBzdHJpY3QnO1xuXG4vLyB2YXJzXG52YXIgalF1ZXJ5ID0gd2luZG93LmpRdWVyeTtcbnZhciBnZXRDb21wdXRlZFN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGU7XG52YXIgY29uc29sZSA9IHdpbmRvdy5jb25zb2xlO1xuXG5mdW5jdGlvbiBtb3ZlRWxlbWVudHMoIGVsZW1zLCB0b0VsZW0gKSB7XG4gIGVsZW1zID0gdXRpbHMubWFrZUFycmF5KCBlbGVtcyApO1xuICB3aGlsZSAoIGVsZW1zLmxlbmd0aCApIHtcbiAgICB0b0VsZW0uYXBwZW5kQ2hpbGQoIGVsZW1zLnNoaWZ0KCkgKTtcbiAgfVxufVxuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBGbGlja2l0eSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvL1xuXG4vLyBnbG9iYWxseSB1bmlxdWUgaWRlbnRpZmllcnNcbnZhciBHVUlEID0gMDtcbi8vIGludGVybmFsIHN0b3JlIG9mIGFsbCBGbGlja2l0eSBpbnRhbmNlc1xudmFyIGluc3RhbmNlcyA9IHt9O1xuXG5mdW5jdGlvbiBGbGlja2l0eSggZWxlbWVudCwgb3B0aW9ucyApIHtcbiAgdmFyIHF1ZXJ5RWxlbWVudCA9IHV0aWxzLmdldFF1ZXJ5RWxlbWVudCggZWxlbWVudCApO1xuICBpZiAoICFxdWVyeUVsZW1lbnQgKSB7XG4gICAgaWYgKCBjb25zb2xlICkge1xuICAgICAgY29uc29sZS5lcnJvciggJ0JhZCBlbGVtZW50IGZvciBGbGlja2l0eTogJyArICggcXVlcnlFbGVtZW50IHx8IGVsZW1lbnQgKSApO1xuICAgIH1cbiAgICByZXR1cm47XG4gIH1cbiAgdGhpcy5lbGVtZW50ID0gcXVlcnlFbGVtZW50O1xuICAvLyBkbyBub3QgaW5pdGlhbGl6ZSB0d2ljZSBvbiBzYW1lIGVsZW1lbnRcbiAgaWYgKCB0aGlzLmVsZW1lbnQuZmxpY2tpdHlHVUlEICkge1xuICAgIHZhciBpbnN0YW5jZSA9IGluc3RhbmNlc1sgdGhpcy5lbGVtZW50LmZsaWNraXR5R1VJRCBdO1xuICAgIGluc3RhbmNlLm9wdGlvbiggb3B0aW9ucyApO1xuICAgIHJldHVybiBpbnN0YW5jZTtcbiAgfVxuXG4gIC8vIGFkZCBqUXVlcnlcbiAgaWYgKCBqUXVlcnkgKSB7XG4gICAgdGhpcy4kZWxlbWVudCA9IGpRdWVyeSggdGhpcy5lbGVtZW50ICk7XG4gIH1cbiAgLy8gb3B0aW9uc1xuICB0aGlzLm9wdGlvbnMgPSB1dGlscy5leHRlbmQoIHt9LCB0aGlzLmNvbnN0cnVjdG9yLmRlZmF1bHRzICk7XG4gIHRoaXMub3B0aW9uKCBvcHRpb25zICk7XG5cbiAgLy8ga2ljayB0aGluZ3Mgb2ZmXG4gIHRoaXMuX2NyZWF0ZSgpO1xufVxuXG5GbGlja2l0eS5kZWZhdWx0cyA9IHtcbiAgYWNjZXNzaWJpbGl0eTogdHJ1ZSxcbiAgLy8gYWRhcHRpdmVIZWlnaHQ6IGZhbHNlLFxuICBjZWxsQWxpZ246ICdjZW50ZXInLFxuICAvLyBjZWxsU2VsZWN0b3I6IHVuZGVmaW5lZCxcbiAgLy8gY29udGFpbjogZmFsc2UsXG4gIGZyZWVTY3JvbGxGcmljdGlvbjogMC4wNzUsIC8vIGZyaWN0aW9uIHdoZW4gZnJlZS1zY3JvbGxpbmdcbiAgZnJpY3Rpb246IDAuMjgsIC8vIGZyaWN0aW9uIHdoZW4gc2VsZWN0aW5nXG4gIG5hbWVzcGFjZUpRdWVyeUV2ZW50czogdHJ1ZSxcbiAgLy8gaW5pdGlhbEluZGV4OiAwLFxuICBwZXJjZW50UG9zaXRpb246IHRydWUsXG4gIHJlc2l6ZTogdHJ1ZSxcbiAgc2VsZWN0ZWRBdHRyYWN0aW9uOiAwLjAyNSxcbiAgc2V0R2FsbGVyeVNpemU6IHRydWVcbiAgLy8gd2F0Y2hDU1M6IGZhbHNlLFxuICAvLyB3cmFwQXJvdW5kOiBmYWxzZVxufTtcblxuLy8gaGFzaCBvZiBtZXRob2RzIHRyaWdnZXJlZCBvbiBfY3JlYXRlKClcbkZsaWNraXR5LmNyZWF0ZU1ldGhvZHMgPSBbXTtcblxudmFyIHByb3RvID0gRmxpY2tpdHkucHJvdG90eXBlO1xuLy8gaW5oZXJpdCBFdmVudEVtaXR0ZXJcbnV0aWxzLmV4dGVuZCggcHJvdG8sIEV2RW1pdHRlci5wcm90b3R5cGUgKTtcblxucHJvdG8uX2NyZWF0ZSA9IGZ1bmN0aW9uKCkge1xuICAvLyBhZGQgaWQgZm9yIEZsaWNraXR5LmRhdGFcbiAgdmFyIGlkID0gdGhpcy5ndWlkID0gKytHVUlEO1xuICB0aGlzLmVsZW1lbnQuZmxpY2tpdHlHVUlEID0gaWQ7IC8vIGV4cGFuZG9cbiAgaW5zdGFuY2VzWyBpZCBdID0gdGhpczsgLy8gYXNzb2NpYXRlIHZpYSBpZFxuICAvLyBpbml0aWFsIHByb3BlcnRpZXNcbiAgdGhpcy5zZWxlY3RlZEluZGV4ID0gMDtcbiAgLy8gaG93IG1hbnkgZnJhbWVzIHNsaWRlciBoYXMgYmVlbiBpbiBzYW1lIHBvc2l0aW9uXG4gIHRoaXMucmVzdGluZ0ZyYW1lcyA9IDA7XG4gIC8vIGluaXRpYWwgcGh5c2ljcyBwcm9wZXJ0aWVzXG4gIHRoaXMueCA9IDA7XG4gIHRoaXMudmVsb2NpdHkgPSAwO1xuICB0aGlzLm9yaWdpblNpZGUgPSB0aGlzLm9wdGlvbnMucmlnaHRUb0xlZnQgPyAncmlnaHQnIDogJ2xlZnQnO1xuICAvLyBjcmVhdGUgdmlld3BvcnQgJiBzbGlkZXJcbiAgdGhpcy52aWV3cG9ydCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICB0aGlzLnZpZXdwb3J0LmNsYXNzTmFtZSA9ICdmbGlja2l0eS12aWV3cG9ydCc7XG4gIHRoaXMuX2NyZWF0ZVNsaWRlcigpO1xuXG4gIGlmICggdGhpcy5vcHRpb25zLnJlc2l6ZSB8fCB0aGlzLm9wdGlvbnMud2F0Y2hDU1MgKSB7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoICdyZXNpemUnLCB0aGlzICk7XG4gIH1cblxuICBGbGlja2l0eS5jcmVhdGVNZXRob2RzLmZvckVhY2goIGZ1bmN0aW9uKCBtZXRob2QgKSB7XG4gICAgdGhpc1sgbWV0aG9kIF0oKTtcbiAgfSwgdGhpcyApO1xuXG4gIGlmICggdGhpcy5vcHRpb25zLndhdGNoQ1NTICkge1xuICAgIHRoaXMud2F0Y2hDU1MoKTtcbiAgfSBlbHNlIHtcbiAgICB0aGlzLmFjdGl2YXRlKCk7XG4gIH1cblxufTtcblxuLyoqXG4gKiBzZXQgb3B0aW9uc1xuICogQHBhcmFtIHtPYmplY3R9IG9wdHNcbiAqL1xucHJvdG8ub3B0aW9uID0gZnVuY3Rpb24oIG9wdHMgKSB7XG4gIHV0aWxzLmV4dGVuZCggdGhpcy5vcHRpb25zLCBvcHRzICk7XG59O1xuXG5wcm90by5hY3RpdmF0ZSA9IGZ1bmN0aW9uKCkge1xuICBpZiAoIHRoaXMuaXNBY3RpdmUgKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIHRoaXMuaXNBY3RpdmUgPSB0cnVlO1xuICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZmxpY2tpdHktZW5hYmxlZCcpO1xuICBpZiAoIHRoaXMub3B0aW9ucy5yaWdodFRvTGVmdCApIHtcbiAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZmxpY2tpdHktcnRsJyk7XG4gIH1cblxuICB0aGlzLmdldFNpemUoKTtcbiAgLy8gbW92ZSBpbml0aWFsIGNlbGwgZWxlbWVudHMgc28gdGhleSBjYW4gYmUgbG9hZGVkIGFzIGNlbGxzXG4gIHZhciBjZWxsRWxlbXMgPSB0aGlzLl9maWx0ZXJGaW5kQ2VsbEVsZW1lbnRzKCB0aGlzLmVsZW1lbnQuY2hpbGRyZW4gKTtcbiAgbW92ZUVsZW1lbnRzKCBjZWxsRWxlbXMsIHRoaXMuc2xpZGVyICk7XG4gIHRoaXMudmlld3BvcnQuYXBwZW5kQ2hpbGQoIHRoaXMuc2xpZGVyICk7XG4gIHRoaXMuZWxlbWVudC5hcHBlbmRDaGlsZCggdGhpcy52aWV3cG9ydCApO1xuICAvLyBnZXQgY2VsbHMgZnJvbSBjaGlsZHJlblxuICB0aGlzLnJlbG9hZENlbGxzKCk7XG5cbiAgaWYgKCB0aGlzLm9wdGlvbnMuYWNjZXNzaWJpbGl0eSApIHtcbiAgICAvLyBhbGxvdyBlbGVtZW50IHRvIGZvY3VzYWJsZVxuICAgIHRoaXMuZWxlbWVudC50YWJJbmRleCA9IDA7XG4gICAgLy8gbGlzdGVuIGZvciBrZXkgcHJlc3Nlc1xuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCAna2V5ZG93bicsIHRoaXMgKTtcbiAgfVxuXG4gIHRoaXMuZW1pdEV2ZW50KCdhY3RpdmF0ZScpO1xuXG4gIHZhciBpbmRleDtcbiAgdmFyIGluaXRpYWxJbmRleCA9IHRoaXMub3B0aW9ucy5pbml0aWFsSW5kZXg7XG4gIGlmICggdGhpcy5pc0luaXRBY3RpdmF0ZWQgKSB7XG4gICAgaW5kZXggPSB0aGlzLnNlbGVjdGVkSW5kZXg7XG4gIH0gZWxzZSBpZiAoIGluaXRpYWxJbmRleCAhPT0gdW5kZWZpbmVkICkge1xuICAgIGluZGV4ID0gdGhpcy5jZWxsc1sgaW5pdGlhbEluZGV4IF0gPyBpbml0aWFsSW5kZXggOiAwO1xuICB9IGVsc2Uge1xuICAgIGluZGV4ID0gMDtcbiAgfVxuICAvLyBzZWxlY3QgaW5zdGFudGx5XG4gIHRoaXMuc2VsZWN0KCBpbmRleCwgZmFsc2UsIHRydWUgKTtcbiAgLy8gZmxhZyBmb3IgaW5pdGlhbCBhY3RpdmF0aW9uLCBmb3IgdXNpbmcgaW5pdGlhbEluZGV4XG4gIHRoaXMuaXNJbml0QWN0aXZhdGVkID0gdHJ1ZTtcbn07XG5cbi8vIHNsaWRlciBwb3NpdGlvbnMgdGhlIGNlbGxzXG5wcm90by5fY3JlYXRlU2xpZGVyID0gZnVuY3Rpb24oKSB7XG4gIC8vIHNsaWRlciBlbGVtZW50IGRvZXMgYWxsIHRoZSBwb3NpdGlvbmluZ1xuICB2YXIgc2xpZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIHNsaWRlci5jbGFzc05hbWUgPSAnZmxpY2tpdHktc2xpZGVyJztcbiAgc2xpZGVyLnN0eWxlWyB0aGlzLm9yaWdpblNpZGUgXSA9IDA7XG4gIHRoaXMuc2xpZGVyID0gc2xpZGVyO1xufTtcblxucHJvdG8uX2ZpbHRlckZpbmRDZWxsRWxlbWVudHMgPSBmdW5jdGlvbiggZWxlbXMgKSB7XG4gIHJldHVybiB1dGlscy5maWx0ZXJGaW5kRWxlbWVudHMoIGVsZW1zLCB0aGlzLm9wdGlvbnMuY2VsbFNlbGVjdG9yICk7XG59O1xuXG4vLyBnb2VzIHRocm91Z2ggYWxsIGNoaWxkcmVuXG5wcm90by5yZWxvYWRDZWxscyA9IGZ1bmN0aW9uKCkge1xuICAvLyBjb2xsZWN0aW9uIG9mIGl0ZW0gZWxlbWVudHNcbiAgdGhpcy5jZWxscyA9IHRoaXMuX21ha2VDZWxscyggdGhpcy5zbGlkZXIuY2hpbGRyZW4gKTtcbiAgdGhpcy5wb3NpdGlvbkNlbGxzKCk7XG4gIHRoaXMuX2dldFdyYXBTaGlmdENlbGxzKCk7XG4gIHRoaXMuc2V0R2FsbGVyeVNpemUoKTtcbn07XG5cbi8qKlxuICogdHVybiBlbGVtZW50cyBpbnRvIEZsaWNraXR5LkNlbGxzXG4gKiBAcGFyYW0ge0FycmF5IG9yIE5vZGVMaXN0IG9yIEhUTUxFbGVtZW50fSBlbGVtc1xuICogQHJldHVybnMge0FycmF5fSBpdGVtcyAtIGNvbGxlY3Rpb24gb2YgbmV3IEZsaWNraXR5IENlbGxzXG4gKi9cbnByb3RvLl9tYWtlQ2VsbHMgPSBmdW5jdGlvbiggZWxlbXMgKSB7XG4gIHZhciBjZWxsRWxlbXMgPSB0aGlzLl9maWx0ZXJGaW5kQ2VsbEVsZW1lbnRzKCBlbGVtcyApO1xuXG4gIC8vIGNyZWF0ZSBuZXcgRmxpY2tpdHkgZm9yIGNvbGxlY3Rpb25cbiAgdmFyIGNlbGxzID0gY2VsbEVsZW1zLm1hcCggZnVuY3Rpb24oIGNlbGxFbGVtICkge1xuICAgIHJldHVybiBuZXcgQ2VsbCggY2VsbEVsZW0sIHRoaXMgKTtcbiAgfSwgdGhpcyApO1xuXG4gIHJldHVybiBjZWxscztcbn07XG5cbnByb3RvLmdldExhc3RDZWxsID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzLmNlbGxzWyB0aGlzLmNlbGxzLmxlbmd0aCAtIDEgXTtcbn07XG5cbnByb3RvLmdldExhc3RTbGlkZSA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gdGhpcy5zbGlkZXNbIHRoaXMuc2xpZGVzLmxlbmd0aCAtIDEgXTtcbn07XG5cbi8vIHBvc2l0aW9ucyBhbGwgY2VsbHNcbnByb3RvLnBvc2l0aW9uQ2VsbHMgPSBmdW5jdGlvbigpIHtcbiAgLy8gc2l6ZSBhbGwgY2VsbHNcbiAgdGhpcy5fc2l6ZUNlbGxzKCB0aGlzLmNlbGxzICk7XG4gIC8vIHBvc2l0aW9uIGFsbCBjZWxsc1xuICB0aGlzLl9wb3NpdGlvbkNlbGxzKCAwICk7XG59O1xuXG4vKipcbiAqIHBvc2l0aW9uIGNlcnRhaW4gY2VsbHNcbiAqIEBwYXJhbSB7SW50ZWdlcn0gaW5kZXggLSB3aGljaCBjZWxsIHRvIHN0YXJ0IHdpdGhcbiAqL1xucHJvdG8uX3Bvc2l0aW9uQ2VsbHMgPSBmdW5jdGlvbiggaW5kZXggKSB7XG4gIGluZGV4ID0gaW5kZXggfHwgMDtcbiAgLy8gYWxzbyBtZWFzdXJlIG1heENlbGxIZWlnaHRcbiAgLy8gc3RhcnQgMCBpZiBwb3NpdGlvbmluZyBhbGwgY2VsbHNcbiAgdGhpcy5tYXhDZWxsSGVpZ2h0ID0gaW5kZXggPyB0aGlzLm1heENlbGxIZWlnaHQgfHwgMCA6IDA7XG4gIHZhciBjZWxsWCA9IDA7XG4gIC8vIGdldCBjZWxsWFxuICBpZiAoIGluZGV4ID4gMCApIHtcbiAgICB2YXIgc3RhcnRDZWxsID0gdGhpcy5jZWxsc1sgaW5kZXggLSAxIF07XG4gICAgY2VsbFggPSBzdGFydENlbGwueCArIHN0YXJ0Q2VsbC5zaXplLm91dGVyV2lkdGg7XG4gIH1cbiAgdmFyIGxlbiA9IHRoaXMuY2VsbHMubGVuZ3RoO1xuICBmb3IgKCB2YXIgaT1pbmRleDsgaSA8IGxlbjsgaSsrICkge1xuICAgIHZhciBjZWxsID0gdGhpcy5jZWxsc1tpXTtcbiAgICBjZWxsLnNldFBvc2l0aW9uKCBjZWxsWCApO1xuICAgIGNlbGxYICs9IGNlbGwuc2l6ZS5vdXRlcldpZHRoO1xuICAgIHRoaXMubWF4Q2VsbEhlaWdodCA9IE1hdGgubWF4KCBjZWxsLnNpemUub3V0ZXJIZWlnaHQsIHRoaXMubWF4Q2VsbEhlaWdodCApO1xuICB9XG4gIC8vIGtlZXAgdHJhY2sgb2YgY2VsbFggZm9yIHdyYXAtYXJvdW5kXG4gIHRoaXMuc2xpZGVhYmxlV2lkdGggPSBjZWxsWDtcbiAgLy8gc2xpZGVzXG4gIHRoaXMudXBkYXRlU2xpZGVzKCk7XG4gIC8vIGNvbnRhaW4gc2xpZGVzIHRhcmdldFxuICB0aGlzLl9jb250YWluU2xpZGVzKCk7XG4gIC8vIHVwZGF0ZSBzbGlkZXNXaWR0aFxuICB0aGlzLnNsaWRlc1dpZHRoID0gbGVuID8gdGhpcy5nZXRMYXN0U2xpZGUoKS50YXJnZXQgLSB0aGlzLnNsaWRlc1swXS50YXJnZXQgOiAwO1xufTtcblxuLyoqXG4gKiBjZWxsLmdldFNpemUoKSBvbiBtdWx0aXBsZSBjZWxsc1xuICogQHBhcmFtIHtBcnJheX0gY2VsbHNcbiAqL1xucHJvdG8uX3NpemVDZWxscyA9IGZ1bmN0aW9uKCBjZWxscyApIHtcbiAgY2VsbHMuZm9yRWFjaCggZnVuY3Rpb24oIGNlbGwgKSB7XG4gICAgY2VsbC5nZXRTaXplKCk7XG4gIH0pO1xufTtcblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vXG5cbnByb3RvLnVwZGF0ZVNsaWRlcyA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLnNsaWRlcyA9IFtdO1xuICBpZiAoICF0aGlzLmNlbGxzLmxlbmd0aCApIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgc2xpZGUgPSBuZXcgU2xpZGUoIHRoaXMgKTtcbiAgdGhpcy5zbGlkZXMucHVzaCggc2xpZGUgKTtcbiAgdmFyIGlzT3JpZ2luTGVmdCA9IHRoaXMub3JpZ2luU2lkZSA9PSAnbGVmdCc7XG4gIHZhciBuZXh0TWFyZ2luID0gaXNPcmlnaW5MZWZ0ID8gJ21hcmdpblJpZ2h0JyA6ICdtYXJnaW5MZWZ0JztcblxuICB2YXIgY2FuQ2VsbEZpdCA9IHRoaXMuX2dldENhbkNlbGxGaXQoKTtcblxuICB0aGlzLmNlbGxzLmZvckVhY2goIGZ1bmN0aW9uKCBjZWxsLCBpICkge1xuICAgIC8vIGp1c3QgYWRkIGNlbGwgaWYgZmlyc3QgY2VsbCBpbiBzbGlkZVxuICAgIGlmICggIXNsaWRlLmNlbGxzLmxlbmd0aCApIHtcbiAgICAgIHNsaWRlLmFkZENlbGwoIGNlbGwgKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgc2xpZGVXaWR0aCA9ICggc2xpZGUub3V0ZXJXaWR0aCAtIHNsaWRlLmZpcnN0TWFyZ2luICkgK1xuICAgICAgKCBjZWxsLnNpemUub3V0ZXJXaWR0aCAtIGNlbGwuc2l6ZVsgbmV4dE1hcmdpbiBdICk7XG5cbiAgICBpZiAoIGNhbkNlbGxGaXQuY2FsbCggdGhpcywgaSwgc2xpZGVXaWR0aCApICkge1xuICAgICAgc2xpZGUuYWRkQ2VsbCggY2VsbCApO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBkb2Vzbid0IGZpdCwgbmV3IHNsaWRlXG4gICAgICBzbGlkZS51cGRhdGVUYXJnZXQoKTtcblxuICAgICAgc2xpZGUgPSBuZXcgU2xpZGUoIHRoaXMgKTtcbiAgICAgIHRoaXMuc2xpZGVzLnB1c2goIHNsaWRlICk7XG4gICAgICBzbGlkZS5hZGRDZWxsKCBjZWxsICk7XG4gICAgfVxuICB9LCB0aGlzICk7XG4gIC8vIGxhc3Qgc2xpZGVcbiAgc2xpZGUudXBkYXRlVGFyZ2V0KCk7XG4gIC8vIHVwZGF0ZSAuc2VsZWN0ZWRTbGlkZVxuICB0aGlzLnVwZGF0ZVNlbGVjdGVkU2xpZGUoKTtcbn07XG5cbnByb3RvLl9nZXRDYW5DZWxsRml0ID0gZnVuY3Rpb24oKSB7XG4gIHZhciBncm91cENlbGxzID0gdGhpcy5vcHRpb25zLmdyb3VwQ2VsbHM7XG4gIGlmICggIWdyb3VwQ2VsbHMgKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gIH0gZWxzZSBpZiAoIHR5cGVvZiBncm91cENlbGxzID09ICdudW1iZXInICkge1xuICAgIC8vIGdyb3VwIGJ5IG51bWJlci4gMyAtPiBbMCwxLDJdLCBbMyw0LDVdLCAuLi5cbiAgICB2YXIgbnVtYmVyID0gcGFyc2VJbnQoIGdyb3VwQ2VsbHMsIDEwICk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCBpICkge1xuICAgICAgcmV0dXJuICggaSAlIG51bWJlciApICE9PSAwO1xuICAgIH07XG4gIH1cbiAgLy8gZGVmYXVsdCwgZ3JvdXAgYnkgd2lkdGggb2Ygc2xpZGVcbiAgLy8gcGFyc2UgJzc1JVxuICB2YXIgcGVyY2VudE1hdGNoID0gdHlwZW9mIGdyb3VwQ2VsbHMgPT0gJ3N0cmluZycgJiZcbiAgICBncm91cENlbGxzLm1hdGNoKC9eKFxcZCspJSQvKTtcbiAgdmFyIHBlcmNlbnQgPSBwZXJjZW50TWF0Y2ggPyBwYXJzZUludCggcGVyY2VudE1hdGNoWzFdLCAxMCApIC8gMTAwIDogMTtcbiAgcmV0dXJuIGZ1bmN0aW9uKCBpLCBzbGlkZVdpZHRoICkge1xuICAgIHJldHVybiBzbGlkZVdpZHRoIDw9ICggdGhpcy5zaXplLmlubmVyV2lkdGggKyAxICkgKiBwZXJjZW50O1xuICB9O1xufTtcblxuLy8gYWxpYXMgX2luaXQgZm9yIGpRdWVyeSBwbHVnaW4gLmZsaWNraXR5KClcbnByb3RvLl9pbml0ID1cbnByb3RvLnJlcG9zaXRpb24gPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5wb3NpdGlvbkNlbGxzKCk7XG4gIHRoaXMucG9zaXRpb25TbGlkZXJBdFNlbGVjdGVkKCk7XG59O1xuXG5wcm90by5nZXRTaXplID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuc2l6ZSA9IGdldFNpemUoIHRoaXMuZWxlbWVudCApO1xuICB0aGlzLnNldENlbGxBbGlnbigpO1xuICB0aGlzLmN1cnNvclBvc2l0aW9uID0gdGhpcy5zaXplLmlubmVyV2lkdGggKiB0aGlzLmNlbGxBbGlnbjtcbn07XG5cbnZhciBjZWxsQWxpZ25TaG9ydGhhbmRzID0ge1xuICAvLyBjZWxsIGFsaWduLCB0aGVuIGJhc2VkIG9uIG9yaWdpbiBzaWRlXG4gIGNlbnRlcjoge1xuICAgIGxlZnQ6IDAuNSxcbiAgICByaWdodDogMC41XG4gIH0sXG4gIGxlZnQ6IHtcbiAgICBsZWZ0OiAwLFxuICAgIHJpZ2h0OiAxXG4gIH0sXG4gIHJpZ2h0OiB7XG4gICAgcmlnaHQ6IDAsXG4gICAgbGVmdDogMVxuICB9XG59O1xuXG5wcm90by5zZXRDZWxsQWxpZ24gPSBmdW5jdGlvbigpIHtcbiAgdmFyIHNob3J0aGFuZCA9IGNlbGxBbGlnblNob3J0aGFuZHNbIHRoaXMub3B0aW9ucy5jZWxsQWxpZ24gXTtcbiAgdGhpcy5jZWxsQWxpZ24gPSBzaG9ydGhhbmQgPyBzaG9ydGhhbmRbIHRoaXMub3JpZ2luU2lkZSBdIDogdGhpcy5vcHRpb25zLmNlbGxBbGlnbjtcbn07XG5cbnByb3RvLnNldEdhbGxlcnlTaXplID0gZnVuY3Rpb24oKSB7XG4gIGlmICggdGhpcy5vcHRpb25zLnNldEdhbGxlcnlTaXplICkge1xuICAgIHZhciBoZWlnaHQgPSB0aGlzLm9wdGlvbnMuYWRhcHRpdmVIZWlnaHQgJiYgdGhpcy5zZWxlY3RlZFNsaWRlID9cbiAgICAgIHRoaXMuc2VsZWN0ZWRTbGlkZS5oZWlnaHQgOiB0aGlzLm1heENlbGxIZWlnaHQ7XG4gICAgdGhpcy52aWV3cG9ydC5zdHlsZS5oZWlnaHQgPSBoZWlnaHQgKyAncHgnO1xuICB9XG59O1xuXG5wcm90by5fZ2V0V3JhcFNoaWZ0Q2VsbHMgPSBmdW5jdGlvbigpIHtcbiAgLy8gb25seSBmb3Igd3JhcC1hcm91bmRcbiAgaWYgKCAhdGhpcy5vcHRpb25zLndyYXBBcm91bmQgKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIC8vIHVuc2hpZnQgcHJldmlvdXMgY2VsbHNcbiAgdGhpcy5fdW5zaGlmdENlbGxzKCB0aGlzLmJlZm9yZVNoaWZ0Q2VsbHMgKTtcbiAgdGhpcy5fdW5zaGlmdENlbGxzKCB0aGlzLmFmdGVyU2hpZnRDZWxscyApO1xuICAvLyBnZXQgYmVmb3JlIGNlbGxzXG4gIC8vIGluaXRpYWwgZ2FwXG4gIHZhciBnYXBYID0gdGhpcy5jdXJzb3JQb3NpdGlvbjtcbiAgdmFyIGNlbGxJbmRleCA9IHRoaXMuY2VsbHMubGVuZ3RoIC0gMTtcbiAgdGhpcy5iZWZvcmVTaGlmdENlbGxzID0gdGhpcy5fZ2V0R2FwQ2VsbHMoIGdhcFgsIGNlbGxJbmRleCwgLTEgKTtcbiAgLy8gZ2V0IGFmdGVyIGNlbGxzXG4gIC8vIGVuZGluZyBnYXAgYmV0d2VlbiBsYXN0IGNlbGwgYW5kIGVuZCBvZiBnYWxsZXJ5IHZpZXdwb3J0XG4gIGdhcFggPSB0aGlzLnNpemUuaW5uZXJXaWR0aCAtIHRoaXMuY3Vyc29yUG9zaXRpb247XG4gIC8vIHN0YXJ0IGNsb25pbmcgYXQgZmlyc3QgY2VsbCwgd29ya2luZyBmb3J3YXJkc1xuICB0aGlzLmFmdGVyU2hpZnRDZWxscyA9IHRoaXMuX2dldEdhcENlbGxzKCBnYXBYLCAwLCAxICk7XG59O1xuXG5wcm90by5fZ2V0R2FwQ2VsbHMgPSBmdW5jdGlvbiggZ2FwWCwgY2VsbEluZGV4LCBpbmNyZW1lbnQgKSB7XG4gIC8vIGtlZXAgYWRkaW5nIGNlbGxzIHVudGlsIHRoZSBjb3ZlciB0aGUgaW5pdGlhbCBnYXBcbiAgdmFyIGNlbGxzID0gW107XG4gIHdoaWxlICggZ2FwWCA+IDAgKSB7XG4gICAgdmFyIGNlbGwgPSB0aGlzLmNlbGxzWyBjZWxsSW5kZXggXTtcbiAgICBpZiAoICFjZWxsICkge1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIGNlbGxzLnB1c2goIGNlbGwgKTtcbiAgICBjZWxsSW5kZXggKz0gaW5jcmVtZW50O1xuICAgIGdhcFggLT0gY2VsbC5zaXplLm91dGVyV2lkdGg7XG4gIH1cbiAgcmV0dXJuIGNlbGxzO1xufTtcblxuLy8gLS0tLS0gY29udGFpbiAtLS0tLSAvL1xuXG4vLyBjb250YWluIGNlbGwgdGFyZ2V0cyBzbyBubyBleGNlc3Mgc2xpZGluZ1xucHJvdG8uX2NvbnRhaW5TbGlkZXMgPSBmdW5jdGlvbigpIHtcbiAgaWYgKCAhdGhpcy5vcHRpb25zLmNvbnRhaW4gfHwgdGhpcy5vcHRpb25zLndyYXBBcm91bmQgfHwgIXRoaXMuY2VsbHMubGVuZ3RoICkge1xuICAgIHJldHVybjtcbiAgfVxuICB2YXIgaXNSaWdodFRvTGVmdCA9IHRoaXMub3B0aW9ucy5yaWdodFRvTGVmdDtcbiAgdmFyIGJlZ2luTWFyZ2luID0gaXNSaWdodFRvTGVmdCA/ICdtYXJnaW5SaWdodCcgOiAnbWFyZ2luTGVmdCc7XG4gIHZhciBlbmRNYXJnaW4gPSBpc1JpZ2h0VG9MZWZ0ID8gJ21hcmdpbkxlZnQnIDogJ21hcmdpblJpZ2h0JztcbiAgdmFyIGNvbnRlbnRXaWR0aCA9IHRoaXMuc2xpZGVhYmxlV2lkdGggLSB0aGlzLmdldExhc3RDZWxsKCkuc2l6ZVsgZW5kTWFyZ2luIF07XG4gIC8vIGNvbnRlbnQgaXMgbGVzcyB0aGFuIGdhbGxlcnkgc2l6ZVxuICB2YXIgaXNDb250ZW50U21hbGxlciA9IGNvbnRlbnRXaWR0aCA8IHRoaXMuc2l6ZS5pbm5lcldpZHRoO1xuICAvLyBib3VuZHNcbiAgdmFyIGJlZ2luQm91bmQgPSB0aGlzLmN1cnNvclBvc2l0aW9uICsgdGhpcy5jZWxsc1swXS5zaXplWyBiZWdpbk1hcmdpbiBdO1xuICB2YXIgZW5kQm91bmQgPSBjb250ZW50V2lkdGggLSB0aGlzLnNpemUuaW5uZXJXaWR0aCAqICggMSAtIHRoaXMuY2VsbEFsaWduICk7XG4gIC8vIGNvbnRhaW4gZWFjaCBjZWxsIHRhcmdldFxuICB0aGlzLnNsaWRlcy5mb3JFYWNoKCBmdW5jdGlvbiggc2xpZGUgKSB7XG4gICAgaWYgKCBpc0NvbnRlbnRTbWFsbGVyICkge1xuICAgICAgLy8gYWxsIGNlbGxzIGZpdCBpbnNpZGUgZ2FsbGVyeVxuICAgICAgc2xpZGUudGFyZ2V0ID0gY29udGVudFdpZHRoICogdGhpcy5jZWxsQWxpZ247XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIGNvbnRhaW4gdG8gYm91bmRzXG4gICAgICBzbGlkZS50YXJnZXQgPSBNYXRoLm1heCggc2xpZGUudGFyZ2V0LCBiZWdpbkJvdW5kICk7XG4gICAgICBzbGlkZS50YXJnZXQgPSBNYXRoLm1pbiggc2xpZGUudGFyZ2V0LCBlbmRCb3VuZCApO1xuICAgIH1cbiAgfSwgdGhpcyApO1xufTtcblxuLy8gLS0tLS0gIC0tLS0tIC8vXG5cbi8qKlxuICogZW1pdHMgZXZlbnRzIHZpYSBldmVudEVtaXR0ZXIgYW5kIGpRdWVyeSBldmVudHNcbiAqIEBwYXJhbSB7U3RyaW5nfSB0eXBlIC0gbmFtZSBvZiBldmVudFxuICogQHBhcmFtIHtFdmVudH0gZXZlbnQgLSBvcmlnaW5hbCBldmVudFxuICogQHBhcmFtIHtBcnJheX0gYXJncyAtIGV4dHJhIGFyZ3VtZW50c1xuICovXG5wcm90by5kaXNwYXRjaEV2ZW50ID0gZnVuY3Rpb24oIHR5cGUsIGV2ZW50LCBhcmdzICkge1xuICB2YXIgZW1pdEFyZ3MgPSBldmVudCA/IFsgZXZlbnQgXS5jb25jYXQoIGFyZ3MgKSA6IGFyZ3M7XG4gIHRoaXMuZW1pdEV2ZW50KCB0eXBlLCBlbWl0QXJncyApO1xuXG4gIGlmICggalF1ZXJ5ICYmIHRoaXMuJGVsZW1lbnQgKSB7XG4gICAgLy8gZGVmYXVsdCB0cmlnZ2VyIHdpdGggdHlwZSBpZiBubyBldmVudFxuICAgIHR5cGUgKz0gdGhpcy5vcHRpb25zLm5hbWVzcGFjZUpRdWVyeUV2ZW50cyA/ICcuZmxpY2tpdHknIDogJyc7XG4gICAgdmFyICRldmVudCA9IHR5cGU7XG4gICAgaWYgKCBldmVudCApIHtcbiAgICAgIC8vIGNyZWF0ZSBqUXVlcnkgZXZlbnRcbiAgICAgIHZhciBqUUV2ZW50ID0galF1ZXJ5LkV2ZW50KCBldmVudCApO1xuICAgICAgalFFdmVudC50eXBlID0gdHlwZTtcbiAgICAgICRldmVudCA9IGpRRXZlbnQ7XG4gICAgfVxuICAgIHRoaXMuJGVsZW1lbnQudHJpZ2dlciggJGV2ZW50LCBhcmdzICk7XG4gIH1cbn07XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIHNlbGVjdCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvL1xuXG4vKipcbiAqIEBwYXJhbSB7SW50ZWdlcn0gaW5kZXggLSBpbmRleCBvZiB0aGUgc2xpZGVcbiAqIEBwYXJhbSB7Qm9vbGVhbn0gaXNXcmFwIC0gd2lsbCB3cmFwLWFyb3VuZCB0byBsYXN0L2ZpcnN0IGlmIGF0IHRoZSBlbmRcbiAqIEBwYXJhbSB7Qm9vbGVhbn0gaXNJbnN0YW50IC0gd2lsbCBpbW1lZGlhdGVseSBzZXQgcG9zaXRpb24gYXQgc2VsZWN0ZWQgY2VsbFxuICovXG5wcm90by5zZWxlY3QgPSBmdW5jdGlvbiggaW5kZXgsIGlzV3JhcCwgaXNJbnN0YW50ICkge1xuICBpZiAoICF0aGlzLmlzQWN0aXZlICkge1xuICAgIHJldHVybjtcbiAgfVxuICBpbmRleCA9IHBhcnNlSW50KCBpbmRleCwgMTAgKTtcbiAgdGhpcy5fd3JhcFNlbGVjdCggaW5kZXggKTtcblxuICBpZiAoIHRoaXMub3B0aW9ucy53cmFwQXJvdW5kIHx8IGlzV3JhcCApIHtcbiAgICBpbmRleCA9IHV0aWxzLm1vZHVsbyggaW5kZXgsIHRoaXMuc2xpZGVzLmxlbmd0aCApO1xuICB9XG4gIC8vIGJhaWwgaWYgaW52YWxpZCBpbmRleFxuICBpZiAoICF0aGlzLnNsaWRlc1sgaW5kZXggXSApIHtcbiAgICByZXR1cm47XG4gIH1cbiAgdGhpcy5zZWxlY3RlZEluZGV4ID0gaW5kZXg7XG4gIHRoaXMudXBkYXRlU2VsZWN0ZWRTbGlkZSgpO1xuICBpZiAoIGlzSW5zdGFudCApIHtcbiAgICB0aGlzLnBvc2l0aW9uU2xpZGVyQXRTZWxlY3RlZCgpO1xuICB9IGVsc2Uge1xuICAgIHRoaXMuc3RhcnRBbmltYXRpb24oKTtcbiAgfVxuICBpZiAoIHRoaXMub3B0aW9ucy5hZGFwdGl2ZUhlaWdodCApIHtcbiAgICB0aGlzLnNldEdhbGxlcnlTaXplKCk7XG4gIH1cblxuICB0aGlzLmRpc3BhdGNoRXZlbnQoJ3NlbGVjdCcpO1xuICAvLyBvbGQgdjEgZXZlbnQgbmFtZSwgcmVtb3ZlIGluIHYzXG4gIHRoaXMuZGlzcGF0Y2hFdmVudCgnY2VsbFNlbGVjdCcpO1xufTtcblxuLy8gd3JhcHMgcG9zaXRpb24gZm9yIHdyYXBBcm91bmQsIHRvIG1vdmUgdG8gY2xvc2VzdCBzbGlkZS4gIzExM1xucHJvdG8uX3dyYXBTZWxlY3QgPSBmdW5jdGlvbiggaW5kZXggKSB7XG4gIHZhciBsZW4gPSB0aGlzLnNsaWRlcy5sZW5ndGg7XG4gIHZhciBpc1dyYXBwaW5nID0gdGhpcy5vcHRpb25zLndyYXBBcm91bmQgJiYgbGVuID4gMTtcbiAgaWYgKCAhaXNXcmFwcGluZyApIHtcbiAgICByZXR1cm4gaW5kZXg7XG4gIH1cbiAgdmFyIHdyYXBJbmRleCA9IHV0aWxzLm1vZHVsbyggaW5kZXgsIGxlbiApO1xuICAvLyBnbyB0byBzaG9ydGVzdFxuICB2YXIgZGVsdGEgPSBNYXRoLmFicyggd3JhcEluZGV4IC0gdGhpcy5zZWxlY3RlZEluZGV4ICk7XG4gIHZhciBiYWNrV3JhcERlbHRhID0gTWF0aC5hYnMoICggd3JhcEluZGV4ICsgbGVuICkgLSB0aGlzLnNlbGVjdGVkSW5kZXggKTtcbiAgdmFyIGZvcmV3YXJkV3JhcERlbHRhID0gTWF0aC5hYnMoICggd3JhcEluZGV4IC0gbGVuICkgLSB0aGlzLnNlbGVjdGVkSW5kZXggKTtcbiAgaWYgKCAhdGhpcy5pc0RyYWdTZWxlY3QgJiYgYmFja1dyYXBEZWx0YSA8IGRlbHRhICkge1xuICAgIGluZGV4ICs9IGxlbjtcbiAgfSBlbHNlIGlmICggIXRoaXMuaXNEcmFnU2VsZWN0ICYmIGZvcmV3YXJkV3JhcERlbHRhIDwgZGVsdGEgKSB7XG4gICAgaW5kZXggLT0gbGVuO1xuICB9XG4gIC8vIHdyYXAgcG9zaXRpb24gc28gc2xpZGVyIGlzIHdpdGhpbiBub3JtYWwgYXJlYVxuICBpZiAoIGluZGV4IDwgMCApIHtcbiAgICB0aGlzLnggLT0gdGhpcy5zbGlkZWFibGVXaWR0aDtcbiAgfSBlbHNlIGlmICggaW5kZXggPj0gbGVuICkge1xuICAgIHRoaXMueCArPSB0aGlzLnNsaWRlYWJsZVdpZHRoO1xuICB9XG59O1xuXG5wcm90by5wcmV2aW91cyA9IGZ1bmN0aW9uKCBpc1dyYXAsIGlzSW5zdGFudCApIHtcbiAgdGhpcy5zZWxlY3QoIHRoaXMuc2VsZWN0ZWRJbmRleCAtIDEsIGlzV3JhcCwgaXNJbnN0YW50ICk7XG59O1xuXG5wcm90by5uZXh0ID0gZnVuY3Rpb24oIGlzV3JhcCwgaXNJbnN0YW50ICkge1xuICB0aGlzLnNlbGVjdCggdGhpcy5zZWxlY3RlZEluZGV4ICsgMSwgaXNXcmFwLCBpc0luc3RhbnQgKTtcbn07XG5cbnByb3RvLnVwZGF0ZVNlbGVjdGVkU2xpZGUgPSBmdW5jdGlvbigpIHtcbiAgdmFyIHNsaWRlID0gdGhpcy5zbGlkZXNbIHRoaXMuc2VsZWN0ZWRJbmRleCBdO1xuICAvLyBzZWxlY3RlZEluZGV4IGNvdWxkIGJlIG91dHNpZGUgb2Ygc2xpZGVzLCBpZiB0cmlnZ2VyZWQgYmVmb3JlIHJlc2l6ZSgpXG4gIGlmICggIXNsaWRlICkge1xuICAgIHJldHVybjtcbiAgfVxuICAvLyB1bnNlbGVjdCBwcmV2aW91cyBzZWxlY3RlZCBzbGlkZVxuICB0aGlzLnVuc2VsZWN0U2VsZWN0ZWRTbGlkZSgpO1xuICAvLyB1cGRhdGUgbmV3IHNlbGVjdGVkIHNsaWRlXG4gIHRoaXMuc2VsZWN0ZWRTbGlkZSA9IHNsaWRlO1xuICBzbGlkZS5zZWxlY3QoKTtcbiAgdGhpcy5zZWxlY3RlZENlbGxzID0gc2xpZGUuY2VsbHM7XG4gIHRoaXMuc2VsZWN0ZWRFbGVtZW50cyA9IHNsaWRlLmdldENlbGxFbGVtZW50cygpO1xuICAvLyBIQUNLOiBzZWxlY3RlZENlbGwgJiBzZWxlY3RlZEVsZW1lbnQgaXMgZmlyc3QgY2VsbCBpbiBzbGlkZSwgYmFja3dhcmRzIGNvbXBhdGliaWxpdHlcbiAgLy8gUmVtb3ZlIGluIHYzP1xuICB0aGlzLnNlbGVjdGVkQ2VsbCA9IHNsaWRlLmNlbGxzWzBdO1xuICB0aGlzLnNlbGVjdGVkRWxlbWVudCA9IHRoaXMuc2VsZWN0ZWRFbGVtZW50c1swXTtcbn07XG5cbnByb3RvLnVuc2VsZWN0U2VsZWN0ZWRTbGlkZSA9IGZ1bmN0aW9uKCkge1xuICBpZiAoIHRoaXMuc2VsZWN0ZWRTbGlkZSApIHtcbiAgICB0aGlzLnNlbGVjdGVkU2xpZGUudW5zZWxlY3QoKTtcbiAgfVxufTtcblxuLyoqXG4gKiBzZWxlY3Qgc2xpZGUgZnJvbSBudW1iZXIgb3IgY2VsbCBlbGVtZW50XG4gKiBAcGFyYW0ge0VsZW1lbnQgb3IgTnVtYmVyfSBlbGVtXG4gKi9cbnByb3RvLnNlbGVjdENlbGwgPSBmdW5jdGlvbiggdmFsdWUsIGlzV3JhcCwgaXNJbnN0YW50ICkge1xuICAvLyBnZXQgY2VsbFxuICB2YXIgY2VsbDtcbiAgaWYgKCB0eXBlb2YgdmFsdWUgPT0gJ251bWJlcicgKSB7XG4gICAgY2VsbCA9IHRoaXMuY2VsbHNbIHZhbHVlIF07XG4gIH0gZWxzZSB7XG4gICAgLy8gdXNlIHN0cmluZyBhcyBzZWxlY3RvclxuICAgIGlmICggdHlwZW9mIHZhbHVlID09ICdzdHJpbmcnICkge1xuICAgICAgdmFsdWUgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvciggdmFsdWUgKTtcbiAgICB9XG4gICAgLy8gZ2V0IGNlbGwgZnJvbSBlbGVtZW50XG4gICAgY2VsbCA9IHRoaXMuZ2V0Q2VsbCggdmFsdWUgKTtcbiAgfVxuICAvLyBzZWxlY3Qgc2xpZGUgdGhhdCBoYXMgY2VsbFxuICBmb3IgKCB2YXIgaT0wOyBjZWxsICYmIGkgPCB0aGlzLnNsaWRlcy5sZW5ndGg7IGkrKyApIHtcbiAgICB2YXIgc2xpZGUgPSB0aGlzLnNsaWRlc1tpXTtcbiAgICB2YXIgaW5kZXggPSBzbGlkZS5jZWxscy5pbmRleE9mKCBjZWxsICk7XG4gICAgaWYgKCBpbmRleCAhPSAtMSApIHtcbiAgICAgIHRoaXMuc2VsZWN0KCBpLCBpc1dyYXAsIGlzSW5zdGFudCApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgfVxufTtcblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gZ2V0IGNlbGxzIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vXG5cbi8qKlxuICogZ2V0IEZsaWNraXR5LkNlbGwsIGdpdmVuIGFuIEVsZW1lbnRcbiAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbVxuICogQHJldHVybnMge0ZsaWNraXR5LkNlbGx9IGl0ZW1cbiAqL1xucHJvdG8uZ2V0Q2VsbCA9IGZ1bmN0aW9uKCBlbGVtICkge1xuICAvLyBsb29wIHRocm91Z2ggY2VsbHMgdG8gZ2V0IHRoZSBvbmUgdGhhdCBtYXRjaGVzXG4gIGZvciAoIHZhciBpPTA7IGkgPCB0aGlzLmNlbGxzLmxlbmd0aDsgaSsrICkge1xuICAgIHZhciBjZWxsID0gdGhpcy5jZWxsc1tpXTtcbiAgICBpZiAoIGNlbGwuZWxlbWVudCA9PSBlbGVtICkge1xuICAgICAgcmV0dXJuIGNlbGw7XG4gICAgfVxuICB9XG59O1xuXG4vKipcbiAqIGdldCBjb2xsZWN0aW9uIG9mIEZsaWNraXR5LkNlbGxzLCBnaXZlbiBFbGVtZW50c1xuICogQHBhcmFtIHtFbGVtZW50LCBBcnJheSwgTm9kZUxpc3R9IGVsZW1zXG4gKiBAcmV0dXJucyB7QXJyYXl9IGNlbGxzIC0gRmxpY2tpdHkuQ2VsbHNcbiAqL1xucHJvdG8uZ2V0Q2VsbHMgPSBmdW5jdGlvbiggZWxlbXMgKSB7XG4gIGVsZW1zID0gdXRpbHMubWFrZUFycmF5KCBlbGVtcyApO1xuICB2YXIgY2VsbHMgPSBbXTtcbiAgZWxlbXMuZm9yRWFjaCggZnVuY3Rpb24oIGVsZW0gKSB7XG4gICAgdmFyIGNlbGwgPSB0aGlzLmdldENlbGwoIGVsZW0gKTtcbiAgICBpZiAoIGNlbGwgKSB7XG4gICAgICBjZWxscy5wdXNoKCBjZWxsICk7XG4gICAgfVxuICB9LCB0aGlzICk7XG4gIHJldHVybiBjZWxscztcbn07XG5cbi8qKlxuICogZ2V0IGNlbGwgZWxlbWVudHNcbiAqIEByZXR1cm5zIHtBcnJheX0gY2VsbEVsZW1zXG4gKi9cbnByb3RvLmdldENlbGxFbGVtZW50cyA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gdGhpcy5jZWxscy5tYXAoIGZ1bmN0aW9uKCBjZWxsICkge1xuICAgIHJldHVybiBjZWxsLmVsZW1lbnQ7XG4gIH0pO1xufTtcblxuLyoqXG4gKiBnZXQgcGFyZW50IGNlbGwgZnJvbSBhbiBlbGVtZW50XG4gKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1cbiAqIEByZXR1cm5zIHtGbGlja2l0LkNlbGx9IGNlbGxcbiAqL1xucHJvdG8uZ2V0UGFyZW50Q2VsbCA9IGZ1bmN0aW9uKCBlbGVtICkge1xuICAvLyBmaXJzdCBjaGVjayBpZiBlbGVtIGlzIGNlbGxcbiAgdmFyIGNlbGwgPSB0aGlzLmdldENlbGwoIGVsZW0gKTtcbiAgaWYgKCBjZWxsICkge1xuICAgIHJldHVybiBjZWxsO1xuICB9XG4gIC8vIHRyeSB0byBnZXQgcGFyZW50IGNlbGwgZWxlbVxuICBlbGVtID0gdXRpbHMuZ2V0UGFyZW50KCBlbGVtLCAnLmZsaWNraXR5LXNsaWRlciA+IConICk7XG4gIHJldHVybiB0aGlzLmdldENlbGwoIGVsZW0gKTtcbn07XG5cbi8qKlxuICogZ2V0IGNlbGxzIGFkamFjZW50IHRvIGEgc2xpZGVcbiAqIEBwYXJhbSB7SW50ZWdlcn0gYWRqQ291bnQgLSBudW1iZXIgb2YgYWRqYWNlbnQgc2xpZGVzXG4gKiBAcGFyYW0ge0ludGVnZXJ9IGluZGV4IC0gaW5kZXggb2Ygc2xpZGUgdG8gc3RhcnRcbiAqIEByZXR1cm5zIHtBcnJheX0gY2VsbHMgLSBhcnJheSBvZiBGbGlja2l0eS5DZWxsc1xuICovXG5wcm90by5nZXRBZGphY2VudENlbGxFbGVtZW50cyA9IGZ1bmN0aW9uKCBhZGpDb3VudCwgaW5kZXggKSB7XG4gIGlmICggIWFkakNvdW50ICkge1xuICAgIHJldHVybiB0aGlzLnNlbGVjdGVkU2xpZGUuZ2V0Q2VsbEVsZW1lbnRzKCk7XG4gIH1cbiAgaW5kZXggPSBpbmRleCA9PT0gdW5kZWZpbmVkID8gdGhpcy5zZWxlY3RlZEluZGV4IDogaW5kZXg7XG5cbiAgdmFyIGxlbiA9IHRoaXMuc2xpZGVzLmxlbmd0aDtcbiAgaWYgKCAxICsgKCBhZGpDb3VudCAqIDIgKSA+PSBsZW4gKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0Q2VsbEVsZW1lbnRzKCk7XG4gIH1cblxuICB2YXIgY2VsbEVsZW1zID0gW107XG4gIGZvciAoIHZhciBpID0gaW5kZXggLSBhZGpDb3VudDsgaSA8PSBpbmRleCArIGFkakNvdW50IDsgaSsrICkge1xuICAgIHZhciBzbGlkZUluZGV4ID0gdGhpcy5vcHRpb25zLndyYXBBcm91bmQgPyB1dGlscy5tb2R1bG8oIGksIGxlbiApIDogaTtcbiAgICB2YXIgc2xpZGUgPSB0aGlzLnNsaWRlc1sgc2xpZGVJbmRleCBdO1xuICAgIGlmICggc2xpZGUgKSB7XG4gICAgICBjZWxsRWxlbXMgPSBjZWxsRWxlbXMuY29uY2F0KCBzbGlkZS5nZXRDZWxsRWxlbWVudHMoKSApO1xuICAgIH1cbiAgfVxuICByZXR1cm4gY2VsbEVsZW1zO1xufTtcblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gZXZlbnRzIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vXG5cbnByb3RvLnVpQ2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuZW1pdEV2ZW50KCd1aUNoYW5nZScpO1xufTtcblxucHJvdG8uY2hpbGRVSVBvaW50ZXJEb3duID0gZnVuY3Rpb24oIGV2ZW50ICkge1xuICB0aGlzLmVtaXRFdmVudCggJ2NoaWxkVUlQb2ludGVyRG93bicsIFsgZXZlbnQgXSApO1xufTtcblxuLy8gLS0tLS0gcmVzaXplIC0tLS0tIC8vXG5cbnByb3RvLm9ucmVzaXplID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMud2F0Y2hDU1MoKTtcbiAgdGhpcy5yZXNpemUoKTtcbn07XG5cbnV0aWxzLmRlYm91bmNlTWV0aG9kKCBGbGlja2l0eSwgJ29ucmVzaXplJywgMTUwICk7XG5cbnByb3RvLnJlc2l6ZSA9IGZ1bmN0aW9uKCkge1xuICBpZiAoICF0aGlzLmlzQWN0aXZlICkge1xuICAgIHJldHVybjtcbiAgfVxuICB0aGlzLmdldFNpemUoKTtcbiAgLy8gd3JhcCB2YWx1ZXNcbiAgaWYgKCB0aGlzLm9wdGlvbnMud3JhcEFyb3VuZCApIHtcbiAgICB0aGlzLnggPSB1dGlscy5tb2R1bG8oIHRoaXMueCwgdGhpcy5zbGlkZWFibGVXaWR0aCApO1xuICB9XG4gIHRoaXMucG9zaXRpb25DZWxscygpO1xuICB0aGlzLl9nZXRXcmFwU2hpZnRDZWxscygpO1xuICB0aGlzLnNldEdhbGxlcnlTaXplKCk7XG4gIHRoaXMuZW1pdEV2ZW50KCdyZXNpemUnKTtcbiAgLy8gdXBkYXRlIHNlbGVjdGVkIGluZGV4IGZvciBncm91cCBzbGlkZXMsIGluc3RhbnRcbiAgLy8gVE9ETzogcG9zaXRpb24gY2FuIGJlIGxvc3QgYmV0d2VlbiBncm91cHMgb2YgdmFyaW91cyBudW1iZXJzXG4gIHZhciBzZWxlY3RlZEVsZW1lbnQgPSB0aGlzLnNlbGVjdGVkRWxlbWVudHMgJiYgdGhpcy5zZWxlY3RlZEVsZW1lbnRzWzBdO1xuICB0aGlzLnNlbGVjdENlbGwoIHNlbGVjdGVkRWxlbWVudCwgZmFsc2UsIHRydWUgKTtcbn07XG5cbi8vIHdhdGNoZXMgdGhlIDphZnRlciBwcm9wZXJ0eSwgYWN0aXZhdGVzL2RlYWN0aXZhdGVzXG5wcm90by53YXRjaENTUyA9IGZ1bmN0aW9uKCkge1xuICB2YXIgd2F0Y2hPcHRpb24gPSB0aGlzLm9wdGlvbnMud2F0Y2hDU1M7XG4gIGlmICggIXdhdGNoT3B0aW9uICkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBhZnRlckNvbnRlbnQgPSBnZXRDb21wdXRlZFN0eWxlKCB0aGlzLmVsZW1lbnQsICc6YWZ0ZXInICkuY29udGVudDtcbiAgLy8gYWN0aXZhdGUgaWYgOmFmdGVyIHsgY29udGVudDogJ2ZsaWNraXR5JyB9XG4gIGlmICggYWZ0ZXJDb250ZW50LmluZGV4T2YoJ2ZsaWNraXR5JykgIT0gLTEgKSB7XG4gICAgdGhpcy5hY3RpdmF0ZSgpO1xuICB9IGVsc2Uge1xuICAgIHRoaXMuZGVhY3RpdmF0ZSgpO1xuICB9XG59O1xuXG4vLyAtLS0tLSBrZXlkb3duIC0tLS0tIC8vXG5cbi8vIGdvIHByZXZpb3VzL25leHQgaWYgbGVmdC9yaWdodCBrZXlzIHByZXNzZWRcbnByb3RvLm9ua2V5ZG93biA9IGZ1bmN0aW9uKCBldmVudCApIHtcbiAgLy8gb25seSB3b3JrIGlmIGVsZW1lbnQgaXMgaW4gZm9jdXNcbiAgaWYgKCAhdGhpcy5vcHRpb25zLmFjY2Vzc2liaWxpdHkgfHxcbiAgICAoIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgJiYgZG9jdW1lbnQuYWN0aXZlRWxlbWVudCAhPSB0aGlzLmVsZW1lbnQgKSApIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoIGV2ZW50LmtleUNvZGUgPT0gMzcgKSB7XG4gICAgLy8gZ28gbGVmdFxuICAgIHZhciBsZWZ0TWV0aG9kID0gdGhpcy5vcHRpb25zLnJpZ2h0VG9MZWZ0ID8gJ25leHQnIDogJ3ByZXZpb3VzJztcbiAgICB0aGlzLnVpQ2hhbmdlKCk7XG4gICAgdGhpc1sgbGVmdE1ldGhvZCBdKCk7XG4gIH0gZWxzZSBpZiAoIGV2ZW50LmtleUNvZGUgPT0gMzkgKSB7XG4gICAgLy8gZ28gcmlnaHRcbiAgICB2YXIgcmlnaHRNZXRob2QgPSB0aGlzLm9wdGlvbnMucmlnaHRUb0xlZnQgPyAncHJldmlvdXMnIDogJ25leHQnO1xuICAgIHRoaXMudWlDaGFuZ2UoKTtcbiAgICB0aGlzWyByaWdodE1ldGhvZCBdKCk7XG4gIH1cbn07XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIGRlc3Ryb3kgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cblxuLy8gZGVhY3RpdmF0ZSBhbGwgRmxpY2tpdHkgZnVuY3Rpb25hbGl0eSwgYnV0IGtlZXAgc3R1ZmYgYXZhaWxhYmxlXG5wcm90by5kZWFjdGl2YXRlID0gZnVuY3Rpb24oKSB7XG4gIGlmICggIXRoaXMuaXNBY3RpdmUgKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdmbGlja2l0eS1lbmFibGVkJyk7XG4gIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdmbGlja2l0eS1ydGwnKTtcbiAgLy8gZGVzdHJveSBjZWxsc1xuICB0aGlzLmNlbGxzLmZvckVhY2goIGZ1bmN0aW9uKCBjZWxsICkge1xuICAgIGNlbGwuZGVzdHJveSgpO1xuICB9KTtcbiAgdGhpcy51bnNlbGVjdFNlbGVjdGVkU2xpZGUoKTtcbiAgdGhpcy5lbGVtZW50LnJlbW92ZUNoaWxkKCB0aGlzLnZpZXdwb3J0ICk7XG4gIC8vIG1vdmUgY2hpbGQgZWxlbWVudHMgYmFjayBpbnRvIGVsZW1lbnRcbiAgbW92ZUVsZW1lbnRzKCB0aGlzLnNsaWRlci5jaGlsZHJlbiwgdGhpcy5lbGVtZW50ICk7XG4gIGlmICggdGhpcy5vcHRpb25zLmFjY2Vzc2liaWxpdHkgKSB7XG4gICAgdGhpcy5lbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgndGFiSW5kZXgnKTtcbiAgICB0aGlzLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ2tleWRvd24nLCB0aGlzICk7XG4gIH1cbiAgLy8gc2V0IGZsYWdzXG4gIHRoaXMuaXNBY3RpdmUgPSBmYWxzZTtcbiAgdGhpcy5lbWl0RXZlbnQoJ2RlYWN0aXZhdGUnKTtcbn07XG5cbnByb3RvLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5kZWFjdGl2YXRlKCk7XG4gIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCAncmVzaXplJywgdGhpcyApO1xuICB0aGlzLmVtaXRFdmVudCgnZGVzdHJveScpO1xuICBpZiAoIGpRdWVyeSAmJiB0aGlzLiRlbGVtZW50ICkge1xuICAgIGpRdWVyeS5yZW1vdmVEYXRhKCB0aGlzLmVsZW1lbnQsICdmbGlja2l0eScgKTtcbiAgfVxuICBkZWxldGUgdGhpcy5lbGVtZW50LmZsaWNraXR5R1VJRDtcbiAgZGVsZXRlIGluc3RhbmNlc1sgdGhpcy5ndWlkIF07XG59O1xuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBwcm90b3R5cGUgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cblxudXRpbHMuZXh0ZW5kKCBwcm90bywgYW5pbWF0ZVByb3RvdHlwZSApO1xuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBleHRyYXMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cblxuLyoqXG4gKiBnZXQgRmxpY2tpdHkgaW5zdGFuY2UgZnJvbSBlbGVtZW50XG4gKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1cbiAqIEByZXR1cm5zIHtGbGlja2l0eX1cbiAqL1xuRmxpY2tpdHkuZGF0YSA9IGZ1bmN0aW9uKCBlbGVtICkge1xuICBlbGVtID0gdXRpbHMuZ2V0UXVlcnlFbGVtZW50KCBlbGVtICk7XG4gIHZhciBpZCA9IGVsZW0gJiYgZWxlbS5mbGlja2l0eUdVSUQ7XG4gIHJldHVybiBpZCAmJiBpbnN0YW5jZXNbIGlkIF07XG59O1xuXG51dGlscy5odG1sSW5pdCggRmxpY2tpdHksICdmbGlja2l0eScgKTtcblxuaWYgKCBqUXVlcnkgJiYgalF1ZXJ5LmJyaWRnZXQgKSB7XG4gIGpRdWVyeS5icmlkZ2V0KCAnZmxpY2tpdHknLCBGbGlja2l0eSApO1xufVxuXG5GbGlja2l0eS5DZWxsID0gQ2VsbDtcblxucmV0dXJuIEZsaWNraXR5O1xuXG59KSk7XG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9mbGlja2l0eS9qcy9mbGlja2l0eS5qc1xuICoqIG1vZHVsZSBpZCA9IDRcbiAqKiBtb2R1bGUgY2h1bmtzID0gMCAxXG4gKiovIiwiLyoqXG4gKiBFdkVtaXR0ZXIgdjEuMC4zXG4gKiBMaWwnIGV2ZW50IGVtaXR0ZXJcbiAqIE1JVCBMaWNlbnNlXG4gKi9cblxuLyoganNoaW50IHVudXNlZDogdHJ1ZSwgdW5kZWY6IHRydWUsIHN0cmljdDogdHJ1ZSAqL1xuXG4oIGZ1bmN0aW9uKCBnbG9iYWwsIGZhY3RvcnkgKSB7XG4gIC8vIHVuaXZlcnNhbCBtb2R1bGUgZGVmaW5pdGlvblxuICAvKiBqc2hpbnQgc3RyaWN0OiBmYWxzZSAqLyAvKiBnbG9iYWxzIGRlZmluZSwgbW9kdWxlLCB3aW5kb3cgKi9cbiAgaWYgKCB0eXBlb2YgZGVmaW5lID09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCApIHtcbiAgICAvLyBBTUQgLSBSZXF1aXJlSlNcbiAgICBkZWZpbmUoIGZhY3RvcnkgKTtcbiAgfSBlbHNlIGlmICggdHlwZW9mIG1vZHVsZSA9PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cyApIHtcbiAgICAvLyBDb21tb25KUyAtIEJyb3dzZXJpZnksIFdlYnBhY2tcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcbiAgfSBlbHNlIHtcbiAgICAvLyBCcm93c2VyIGdsb2JhbHNcbiAgICBnbG9iYWwuRXZFbWl0dGVyID0gZmFjdG9yeSgpO1xuICB9XG5cbn0oIHR5cGVvZiB3aW5kb3cgIT0gJ3VuZGVmaW5lZCcgPyB3aW5kb3cgOiB0aGlzLCBmdW5jdGlvbigpIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIEV2RW1pdHRlcigpIHt9XG5cbnZhciBwcm90byA9IEV2RW1pdHRlci5wcm90b3R5cGU7XG5cbnByb3RvLm9uID0gZnVuY3Rpb24oIGV2ZW50TmFtZSwgbGlzdGVuZXIgKSB7XG4gIGlmICggIWV2ZW50TmFtZSB8fCAhbGlzdGVuZXIgKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIC8vIHNldCBldmVudHMgaGFzaFxuICB2YXIgZXZlbnRzID0gdGhpcy5fZXZlbnRzID0gdGhpcy5fZXZlbnRzIHx8IHt9O1xuICAvLyBzZXQgbGlzdGVuZXJzIGFycmF5XG4gIHZhciBsaXN0ZW5lcnMgPSBldmVudHNbIGV2ZW50TmFtZSBdID0gZXZlbnRzWyBldmVudE5hbWUgXSB8fCBbXTtcbiAgLy8gb25seSBhZGQgb25jZVxuICBpZiAoIGxpc3RlbmVycy5pbmRleE9mKCBsaXN0ZW5lciApID09IC0xICkge1xuICAgIGxpc3RlbmVycy5wdXNoKCBsaXN0ZW5lciApO1xuICB9XG5cbiAgcmV0dXJuIHRoaXM7XG59O1xuXG5wcm90by5vbmNlID0gZnVuY3Rpb24oIGV2ZW50TmFtZSwgbGlzdGVuZXIgKSB7XG4gIGlmICggIWV2ZW50TmFtZSB8fCAhbGlzdGVuZXIgKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIC8vIGFkZCBldmVudFxuICB0aGlzLm9uKCBldmVudE5hbWUsIGxpc3RlbmVyICk7XG4gIC8vIHNldCBvbmNlIGZsYWdcbiAgLy8gc2V0IG9uY2VFdmVudHMgaGFzaFxuICB2YXIgb25jZUV2ZW50cyA9IHRoaXMuX29uY2VFdmVudHMgPSB0aGlzLl9vbmNlRXZlbnRzIHx8IHt9O1xuICAvLyBzZXQgb25jZUxpc3RlbmVycyBvYmplY3RcbiAgdmFyIG9uY2VMaXN0ZW5lcnMgPSBvbmNlRXZlbnRzWyBldmVudE5hbWUgXSA9IG9uY2VFdmVudHNbIGV2ZW50TmFtZSBdIHx8IHt9O1xuICAvLyBzZXQgZmxhZ1xuICBvbmNlTGlzdGVuZXJzWyBsaXN0ZW5lciBdID0gdHJ1ZTtcblxuICByZXR1cm4gdGhpcztcbn07XG5cbnByb3RvLm9mZiA9IGZ1bmN0aW9uKCBldmVudE5hbWUsIGxpc3RlbmVyICkge1xuICB2YXIgbGlzdGVuZXJzID0gdGhpcy5fZXZlbnRzICYmIHRoaXMuX2V2ZW50c1sgZXZlbnROYW1lIF07XG4gIGlmICggIWxpc3RlbmVycyB8fCAhbGlzdGVuZXJzLmxlbmd0aCApIHtcbiAgICByZXR1cm47XG4gIH1cbiAgdmFyIGluZGV4ID0gbGlzdGVuZXJzLmluZGV4T2YoIGxpc3RlbmVyICk7XG4gIGlmICggaW5kZXggIT0gLTEgKSB7XG4gICAgbGlzdGVuZXJzLnNwbGljZSggaW5kZXgsIDEgKTtcbiAgfVxuXG4gIHJldHVybiB0aGlzO1xufTtcblxucHJvdG8uZW1pdEV2ZW50ID0gZnVuY3Rpb24oIGV2ZW50TmFtZSwgYXJncyApIHtcbiAgdmFyIGxpc3RlbmVycyA9IHRoaXMuX2V2ZW50cyAmJiB0aGlzLl9ldmVudHNbIGV2ZW50TmFtZSBdO1xuICBpZiAoICFsaXN0ZW5lcnMgfHwgIWxpc3RlbmVycy5sZW5ndGggKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIHZhciBpID0gMDtcbiAgdmFyIGxpc3RlbmVyID0gbGlzdGVuZXJzW2ldO1xuICBhcmdzID0gYXJncyB8fCBbXTtcbiAgLy8gb25jZSBzdHVmZlxuICB2YXIgb25jZUxpc3RlbmVycyA9IHRoaXMuX29uY2VFdmVudHMgJiYgdGhpcy5fb25jZUV2ZW50c1sgZXZlbnROYW1lIF07XG5cbiAgd2hpbGUgKCBsaXN0ZW5lciApIHtcbiAgICB2YXIgaXNPbmNlID0gb25jZUxpc3RlbmVycyAmJiBvbmNlTGlzdGVuZXJzWyBsaXN0ZW5lciBdO1xuICAgIGlmICggaXNPbmNlICkge1xuICAgICAgLy8gcmVtb3ZlIGxpc3RlbmVyXG4gICAgICAvLyByZW1vdmUgYmVmb3JlIHRyaWdnZXIgdG8gcHJldmVudCByZWN1cnNpb25cbiAgICAgIHRoaXMub2ZmKCBldmVudE5hbWUsIGxpc3RlbmVyICk7XG4gICAgICAvLyB1bnNldCBvbmNlIGZsYWdcbiAgICAgIGRlbGV0ZSBvbmNlTGlzdGVuZXJzWyBsaXN0ZW5lciBdO1xuICAgIH1cbiAgICAvLyB0cmlnZ2VyIGxpc3RlbmVyXG4gICAgbGlzdGVuZXIuYXBwbHkoIHRoaXMsIGFyZ3MgKTtcbiAgICAvLyBnZXQgbmV4dCBsaXN0ZW5lclxuICAgIGkgKz0gaXNPbmNlID8gMCA6IDE7XG4gICAgbGlzdGVuZXIgPSBsaXN0ZW5lcnNbaV07XG4gIH1cblxuICByZXR1cm4gdGhpcztcbn07XG5cbnJldHVybiBFdkVtaXR0ZXI7XG5cbn0pKTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2V2LWVtaXR0ZXIvZXYtZW1pdHRlci5qc1xuICoqIG1vZHVsZSBpZCA9IDVcbiAqKiBtb2R1bGUgY2h1bmtzID0gMCAxXG4gKiovIiwiLyohXG4gKiBnZXRTaXplIHYyLjAuMlxuICogbWVhc3VyZSBzaXplIG9mIGVsZW1lbnRzXG4gKiBNSVQgbGljZW5zZVxuICovXG5cbi8qanNoaW50IGJyb3dzZXI6IHRydWUsIHN0cmljdDogdHJ1ZSwgdW5kZWY6IHRydWUsIHVudXNlZDogdHJ1ZSAqL1xuLypnbG9iYWwgZGVmaW5lOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSwgY29uc29sZTogZmFsc2UgKi9cblxuKCBmdW5jdGlvbiggd2luZG93LCBmYWN0b3J5ICkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgaWYgKCB0eXBlb2YgZGVmaW5lID09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCApIHtcbiAgICAvLyBBTURcbiAgICBkZWZpbmUoIGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGZhY3RvcnkoKTtcbiAgICB9KTtcbiAgfSBlbHNlIGlmICggdHlwZW9mIG1vZHVsZSA9PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cyApIHtcbiAgICAvLyBDb21tb25KU1xuICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuICB9IGVsc2Uge1xuICAgIC8vIGJyb3dzZXIgZ2xvYmFsXG4gICAgd2luZG93LmdldFNpemUgPSBmYWN0b3J5KCk7XG4gIH1cblxufSkoIHdpbmRvdywgZnVuY3Rpb24gZmFjdG9yeSgpIHtcbid1c2Ugc3RyaWN0JztcblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gaGVscGVycyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvL1xuXG4vLyBnZXQgYSBudW1iZXIgZnJvbSBhIHN0cmluZywgbm90IGEgcGVyY2VudGFnZVxuZnVuY3Rpb24gZ2V0U3R5bGVTaXplKCB2YWx1ZSApIHtcbiAgdmFyIG51bSA9IHBhcnNlRmxvYXQoIHZhbHVlICk7XG4gIC8vIG5vdCBhIHBlcmNlbnQgbGlrZSAnMTAwJScsIGFuZCBhIG51bWJlclxuICB2YXIgaXNWYWxpZCA9IHZhbHVlLmluZGV4T2YoJyUnKSA9PSAtMSAmJiAhaXNOYU4oIG51bSApO1xuICByZXR1cm4gaXNWYWxpZCAmJiBudW07XG59XG5cbmZ1bmN0aW9uIG5vb3AoKSB7fVxuXG52YXIgbG9nRXJyb3IgPSB0eXBlb2YgY29uc29sZSA9PSAndW5kZWZpbmVkJyA/IG5vb3AgOlxuICBmdW5jdGlvbiggbWVzc2FnZSApIHtcbiAgICBjb25zb2xlLmVycm9yKCBtZXNzYWdlICk7XG4gIH07XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIG1lYXN1cmVtZW50cyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvL1xuXG52YXIgbWVhc3VyZW1lbnRzID0gW1xuICAncGFkZGluZ0xlZnQnLFxuICAncGFkZGluZ1JpZ2h0JyxcbiAgJ3BhZGRpbmdUb3AnLFxuICAncGFkZGluZ0JvdHRvbScsXG4gICdtYXJnaW5MZWZ0JyxcbiAgJ21hcmdpblJpZ2h0JyxcbiAgJ21hcmdpblRvcCcsXG4gICdtYXJnaW5Cb3R0b20nLFxuICAnYm9yZGVyTGVmdFdpZHRoJyxcbiAgJ2JvcmRlclJpZ2h0V2lkdGgnLFxuICAnYm9yZGVyVG9wV2lkdGgnLFxuICAnYm9yZGVyQm90dG9tV2lkdGgnXG5dO1xuXG52YXIgbWVhc3VyZW1lbnRzTGVuZ3RoID0gbWVhc3VyZW1lbnRzLmxlbmd0aDtcblxuZnVuY3Rpb24gZ2V0WmVyb1NpemUoKSB7XG4gIHZhciBzaXplID0ge1xuICAgIHdpZHRoOiAwLFxuICAgIGhlaWdodDogMCxcbiAgICBpbm5lcldpZHRoOiAwLFxuICAgIGlubmVySGVpZ2h0OiAwLFxuICAgIG91dGVyV2lkdGg6IDAsXG4gICAgb3V0ZXJIZWlnaHQ6IDBcbiAgfTtcbiAgZm9yICggdmFyIGk9MDsgaSA8IG1lYXN1cmVtZW50c0xlbmd0aDsgaSsrICkge1xuICAgIHZhciBtZWFzdXJlbWVudCA9IG1lYXN1cmVtZW50c1tpXTtcbiAgICBzaXplWyBtZWFzdXJlbWVudCBdID0gMDtcbiAgfVxuICByZXR1cm4gc2l6ZTtcbn1cblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gZ2V0U3R5bGUgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cblxuLyoqXG4gKiBnZXRTdHlsZSwgZ2V0IHN0eWxlIG9mIGVsZW1lbnQsIGNoZWNrIGZvciBGaXJlZm94IGJ1Z1xuICogaHR0cHM6Ly9idWd6aWxsYS5tb3ppbGxhLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9NTQ4Mzk3XG4gKi9cbmZ1bmN0aW9uIGdldFN0eWxlKCBlbGVtICkge1xuICB2YXIgc3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKCBlbGVtICk7XG4gIGlmICggIXN0eWxlICkge1xuICAgIGxvZ0Vycm9yKCAnU3R5bGUgcmV0dXJuZWQgJyArIHN0eWxlICtcbiAgICAgICcuIEFyZSB5b3UgcnVubmluZyB0aGlzIGNvZGUgaW4gYSBoaWRkZW4gaWZyYW1lIG9uIEZpcmVmb3g/ICcgK1xuICAgICAgJ1NlZSBodHRwOi8vYml0Lmx5L2dldHNpemVidWcxJyApO1xuICB9XG4gIHJldHVybiBzdHlsZTtcbn1cblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gc2V0dXAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cblxudmFyIGlzU2V0dXAgPSBmYWxzZTtcblxudmFyIGlzQm94U2l6ZU91dGVyO1xuXG4vKipcbiAqIHNldHVwXG4gKiBjaGVjayBpc0JveFNpemVyT3V0ZXJcbiAqIGRvIG9uIGZpcnN0IGdldFNpemUoKSByYXRoZXIgdGhhbiBvbiBwYWdlIGxvYWQgZm9yIEZpcmVmb3ggYnVnXG4gKi9cbmZ1bmN0aW9uIHNldHVwKCkge1xuICAvLyBzZXR1cCBvbmNlXG4gIGlmICggaXNTZXR1cCApIHtcbiAgICByZXR1cm47XG4gIH1cbiAgaXNTZXR1cCA9IHRydWU7XG5cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gYm94IHNpemluZyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvL1xuXG4gIC8qKlxuICAgKiBXZWJLaXQgbWVhc3VyZXMgdGhlIG91dGVyLXdpZHRoIG9uIHN0eWxlLndpZHRoIG9uIGJvcmRlci1ib3ggZWxlbXNcbiAgICogSUUgJiBGaXJlZm94PDI5IG1lYXN1cmVzIHRoZSBpbm5lci13aWR0aFxuICAgKi9cbiAgdmFyIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICBkaXYuc3R5bGUud2lkdGggPSAnMjAwcHgnO1xuICBkaXYuc3R5bGUucGFkZGluZyA9ICcxcHggMnB4IDNweCA0cHgnO1xuICBkaXYuc3R5bGUuYm9yZGVyU3R5bGUgPSAnc29saWQnO1xuICBkaXYuc3R5bGUuYm9yZGVyV2lkdGggPSAnMXB4IDJweCAzcHggNHB4JztcbiAgZGl2LnN0eWxlLmJveFNpemluZyA9ICdib3JkZXItYm94JztcblxuICB2YXIgYm9keSA9IGRvY3VtZW50LmJvZHkgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50O1xuICBib2R5LmFwcGVuZENoaWxkKCBkaXYgKTtcbiAgdmFyIHN0eWxlID0gZ2V0U3R5bGUoIGRpdiApO1xuXG4gIGdldFNpemUuaXNCb3hTaXplT3V0ZXIgPSBpc0JveFNpemVPdXRlciA9IGdldFN0eWxlU2l6ZSggc3R5bGUud2lkdGggKSA9PSAyMDA7XG4gIGJvZHkucmVtb3ZlQ2hpbGQoIGRpdiApO1xuXG59XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIGdldFNpemUgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cblxuZnVuY3Rpb24gZ2V0U2l6ZSggZWxlbSApIHtcbiAgc2V0dXAoKTtcblxuICAvLyB1c2UgcXVlcnlTZWxldG9yIGlmIGVsZW0gaXMgc3RyaW5nXG4gIGlmICggdHlwZW9mIGVsZW0gPT0gJ3N0cmluZycgKSB7XG4gICAgZWxlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIGVsZW0gKTtcbiAgfVxuXG4gIC8vIGRvIG5vdCBwcm9jZWVkIG9uIG5vbi1vYmplY3RzXG4gIGlmICggIWVsZW0gfHwgdHlwZW9mIGVsZW0gIT0gJ29iamVjdCcgfHwgIWVsZW0ubm9kZVR5cGUgKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIHN0eWxlID0gZ2V0U3R5bGUoIGVsZW0gKTtcblxuICAvLyBpZiBoaWRkZW4sIGV2ZXJ5dGhpbmcgaXMgMFxuICBpZiAoIHN0eWxlLmRpc3BsYXkgPT0gJ25vbmUnICkge1xuICAgIHJldHVybiBnZXRaZXJvU2l6ZSgpO1xuICB9XG5cbiAgdmFyIHNpemUgPSB7fTtcbiAgc2l6ZS53aWR0aCA9IGVsZW0ub2Zmc2V0V2lkdGg7XG4gIHNpemUuaGVpZ2h0ID0gZWxlbS5vZmZzZXRIZWlnaHQ7XG5cbiAgdmFyIGlzQm9yZGVyQm94ID0gc2l6ZS5pc0JvcmRlckJveCA9IHN0eWxlLmJveFNpemluZyA9PSAnYm9yZGVyLWJveCc7XG5cbiAgLy8gZ2V0IGFsbCBtZWFzdXJlbWVudHNcbiAgZm9yICggdmFyIGk9MDsgaSA8IG1lYXN1cmVtZW50c0xlbmd0aDsgaSsrICkge1xuICAgIHZhciBtZWFzdXJlbWVudCA9IG1lYXN1cmVtZW50c1tpXTtcbiAgICB2YXIgdmFsdWUgPSBzdHlsZVsgbWVhc3VyZW1lbnQgXTtcbiAgICB2YXIgbnVtID0gcGFyc2VGbG9hdCggdmFsdWUgKTtcbiAgICAvLyBhbnkgJ2F1dG8nLCAnbWVkaXVtJyB2YWx1ZSB3aWxsIGJlIDBcbiAgICBzaXplWyBtZWFzdXJlbWVudCBdID0gIWlzTmFOKCBudW0gKSA/IG51bSA6IDA7XG4gIH1cblxuICB2YXIgcGFkZGluZ1dpZHRoID0gc2l6ZS5wYWRkaW5nTGVmdCArIHNpemUucGFkZGluZ1JpZ2h0O1xuICB2YXIgcGFkZGluZ0hlaWdodCA9IHNpemUucGFkZGluZ1RvcCArIHNpemUucGFkZGluZ0JvdHRvbTtcbiAgdmFyIG1hcmdpbldpZHRoID0gc2l6ZS5tYXJnaW5MZWZ0ICsgc2l6ZS5tYXJnaW5SaWdodDtcbiAgdmFyIG1hcmdpbkhlaWdodCA9IHNpemUubWFyZ2luVG9wICsgc2l6ZS5tYXJnaW5Cb3R0b207XG4gIHZhciBib3JkZXJXaWR0aCA9IHNpemUuYm9yZGVyTGVmdFdpZHRoICsgc2l6ZS5ib3JkZXJSaWdodFdpZHRoO1xuICB2YXIgYm9yZGVySGVpZ2h0ID0gc2l6ZS5ib3JkZXJUb3BXaWR0aCArIHNpemUuYm9yZGVyQm90dG9tV2lkdGg7XG5cbiAgdmFyIGlzQm9yZGVyQm94U2l6ZU91dGVyID0gaXNCb3JkZXJCb3ggJiYgaXNCb3hTaXplT3V0ZXI7XG5cbiAgLy8gb3ZlcndyaXRlIHdpZHRoIGFuZCBoZWlnaHQgaWYgd2UgY2FuIGdldCBpdCBmcm9tIHN0eWxlXG4gIHZhciBzdHlsZVdpZHRoID0gZ2V0U3R5bGVTaXplKCBzdHlsZS53aWR0aCApO1xuICBpZiAoIHN0eWxlV2lkdGggIT09IGZhbHNlICkge1xuICAgIHNpemUud2lkdGggPSBzdHlsZVdpZHRoICtcbiAgICAgIC8vIGFkZCBwYWRkaW5nIGFuZCBib3JkZXIgdW5sZXNzIGl0J3MgYWxyZWFkeSBpbmNsdWRpbmcgaXRcbiAgICAgICggaXNCb3JkZXJCb3hTaXplT3V0ZXIgPyAwIDogcGFkZGluZ1dpZHRoICsgYm9yZGVyV2lkdGggKTtcbiAgfVxuXG4gIHZhciBzdHlsZUhlaWdodCA9IGdldFN0eWxlU2l6ZSggc3R5bGUuaGVpZ2h0ICk7XG4gIGlmICggc3R5bGVIZWlnaHQgIT09IGZhbHNlICkge1xuICAgIHNpemUuaGVpZ2h0ID0gc3R5bGVIZWlnaHQgK1xuICAgICAgLy8gYWRkIHBhZGRpbmcgYW5kIGJvcmRlciB1bmxlc3MgaXQncyBhbHJlYWR5IGluY2x1ZGluZyBpdFxuICAgICAgKCBpc0JvcmRlckJveFNpemVPdXRlciA/IDAgOiBwYWRkaW5nSGVpZ2h0ICsgYm9yZGVySGVpZ2h0ICk7XG4gIH1cblxuICBzaXplLmlubmVyV2lkdGggPSBzaXplLndpZHRoIC0gKCBwYWRkaW5nV2lkdGggKyBib3JkZXJXaWR0aCApO1xuICBzaXplLmlubmVySGVpZ2h0ID0gc2l6ZS5oZWlnaHQgLSAoIHBhZGRpbmdIZWlnaHQgKyBib3JkZXJIZWlnaHQgKTtcblxuICBzaXplLm91dGVyV2lkdGggPSBzaXplLndpZHRoICsgbWFyZ2luV2lkdGg7XG4gIHNpemUub3V0ZXJIZWlnaHQgPSBzaXplLmhlaWdodCArIG1hcmdpbkhlaWdodDtcblxuICByZXR1cm4gc2l6ZTtcbn1cblxucmV0dXJuIGdldFNpemU7XG5cbn0pO1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vZ2V0LXNpemUvZ2V0LXNpemUuanNcbiAqKiBtb2R1bGUgaWQgPSA2XG4gKiogbW9kdWxlIGNodW5rcyA9IDAgMVxuICoqLyIsIi8qKlxuICogRml6enkgVUkgdXRpbHMgdjIuMC4zXG4gKiBNSVQgbGljZW5zZVxuICovXG5cbi8qanNoaW50IGJyb3dzZXI6IHRydWUsIHVuZGVmOiB0cnVlLCB1bnVzZWQ6IHRydWUsIHN0cmljdDogdHJ1ZSAqL1xuXG4oIGZ1bmN0aW9uKCB3aW5kb3csIGZhY3RvcnkgKSB7XG4gIC8vIHVuaXZlcnNhbCBtb2R1bGUgZGVmaW5pdGlvblxuICAvKmpzaGludCBzdHJpY3Q6IGZhbHNlICovIC8qZ2xvYmFscyBkZWZpbmUsIG1vZHVsZSwgcmVxdWlyZSAqL1xuXG4gIGlmICggdHlwZW9mIGRlZmluZSA9PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgKSB7XG4gICAgLy8gQU1EXG4gICAgZGVmaW5lKCBbXG4gICAgICAnZGVzYW5kcm8tbWF0Y2hlcy1zZWxlY3Rvci9tYXRjaGVzLXNlbGVjdG9yJ1xuICAgIF0sIGZ1bmN0aW9uKCBtYXRjaGVzU2VsZWN0b3IgKSB7XG4gICAgICByZXR1cm4gZmFjdG9yeSggd2luZG93LCBtYXRjaGVzU2VsZWN0b3IgKTtcbiAgICB9KTtcbiAgfSBlbHNlIGlmICggdHlwZW9mIG1vZHVsZSA9PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cyApIHtcbiAgICAvLyBDb21tb25KU1xuICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShcbiAgICAgIHdpbmRvdyxcbiAgICAgIHJlcXVpcmUoJ2Rlc2FuZHJvLW1hdGNoZXMtc2VsZWN0b3InKVxuICAgICk7XG4gIH0gZWxzZSB7XG4gICAgLy8gYnJvd3NlciBnbG9iYWxcbiAgICB3aW5kb3cuZml6enlVSVV0aWxzID0gZmFjdG9yeShcbiAgICAgIHdpbmRvdyxcbiAgICAgIHdpbmRvdy5tYXRjaGVzU2VsZWN0b3JcbiAgICApO1xuICB9XG5cbn0oIHdpbmRvdywgZnVuY3Rpb24gZmFjdG9yeSggd2luZG93LCBtYXRjaGVzU2VsZWN0b3IgKSB7XG5cbid1c2Ugc3RyaWN0JztcblxudmFyIHV0aWxzID0ge307XG5cbi8vIC0tLS0tIGV4dGVuZCAtLS0tLSAvL1xuXG4vLyBleHRlbmRzIG9iamVjdHNcbnV0aWxzLmV4dGVuZCA9IGZ1bmN0aW9uKCBhLCBiICkge1xuICBmb3IgKCB2YXIgcHJvcCBpbiBiICkge1xuICAgIGFbIHByb3AgXSA9IGJbIHByb3AgXTtcbiAgfVxuICByZXR1cm4gYTtcbn07XG5cbi8vIC0tLS0tIG1vZHVsbyAtLS0tLSAvL1xuXG51dGlscy5tb2R1bG8gPSBmdW5jdGlvbiggbnVtLCBkaXYgKSB7XG4gIHJldHVybiAoICggbnVtICUgZGl2ICkgKyBkaXYgKSAlIGRpdjtcbn07XG5cbi8vIC0tLS0tIG1ha2VBcnJheSAtLS0tLSAvL1xuXG4vLyB0dXJuIGVsZW1lbnQgb3Igbm9kZUxpc3QgaW50byBhbiBhcnJheVxudXRpbHMubWFrZUFycmF5ID0gZnVuY3Rpb24oIG9iaiApIHtcbiAgdmFyIGFyeSA9IFtdO1xuICBpZiAoIEFycmF5LmlzQXJyYXkoIG9iaiApICkge1xuICAgIC8vIHVzZSBvYmplY3QgaWYgYWxyZWFkeSBhbiBhcnJheVxuICAgIGFyeSA9IG9iajtcbiAgfSBlbHNlIGlmICggb2JqICYmIHR5cGVvZiBvYmoubGVuZ3RoID09ICdudW1iZXInICkge1xuICAgIC8vIGNvbnZlcnQgbm9kZUxpc3QgdG8gYXJyYXlcbiAgICBmb3IgKCB2YXIgaT0wOyBpIDwgb2JqLmxlbmd0aDsgaSsrICkge1xuICAgICAgYXJ5LnB1c2goIG9ialtpXSApO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICAvLyBhcnJheSBvZiBzaW5nbGUgaW5kZXhcbiAgICBhcnkucHVzaCggb2JqICk7XG4gIH1cbiAgcmV0dXJuIGFyeTtcbn07XG5cbi8vIC0tLS0tIHJlbW92ZUZyb20gLS0tLS0gLy9cblxudXRpbHMucmVtb3ZlRnJvbSA9IGZ1bmN0aW9uKCBhcnksIG9iaiApIHtcbiAgdmFyIGluZGV4ID0gYXJ5LmluZGV4T2YoIG9iaiApO1xuICBpZiAoIGluZGV4ICE9IC0xICkge1xuICAgIGFyeS5zcGxpY2UoIGluZGV4LCAxICk7XG4gIH1cbn07XG5cbi8vIC0tLS0tIGdldFBhcmVudCAtLS0tLSAvL1xuXG51dGlscy5nZXRQYXJlbnQgPSBmdW5jdGlvbiggZWxlbSwgc2VsZWN0b3IgKSB7XG4gIHdoaWxlICggZWxlbSAhPSBkb2N1bWVudC5ib2R5ICkge1xuICAgIGVsZW0gPSBlbGVtLnBhcmVudE5vZGU7XG4gICAgaWYgKCBtYXRjaGVzU2VsZWN0b3IoIGVsZW0sIHNlbGVjdG9yICkgKSB7XG4gICAgICByZXR1cm4gZWxlbTtcbiAgICB9XG4gIH1cbn07XG5cbi8vIC0tLS0tIGdldFF1ZXJ5RWxlbWVudCAtLS0tLSAvL1xuXG4vLyB1c2UgZWxlbWVudCBhcyBzZWxlY3RvciBzdHJpbmdcbnV0aWxzLmdldFF1ZXJ5RWxlbWVudCA9IGZ1bmN0aW9uKCBlbGVtICkge1xuICBpZiAoIHR5cGVvZiBlbGVtID09ICdzdHJpbmcnICkge1xuICAgIHJldHVybiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCBlbGVtICk7XG4gIH1cbiAgcmV0dXJuIGVsZW07XG59O1xuXG4vLyAtLS0tLSBoYW5kbGVFdmVudCAtLS0tLSAvL1xuXG4vLyBlbmFibGUgLm9udHlwZSB0byB0cmlnZ2VyIGZyb20gLmFkZEV2ZW50TGlzdGVuZXIoIGVsZW0sICd0eXBlJyApXG51dGlscy5oYW5kbGVFdmVudCA9IGZ1bmN0aW9uKCBldmVudCApIHtcbiAgdmFyIG1ldGhvZCA9ICdvbicgKyBldmVudC50eXBlO1xuICBpZiAoIHRoaXNbIG1ldGhvZCBdICkge1xuICAgIHRoaXNbIG1ldGhvZCBdKCBldmVudCApO1xuICB9XG59O1xuXG4vLyAtLS0tLSBmaWx0ZXJGaW5kRWxlbWVudHMgLS0tLS0gLy9cblxudXRpbHMuZmlsdGVyRmluZEVsZW1lbnRzID0gZnVuY3Rpb24oIGVsZW1zLCBzZWxlY3RvciApIHtcbiAgLy8gbWFrZSBhcnJheSBvZiBlbGVtc1xuICBlbGVtcyA9IHV0aWxzLm1ha2VBcnJheSggZWxlbXMgKTtcbiAgdmFyIGZmRWxlbXMgPSBbXTtcblxuICBlbGVtcy5mb3JFYWNoKCBmdW5jdGlvbiggZWxlbSApIHtcbiAgICAvLyBjaGVjayB0aGF0IGVsZW0gaXMgYW4gYWN0dWFsIGVsZW1lbnRcbiAgICBpZiAoICEoIGVsZW0gaW5zdGFuY2VvZiBIVE1MRWxlbWVudCApICkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAvLyBhZGQgZWxlbSBpZiBubyBzZWxlY3RvclxuICAgIGlmICggIXNlbGVjdG9yICkge1xuICAgICAgZmZFbGVtcy5wdXNoKCBlbGVtICk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIC8vIGZpbHRlciAmIGZpbmQgaXRlbXMgaWYgd2UgaGF2ZSBhIHNlbGVjdG9yXG4gICAgLy8gZmlsdGVyXG4gICAgaWYgKCBtYXRjaGVzU2VsZWN0b3IoIGVsZW0sIHNlbGVjdG9yICkgKSB7XG4gICAgICBmZkVsZW1zLnB1c2goIGVsZW0gKTtcbiAgICB9XG4gICAgLy8gZmluZCBjaGlsZHJlblxuICAgIHZhciBjaGlsZEVsZW1zID0gZWxlbS5xdWVyeVNlbGVjdG9yQWxsKCBzZWxlY3RvciApO1xuICAgIC8vIGNvbmNhdCBjaGlsZEVsZW1zIHRvIGZpbHRlckZvdW5kIGFycmF5XG4gICAgZm9yICggdmFyIGk9MDsgaSA8IGNoaWxkRWxlbXMubGVuZ3RoOyBpKysgKSB7XG4gICAgICBmZkVsZW1zLnB1c2goIGNoaWxkRWxlbXNbaV0gKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBmZkVsZW1zO1xufTtcblxuLy8gLS0tLS0gZGVib3VuY2VNZXRob2QgLS0tLS0gLy9cblxudXRpbHMuZGVib3VuY2VNZXRob2QgPSBmdW5jdGlvbiggX2NsYXNzLCBtZXRob2ROYW1lLCB0aHJlc2hvbGQgKSB7XG4gIC8vIG9yaWdpbmFsIG1ldGhvZFxuICB2YXIgbWV0aG9kID0gX2NsYXNzLnByb3RvdHlwZVsgbWV0aG9kTmFtZSBdO1xuICB2YXIgdGltZW91dE5hbWUgPSBtZXRob2ROYW1lICsgJ1RpbWVvdXQnO1xuXG4gIF9jbGFzcy5wcm90b3R5cGVbIG1ldGhvZE5hbWUgXSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciB0aW1lb3V0ID0gdGhpc1sgdGltZW91dE5hbWUgXTtcbiAgICBpZiAoIHRpbWVvdXQgKSB7XG4gICAgICBjbGVhclRpbWVvdXQoIHRpbWVvdXQgKTtcbiAgICB9XG4gICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XG5cbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgIHRoaXNbIHRpbWVvdXROYW1lIF0gPSBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcbiAgICAgIG1ldGhvZC5hcHBseSggX3RoaXMsIGFyZ3MgKTtcbiAgICAgIGRlbGV0ZSBfdGhpc1sgdGltZW91dE5hbWUgXTtcbiAgICB9LCB0aHJlc2hvbGQgfHwgMTAwICk7XG4gIH07XG59O1xuXG4vLyAtLS0tLSBkb2NSZWFkeSAtLS0tLSAvL1xuXG51dGlscy5kb2NSZWFkeSA9IGZ1bmN0aW9uKCBjYWxsYmFjayApIHtcbiAgdmFyIHJlYWR5U3RhdGUgPSBkb2N1bWVudC5yZWFkeVN0YXRlO1xuICBpZiAoIHJlYWR5U3RhdGUgPT0gJ2NvbXBsZXRlJyB8fCByZWFkeVN0YXRlID09ICdpbnRlcmFjdGl2ZScgKSB7XG4gICAgLy8gZG8gYXN5bmMgdG8gYWxsb3cgZm9yIG90aGVyIHNjcmlwdHMgdG8gcnVuLiBtZXRhZml6enkvZmxpY2tpdHkjNDQxXG4gICAgc2V0VGltZW91dCggY2FsbGJhY2sgKTtcbiAgfSBlbHNlIHtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCAnRE9NQ29udGVudExvYWRlZCcsIGNhbGxiYWNrICk7XG4gIH1cbn07XG5cbi8vIC0tLS0tIGh0bWxJbml0IC0tLS0tIC8vXG5cbi8vIGh0dHA6Ly9qYW1lc3JvYmVydHMubmFtZS9ibG9nLzIwMTAvMDIvMjIvc3RyaW5nLWZ1bmN0aW9ucy1mb3ItamF2YXNjcmlwdC10cmltLXRvLWNhbWVsLWNhc2UtdG8tZGFzaGVkLWFuZC10by11bmRlcnNjb3JlL1xudXRpbHMudG9EYXNoZWQgPSBmdW5jdGlvbiggc3RyICkge1xuICByZXR1cm4gc3RyLnJlcGxhY2UoIC8oLikoW0EtWl0pL2csIGZ1bmN0aW9uKCBtYXRjaCwgJDEsICQyICkge1xuICAgIHJldHVybiAkMSArICctJyArICQyO1xuICB9KS50b0xvd2VyQ2FzZSgpO1xufTtcblxudmFyIGNvbnNvbGUgPSB3aW5kb3cuY29uc29sZTtcbi8qKlxuICogYWxsb3cgdXNlciB0byBpbml0aWFsaXplIGNsYXNzZXMgdmlhIFtkYXRhLW5hbWVzcGFjZV0gb3IgLmpzLW5hbWVzcGFjZSBjbGFzc1xuICogaHRtbEluaXQoIFdpZGdldCwgJ3dpZGdldE5hbWUnIClcbiAqIG9wdGlvbnMgYXJlIHBhcnNlZCBmcm9tIGRhdGEtbmFtZXNwYWNlLW9wdGlvbnNcbiAqL1xudXRpbHMuaHRtbEluaXQgPSBmdW5jdGlvbiggV2lkZ2V0Q2xhc3MsIG5hbWVzcGFjZSApIHtcbiAgdXRpbHMuZG9jUmVhZHkoIGZ1bmN0aW9uKCkge1xuICAgIHZhciBkYXNoZWROYW1lc3BhY2UgPSB1dGlscy50b0Rhc2hlZCggbmFtZXNwYWNlICk7XG4gICAgdmFyIGRhdGFBdHRyID0gJ2RhdGEtJyArIGRhc2hlZE5hbWVzcGFjZTtcbiAgICB2YXIgZGF0YUF0dHJFbGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoICdbJyArIGRhdGFBdHRyICsgJ10nICk7XG4gICAgdmFyIGpzRGFzaEVsZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCggJy5qcy0nICsgZGFzaGVkTmFtZXNwYWNlICk7XG4gICAgdmFyIGVsZW1zID0gdXRpbHMubWFrZUFycmF5KCBkYXRhQXR0ckVsZW1zIClcbiAgICAgIC5jb25jYXQoIHV0aWxzLm1ha2VBcnJheSgganNEYXNoRWxlbXMgKSApO1xuICAgIHZhciBkYXRhT3B0aW9uc0F0dHIgPSBkYXRhQXR0ciArICctb3B0aW9ucyc7XG4gICAgdmFyIGpRdWVyeSA9IHdpbmRvdy5qUXVlcnk7XG5cbiAgICBlbGVtcy5mb3JFYWNoKCBmdW5jdGlvbiggZWxlbSApIHtcbiAgICAgIHZhciBhdHRyID0gZWxlbS5nZXRBdHRyaWJ1dGUoIGRhdGFBdHRyICkgfHxcbiAgICAgICAgZWxlbS5nZXRBdHRyaWJ1dGUoIGRhdGFPcHRpb25zQXR0ciApO1xuICAgICAgdmFyIG9wdGlvbnM7XG4gICAgICB0cnkge1xuICAgICAgICBvcHRpb25zID0gYXR0ciAmJiBKU09OLnBhcnNlKCBhdHRyICk7XG4gICAgICB9IGNhdGNoICggZXJyb3IgKSB7XG4gICAgICAgIC8vIGxvZyBlcnJvciwgZG8gbm90IGluaXRpYWxpemVcbiAgICAgICAgaWYgKCBjb25zb2xlICkge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoICdFcnJvciBwYXJzaW5nICcgKyBkYXRhQXR0ciArICcgb24gJyArIGVsZW0uY2xhc3NOYW1lICtcbiAgICAgICAgICAnOiAnICsgZXJyb3IgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICAvLyBpbml0aWFsaXplXG4gICAgICB2YXIgaW5zdGFuY2UgPSBuZXcgV2lkZ2V0Q2xhc3MoIGVsZW0sIG9wdGlvbnMgKTtcbiAgICAgIC8vIG1ha2UgYXZhaWxhYmxlIHZpYSAkKCkuZGF0YSgnbmFtZXNwYWNlJylcbiAgICAgIGlmICggalF1ZXJ5ICkge1xuICAgICAgICBqUXVlcnkuZGF0YSggZWxlbSwgbmFtZXNwYWNlLCBpbnN0YW5jZSApO1xuICAgICAgfVxuICAgIH0pO1xuXG4gIH0pO1xufTtcblxuLy8gLS0tLS0gIC0tLS0tIC8vXG5cbnJldHVybiB1dGlscztcblxufSkpO1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vZml6enktdWktdXRpbHMvdXRpbHMuanNcbiAqKiBtb2R1bGUgaWQgPSA3XG4gKiogbW9kdWxlIGNodW5rcyA9IDAgMVxuICoqLyIsIi8qKlxuICogbWF0Y2hlc1NlbGVjdG9yIHYyLjAuMVxuICogbWF0Y2hlc1NlbGVjdG9yKCBlbGVtZW50LCAnLnNlbGVjdG9yJyApXG4gKiBNSVQgbGljZW5zZVxuICovXG5cbi8qanNoaW50IGJyb3dzZXI6IHRydWUsIHN0cmljdDogdHJ1ZSwgdW5kZWY6IHRydWUsIHVudXNlZDogdHJ1ZSAqL1xuXG4oIGZ1bmN0aW9uKCB3aW5kb3csIGZhY3RvcnkgKSB7XG4gIC8qZ2xvYmFsIGRlZmluZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cbiAgJ3VzZSBzdHJpY3QnO1xuICAvLyB1bml2ZXJzYWwgbW9kdWxlIGRlZmluaXRpb25cbiAgaWYgKCB0eXBlb2YgZGVmaW5lID09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCApIHtcbiAgICAvLyBBTURcbiAgICBkZWZpbmUoIGZhY3RvcnkgKTtcbiAgfSBlbHNlIGlmICggdHlwZW9mIG1vZHVsZSA9PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cyApIHtcbiAgICAvLyBDb21tb25KU1xuICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuICB9IGVsc2Uge1xuICAgIC8vIGJyb3dzZXIgZ2xvYmFsXG4gICAgd2luZG93Lm1hdGNoZXNTZWxlY3RvciA9IGZhY3RvcnkoKTtcbiAgfVxuXG59KCB3aW5kb3csIGZ1bmN0aW9uIGZhY3RvcnkoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICB2YXIgbWF0Y2hlc01ldGhvZCA9ICggZnVuY3Rpb24oKSB7XG4gICAgdmFyIEVsZW1Qcm90byA9IEVsZW1lbnQucHJvdG90eXBlO1xuICAgIC8vIGNoZWNrIGZvciB0aGUgc3RhbmRhcmQgbWV0aG9kIG5hbWUgZmlyc3RcbiAgICBpZiAoIEVsZW1Qcm90by5tYXRjaGVzICkge1xuICAgICAgcmV0dXJuICdtYXRjaGVzJztcbiAgICB9XG4gICAgLy8gY2hlY2sgdW4tcHJlZml4ZWRcbiAgICBpZiAoIEVsZW1Qcm90by5tYXRjaGVzU2VsZWN0b3IgKSB7XG4gICAgICByZXR1cm4gJ21hdGNoZXNTZWxlY3Rvcic7XG4gICAgfVxuICAgIC8vIGNoZWNrIHZlbmRvciBwcmVmaXhlc1xuICAgIHZhciBwcmVmaXhlcyA9IFsgJ3dlYmtpdCcsICdtb3onLCAnbXMnLCAnbycgXTtcblxuICAgIGZvciAoIHZhciBpPTA7IGkgPCBwcmVmaXhlcy5sZW5ndGg7IGkrKyApIHtcbiAgICAgIHZhciBwcmVmaXggPSBwcmVmaXhlc1tpXTtcbiAgICAgIHZhciBtZXRob2QgPSBwcmVmaXggKyAnTWF0Y2hlc1NlbGVjdG9yJztcbiAgICAgIGlmICggRWxlbVByb3RvWyBtZXRob2QgXSApIHtcbiAgICAgICAgcmV0dXJuIG1ldGhvZDtcbiAgICAgIH1cbiAgICB9XG4gIH0pKCk7XG5cbiAgcmV0dXJuIGZ1bmN0aW9uIG1hdGNoZXNTZWxlY3RvciggZWxlbSwgc2VsZWN0b3IgKSB7XG4gICAgcmV0dXJuIGVsZW1bIG1hdGNoZXNNZXRob2QgXSggc2VsZWN0b3IgKTtcbiAgfTtcblxufSkpO1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vZGVzYW5kcm8tbWF0Y2hlcy1zZWxlY3Rvci9tYXRjaGVzLXNlbGVjdG9yLmpzXG4gKiogbW9kdWxlIGlkID0gOFxuICoqIG1vZHVsZSBjaHVua3MgPSAwIDFcbiAqKi8iLCIvLyBGbGlja2l0eS5DZWxsXG4oIGZ1bmN0aW9uKCB3aW5kb3csIGZhY3RvcnkgKSB7XG4gIC8vIHVuaXZlcnNhbCBtb2R1bGUgZGVmaW5pdGlvblxuICAvKiBqc2hpbnQgc3RyaWN0OiBmYWxzZSAqL1xuICBpZiAoIHR5cGVvZiBkZWZpbmUgPT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kICkge1xuICAgIC8vIEFNRFxuICAgIGRlZmluZSggW1xuICAgICAgJ2dldC1zaXplL2dldC1zaXplJ1xuICAgIF0sIGZ1bmN0aW9uKCBnZXRTaXplICkge1xuICAgICAgcmV0dXJuIGZhY3RvcnkoIHdpbmRvdywgZ2V0U2l6ZSApO1xuICAgIH0pO1xuICB9IGVsc2UgaWYgKCB0eXBlb2YgbW9kdWxlID09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzICkge1xuICAgIC8vIENvbW1vbkpTXG4gICAgbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KFxuICAgICAgd2luZG93LFxuICAgICAgcmVxdWlyZSgnZ2V0LXNpemUnKVxuICAgICk7XG4gIH0gZWxzZSB7XG4gICAgLy8gYnJvd3NlciBnbG9iYWxcbiAgICB3aW5kb3cuRmxpY2tpdHkgPSB3aW5kb3cuRmxpY2tpdHkgfHwge307XG4gICAgd2luZG93LkZsaWNraXR5LkNlbGwgPSBmYWN0b3J5KFxuICAgICAgd2luZG93LFxuICAgICAgd2luZG93LmdldFNpemVcbiAgICApO1xuICB9XG5cbn0oIHdpbmRvdywgZnVuY3Rpb24gZmFjdG9yeSggd2luZG93LCBnZXRTaXplICkge1xuXG4ndXNlIHN0cmljdCc7XG5cbmZ1bmN0aW9uIENlbGwoIGVsZW0sIHBhcmVudCApIHtcbiAgdGhpcy5lbGVtZW50ID0gZWxlbTtcbiAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG5cbiAgdGhpcy5jcmVhdGUoKTtcbn1cblxudmFyIHByb3RvID0gQ2VsbC5wcm90b3R5cGU7XG5cbnByb3RvLmNyZWF0ZSA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLmVsZW1lbnQuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xuICB0aGlzLnggPSAwO1xuICB0aGlzLnNoaWZ0ID0gMDtcbn07XG5cbnByb3RvLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcbiAgLy8gcmVzZXQgc3R5bGVcbiAgdGhpcy5lbGVtZW50LnN0eWxlLnBvc2l0aW9uID0gJyc7XG4gIHZhciBzaWRlID0gdGhpcy5wYXJlbnQub3JpZ2luU2lkZTtcbiAgdGhpcy5lbGVtZW50LnN0eWxlWyBzaWRlIF0gPSAnJztcbn07XG5cbnByb3RvLmdldFNpemUgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5zaXplID0gZ2V0U2l6ZSggdGhpcy5lbGVtZW50ICk7XG59O1xuXG5wcm90by5zZXRQb3NpdGlvbiA9IGZ1bmN0aW9uKCB4ICkge1xuICB0aGlzLnggPSB4O1xuICB0aGlzLnVwZGF0ZVRhcmdldCgpO1xuICB0aGlzLnJlbmRlclBvc2l0aW9uKCB4ICk7XG59O1xuXG4vLyBzZXREZWZhdWx0VGFyZ2V0IHYxIG1ldGhvZCwgYmFja3dhcmRzIGNvbXBhdGliaWxpdHksIHJlbW92ZSBpbiB2M1xucHJvdG8udXBkYXRlVGFyZ2V0ID0gcHJvdG8uc2V0RGVmYXVsdFRhcmdldCA9IGZ1bmN0aW9uKCkge1xuICB2YXIgbWFyZ2luUHJvcGVydHkgPSB0aGlzLnBhcmVudC5vcmlnaW5TaWRlID09ICdsZWZ0JyA/ICdtYXJnaW5MZWZ0JyA6ICdtYXJnaW5SaWdodCc7XG4gIHRoaXMudGFyZ2V0ID0gdGhpcy54ICsgdGhpcy5zaXplWyBtYXJnaW5Qcm9wZXJ0eSBdICtcbiAgICB0aGlzLnNpemUud2lkdGggKiB0aGlzLnBhcmVudC5jZWxsQWxpZ247XG59O1xuXG5wcm90by5yZW5kZXJQb3NpdGlvbiA9IGZ1bmN0aW9uKCB4ICkge1xuICAvLyByZW5kZXIgcG9zaXRpb24gb2YgY2VsbCB3aXRoIGluIHNsaWRlclxuICB2YXIgc2lkZSA9IHRoaXMucGFyZW50Lm9yaWdpblNpZGU7XG4gIHRoaXMuZWxlbWVudC5zdHlsZVsgc2lkZSBdID0gdGhpcy5wYXJlbnQuZ2V0UG9zaXRpb25WYWx1ZSggeCApO1xufTtcblxuLyoqXG4gKiBAcGFyYW0ge0ludGVnZXJ9IGZhY3RvciAtIDAsIDEsIG9yIC0xXG4qKi9cbnByb3RvLndyYXBTaGlmdCA9IGZ1bmN0aW9uKCBzaGlmdCApIHtcbiAgdGhpcy5zaGlmdCA9IHNoaWZ0O1xuICB0aGlzLnJlbmRlclBvc2l0aW9uKCB0aGlzLnggKyB0aGlzLnBhcmVudC5zbGlkZWFibGVXaWR0aCAqIHNoaWZ0ICk7XG59O1xuXG5wcm90by5yZW1vdmUgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5lbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoIHRoaXMuZWxlbWVudCApO1xufTtcblxucmV0dXJuIENlbGw7XG5cbn0pKTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2ZsaWNraXR5L2pzL2NlbGwuanNcbiAqKiBtb2R1bGUgaWQgPSA5XG4gKiogbW9kdWxlIGNodW5rcyA9IDAgMVxuICoqLyIsIi8vIHNsaWRlXG4oIGZ1bmN0aW9uKCB3aW5kb3csIGZhY3RvcnkgKSB7XG4gIC8vIHVuaXZlcnNhbCBtb2R1bGUgZGVmaW5pdGlvblxuICAvKiBqc2hpbnQgc3RyaWN0OiBmYWxzZSAqL1xuICBpZiAoIHR5cGVvZiBkZWZpbmUgPT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kICkge1xuICAgIC8vIEFNRFxuICAgIGRlZmluZSggZmFjdG9yeSApO1xuICB9IGVsc2UgaWYgKCB0eXBlb2YgbW9kdWxlID09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzICkge1xuICAgIC8vIENvbW1vbkpTXG4gICAgbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG4gIH0gZWxzZSB7XG4gICAgLy8gYnJvd3NlciBnbG9iYWxcbiAgICB3aW5kb3cuRmxpY2tpdHkgPSB3aW5kb3cuRmxpY2tpdHkgfHwge307XG4gICAgd2luZG93LkZsaWNraXR5LlNsaWRlID0gZmFjdG9yeSgpO1xuICB9XG5cbn0oIHdpbmRvdywgZnVuY3Rpb24gZmFjdG9yeSgpIHtcbid1c2Ugc3RyaWN0JztcblxuZnVuY3Rpb24gU2xpZGUoIHBhcmVudCApIHtcbiAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gIHRoaXMuaXNPcmlnaW5MZWZ0ID0gcGFyZW50Lm9yaWdpblNpZGUgPT0gJ2xlZnQnO1xuICB0aGlzLmNlbGxzID0gW107XG4gIHRoaXMub3V0ZXJXaWR0aCA9IDA7XG4gIHRoaXMuaGVpZ2h0ID0gMDtcbn1cblxudmFyIHByb3RvID0gU2xpZGUucHJvdG90eXBlO1xuXG5wcm90by5hZGRDZWxsID0gZnVuY3Rpb24oIGNlbGwgKSB7XG4gIHRoaXMuY2VsbHMucHVzaCggY2VsbCApO1xuICB0aGlzLm91dGVyV2lkdGggKz0gY2VsbC5zaXplLm91dGVyV2lkdGg7XG4gIHRoaXMuaGVpZ2h0ID0gTWF0aC5tYXgoIGNlbGwuc2l6ZS5vdXRlckhlaWdodCwgdGhpcy5oZWlnaHQgKTtcbiAgLy8gZmlyc3QgY2VsbCBzdHVmZlxuICBpZiAoIHRoaXMuY2VsbHMubGVuZ3RoID09IDEgKSB7XG4gICAgdGhpcy54ID0gY2VsbC54OyAvLyB4IGNvbWVzIGZyb20gZmlyc3QgY2VsbFxuICAgIHZhciBiZWdpbk1hcmdpbiA9IHRoaXMuaXNPcmlnaW5MZWZ0ID8gJ21hcmdpbkxlZnQnIDogJ21hcmdpblJpZ2h0JztcbiAgICB0aGlzLmZpcnN0TWFyZ2luID0gY2VsbC5zaXplWyBiZWdpbk1hcmdpbiBdO1xuICB9XG59O1xuXG5wcm90by51cGRhdGVUYXJnZXQgPSBmdW5jdGlvbigpIHtcbiAgdmFyIGVuZE1hcmdpbiA9IHRoaXMuaXNPcmlnaW5MZWZ0ID8gJ21hcmdpblJpZ2h0JyA6ICdtYXJnaW5MZWZ0JztcbiAgdmFyIGxhc3RDZWxsID0gdGhpcy5nZXRMYXN0Q2VsbCgpO1xuICB2YXIgbGFzdE1hcmdpbiA9IGxhc3RDZWxsID8gbGFzdENlbGwuc2l6ZVsgZW5kTWFyZ2luIF0gOiAwO1xuICB2YXIgc2xpZGVXaWR0aCA9IHRoaXMub3V0ZXJXaWR0aCAtICggdGhpcy5maXJzdE1hcmdpbiArIGxhc3RNYXJnaW4gKTtcbiAgdGhpcy50YXJnZXQgPSB0aGlzLnggKyB0aGlzLmZpcnN0TWFyZ2luICsgc2xpZGVXaWR0aCAqIHRoaXMucGFyZW50LmNlbGxBbGlnbjtcbn07XG5cbnByb3RvLmdldExhc3RDZWxsID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzLmNlbGxzWyB0aGlzLmNlbGxzLmxlbmd0aCAtIDEgXTtcbn07XG5cbnByb3RvLnNlbGVjdCA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLmNoYW5nZVNlbGVjdGVkQ2xhc3MoJ2FkZCcpO1xufTtcblxucHJvdG8udW5zZWxlY3QgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5jaGFuZ2VTZWxlY3RlZENsYXNzKCdyZW1vdmUnKTtcbn07XG5cbnByb3RvLmNoYW5nZVNlbGVjdGVkQ2xhc3MgPSBmdW5jdGlvbiggbWV0aG9kICkge1xuICB0aGlzLmNlbGxzLmZvckVhY2goIGZ1bmN0aW9uKCBjZWxsICkge1xuICAgIGNlbGwuZWxlbWVudC5jbGFzc0xpc3RbIG1ldGhvZCBdKCdpcy1zZWxlY3RlZCcpO1xuICB9KTtcbn07XG5cbnByb3RvLmdldENlbGxFbGVtZW50cyA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gdGhpcy5jZWxscy5tYXAoIGZ1bmN0aW9uKCBjZWxsICkge1xuICAgIHJldHVybiBjZWxsLmVsZW1lbnQ7XG4gIH0pO1xufTtcblxucmV0dXJuIFNsaWRlO1xuXG59KSk7XG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9mbGlja2l0eS9qcy9zbGlkZS5qc1xuICoqIG1vZHVsZSBpZCA9IDEwXG4gKiogbW9kdWxlIGNodW5rcyA9IDAgMVxuICoqLyIsIi8vIGFuaW1hdGVcbiggZnVuY3Rpb24oIHdpbmRvdywgZmFjdG9yeSApIHtcbiAgLy8gdW5pdmVyc2FsIG1vZHVsZSBkZWZpbml0aW9uXG4gIC8qIGpzaGludCBzdHJpY3Q6IGZhbHNlICovXG4gIGlmICggdHlwZW9mIGRlZmluZSA9PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgKSB7XG4gICAgLy8gQU1EXG4gICAgZGVmaW5lKCBbXG4gICAgICAnZml6enktdWktdXRpbHMvdXRpbHMnXG4gICAgXSwgZnVuY3Rpb24oIHV0aWxzICkge1xuICAgICAgcmV0dXJuIGZhY3RvcnkoIHdpbmRvdywgdXRpbHMgKTtcbiAgICB9KTtcbiAgfSBlbHNlIGlmICggdHlwZW9mIG1vZHVsZSA9PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cyApIHtcbiAgICAvLyBDb21tb25KU1xuICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShcbiAgICAgIHdpbmRvdyxcbiAgICAgIHJlcXVpcmUoJ2Zpenp5LXVpLXV0aWxzJylcbiAgICApO1xuICB9IGVsc2Uge1xuICAgIC8vIGJyb3dzZXIgZ2xvYmFsXG4gICAgd2luZG93LkZsaWNraXR5ID0gd2luZG93LkZsaWNraXR5IHx8IHt9O1xuICAgIHdpbmRvdy5GbGlja2l0eS5hbmltYXRlUHJvdG90eXBlID0gZmFjdG9yeShcbiAgICAgIHdpbmRvdyxcbiAgICAgIHdpbmRvdy5maXp6eVVJVXRpbHNcbiAgICApO1xuICB9XG5cbn0oIHdpbmRvdywgZnVuY3Rpb24gZmFjdG9yeSggd2luZG93LCB1dGlscyApIHtcblxuJ3VzZSBzdHJpY3QnO1xuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cblxuLy8gZ2V0IHJBRiwgcHJlZml4ZWQsIGlmIHByZXNlbnRcbnZhciByZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8XG4gIHdpbmRvdy53ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWU7XG5cbi8vIGZhbGxiYWNrIHRvIHNldFRpbWVvdXRcbnZhciBsYXN0VGltZSA9IDA7XG5pZiAoICFyZXF1ZXN0QW5pbWF0aW9uRnJhbWUgKSAge1xuICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSBmdW5jdGlvbiggY2FsbGJhY2sgKSB7XG4gICAgdmFyIGN1cnJUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gICAgdmFyIHRpbWVUb0NhbGwgPSBNYXRoLm1heCggMCwgMTYgLSAoIGN1cnJUaW1lIC0gbGFzdFRpbWUgKSApO1xuICAgIHZhciBpZCA9IHNldFRpbWVvdXQoIGNhbGxiYWNrLCB0aW1lVG9DYWxsICk7XG4gICAgbGFzdFRpbWUgPSBjdXJyVGltZSArIHRpbWVUb0NhbGw7XG4gICAgcmV0dXJuIGlkO1xuICB9O1xufVxuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBhbmltYXRlIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vXG5cbnZhciBwcm90byA9IHt9O1xuXG5wcm90by5zdGFydEFuaW1hdGlvbiA9IGZ1bmN0aW9uKCkge1xuICBpZiAoIHRoaXMuaXNBbmltYXRpbmcgKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdGhpcy5pc0FuaW1hdGluZyA9IHRydWU7XG4gIHRoaXMucmVzdGluZ0ZyYW1lcyA9IDA7XG4gIHRoaXMuYW5pbWF0ZSgpO1xufTtcblxucHJvdG8uYW5pbWF0ZSA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLmFwcGx5RHJhZ0ZvcmNlKCk7XG4gIHRoaXMuYXBwbHlTZWxlY3RlZEF0dHJhY3Rpb24oKTtcblxuICB2YXIgcHJldmlvdXNYID0gdGhpcy54O1xuXG4gIHRoaXMuaW50ZWdyYXRlUGh5c2ljcygpO1xuICB0aGlzLnBvc2l0aW9uU2xpZGVyKCk7XG4gIHRoaXMuc2V0dGxlKCBwcmV2aW91c1ggKTtcbiAgLy8gYW5pbWF0ZSBuZXh0IGZyYW1lXG4gIGlmICggdGhpcy5pc0FuaW1hdGluZyApIHtcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSggZnVuY3Rpb24gYW5pbWF0ZUZyYW1lKCkge1xuICAgICAgX3RoaXMuYW5pbWF0ZSgpO1xuICAgIH0pO1xuICB9XG59O1xuXG5cbnZhciB0cmFuc2Zvcm1Qcm9wZXJ0eSA9ICggZnVuY3Rpb24gKCkge1xuICB2YXIgc3R5bGUgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGU7XG4gIGlmICggdHlwZW9mIHN0eWxlLnRyYW5zZm9ybSA9PSAnc3RyaW5nJyApIHtcbiAgICByZXR1cm4gJ3RyYW5zZm9ybSc7XG4gIH1cbiAgcmV0dXJuICdXZWJraXRUcmFuc2Zvcm0nO1xufSkoKTtcblxucHJvdG8ucG9zaXRpb25TbGlkZXIgPSBmdW5jdGlvbigpIHtcbiAgdmFyIHggPSB0aGlzLng7XG4gIC8vIHdyYXAgcG9zaXRpb24gYXJvdW5kXG4gIGlmICggdGhpcy5vcHRpb25zLndyYXBBcm91bmQgJiYgdGhpcy5jZWxscy5sZW5ndGggPiAxICkge1xuICAgIHggPSB1dGlscy5tb2R1bG8oIHgsIHRoaXMuc2xpZGVhYmxlV2lkdGggKTtcbiAgICB4ID0geCAtIHRoaXMuc2xpZGVhYmxlV2lkdGg7XG4gICAgdGhpcy5zaGlmdFdyYXBDZWxscyggeCApO1xuICB9XG5cbiAgeCA9IHggKyB0aGlzLmN1cnNvclBvc2l0aW9uO1xuICAvLyByZXZlcnNlIGlmIHJpZ2h0LXRvLWxlZnQgYW5kIHVzaW5nIHRyYW5zZm9ybVxuICB4ID0gdGhpcy5vcHRpb25zLnJpZ2h0VG9MZWZ0ICYmIHRyYW5zZm9ybVByb3BlcnR5ID8gLXggOiB4O1xuICB2YXIgdmFsdWUgPSB0aGlzLmdldFBvc2l0aW9uVmFsdWUoIHggKTtcbiAgLy8gdXNlIDNEIHRyYW5mb3JtcyBmb3IgaGFyZHdhcmUgYWNjZWxlcmF0aW9uIG9uIGlPU1xuICAvLyBidXQgdXNlIDJEIHdoZW4gc2V0dGxlZCwgZm9yIGJldHRlciBmb250LXJlbmRlcmluZ1xuICB0aGlzLnNsaWRlci5zdHlsZVsgdHJhbnNmb3JtUHJvcGVydHkgXSA9IHRoaXMuaXNBbmltYXRpbmcgP1xuICAgICd0cmFuc2xhdGUzZCgnICsgdmFsdWUgKyAnLDAsMCknIDogJ3RyYW5zbGF0ZVgoJyArIHZhbHVlICsgJyknO1xuXG4gIC8vIHNjcm9sbCBldmVudFxuICB2YXIgZmlyc3RTbGlkZSA9IHRoaXMuc2xpZGVzWzBdO1xuICBpZiAoIGZpcnN0U2xpZGUgKSB7XG4gICAgdmFyIHBvc2l0aW9uWCA9IC10aGlzLnggLSBmaXJzdFNsaWRlLnRhcmdldDtcbiAgICB2YXIgcHJvZ3Jlc3MgPSBwb3NpdGlvblggLyB0aGlzLnNsaWRlc1dpZHRoO1xuICAgIHRoaXMuZGlzcGF0Y2hFdmVudCggJ3Njcm9sbCcsIG51bGwsIFsgcHJvZ3Jlc3MsIHBvc2l0aW9uWCBdICk7XG4gIH1cbn07XG5cbnByb3RvLnBvc2l0aW9uU2xpZGVyQXRTZWxlY3RlZCA9IGZ1bmN0aW9uKCkge1xuICBpZiAoICF0aGlzLmNlbGxzLmxlbmd0aCApIHtcbiAgICByZXR1cm47XG4gIH1cbiAgdGhpcy54ID0gLXRoaXMuc2VsZWN0ZWRTbGlkZS50YXJnZXQ7XG4gIHRoaXMucG9zaXRpb25TbGlkZXIoKTtcbn07XG5cbnByb3RvLmdldFBvc2l0aW9uVmFsdWUgPSBmdW5jdGlvbiggcG9zaXRpb24gKSB7XG4gIGlmICggdGhpcy5vcHRpb25zLnBlcmNlbnRQb3NpdGlvbiApIHtcbiAgICAvLyBwZXJjZW50IHBvc2l0aW9uLCByb3VuZCB0byAyIGRpZ2l0cywgbGlrZSAxMi4zNCVcbiAgICByZXR1cm4gKCBNYXRoLnJvdW5kKCAoIHBvc2l0aW9uIC8gdGhpcy5zaXplLmlubmVyV2lkdGggKSAqIDEwMDAwICkgKiAwLjAxICkrICclJztcbiAgfSBlbHNlIHtcbiAgICAvLyBwaXhlbCBwb3NpdGlvbmluZ1xuICAgIHJldHVybiBNYXRoLnJvdW5kKCBwb3NpdGlvbiApICsgJ3B4JztcbiAgfVxufTtcblxucHJvdG8uc2V0dGxlID0gZnVuY3Rpb24oIHByZXZpb3VzWCApIHtcbiAgLy8ga2VlcCB0cmFjayBvZiBmcmFtZXMgd2hlcmUgeCBoYXNuJ3QgbW92ZWRcbiAgaWYgKCAhdGhpcy5pc1BvaW50ZXJEb3duICYmIE1hdGgucm91bmQoIHRoaXMueCAqIDEwMCApID09IE1hdGgucm91bmQoIHByZXZpb3VzWCAqIDEwMCApICkge1xuICAgIHRoaXMucmVzdGluZ0ZyYW1lcysrO1xuICB9XG4gIC8vIHN0b3AgYW5pbWF0aW5nIGlmIHJlc3RpbmcgZm9yIDMgb3IgbW9yZSBmcmFtZXNcbiAgaWYgKCB0aGlzLnJlc3RpbmdGcmFtZXMgPiAyICkge1xuICAgIHRoaXMuaXNBbmltYXRpbmcgPSBmYWxzZTtcbiAgICBkZWxldGUgdGhpcy5pc0ZyZWVTY3JvbGxpbmc7XG4gICAgLy8gcmVuZGVyIHBvc2l0aW9uIHdpdGggdHJhbnNsYXRlWCB3aGVuIHNldHRsZWRcbiAgICB0aGlzLnBvc2l0aW9uU2xpZGVyKCk7XG4gICAgdGhpcy5kaXNwYXRjaEV2ZW50KCdzZXR0bGUnKTtcbiAgfVxufTtcblxucHJvdG8uc2hpZnRXcmFwQ2VsbHMgPSBmdW5jdGlvbiggeCApIHtcbiAgLy8gc2hpZnQgYmVmb3JlIGNlbGxzXG4gIHZhciBiZWZvcmVHYXAgPSB0aGlzLmN1cnNvclBvc2l0aW9uICsgeDtcbiAgdGhpcy5fc2hpZnRDZWxscyggdGhpcy5iZWZvcmVTaGlmdENlbGxzLCBiZWZvcmVHYXAsIC0xICk7XG4gIC8vIHNoaWZ0IGFmdGVyIGNlbGxzXG4gIHZhciBhZnRlckdhcCA9IHRoaXMuc2l6ZS5pbm5lcldpZHRoIC0gKCB4ICsgdGhpcy5zbGlkZWFibGVXaWR0aCArIHRoaXMuY3Vyc29yUG9zaXRpb24gKTtcbiAgdGhpcy5fc2hpZnRDZWxscyggdGhpcy5hZnRlclNoaWZ0Q2VsbHMsIGFmdGVyR2FwLCAxICk7XG59O1xuXG5wcm90by5fc2hpZnRDZWxscyA9IGZ1bmN0aW9uKCBjZWxscywgZ2FwLCBzaGlmdCApIHtcbiAgZm9yICggdmFyIGk9MDsgaSA8IGNlbGxzLmxlbmd0aDsgaSsrICkge1xuICAgIHZhciBjZWxsID0gY2VsbHNbaV07XG4gICAgdmFyIGNlbGxTaGlmdCA9IGdhcCA+IDAgPyBzaGlmdCA6IDA7XG4gICAgY2VsbC53cmFwU2hpZnQoIGNlbGxTaGlmdCApO1xuICAgIGdhcCAtPSBjZWxsLnNpemUub3V0ZXJXaWR0aDtcbiAgfVxufTtcblxucHJvdG8uX3Vuc2hpZnRDZWxscyA9IGZ1bmN0aW9uKCBjZWxscyApIHtcbiAgaWYgKCAhY2VsbHMgfHwgIWNlbGxzLmxlbmd0aCApIHtcbiAgICByZXR1cm47XG4gIH1cbiAgZm9yICggdmFyIGk9MDsgaSA8IGNlbGxzLmxlbmd0aDsgaSsrICkge1xuICAgIGNlbGxzW2ldLndyYXBTaGlmdCggMCApO1xuICB9XG59O1xuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBwaHlzaWNzIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vXG5cbnByb3RvLmludGVncmF0ZVBoeXNpY3MgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy54ICs9IHRoaXMudmVsb2NpdHk7XG4gIHRoaXMudmVsb2NpdHkgKj0gdGhpcy5nZXRGcmljdGlvbkZhY3RvcigpO1xufTtcblxucHJvdG8uYXBwbHlGb3JjZSA9IGZ1bmN0aW9uKCBmb3JjZSApIHtcbiAgdGhpcy52ZWxvY2l0eSArPSBmb3JjZTtcbn07XG5cbnByb3RvLmdldEZyaWN0aW9uRmFjdG9yID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiAxIC0gdGhpcy5vcHRpb25zWyB0aGlzLmlzRnJlZVNjcm9sbGluZyA/ICdmcmVlU2Nyb2xsRnJpY3Rpb24nIDogJ2ZyaWN0aW9uJyBdO1xufTtcblxucHJvdG8uZ2V0UmVzdGluZ1Bvc2l0aW9uID0gZnVuY3Rpb24oKSB7XG4gIC8vIG15IHRoYW5rcyB0byBTdGV2ZW4gV2l0dGVucywgd2hvIHNpbXBsaWZpZWQgdGhpcyBtYXRoIGdyZWF0bHlcbiAgcmV0dXJuIHRoaXMueCArIHRoaXMudmVsb2NpdHkgLyAoIDEgLSB0aGlzLmdldEZyaWN0aW9uRmFjdG9yKCkgKTtcbn07XG5cbnByb3RvLmFwcGx5RHJhZ0ZvcmNlID0gZnVuY3Rpb24oKSB7XG4gIGlmICggIXRoaXMuaXNQb2ludGVyRG93biApIHtcbiAgICByZXR1cm47XG4gIH1cbiAgLy8gY2hhbmdlIHRoZSBwb3NpdGlvbiB0byBkcmFnIHBvc2l0aW9uIGJ5IGFwcGx5aW5nIGZvcmNlXG4gIHZhciBkcmFnVmVsb2NpdHkgPSB0aGlzLmRyYWdYIC0gdGhpcy54O1xuICB2YXIgZHJhZ0ZvcmNlID0gZHJhZ1ZlbG9jaXR5IC0gdGhpcy52ZWxvY2l0eTtcbiAgdGhpcy5hcHBseUZvcmNlKCBkcmFnRm9yY2UgKTtcbn07XG5cbnByb3RvLmFwcGx5U2VsZWN0ZWRBdHRyYWN0aW9uID0gZnVuY3Rpb24oKSB7XG4gIC8vIGRvIG5vdCBhdHRyYWN0IGlmIHBvaW50ZXIgZG93biBvciBubyBjZWxsc1xuICBpZiAoIHRoaXMuaXNQb2ludGVyRG93biB8fCB0aGlzLmlzRnJlZVNjcm9sbGluZyB8fCAhdGhpcy5jZWxscy5sZW5ndGggKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIHZhciBkaXN0YW5jZSA9IHRoaXMuc2VsZWN0ZWRTbGlkZS50YXJnZXQgKiAtMSAtIHRoaXMueDtcbiAgdmFyIGZvcmNlID0gZGlzdGFuY2UgKiB0aGlzLm9wdGlvbnMuc2VsZWN0ZWRBdHRyYWN0aW9uO1xuICB0aGlzLmFwcGx5Rm9yY2UoIGZvcmNlICk7XG59O1xuXG5yZXR1cm4gcHJvdG87XG5cbn0pKTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2ZsaWNraXR5L2pzL2FuaW1hdGUuanNcbiAqKiBtb2R1bGUgaWQgPSAxMVxuICoqIG1vZHVsZSBjaHVua3MgPSAwIDFcbiAqKi8iLCIvLyBkcmFnXG4oIGZ1bmN0aW9uKCB3aW5kb3csIGZhY3RvcnkgKSB7XG4gIC8vIHVuaXZlcnNhbCBtb2R1bGUgZGVmaW5pdGlvblxuICAvKiBqc2hpbnQgc3RyaWN0OiBmYWxzZSAqL1xuICBpZiAoIHR5cGVvZiBkZWZpbmUgPT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kICkge1xuICAgIC8vIEFNRFxuICAgIGRlZmluZSggW1xuICAgICAgJy4vZmxpY2tpdHknLFxuICAgICAgJ3VuaWRyYWdnZXIvdW5pZHJhZ2dlcicsXG4gICAgICAnZml6enktdWktdXRpbHMvdXRpbHMnXG4gICAgXSwgZnVuY3Rpb24oIEZsaWNraXR5LCBVbmlkcmFnZ2VyLCB1dGlscyApIHtcbiAgICAgIHJldHVybiBmYWN0b3J5KCB3aW5kb3csIEZsaWNraXR5LCBVbmlkcmFnZ2VyLCB1dGlscyApO1xuICAgIH0pO1xuICB9IGVsc2UgaWYgKCB0eXBlb2YgbW9kdWxlID09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzICkge1xuICAgIC8vIENvbW1vbkpTXG4gICAgbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KFxuICAgICAgd2luZG93LFxuICAgICAgcmVxdWlyZSgnLi9mbGlja2l0eScpLFxuICAgICAgcmVxdWlyZSgndW5pZHJhZ2dlcicpLFxuICAgICAgcmVxdWlyZSgnZml6enktdWktdXRpbHMnKVxuICAgICk7XG4gIH0gZWxzZSB7XG4gICAgLy8gYnJvd3NlciBnbG9iYWxcbiAgICB3aW5kb3cuRmxpY2tpdHkgPSBmYWN0b3J5KFxuICAgICAgd2luZG93LFxuICAgICAgd2luZG93LkZsaWNraXR5LFxuICAgICAgd2luZG93LlVuaWRyYWdnZXIsXG4gICAgICB3aW5kb3cuZml6enlVSVV0aWxzXG4gICAgKTtcbiAgfVxuXG59KCB3aW5kb3csIGZ1bmN0aW9uIGZhY3RvcnkoIHdpbmRvdywgRmxpY2tpdHksIFVuaWRyYWdnZXIsIHV0aWxzICkge1xuXG4ndXNlIHN0cmljdCc7XG5cbi8vIC0tLS0tIGRlZmF1bHRzIC0tLS0tIC8vXG5cbnV0aWxzLmV4dGVuZCggRmxpY2tpdHkuZGVmYXVsdHMsIHtcbiAgZHJhZ2dhYmxlOiB0cnVlLFxuICBkcmFnVGhyZXNob2xkOiAzLFxufSk7XG5cbi8vIC0tLS0tIGNyZWF0ZSAtLS0tLSAvL1xuXG5GbGlja2l0eS5jcmVhdGVNZXRob2RzLnB1c2goJ19jcmVhdGVEcmFnJyk7XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIGRyYWcgcHJvdG90eXBlIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vXG5cbnZhciBwcm90byA9IEZsaWNraXR5LnByb3RvdHlwZTtcbnV0aWxzLmV4dGVuZCggcHJvdG8sIFVuaWRyYWdnZXIucHJvdG90eXBlICk7XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvL1xuXG5wcm90by5fY3JlYXRlRHJhZyA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLm9uKCAnYWN0aXZhdGUnLCB0aGlzLmJpbmREcmFnICk7XG4gIHRoaXMub24oICd1aUNoYW5nZScsIHRoaXMuX3VpQ2hhbmdlRHJhZyApO1xuICB0aGlzLm9uKCAnY2hpbGRVSVBvaW50ZXJEb3duJywgdGhpcy5fY2hpbGRVSVBvaW50ZXJEb3duRHJhZyApO1xuICB0aGlzLm9uKCAnZGVhY3RpdmF0ZScsIHRoaXMudW5iaW5kRHJhZyApO1xufTtcblxucHJvdG8uYmluZERyYWcgPSBmdW5jdGlvbigpIHtcbiAgaWYgKCAhdGhpcy5vcHRpb25zLmRyYWdnYWJsZSB8fCB0aGlzLmlzRHJhZ0JvdW5kICkge1xuICAgIHJldHVybjtcbiAgfVxuICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnaXMtZHJhZ2dhYmxlJyk7XG4gIHRoaXMuaGFuZGxlcyA9IFsgdGhpcy52aWV3cG9ydCBdO1xuICB0aGlzLmJpbmRIYW5kbGVzKCk7XG4gIHRoaXMuaXNEcmFnQm91bmQgPSB0cnVlO1xufTtcblxucHJvdG8udW5iaW5kRHJhZyA9IGZ1bmN0aW9uKCkge1xuICBpZiAoICF0aGlzLmlzRHJhZ0JvdW5kICkge1xuICAgIHJldHVybjtcbiAgfVxuICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnaXMtZHJhZ2dhYmxlJyk7XG4gIHRoaXMudW5iaW5kSGFuZGxlcygpO1xuICBkZWxldGUgdGhpcy5pc0RyYWdCb3VuZDtcbn07XG5cbnByb3RvLl91aUNoYW5nZURyYWcgPSBmdW5jdGlvbigpIHtcbiAgZGVsZXRlIHRoaXMuaXNGcmVlU2Nyb2xsaW5nO1xufTtcblxucHJvdG8uX2NoaWxkVUlQb2ludGVyRG93bkRyYWcgPSBmdW5jdGlvbiggZXZlbnQgKSB7XG4gIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gIHRoaXMucG9pbnRlckRvd25Gb2N1cyggZXZlbnQgKTtcbn07XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIHBvaW50ZXIgZXZlbnRzIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vXG5cbi8vIG5vZGVzIHRoYXQgaGF2ZSB0ZXh0IGZpZWxkc1xudmFyIGN1cnNvck5vZGVzID0ge1xuICBURVhUQVJFQTogdHJ1ZSxcbiAgSU5QVVQ6IHRydWUsXG4gIE9QVElPTjogdHJ1ZSxcbn07XG5cbi8vIGlucHV0IHR5cGVzIHRoYXQgZG8gbm90IGhhdmUgdGV4dCBmaWVsZHNcbnZhciBjbGlja1R5cGVzID0ge1xuICByYWRpbzogdHJ1ZSxcbiAgY2hlY2tib3g6IHRydWUsXG4gIGJ1dHRvbjogdHJ1ZSxcbiAgc3VibWl0OiB0cnVlLFxuICBpbWFnZTogdHJ1ZSxcbiAgZmlsZTogdHJ1ZSxcbn07XG5cbnByb3RvLnBvaW50ZXJEb3duID0gZnVuY3Rpb24oIGV2ZW50LCBwb2ludGVyICkge1xuICAvLyBkaXNtaXNzIGlucHV0cyB3aXRoIHRleHQgZmllbGRzLiAjNDAzLCAjNDA0XG4gIHZhciBpc0N1cnNvcklucHV0ID0gY3Vyc29yTm9kZXNbIGV2ZW50LnRhcmdldC5ub2RlTmFtZSBdICYmXG4gICAgIWNsaWNrVHlwZXNbIGV2ZW50LnRhcmdldC50eXBlIF07XG4gIGlmICggaXNDdXJzb3JJbnB1dCApIHtcbiAgICAvLyByZXNldCBwb2ludGVyRG93biBsb2dpY1xuICAgIHRoaXMuaXNQb2ludGVyRG93biA9IGZhbHNlO1xuICAgIGRlbGV0ZSB0aGlzLnBvaW50ZXJJZGVudGlmaWVyO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHRoaXMuX2RyYWdQb2ludGVyRG93biggZXZlbnQsIHBvaW50ZXIgKTtcblxuICAvLyBrbHVkZ2UgdG8gYmx1ciBmb2N1c2VkIGlucHV0cyBpbiBkcmFnZ2VyXG4gIHZhciBmb2N1c2VkID0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudDtcbiAgaWYgKCBmb2N1c2VkICYmIGZvY3VzZWQuYmx1ciAmJiBmb2N1c2VkICE9IHRoaXMuZWxlbWVudCAmJlxuICAgIC8vIGRvIG5vdCBibHVyIGJvZHkgZm9yIElFOSAmIDEwLCAjMTE3XG4gICAgZm9jdXNlZCAhPSBkb2N1bWVudC5ib2R5ICkge1xuICAgIGZvY3VzZWQuYmx1cigpO1xuICB9XG4gIHRoaXMucG9pbnRlckRvd25Gb2N1cyggZXZlbnQgKTtcbiAgLy8gc3RvcCBpZiBpdCB3YXMgbW92aW5nXG4gIHRoaXMuZHJhZ1ggPSB0aGlzLng7XG4gIHRoaXMudmlld3BvcnQuY2xhc3NMaXN0LmFkZCgnaXMtcG9pbnRlci1kb3duJyk7XG4gIC8vIGJpbmQgbW92ZSBhbmQgZW5kIGV2ZW50c1xuICB0aGlzLl9iaW5kUG9zdFN0YXJ0RXZlbnRzKCBldmVudCApO1xuICAvLyB0cmFjayBzY3JvbGxpbmdcbiAgdGhpcy5wb2ludGVyRG93blNjcm9sbCA9IGdldFNjcm9sbFBvc2l0aW9uKCk7XG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCAnc2Nyb2xsJywgdGhpcyApO1xuXG4gIHRoaXMuZGlzcGF0Y2hFdmVudCggJ3BvaW50ZXJEb3duJywgZXZlbnQsIFsgcG9pbnRlciBdICk7XG59O1xuXG52YXIgdG91Y2hTdGFydEV2ZW50cyA9IHtcbiAgdG91Y2hzdGFydDogdHJ1ZSxcbiAgTVNQb2ludGVyRG93bjogdHJ1ZVxufTtcblxudmFyIGZvY3VzTm9kZXMgPSB7XG4gIElOUFVUOiB0cnVlLFxuICBTRUxFQ1Q6IHRydWVcbn07XG5cbnByb3RvLnBvaW50ZXJEb3duRm9jdXMgPSBmdW5jdGlvbiggZXZlbnQgKSB7XG4gIC8vIGZvY3VzIGVsZW1lbnQsIGlmIG5vdCB0b3VjaCwgYW5kIGl0cyBub3QgYW4gaW5wdXQgb3Igc2VsZWN0XG4gIGlmICggIXRoaXMub3B0aW9ucy5hY2Nlc3NpYmlsaXR5IHx8IHRvdWNoU3RhcnRFdmVudHNbIGV2ZW50LnR5cGUgXSB8fFxuICAgICAgZm9jdXNOb2Rlc1sgZXZlbnQudGFyZ2V0Lm5vZGVOYW1lIF0gKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIHZhciBwcmV2U2Nyb2xsWSA9IHdpbmRvdy5wYWdlWU9mZnNldDtcbiAgdGhpcy5lbGVtZW50LmZvY3VzKCk7XG4gIC8vIGhhY2sgdG8gZml4IHNjcm9sbCBqdW1wIGFmdGVyIGZvY3VzLCAjNzZcbiAgaWYgKCB3aW5kb3cucGFnZVlPZmZzZXQgIT0gcHJldlNjcm9sbFkgKSB7XG4gICAgd2luZG93LnNjcm9sbFRvKCB3aW5kb3cucGFnZVhPZmZzZXQsIHByZXZTY3JvbGxZICk7XG4gIH1cbn07XG5cbnByb3RvLmNhblByZXZlbnREZWZhdWx0T25Qb2ludGVyRG93biA9IGZ1bmN0aW9uKCBldmVudCApIHtcbiAgLy8gcHJldmVudCBkZWZhdWx0LCB1bmxlc3MgdG91Y2hzdGFydCBvciA8c2VsZWN0PlxuICB2YXIgaXNUb3VjaHN0YXJ0ID0gZXZlbnQudHlwZSA9PSAndG91Y2hzdGFydCc7XG4gIHZhciB0YXJnZXROb2RlTmFtZSA9IGV2ZW50LnRhcmdldC5ub2RlTmFtZTtcbiAgcmV0dXJuICFpc1RvdWNoc3RhcnQgJiYgdGFyZ2V0Tm9kZU5hbWUgIT0gJ1NFTEVDVCc7XG59O1xuXG4vLyAtLS0tLSBtb3ZlIC0tLS0tIC8vXG5cbnByb3RvLmhhc0RyYWdTdGFydGVkID0gZnVuY3Rpb24oIG1vdmVWZWN0b3IgKSB7XG4gIHJldHVybiBNYXRoLmFicyggbW92ZVZlY3Rvci54ICkgPiB0aGlzLm9wdGlvbnMuZHJhZ1RocmVzaG9sZDtcbn07XG5cbi8vIC0tLS0tIHVwIC0tLS0tIC8vXG5cbnByb3RvLnBvaW50ZXJVcCA9IGZ1bmN0aW9uKCBldmVudCwgcG9pbnRlciApIHtcbiAgZGVsZXRlIHRoaXMuaXNUb3VjaFNjcm9sbGluZztcbiAgdGhpcy52aWV3cG9ydC5jbGFzc0xpc3QucmVtb3ZlKCdpcy1wb2ludGVyLWRvd24nKTtcbiAgdGhpcy5kaXNwYXRjaEV2ZW50KCAncG9pbnRlclVwJywgZXZlbnQsIFsgcG9pbnRlciBdICk7XG4gIHRoaXMuX2RyYWdQb2ludGVyVXAoIGV2ZW50LCBwb2ludGVyICk7XG59O1xuXG5wcm90by5wb2ludGVyRG9uZSA9IGZ1bmN0aW9uKCkge1xuICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ3Njcm9sbCcsIHRoaXMgKTtcbiAgZGVsZXRlIHRoaXMucG9pbnRlckRvd25TY3JvbGw7XG59O1xuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBkcmFnZ2luZyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvL1xuXG5wcm90by5kcmFnU3RhcnQgPSBmdW5jdGlvbiggZXZlbnQsIHBvaW50ZXIgKSB7XG4gIHRoaXMuZHJhZ1N0YXJ0UG9zaXRpb24gPSB0aGlzLng7XG4gIHRoaXMuc3RhcnRBbmltYXRpb24oKTtcbiAgdGhpcy5kaXNwYXRjaEV2ZW50KCAnZHJhZ1N0YXJ0JywgZXZlbnQsIFsgcG9pbnRlciBdICk7XG59O1xuXG5wcm90by5wb2ludGVyTW92ZSA9IGZ1bmN0aW9uKCBldmVudCwgcG9pbnRlciApIHtcbiAgdmFyIG1vdmVWZWN0b3IgPSB0aGlzLl9kcmFnUG9pbnRlck1vdmUoIGV2ZW50LCBwb2ludGVyICk7XG4gIHRoaXMuZGlzcGF0Y2hFdmVudCggJ3BvaW50ZXJNb3ZlJywgZXZlbnQsIFsgcG9pbnRlciwgbW92ZVZlY3RvciBdICk7XG4gIHRoaXMuX2RyYWdNb3ZlKCBldmVudCwgcG9pbnRlciwgbW92ZVZlY3RvciApO1xufTtcblxucHJvdG8uZHJhZ01vdmUgPSBmdW5jdGlvbiggZXZlbnQsIHBvaW50ZXIsIG1vdmVWZWN0b3IgKSB7XG4gIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgdGhpcy5wcmV2aW91c0RyYWdYID0gdGhpcy5kcmFnWDtcbiAgLy8gcmV2ZXJzZSBpZiByaWdodC10by1sZWZ0XG4gIHZhciBkaXJlY3Rpb24gPSB0aGlzLm9wdGlvbnMucmlnaHRUb0xlZnQgPyAtMSA6IDE7XG4gIHZhciBkcmFnWCA9IHRoaXMuZHJhZ1N0YXJ0UG9zaXRpb24gKyBtb3ZlVmVjdG9yLnggKiBkaXJlY3Rpb247XG5cbiAgaWYgKCAhdGhpcy5vcHRpb25zLndyYXBBcm91bmQgJiYgdGhpcy5zbGlkZXMubGVuZ3RoICkge1xuICAgIC8vIHNsb3cgZHJhZ1xuICAgIHZhciBvcmlnaW5Cb3VuZCA9IE1hdGgubWF4KCAtdGhpcy5zbGlkZXNbMF0udGFyZ2V0LCB0aGlzLmRyYWdTdGFydFBvc2l0aW9uICk7XG4gICAgZHJhZ1ggPSBkcmFnWCA+IG9yaWdpbkJvdW5kID8gKCBkcmFnWCArIG9yaWdpbkJvdW5kICkgKiAwLjUgOiBkcmFnWDtcbiAgICB2YXIgZW5kQm91bmQgPSBNYXRoLm1pbiggLXRoaXMuZ2V0TGFzdFNsaWRlKCkudGFyZ2V0LCB0aGlzLmRyYWdTdGFydFBvc2l0aW9uICk7XG4gICAgZHJhZ1ggPSBkcmFnWCA8IGVuZEJvdW5kID8gKCBkcmFnWCArIGVuZEJvdW5kICkgKiAwLjUgOiBkcmFnWDtcbiAgfVxuXG4gIHRoaXMuZHJhZ1ggPSBkcmFnWDtcblxuICB0aGlzLmRyYWdNb3ZlVGltZSA9IG5ldyBEYXRlKCk7XG4gIHRoaXMuZGlzcGF0Y2hFdmVudCggJ2RyYWdNb3ZlJywgZXZlbnQsIFsgcG9pbnRlciwgbW92ZVZlY3RvciBdICk7XG59O1xuXG5wcm90by5kcmFnRW5kID0gZnVuY3Rpb24oIGV2ZW50LCBwb2ludGVyICkge1xuICBpZiAoIHRoaXMub3B0aW9ucy5mcmVlU2Nyb2xsICkge1xuICAgIHRoaXMuaXNGcmVlU2Nyb2xsaW5nID0gdHJ1ZTtcbiAgfVxuICAvLyBzZXQgc2VsZWN0ZWRJbmRleCBiYXNlZCBvbiB3aGVyZSBmbGljayB3aWxsIGVuZCB1cFxuICB2YXIgaW5kZXggPSB0aGlzLmRyYWdFbmRSZXN0aW5nU2VsZWN0KCk7XG5cbiAgaWYgKCB0aGlzLm9wdGlvbnMuZnJlZVNjcm9sbCAmJiAhdGhpcy5vcHRpb25zLndyYXBBcm91bmQgKSB7XG4gICAgLy8gaWYgZnJlZS1zY3JvbGwgJiBub3Qgd3JhcCBhcm91bmRcbiAgICAvLyBkbyBub3QgZnJlZS1zY3JvbGwgaWYgZ29pbmcgb3V0c2lkZSBvZiBib3VuZGluZyBzbGlkZXNcbiAgICAvLyBzbyBib3VuZGluZyBzbGlkZXMgY2FuIGF0dHJhY3Qgc2xpZGVyLCBhbmQga2VlcCBpdCBpbiBib3VuZHNcbiAgICB2YXIgcmVzdGluZ1ggPSB0aGlzLmdldFJlc3RpbmdQb3NpdGlvbigpO1xuICAgIHRoaXMuaXNGcmVlU2Nyb2xsaW5nID0gLXJlc3RpbmdYID4gdGhpcy5zbGlkZXNbMF0udGFyZ2V0ICYmXG4gICAgICAtcmVzdGluZ1ggPCB0aGlzLmdldExhc3RTbGlkZSgpLnRhcmdldDtcbiAgfSBlbHNlIGlmICggIXRoaXMub3B0aW9ucy5mcmVlU2Nyb2xsICYmIGluZGV4ID09IHRoaXMuc2VsZWN0ZWRJbmRleCApIHtcbiAgICAvLyBib29zdCBzZWxlY3Rpb24gaWYgc2VsZWN0ZWQgaW5kZXggaGFzIG5vdCBjaGFuZ2VkXG4gICAgaW5kZXggKz0gdGhpcy5kcmFnRW5kQm9vc3RTZWxlY3QoKTtcbiAgfVxuICBkZWxldGUgdGhpcy5wcmV2aW91c0RyYWdYO1xuICAvLyBhcHBseSBzZWxlY3Rpb25cbiAgLy8gVE9ETyByZWZhY3RvciB0aGlzLCBzZWxlY3RpbmcgaGVyZSBmZWVscyB3ZWlyZFxuICAvLyBIQUNLLCBzZXQgZmxhZyBzbyBkcmFnZ2luZyBzdGF5cyBpbiBjb3JyZWN0IGRpcmVjdGlvblxuICB0aGlzLmlzRHJhZ1NlbGVjdCA9IHRoaXMub3B0aW9ucy53cmFwQXJvdW5kO1xuICB0aGlzLnNlbGVjdCggaW5kZXggKTtcbiAgZGVsZXRlIHRoaXMuaXNEcmFnU2VsZWN0O1xuICB0aGlzLmRpc3BhdGNoRXZlbnQoICdkcmFnRW5kJywgZXZlbnQsIFsgcG9pbnRlciBdICk7XG59O1xuXG5wcm90by5kcmFnRW5kUmVzdGluZ1NlbGVjdCA9IGZ1bmN0aW9uKCkge1xuICB2YXIgcmVzdGluZ1ggPSB0aGlzLmdldFJlc3RpbmdQb3NpdGlvbigpO1xuICAvLyBob3cgZmFyIGF3YXkgZnJvbSBzZWxlY3RlZCBzbGlkZVxuICB2YXIgZGlzdGFuY2UgPSBNYXRoLmFicyggdGhpcy5nZXRTbGlkZURpc3RhbmNlKCAtcmVzdGluZ1gsIHRoaXMuc2VsZWN0ZWRJbmRleCApICk7XG4gIC8vIGdldCBjbG9zZXQgcmVzdGluZyBnb2luZyB1cCBhbmQgZ29pbmcgZG93blxuICB2YXIgcG9zaXRpdmVSZXN0aW5nID0gdGhpcy5fZ2V0Q2xvc2VzdFJlc3RpbmcoIHJlc3RpbmdYLCBkaXN0YW5jZSwgMSApO1xuICB2YXIgbmVnYXRpdmVSZXN0aW5nID0gdGhpcy5fZ2V0Q2xvc2VzdFJlc3RpbmcoIHJlc3RpbmdYLCBkaXN0YW5jZSwgLTEgKTtcbiAgLy8gdXNlIGNsb3NlciByZXN0aW5nIGZvciB3cmFwLWFyb3VuZFxuICB2YXIgaW5kZXggPSBwb3NpdGl2ZVJlc3RpbmcuZGlzdGFuY2UgPCBuZWdhdGl2ZVJlc3RpbmcuZGlzdGFuY2UgP1xuICAgIHBvc2l0aXZlUmVzdGluZy5pbmRleCA6IG5lZ2F0aXZlUmVzdGluZy5pbmRleDtcbiAgcmV0dXJuIGluZGV4O1xufTtcblxuLyoqXG4gKiBnaXZlbiByZXN0aW5nIFggYW5kIGRpc3RhbmNlIHRvIHNlbGVjdGVkIGNlbGxcbiAqIGdldCB0aGUgZGlzdGFuY2UgYW5kIGluZGV4IG9mIHRoZSBjbG9zZXN0IGNlbGxcbiAqIEBwYXJhbSB7TnVtYmVyfSByZXN0aW5nWCAtIGVzdGltYXRlZCBwb3N0LWZsaWNrIHJlc3RpbmcgcG9zaXRpb25cbiAqIEBwYXJhbSB7TnVtYmVyfSBkaXN0YW5jZSAtIGRpc3RhbmNlIHRvIHNlbGVjdGVkIGNlbGxcbiAqIEBwYXJhbSB7SW50ZWdlcn0gaW5jcmVtZW50IC0gKzEgb3IgLTEsIGdvaW5nIHVwIG9yIGRvd25cbiAqIEByZXR1cm5zIHtPYmplY3R9IC0geyBkaXN0YW5jZToge051bWJlcn0sIGluZGV4OiB7SW50ZWdlcn0gfVxuICovXG5wcm90by5fZ2V0Q2xvc2VzdFJlc3RpbmcgPSBmdW5jdGlvbiggcmVzdGluZ1gsIGRpc3RhbmNlLCBpbmNyZW1lbnQgKSB7XG4gIHZhciBpbmRleCA9IHRoaXMuc2VsZWN0ZWRJbmRleDtcbiAgdmFyIG1pbkRpc3RhbmNlID0gSW5maW5pdHk7XG4gIHZhciBjb25kaXRpb24gPSB0aGlzLm9wdGlvbnMuY29udGFpbiAmJiAhdGhpcy5vcHRpb25zLndyYXBBcm91bmQgP1xuICAgIC8vIGlmIGNvbnRhaW4sIGtlZXAgZ29pbmcgaWYgZGlzdGFuY2UgaXMgZXF1YWwgdG8gbWluRGlzdGFuY2VcbiAgICBmdW5jdGlvbiggZCwgbWQgKSB7IHJldHVybiBkIDw9IG1kOyB9IDogZnVuY3Rpb24oIGQsIG1kICkgeyByZXR1cm4gZCA8IG1kOyB9O1xuICB3aGlsZSAoIGNvbmRpdGlvbiggZGlzdGFuY2UsIG1pbkRpc3RhbmNlICkgKSB7XG4gICAgLy8gbWVhc3VyZSBkaXN0YW5jZSB0byBuZXh0IGNlbGxcbiAgICBpbmRleCArPSBpbmNyZW1lbnQ7XG4gICAgbWluRGlzdGFuY2UgPSBkaXN0YW5jZTtcbiAgICBkaXN0YW5jZSA9IHRoaXMuZ2V0U2xpZGVEaXN0YW5jZSggLXJlc3RpbmdYLCBpbmRleCApO1xuICAgIGlmICggZGlzdGFuY2UgPT09IG51bGwgKSB7XG4gICAgICBicmVhaztcbiAgICB9XG4gICAgZGlzdGFuY2UgPSBNYXRoLmFicyggZGlzdGFuY2UgKTtcbiAgfVxuICByZXR1cm4ge1xuICAgIGRpc3RhbmNlOiBtaW5EaXN0YW5jZSxcbiAgICAvLyBzZWxlY3RlZCB3YXMgcHJldmlvdXMgaW5kZXhcbiAgICBpbmRleDogaW5kZXggLSBpbmNyZW1lbnRcbiAgfTtcbn07XG5cbi8qKlxuICogbWVhc3VyZSBkaXN0YW5jZSBiZXR3ZWVuIHggYW5kIGEgc2xpZGUgdGFyZ2V0XG4gKiBAcGFyYW0ge051bWJlcn0geFxuICogQHBhcmFtIHtJbnRlZ2VyfSBpbmRleCAtIHNsaWRlIGluZGV4XG4gKi9cbnByb3RvLmdldFNsaWRlRGlzdGFuY2UgPSBmdW5jdGlvbiggeCwgaW5kZXggKSB7XG4gIHZhciBsZW4gPSB0aGlzLnNsaWRlcy5sZW5ndGg7XG4gIC8vIHdyYXAgYXJvdW5kIGlmIGF0IGxlYXN0IDIgc2xpZGVzXG4gIHZhciBpc1dyYXBBcm91bmQgPSB0aGlzLm9wdGlvbnMud3JhcEFyb3VuZCAmJiBsZW4gPiAxO1xuICB2YXIgc2xpZGVJbmRleCA9IGlzV3JhcEFyb3VuZCA/IHV0aWxzLm1vZHVsbyggaW5kZXgsIGxlbiApIDogaW5kZXg7XG4gIHZhciBzbGlkZSA9IHRoaXMuc2xpZGVzWyBzbGlkZUluZGV4IF07XG4gIGlmICggIXNsaWRlICkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIC8vIGFkZCBkaXN0YW5jZSBmb3Igd3JhcC1hcm91bmQgc2xpZGVzXG4gIHZhciB3cmFwID0gaXNXcmFwQXJvdW5kID8gdGhpcy5zbGlkZWFibGVXaWR0aCAqIE1hdGguZmxvb3IoIGluZGV4IC8gbGVuICkgOiAwO1xuICByZXR1cm4geCAtICggc2xpZGUudGFyZ2V0ICsgd3JhcCApO1xufTtcblxucHJvdG8uZHJhZ0VuZEJvb3N0U2VsZWN0ID0gZnVuY3Rpb24oKSB7XG4gIC8vIGRvIG5vdCBib29zdCBpZiBubyBwcmV2aW91c0RyYWdYIG9yIGRyYWdNb3ZlVGltZVxuICBpZiAoIHRoaXMucHJldmlvdXNEcmFnWCA9PT0gdW5kZWZpbmVkIHx8ICF0aGlzLmRyYWdNb3ZlVGltZSB8fFxuICAgIC8vIG9yIGlmIGRyYWcgd2FzIGhlbGQgZm9yIDEwMCBtc1xuICAgIG5ldyBEYXRlKCkgLSB0aGlzLmRyYWdNb3ZlVGltZSA+IDEwMCApIHtcbiAgICByZXR1cm4gMDtcbiAgfVxuXG4gIHZhciBkaXN0YW5jZSA9IHRoaXMuZ2V0U2xpZGVEaXN0YW5jZSggLXRoaXMuZHJhZ1gsIHRoaXMuc2VsZWN0ZWRJbmRleCApO1xuICB2YXIgZGVsdGEgPSB0aGlzLnByZXZpb3VzRHJhZ1ggLSB0aGlzLmRyYWdYO1xuICBpZiAoIGRpc3RhbmNlID4gMCAmJiBkZWx0YSA+IDAgKSB7XG4gICAgLy8gYm9vc3QgdG8gbmV4dCBpZiBtb3ZpbmcgdG93YXJkcyB0aGUgcmlnaHQsIGFuZCBwb3NpdGl2ZSB2ZWxvY2l0eVxuICAgIHJldHVybiAxO1xuICB9IGVsc2UgaWYgKCBkaXN0YW5jZSA8IDAgJiYgZGVsdGEgPCAwICkge1xuICAgIC8vIGJvb3N0IHRvIHByZXZpb3VzIGlmIG1vdmluZyB0b3dhcmRzIHRoZSBsZWZ0LCBhbmQgbmVnYXRpdmUgdmVsb2NpdHlcbiAgICByZXR1cm4gLTE7XG4gIH1cbiAgcmV0dXJuIDA7XG59O1xuXG4vLyAtLS0tLSBzdGF0aWNDbGljayAtLS0tLSAvL1xuXG5wcm90by5zdGF0aWNDbGljayA9IGZ1bmN0aW9uKCBldmVudCwgcG9pbnRlciApIHtcbiAgLy8gZ2V0IGNsaWNrZWRDZWxsLCBpZiBjZWxsIHdhcyBjbGlja2VkXG4gIHZhciBjbGlja2VkQ2VsbCA9IHRoaXMuZ2V0UGFyZW50Q2VsbCggZXZlbnQudGFyZ2V0ICk7XG4gIHZhciBjZWxsRWxlbSA9IGNsaWNrZWRDZWxsICYmIGNsaWNrZWRDZWxsLmVsZW1lbnQ7XG4gIHZhciBjZWxsSW5kZXggPSBjbGlja2VkQ2VsbCAmJiB0aGlzLmNlbGxzLmluZGV4T2YoIGNsaWNrZWRDZWxsICk7XG4gIHRoaXMuZGlzcGF0Y2hFdmVudCggJ3N0YXRpY0NsaWNrJywgZXZlbnQsIFsgcG9pbnRlciwgY2VsbEVsZW0sIGNlbGxJbmRleCBdICk7XG59O1xuXG4vLyAtLS0tLSBzY3JvbGwgLS0tLS0gLy9cblxucHJvdG8ub25zY3JvbGwgPSBmdW5jdGlvbigpIHtcbiAgdmFyIHNjcm9sbCA9IGdldFNjcm9sbFBvc2l0aW9uKCk7XG4gIHZhciBzY3JvbGxNb3ZlWCA9IHRoaXMucG9pbnRlckRvd25TY3JvbGwueCAtIHNjcm9sbC54O1xuICB2YXIgc2Nyb2xsTW92ZVkgPSB0aGlzLnBvaW50ZXJEb3duU2Nyb2xsLnkgLSBzY3JvbGwueTtcbiAgLy8gY2FuY2VsIGNsaWNrL3RhcCBpZiBzY3JvbGwgaXMgdG9vIG11Y2hcbiAgaWYgKCBNYXRoLmFicyggc2Nyb2xsTW92ZVggKSA+IDMgfHwgTWF0aC5hYnMoIHNjcm9sbE1vdmVZICkgPiAzICkge1xuICAgIHRoaXMuX3BvaW50ZXJEb25lKCk7XG4gIH1cbn07XG5cbi8vIC0tLS0tIHV0aWxzIC0tLS0tIC8vXG5cbmZ1bmN0aW9uIGdldFNjcm9sbFBvc2l0aW9uKCkge1xuICByZXR1cm4ge1xuICAgIHg6IHdpbmRvdy5wYWdlWE9mZnNldCxcbiAgICB5OiB3aW5kb3cucGFnZVlPZmZzZXRcbiAgfTtcbn1cblxuLy8gLS0tLS0gIC0tLS0tIC8vXG5cbnJldHVybiBGbGlja2l0eTtcblxufSkpO1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vZmxpY2tpdHkvanMvZHJhZy5qc1xuICoqIG1vZHVsZSBpZCA9IDEyXG4gKiogbW9kdWxlIGNodW5rcyA9IDAgMVxuICoqLyIsIi8qIVxuICogVW5pZHJhZ2dlciB2Mi4xLjBcbiAqIERyYWdnYWJsZSBiYXNlIGNsYXNzXG4gKiBNSVQgbGljZW5zZVxuICovXG5cbi8qanNoaW50IGJyb3dzZXI6IHRydWUsIHVudXNlZDogdHJ1ZSwgdW5kZWY6IHRydWUsIHN0cmljdDogdHJ1ZSAqL1xuXG4oIGZ1bmN0aW9uKCB3aW5kb3csIGZhY3RvcnkgKSB7XG4gIC8vIHVuaXZlcnNhbCBtb2R1bGUgZGVmaW5pdGlvblxuICAvKmpzaGludCBzdHJpY3Q6IGZhbHNlICovIC8qZ2xvYmFscyBkZWZpbmUsIG1vZHVsZSwgcmVxdWlyZSAqL1xuXG4gIGlmICggdHlwZW9mIGRlZmluZSA9PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgKSB7XG4gICAgLy8gQU1EXG4gICAgZGVmaW5lKCBbXG4gICAgICAndW5pcG9pbnRlci91bmlwb2ludGVyJ1xuICAgIF0sIGZ1bmN0aW9uKCBVbmlwb2ludGVyICkge1xuICAgICAgcmV0dXJuIGZhY3RvcnkoIHdpbmRvdywgVW5pcG9pbnRlciApO1xuICAgIH0pO1xuICB9IGVsc2UgaWYgKCB0eXBlb2YgbW9kdWxlID09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzICkge1xuICAgIC8vIENvbW1vbkpTXG4gICAgbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KFxuICAgICAgd2luZG93LFxuICAgICAgcmVxdWlyZSgndW5pcG9pbnRlcicpXG4gICAgKTtcbiAgfSBlbHNlIHtcbiAgICAvLyBicm93c2VyIGdsb2JhbFxuICAgIHdpbmRvdy5VbmlkcmFnZ2VyID0gZmFjdG9yeShcbiAgICAgIHdpbmRvdyxcbiAgICAgIHdpbmRvdy5Vbmlwb2ludGVyXG4gICAgKTtcbiAgfVxuXG59KCB3aW5kb3csIGZ1bmN0aW9uIGZhY3RvcnkoIHdpbmRvdywgVW5pcG9pbnRlciApIHtcblxuJ3VzZSBzdHJpY3QnO1xuXG4vLyAtLS0tLSAgLS0tLS0gLy9cblxuZnVuY3Rpb24gbm9vcCgpIHt9XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFVuaWRyYWdnZXIgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cblxuZnVuY3Rpb24gVW5pZHJhZ2dlcigpIHt9XG5cbi8vIGluaGVyaXQgVW5pcG9pbnRlciAmIEV2RW1pdHRlclxudmFyIHByb3RvID0gVW5pZHJhZ2dlci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKCBVbmlwb2ludGVyLnByb3RvdHlwZSApO1xuXG4vLyAtLS0tLSBiaW5kIHN0YXJ0IC0tLS0tIC8vXG5cbnByb3RvLmJpbmRIYW5kbGVzID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuX2JpbmRIYW5kbGVzKCB0cnVlICk7XG59O1xuXG5wcm90by51bmJpbmRIYW5kbGVzID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuX2JpbmRIYW5kbGVzKCBmYWxzZSApO1xufTtcblxudmFyIG5hdmlnYXRvciA9IHdpbmRvdy5uYXZpZ2F0b3I7XG4vKipcbiAqIHdvcmtzIGFzIHVuYmluZGVyLCBhcyB5b3UgY2FuIC5iaW5kSGFuZGxlcyggZmFsc2UgKSB0byB1bmJpbmRcbiAqIEBwYXJhbSB7Qm9vbGVhbn0gaXNCaW5kIC0gd2lsbCB1bmJpbmQgaWYgZmFsc2V5XG4gKi9cbnByb3RvLl9iaW5kSGFuZGxlcyA9IGZ1bmN0aW9uKCBpc0JpbmQgKSB7XG4gIC8vIG11bmdlIGlzQmluZCwgZGVmYXVsdCB0byB0cnVlXG4gIGlzQmluZCA9IGlzQmluZCA9PT0gdW5kZWZpbmVkID8gdHJ1ZSA6ICEhaXNCaW5kO1xuICAvLyBleHRyYSBiaW5kIGxvZ2ljXG4gIHZhciBiaW5kZXJFeHRyYTtcbiAgaWYgKCBuYXZpZ2F0b3IucG9pbnRlckVuYWJsZWQgKSB7XG4gICAgYmluZGVyRXh0cmEgPSBmdW5jdGlvbiggaGFuZGxlICkge1xuICAgICAgLy8gZGlzYWJsZSBzY3JvbGxpbmcgb24gdGhlIGVsZW1lbnRcbiAgICAgIGhhbmRsZS5zdHlsZS50b3VjaEFjdGlvbiA9IGlzQmluZCA/ICdub25lJyA6ICcnO1xuICAgIH07XG4gIH0gZWxzZSBpZiAoIG5hdmlnYXRvci5tc1BvaW50ZXJFbmFibGVkICkge1xuICAgIGJpbmRlckV4dHJhID0gZnVuY3Rpb24oIGhhbmRsZSApIHtcbiAgICAgIC8vIGRpc2FibGUgc2Nyb2xsaW5nIG9uIHRoZSBlbGVtZW50XG4gICAgICBoYW5kbGUuc3R5bGUubXNUb3VjaEFjdGlvbiA9IGlzQmluZCA/ICdub25lJyA6ICcnO1xuICAgIH07XG4gIH0gZWxzZSB7XG4gICAgYmluZGVyRXh0cmEgPSBub29wO1xuICB9XG4gIC8vIGJpbmQgZWFjaCBoYW5kbGVcbiAgdmFyIGJpbmRNZXRob2QgPSBpc0JpbmQgPyAnYWRkRXZlbnRMaXN0ZW5lcicgOiAncmVtb3ZlRXZlbnRMaXN0ZW5lcic7XG4gIGZvciAoIHZhciBpPTA7IGkgPCB0aGlzLmhhbmRsZXMubGVuZ3RoOyBpKysgKSB7XG4gICAgdmFyIGhhbmRsZSA9IHRoaXMuaGFuZGxlc1tpXTtcbiAgICB0aGlzLl9iaW5kU3RhcnRFdmVudCggaGFuZGxlLCBpc0JpbmQgKTtcbiAgICBiaW5kZXJFeHRyYSggaGFuZGxlICk7XG4gICAgaGFuZGxlWyBiaW5kTWV0aG9kIF0oICdjbGljaycsIHRoaXMgKTtcbiAgfVxufTtcblxuLy8gLS0tLS0gc3RhcnQgZXZlbnQgLS0tLS0gLy9cblxuLyoqXG4gKiBwb2ludGVyIHN0YXJ0XG4gKiBAcGFyYW0ge0V2ZW50fSBldmVudFxuICogQHBhcmFtIHtFdmVudCBvciBUb3VjaH0gcG9pbnRlclxuICovXG5wcm90by5wb2ludGVyRG93biA9IGZ1bmN0aW9uKCBldmVudCwgcG9pbnRlciApIHtcbiAgLy8gZGlzbWlzcyByYW5nZSBzbGlkZXJzXG4gIGlmICggZXZlbnQudGFyZ2V0Lm5vZGVOYW1lID09ICdJTlBVVCcgJiYgZXZlbnQudGFyZ2V0LnR5cGUgPT0gJ3JhbmdlJyApIHtcbiAgICAvLyByZXNldCBwb2ludGVyRG93biBsb2dpY1xuICAgIHRoaXMuaXNQb2ludGVyRG93biA9IGZhbHNlO1xuICAgIGRlbGV0ZSB0aGlzLnBvaW50ZXJJZGVudGlmaWVyO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHRoaXMuX2RyYWdQb2ludGVyRG93biggZXZlbnQsIHBvaW50ZXIgKTtcbiAgLy8ga2x1ZGdlIHRvIGJsdXIgZm9jdXNlZCBpbnB1dHMgaW4gZHJhZ2dlclxuICB2YXIgZm9jdXNlZCA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7XG4gIGlmICggZm9jdXNlZCAmJiBmb2N1c2VkLmJsdXIgKSB7XG4gICAgZm9jdXNlZC5ibHVyKCk7XG4gIH1cbiAgLy8gYmluZCBtb3ZlIGFuZCBlbmQgZXZlbnRzXG4gIHRoaXMuX2JpbmRQb3N0U3RhcnRFdmVudHMoIGV2ZW50ICk7XG4gIHRoaXMuZW1pdEV2ZW50KCAncG9pbnRlckRvd24nLCBbIGV2ZW50LCBwb2ludGVyIF0gKTtcbn07XG5cbi8vIGJhc2UgcG9pbnRlciBkb3duIGxvZ2ljXG5wcm90by5fZHJhZ1BvaW50ZXJEb3duID0gZnVuY3Rpb24oIGV2ZW50LCBwb2ludGVyICkge1xuICAvLyB0cmFjayB0byBzZWUgd2hlbiBkcmFnZ2luZyBzdGFydHNcbiAgdGhpcy5wb2ludGVyRG93blBvaW50ID0gVW5pcG9pbnRlci5nZXRQb2ludGVyUG9pbnQoIHBvaW50ZXIgKTtcblxuICB2YXIgY2FuUHJldmVudERlZmF1bHQgPSB0aGlzLmNhblByZXZlbnREZWZhdWx0T25Qb2ludGVyRG93biggZXZlbnQsIHBvaW50ZXIgKTtcbiAgaWYgKCBjYW5QcmV2ZW50RGVmYXVsdCApIHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICB9XG59O1xuXG4vLyBvdmVyd3JpdGVhYmxlIG1ldGhvZCBzbyBGbGlja2l0eSBjYW4gcHJldmVudCBmb3Igc2Nyb2xsaW5nXG5wcm90by5jYW5QcmV2ZW50RGVmYXVsdE9uUG9pbnRlckRvd24gPSBmdW5jdGlvbiggZXZlbnQgKSB7XG4gIC8vIHByZXZlbnQgZGVmYXVsdCwgdW5sZXNzIHRvdWNoc3RhcnQgb3IgPHNlbGVjdD5cbiAgcmV0dXJuIGV2ZW50LnRhcmdldC5ub2RlTmFtZSAhPSAnU0VMRUNUJztcbn07XG5cbi8vIC0tLS0tIG1vdmUgZXZlbnQgLS0tLS0gLy9cblxuLyoqXG4gKiBkcmFnIG1vdmVcbiAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50XG4gKiBAcGFyYW0ge0V2ZW50IG9yIFRvdWNofSBwb2ludGVyXG4gKi9cbnByb3RvLnBvaW50ZXJNb3ZlID0gZnVuY3Rpb24oIGV2ZW50LCBwb2ludGVyICkge1xuICB2YXIgbW92ZVZlY3RvciA9IHRoaXMuX2RyYWdQb2ludGVyTW92ZSggZXZlbnQsIHBvaW50ZXIgKTtcbiAgdGhpcy5lbWl0RXZlbnQoICdwb2ludGVyTW92ZScsIFsgZXZlbnQsIHBvaW50ZXIsIG1vdmVWZWN0b3IgXSApO1xuICB0aGlzLl9kcmFnTW92ZSggZXZlbnQsIHBvaW50ZXIsIG1vdmVWZWN0b3IgKTtcbn07XG5cbi8vIGJhc2UgcG9pbnRlciBtb3ZlIGxvZ2ljXG5wcm90by5fZHJhZ1BvaW50ZXJNb3ZlID0gZnVuY3Rpb24oIGV2ZW50LCBwb2ludGVyICkge1xuICB2YXIgbW92ZVBvaW50ID0gVW5pcG9pbnRlci5nZXRQb2ludGVyUG9pbnQoIHBvaW50ZXIgKTtcbiAgdmFyIG1vdmVWZWN0b3IgPSB7XG4gICAgeDogbW92ZVBvaW50LnggLSB0aGlzLnBvaW50ZXJEb3duUG9pbnQueCxcbiAgICB5OiBtb3ZlUG9pbnQueSAtIHRoaXMucG9pbnRlckRvd25Qb2ludC55XG4gIH07XG4gIC8vIHN0YXJ0IGRyYWcgaWYgcG9pbnRlciBoYXMgbW92ZWQgZmFyIGVub3VnaCB0byBzdGFydCBkcmFnXG4gIGlmICggIXRoaXMuaXNEcmFnZ2luZyAmJiB0aGlzLmhhc0RyYWdTdGFydGVkKCBtb3ZlVmVjdG9yICkgKSB7XG4gICAgdGhpcy5fZHJhZ1N0YXJ0KCBldmVudCwgcG9pbnRlciApO1xuICB9XG4gIHJldHVybiBtb3ZlVmVjdG9yO1xufTtcblxuLy8gY29uZGl0aW9uIGlmIHBvaW50ZXIgaGFzIG1vdmVkIGZhciBlbm91Z2ggdG8gc3RhcnQgZHJhZ1xucHJvdG8uaGFzRHJhZ1N0YXJ0ZWQgPSBmdW5jdGlvbiggbW92ZVZlY3RvciApIHtcbiAgcmV0dXJuIE1hdGguYWJzKCBtb3ZlVmVjdG9yLnggKSA+IDMgfHwgTWF0aC5hYnMoIG1vdmVWZWN0b3IueSApID4gMztcbn07XG5cblxuLy8gLS0tLS0gZW5kIGV2ZW50IC0tLS0tIC8vXG5cbi8qKlxuICogcG9pbnRlciB1cFxuICogQHBhcmFtIHtFdmVudH0gZXZlbnRcbiAqIEBwYXJhbSB7RXZlbnQgb3IgVG91Y2h9IHBvaW50ZXJcbiAqL1xucHJvdG8ucG9pbnRlclVwID0gZnVuY3Rpb24oIGV2ZW50LCBwb2ludGVyICkge1xuICB0aGlzLmVtaXRFdmVudCggJ3BvaW50ZXJVcCcsIFsgZXZlbnQsIHBvaW50ZXIgXSApO1xuICB0aGlzLl9kcmFnUG9pbnRlclVwKCBldmVudCwgcG9pbnRlciApO1xufTtcblxucHJvdG8uX2RyYWdQb2ludGVyVXAgPSBmdW5jdGlvbiggZXZlbnQsIHBvaW50ZXIgKSB7XG4gIGlmICggdGhpcy5pc0RyYWdnaW5nICkge1xuICAgIHRoaXMuX2RyYWdFbmQoIGV2ZW50LCBwb2ludGVyICk7XG4gIH0gZWxzZSB7XG4gICAgLy8gcG9pbnRlciBkaWRuJ3QgbW92ZSBlbm91Z2ggZm9yIGRyYWcgdG8gc3RhcnRcbiAgICB0aGlzLl9zdGF0aWNDbGljayggZXZlbnQsIHBvaW50ZXIgKTtcbiAgfVxufTtcblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gZHJhZyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvL1xuXG4vLyBkcmFnU3RhcnRcbnByb3RvLl9kcmFnU3RhcnQgPSBmdW5jdGlvbiggZXZlbnQsIHBvaW50ZXIgKSB7XG4gIHRoaXMuaXNEcmFnZ2luZyA9IHRydWU7XG4gIHRoaXMuZHJhZ1N0YXJ0UG9pbnQgPSBVbmlwb2ludGVyLmdldFBvaW50ZXJQb2ludCggcG9pbnRlciApO1xuICAvLyBwcmV2ZW50IGNsaWNrc1xuICB0aGlzLmlzUHJldmVudGluZ0NsaWNrcyA9IHRydWU7XG5cbiAgdGhpcy5kcmFnU3RhcnQoIGV2ZW50LCBwb2ludGVyICk7XG59O1xuXG5wcm90by5kcmFnU3RhcnQgPSBmdW5jdGlvbiggZXZlbnQsIHBvaW50ZXIgKSB7XG4gIHRoaXMuZW1pdEV2ZW50KCAnZHJhZ1N0YXJ0JywgWyBldmVudCwgcG9pbnRlciBdICk7XG59O1xuXG4vLyBkcmFnTW92ZVxucHJvdG8uX2RyYWdNb3ZlID0gZnVuY3Rpb24oIGV2ZW50LCBwb2ludGVyLCBtb3ZlVmVjdG9yICkge1xuICAvLyBkbyBub3QgZHJhZyBpZiBub3QgZHJhZ2dpbmcgeWV0XG4gIGlmICggIXRoaXMuaXNEcmFnZ2luZyApIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB0aGlzLmRyYWdNb3ZlKCBldmVudCwgcG9pbnRlciwgbW92ZVZlY3RvciApO1xufTtcblxucHJvdG8uZHJhZ01vdmUgPSBmdW5jdGlvbiggZXZlbnQsIHBvaW50ZXIsIG1vdmVWZWN0b3IgKSB7XG4gIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gIHRoaXMuZW1pdEV2ZW50KCAnZHJhZ01vdmUnLCBbIGV2ZW50LCBwb2ludGVyLCBtb3ZlVmVjdG9yIF0gKTtcbn07XG5cbi8vIGRyYWdFbmRcbnByb3RvLl9kcmFnRW5kID0gZnVuY3Rpb24oIGV2ZW50LCBwb2ludGVyICkge1xuICAvLyBzZXQgZmxhZ3NcbiAgdGhpcy5pc0RyYWdnaW5nID0gZmFsc2U7XG4gIC8vIHJlLWVuYWJsZSBjbGlja2luZyBhc3luY1xuICBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcbiAgICBkZWxldGUgdGhpcy5pc1ByZXZlbnRpbmdDbGlja3M7XG4gIH0uYmluZCggdGhpcyApICk7XG5cbiAgdGhpcy5kcmFnRW5kKCBldmVudCwgcG9pbnRlciApO1xufTtcblxucHJvdG8uZHJhZ0VuZCA9IGZ1bmN0aW9uKCBldmVudCwgcG9pbnRlciApIHtcbiAgdGhpcy5lbWl0RXZlbnQoICdkcmFnRW5kJywgWyBldmVudCwgcG9pbnRlciBdICk7XG59O1xuXG4vLyAtLS0tLSBvbmNsaWNrIC0tLS0tIC8vXG5cbi8vIGhhbmRsZSBhbGwgY2xpY2tzIGFuZCBwcmV2ZW50IGNsaWNrcyB3aGVuIGRyYWdnaW5nXG5wcm90by5vbmNsaWNrID0gZnVuY3Rpb24oIGV2ZW50ICkge1xuICBpZiAoIHRoaXMuaXNQcmV2ZW50aW5nQ2xpY2tzICkge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gIH1cbn07XG5cbi8vIC0tLS0tIHN0YXRpY0NsaWNrIC0tLS0tIC8vXG5cbi8vIHRyaWdnZXJlZCBhZnRlciBwb2ludGVyIGRvd24gJiB1cCB3aXRoIG5vL3RpbnkgbW92ZW1lbnRcbnByb3RvLl9zdGF0aWNDbGljayA9IGZ1bmN0aW9uKCBldmVudCwgcG9pbnRlciApIHtcbiAgLy8gaWdub3JlIGVtdWxhdGVkIG1vdXNlIHVwIGNsaWNrc1xuICBpZiAoIHRoaXMuaXNJZ25vcmluZ01vdXNlVXAgJiYgZXZlbnQudHlwZSA9PSAnbW91c2V1cCcgKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gYWxsb3cgY2xpY2sgaW4gPGlucHV0PnMgYW5kIDx0ZXh0YXJlYT5zXG4gIHZhciBub2RlTmFtZSA9IGV2ZW50LnRhcmdldC5ub2RlTmFtZTtcbiAgaWYgKCBub2RlTmFtZSA9PSAnSU5QVVQnIHx8IG5vZGVOYW1lID09ICdURVhUQVJFQScgKSB7XG4gICAgZXZlbnQudGFyZ2V0LmZvY3VzKCk7XG4gIH1cbiAgdGhpcy5zdGF0aWNDbGljayggZXZlbnQsIHBvaW50ZXIgKTtcblxuICAvLyBzZXQgZmxhZyBmb3IgZW11bGF0ZWQgY2xpY2tzIDMwMG1zIGFmdGVyIHRvdWNoZW5kXG4gIGlmICggZXZlbnQudHlwZSAhPSAnbW91c2V1cCcgKSB7XG4gICAgdGhpcy5pc0lnbm9yaW5nTW91c2VVcCA9IHRydWU7XG4gICAgLy8gcmVzZXQgZmxhZyBhZnRlciAzMDBtc1xuICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuICAgICAgZGVsZXRlIHRoaXMuaXNJZ25vcmluZ01vdXNlVXA7XG4gICAgfS5iaW5kKCB0aGlzICksIDQwMCApO1xuICB9XG59O1xuXG5wcm90by5zdGF0aWNDbGljayA9IGZ1bmN0aW9uKCBldmVudCwgcG9pbnRlciApIHtcbiAgdGhpcy5lbWl0RXZlbnQoICdzdGF0aWNDbGljaycsIFsgZXZlbnQsIHBvaW50ZXIgXSApO1xufTtcblxuLy8gLS0tLS0gdXRpbHMgLS0tLS0gLy9cblxuVW5pZHJhZ2dlci5nZXRQb2ludGVyUG9pbnQgPSBVbmlwb2ludGVyLmdldFBvaW50ZXJQb2ludDtcblxuLy8gLS0tLS0gIC0tLS0tIC8vXG5cbnJldHVybiBVbmlkcmFnZ2VyO1xuXG59KSk7XG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi91bmlkcmFnZ2VyL3VuaWRyYWdnZXIuanNcbiAqKiBtb2R1bGUgaWQgPSAxM1xuICoqIG1vZHVsZSBjaHVua3MgPSAwIDFcbiAqKi8iLCIvKiFcbiAqIFVuaXBvaW50ZXIgdjIuMS4wXG4gKiBiYXNlIGNsYXNzIGZvciBkb2luZyBvbmUgdGhpbmcgd2l0aCBwb2ludGVyIGV2ZW50XG4gKiBNSVQgbGljZW5zZVxuICovXG5cbi8qanNoaW50IGJyb3dzZXI6IHRydWUsIHVuZGVmOiB0cnVlLCB1bnVzZWQ6IHRydWUsIHN0cmljdDogdHJ1ZSAqL1xuXG4oIGZ1bmN0aW9uKCB3aW5kb3csIGZhY3RvcnkgKSB7XG4gIC8vIHVuaXZlcnNhbCBtb2R1bGUgZGVmaW5pdGlvblxuICAvKiBqc2hpbnQgc3RyaWN0OiBmYWxzZSAqLyAvKmdsb2JhbCBkZWZpbmUsIG1vZHVsZSwgcmVxdWlyZSAqL1xuICBpZiAoIHR5cGVvZiBkZWZpbmUgPT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kICkge1xuICAgIC8vIEFNRFxuICAgIGRlZmluZSggW1xuICAgICAgJ2V2LWVtaXR0ZXIvZXYtZW1pdHRlcidcbiAgICBdLCBmdW5jdGlvbiggRXZFbWl0dGVyICkge1xuICAgICAgcmV0dXJuIGZhY3RvcnkoIHdpbmRvdywgRXZFbWl0dGVyICk7XG4gICAgfSk7XG4gIH0gZWxzZSBpZiAoIHR5cGVvZiBtb2R1bGUgPT0gJ29iamVjdCcgJiYgbW9kdWxlLmV4cG9ydHMgKSB7XG4gICAgLy8gQ29tbW9uSlNcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoXG4gICAgICB3aW5kb3csXG4gICAgICByZXF1aXJlKCdldi1lbWl0dGVyJylcbiAgICApO1xuICB9IGVsc2Uge1xuICAgIC8vIGJyb3dzZXIgZ2xvYmFsXG4gICAgd2luZG93LlVuaXBvaW50ZXIgPSBmYWN0b3J5KFxuICAgICAgd2luZG93LFxuICAgICAgd2luZG93LkV2RW1pdHRlclxuICAgICk7XG4gIH1cblxufSggd2luZG93LCBmdW5jdGlvbiBmYWN0b3J5KCB3aW5kb3csIEV2RW1pdHRlciApIHtcblxuJ3VzZSBzdHJpY3QnO1xuXG5mdW5jdGlvbiBub29wKCkge31cblxuZnVuY3Rpb24gVW5pcG9pbnRlcigpIHt9XG5cbi8vIGluaGVyaXQgRXZFbWl0dGVyXG52YXIgcHJvdG8gPSBVbmlwb2ludGVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoIEV2RW1pdHRlci5wcm90b3R5cGUgKTtcblxucHJvdG8uYmluZFN0YXJ0RXZlbnQgPSBmdW5jdGlvbiggZWxlbSApIHtcbiAgdGhpcy5fYmluZFN0YXJ0RXZlbnQoIGVsZW0sIHRydWUgKTtcbn07XG5cbnByb3RvLnVuYmluZFN0YXJ0RXZlbnQgPSBmdW5jdGlvbiggZWxlbSApIHtcbiAgdGhpcy5fYmluZFN0YXJ0RXZlbnQoIGVsZW0sIGZhbHNlICk7XG59O1xuXG4vKipcbiAqIHdvcmtzIGFzIHVuYmluZGVyLCBhcyB5b3UgY2FuIC5fYmluZFN0YXJ0KCBmYWxzZSApIHRvIHVuYmluZFxuICogQHBhcmFtIHtCb29sZWFufSBpc0JpbmQgLSB3aWxsIHVuYmluZCBpZiBmYWxzZXlcbiAqL1xucHJvdG8uX2JpbmRTdGFydEV2ZW50ID0gZnVuY3Rpb24oIGVsZW0sIGlzQmluZCApIHtcbiAgLy8gbXVuZ2UgaXNCaW5kLCBkZWZhdWx0IHRvIHRydWVcbiAgaXNCaW5kID0gaXNCaW5kID09PSB1bmRlZmluZWQgPyB0cnVlIDogISFpc0JpbmQ7XG4gIHZhciBiaW5kTWV0aG9kID0gaXNCaW5kID8gJ2FkZEV2ZW50TGlzdGVuZXInIDogJ3JlbW92ZUV2ZW50TGlzdGVuZXInO1xuXG4gIGlmICggd2luZG93Lm5hdmlnYXRvci5wb2ludGVyRW5hYmxlZCApIHtcbiAgICAvLyBXM0MgUG9pbnRlciBFdmVudHMsIElFMTEuIFNlZSBodHRwczovL2NvZGVyd2FsbC5jb20vcC9tZnJlY2FcbiAgICBlbGVtWyBiaW5kTWV0aG9kIF0oICdwb2ludGVyZG93bicsIHRoaXMgKTtcbiAgfSBlbHNlIGlmICggd2luZG93Lm5hdmlnYXRvci5tc1BvaW50ZXJFbmFibGVkICkge1xuICAgIC8vIElFMTAgUG9pbnRlciBFdmVudHNcbiAgICBlbGVtWyBiaW5kTWV0aG9kIF0oICdNU1BvaW50ZXJEb3duJywgdGhpcyApO1xuICB9IGVsc2Uge1xuICAgIC8vIGxpc3RlbiBmb3IgYm90aCwgZm9yIGRldmljZXMgbGlrZSBDaHJvbWUgUGl4ZWxcbiAgICBlbGVtWyBiaW5kTWV0aG9kIF0oICdtb3VzZWRvd24nLCB0aGlzICk7XG4gICAgZWxlbVsgYmluZE1ldGhvZCBdKCAndG91Y2hzdGFydCcsIHRoaXMgKTtcbiAgfVxufTtcblxuLy8gdHJpZ2dlciBoYW5kbGVyIG1ldGhvZHMgZm9yIGV2ZW50c1xucHJvdG8uaGFuZGxlRXZlbnQgPSBmdW5jdGlvbiggZXZlbnQgKSB7XG4gIHZhciBtZXRob2QgPSAnb24nICsgZXZlbnQudHlwZTtcbiAgaWYgKCB0aGlzWyBtZXRob2QgXSApIHtcbiAgICB0aGlzWyBtZXRob2QgXSggZXZlbnQgKTtcbiAgfVxufTtcblxuLy8gcmV0dXJucyB0aGUgdG91Y2ggdGhhdCB3ZSdyZSBrZWVwaW5nIHRyYWNrIG9mXG5wcm90by5nZXRUb3VjaCA9IGZ1bmN0aW9uKCB0b3VjaGVzICkge1xuICBmb3IgKCB2YXIgaT0wOyBpIDwgdG91Y2hlcy5sZW5ndGg7IGkrKyApIHtcbiAgICB2YXIgdG91Y2ggPSB0b3VjaGVzW2ldO1xuICAgIGlmICggdG91Y2guaWRlbnRpZmllciA9PSB0aGlzLnBvaW50ZXJJZGVudGlmaWVyICkge1xuICAgICAgcmV0dXJuIHRvdWNoO1xuICAgIH1cbiAgfVxufTtcblxuLy8gLS0tLS0gc3RhcnQgZXZlbnQgLS0tLS0gLy9cblxucHJvdG8ub25tb3VzZWRvd24gPSBmdW5jdGlvbiggZXZlbnQgKSB7XG4gIC8vIGRpc21pc3MgY2xpY2tzIGZyb20gcmlnaHQgb3IgbWlkZGxlIGJ1dHRvbnNcbiAgdmFyIGJ1dHRvbiA9IGV2ZW50LmJ1dHRvbjtcbiAgaWYgKCBidXR0b24gJiYgKCBidXR0b24gIT09IDAgJiYgYnV0dG9uICE9PSAxICkgKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIHRoaXMuX3BvaW50ZXJEb3duKCBldmVudCwgZXZlbnQgKTtcbn07XG5cbnByb3RvLm9udG91Y2hzdGFydCA9IGZ1bmN0aW9uKCBldmVudCApIHtcbiAgdGhpcy5fcG9pbnRlckRvd24oIGV2ZW50LCBldmVudC5jaGFuZ2VkVG91Y2hlc1swXSApO1xufTtcblxucHJvdG8ub25NU1BvaW50ZXJEb3duID1cbnByb3RvLm9ucG9pbnRlcmRvd24gPSBmdW5jdGlvbiggZXZlbnQgKSB7XG4gIHRoaXMuX3BvaW50ZXJEb3duKCBldmVudCwgZXZlbnQgKTtcbn07XG5cbi8qKlxuICogcG9pbnRlciBzdGFydFxuICogQHBhcmFtIHtFdmVudH0gZXZlbnRcbiAqIEBwYXJhbSB7RXZlbnQgb3IgVG91Y2h9IHBvaW50ZXJcbiAqL1xucHJvdG8uX3BvaW50ZXJEb3duID0gZnVuY3Rpb24oIGV2ZW50LCBwb2ludGVyICkge1xuICAvLyBkaXNtaXNzIG90aGVyIHBvaW50ZXJzXG4gIGlmICggdGhpcy5pc1BvaW50ZXJEb3duICkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHRoaXMuaXNQb2ludGVyRG93biA9IHRydWU7XG4gIC8vIHNhdmUgcG9pbnRlciBpZGVudGlmaWVyIHRvIG1hdGNoIHVwIHRvdWNoIGV2ZW50c1xuICB0aGlzLnBvaW50ZXJJZGVudGlmaWVyID0gcG9pbnRlci5wb2ludGVySWQgIT09IHVuZGVmaW5lZCA/XG4gICAgLy8gcG9pbnRlcklkIGZvciBwb2ludGVyIGV2ZW50cywgdG91Y2guaW5kZW50aWZpZXIgZm9yIHRvdWNoIGV2ZW50c1xuICAgIHBvaW50ZXIucG9pbnRlcklkIDogcG9pbnRlci5pZGVudGlmaWVyO1xuXG4gIHRoaXMucG9pbnRlckRvd24oIGV2ZW50LCBwb2ludGVyICk7XG59O1xuXG5wcm90by5wb2ludGVyRG93biA9IGZ1bmN0aW9uKCBldmVudCwgcG9pbnRlciApIHtcbiAgdGhpcy5fYmluZFBvc3RTdGFydEV2ZW50cyggZXZlbnQgKTtcbiAgdGhpcy5lbWl0RXZlbnQoICdwb2ludGVyRG93bicsIFsgZXZlbnQsIHBvaW50ZXIgXSApO1xufTtcblxuLy8gaGFzaCBvZiBldmVudHMgdG8gYmUgYm91bmQgYWZ0ZXIgc3RhcnQgZXZlbnRcbnZhciBwb3N0U3RhcnRFdmVudHMgPSB7XG4gIG1vdXNlZG93bjogWyAnbW91c2Vtb3ZlJywgJ21vdXNldXAnIF0sXG4gIHRvdWNoc3RhcnQ6IFsgJ3RvdWNobW92ZScsICd0b3VjaGVuZCcsICd0b3VjaGNhbmNlbCcgXSxcbiAgcG9pbnRlcmRvd246IFsgJ3BvaW50ZXJtb3ZlJywgJ3BvaW50ZXJ1cCcsICdwb2ludGVyY2FuY2VsJyBdLFxuICBNU1BvaW50ZXJEb3duOiBbICdNU1BvaW50ZXJNb3ZlJywgJ01TUG9pbnRlclVwJywgJ01TUG9pbnRlckNhbmNlbCcgXVxufTtcblxucHJvdG8uX2JpbmRQb3N0U3RhcnRFdmVudHMgPSBmdW5jdGlvbiggZXZlbnQgKSB7XG4gIGlmICggIWV2ZW50ICkge1xuICAgIHJldHVybjtcbiAgfVxuICAvLyBnZXQgcHJvcGVyIGV2ZW50cyB0byBtYXRjaCBzdGFydCBldmVudFxuICB2YXIgZXZlbnRzID0gcG9zdFN0YXJ0RXZlbnRzWyBldmVudC50eXBlIF07XG4gIC8vIGJpbmQgZXZlbnRzIHRvIG5vZGVcbiAgZXZlbnRzLmZvckVhY2goIGZ1bmN0aW9uKCBldmVudE5hbWUgKSB7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoIGV2ZW50TmFtZSwgdGhpcyApO1xuICB9LCB0aGlzICk7XG4gIC8vIHNhdmUgdGhlc2UgYXJndW1lbnRzXG4gIHRoaXMuX2JvdW5kUG9pbnRlckV2ZW50cyA9IGV2ZW50cztcbn07XG5cbnByb3RvLl91bmJpbmRQb3N0U3RhcnRFdmVudHMgPSBmdW5jdGlvbigpIHtcbiAgLy8gY2hlY2sgZm9yIF9ib3VuZEV2ZW50cywgaW4gY2FzZSBkcmFnRW5kIHRyaWdnZXJlZCB0d2ljZSAob2xkIElFOCBidWcpXG4gIGlmICggIXRoaXMuX2JvdW5kUG9pbnRlckV2ZW50cyApIHtcbiAgICByZXR1cm47XG4gIH1cbiAgdGhpcy5fYm91bmRQb2ludGVyRXZlbnRzLmZvckVhY2goIGZ1bmN0aW9uKCBldmVudE5hbWUgKSB7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoIGV2ZW50TmFtZSwgdGhpcyApO1xuICB9LCB0aGlzICk7XG5cbiAgZGVsZXRlIHRoaXMuX2JvdW5kUG9pbnRlckV2ZW50cztcbn07XG5cbi8vIC0tLS0tIG1vdmUgZXZlbnQgLS0tLS0gLy9cblxucHJvdG8ub25tb3VzZW1vdmUgPSBmdW5jdGlvbiggZXZlbnQgKSB7XG4gIHRoaXMuX3BvaW50ZXJNb3ZlKCBldmVudCwgZXZlbnQgKTtcbn07XG5cbnByb3RvLm9uTVNQb2ludGVyTW92ZSA9XG5wcm90by5vbnBvaW50ZXJtb3ZlID0gZnVuY3Rpb24oIGV2ZW50ICkge1xuICBpZiAoIGV2ZW50LnBvaW50ZXJJZCA9PSB0aGlzLnBvaW50ZXJJZGVudGlmaWVyICkge1xuICAgIHRoaXMuX3BvaW50ZXJNb3ZlKCBldmVudCwgZXZlbnQgKTtcbiAgfVxufTtcblxucHJvdG8ub250b3VjaG1vdmUgPSBmdW5jdGlvbiggZXZlbnQgKSB7XG4gIHZhciB0b3VjaCA9IHRoaXMuZ2V0VG91Y2goIGV2ZW50LmNoYW5nZWRUb3VjaGVzICk7XG4gIGlmICggdG91Y2ggKSB7XG4gICAgdGhpcy5fcG9pbnRlck1vdmUoIGV2ZW50LCB0b3VjaCApO1xuICB9XG59O1xuXG4vKipcbiAqIHBvaW50ZXIgbW92ZVxuICogQHBhcmFtIHtFdmVudH0gZXZlbnRcbiAqIEBwYXJhbSB7RXZlbnQgb3IgVG91Y2h9IHBvaW50ZXJcbiAqIEBwcml2YXRlXG4gKi9cbnByb3RvLl9wb2ludGVyTW92ZSA9IGZ1bmN0aW9uKCBldmVudCwgcG9pbnRlciApIHtcbiAgdGhpcy5wb2ludGVyTW92ZSggZXZlbnQsIHBvaW50ZXIgKTtcbn07XG5cbi8vIHB1YmxpY1xucHJvdG8ucG9pbnRlck1vdmUgPSBmdW5jdGlvbiggZXZlbnQsIHBvaW50ZXIgKSB7XG4gIHRoaXMuZW1pdEV2ZW50KCAncG9pbnRlck1vdmUnLCBbIGV2ZW50LCBwb2ludGVyIF0gKTtcbn07XG5cbi8vIC0tLS0tIGVuZCBldmVudCAtLS0tLSAvL1xuXG5cbnByb3RvLm9ubW91c2V1cCA9IGZ1bmN0aW9uKCBldmVudCApIHtcbiAgdGhpcy5fcG9pbnRlclVwKCBldmVudCwgZXZlbnQgKTtcbn07XG5cbnByb3RvLm9uTVNQb2ludGVyVXAgPVxucHJvdG8ub25wb2ludGVydXAgPSBmdW5jdGlvbiggZXZlbnQgKSB7XG4gIGlmICggZXZlbnQucG9pbnRlcklkID09IHRoaXMucG9pbnRlcklkZW50aWZpZXIgKSB7XG4gICAgdGhpcy5fcG9pbnRlclVwKCBldmVudCwgZXZlbnQgKTtcbiAgfVxufTtcblxucHJvdG8ub250b3VjaGVuZCA9IGZ1bmN0aW9uKCBldmVudCApIHtcbiAgdmFyIHRvdWNoID0gdGhpcy5nZXRUb3VjaCggZXZlbnQuY2hhbmdlZFRvdWNoZXMgKTtcbiAgaWYgKCB0b3VjaCApIHtcbiAgICB0aGlzLl9wb2ludGVyVXAoIGV2ZW50LCB0b3VjaCApO1xuICB9XG59O1xuXG4vKipcbiAqIHBvaW50ZXIgdXBcbiAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50XG4gKiBAcGFyYW0ge0V2ZW50IG9yIFRvdWNofSBwb2ludGVyXG4gKiBAcHJpdmF0ZVxuICovXG5wcm90by5fcG9pbnRlclVwID0gZnVuY3Rpb24oIGV2ZW50LCBwb2ludGVyICkge1xuICB0aGlzLl9wb2ludGVyRG9uZSgpO1xuICB0aGlzLnBvaW50ZXJVcCggZXZlbnQsIHBvaW50ZXIgKTtcbn07XG5cbi8vIHB1YmxpY1xucHJvdG8ucG9pbnRlclVwID0gZnVuY3Rpb24oIGV2ZW50LCBwb2ludGVyICkge1xuICB0aGlzLmVtaXRFdmVudCggJ3BvaW50ZXJVcCcsIFsgZXZlbnQsIHBvaW50ZXIgXSApO1xufTtcblxuLy8gLS0tLS0gcG9pbnRlciBkb25lIC0tLS0tIC8vXG5cbi8vIHRyaWdnZXJlZCBvbiBwb2ludGVyIHVwICYgcG9pbnRlciBjYW5jZWxcbnByb3RvLl9wb2ludGVyRG9uZSA9IGZ1bmN0aW9uKCkge1xuICAvLyByZXNldCBwcm9wZXJ0aWVzXG4gIHRoaXMuaXNQb2ludGVyRG93biA9IGZhbHNlO1xuICBkZWxldGUgdGhpcy5wb2ludGVySWRlbnRpZmllcjtcbiAgLy8gcmVtb3ZlIGV2ZW50c1xuICB0aGlzLl91bmJpbmRQb3N0U3RhcnRFdmVudHMoKTtcbiAgdGhpcy5wb2ludGVyRG9uZSgpO1xufTtcblxucHJvdG8ucG9pbnRlckRvbmUgPSBub29wO1xuXG4vLyAtLS0tLSBwb2ludGVyIGNhbmNlbCAtLS0tLSAvL1xuXG5wcm90by5vbk1TUG9pbnRlckNhbmNlbCA9XG5wcm90by5vbnBvaW50ZXJjYW5jZWwgPSBmdW5jdGlvbiggZXZlbnQgKSB7XG4gIGlmICggZXZlbnQucG9pbnRlcklkID09IHRoaXMucG9pbnRlcklkZW50aWZpZXIgKSB7XG4gICAgdGhpcy5fcG9pbnRlckNhbmNlbCggZXZlbnQsIGV2ZW50ICk7XG4gIH1cbn07XG5cbnByb3RvLm9udG91Y2hjYW5jZWwgPSBmdW5jdGlvbiggZXZlbnQgKSB7XG4gIHZhciB0b3VjaCA9IHRoaXMuZ2V0VG91Y2goIGV2ZW50LmNoYW5nZWRUb3VjaGVzICk7XG4gIGlmICggdG91Y2ggKSB7XG4gICAgdGhpcy5fcG9pbnRlckNhbmNlbCggZXZlbnQsIHRvdWNoICk7XG4gIH1cbn07XG5cbi8qKlxuICogcG9pbnRlciBjYW5jZWxcbiAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50XG4gKiBAcGFyYW0ge0V2ZW50IG9yIFRvdWNofSBwb2ludGVyXG4gKiBAcHJpdmF0ZVxuICovXG5wcm90by5fcG9pbnRlckNhbmNlbCA9IGZ1bmN0aW9uKCBldmVudCwgcG9pbnRlciApIHtcbiAgdGhpcy5fcG9pbnRlckRvbmUoKTtcbiAgdGhpcy5wb2ludGVyQ2FuY2VsKCBldmVudCwgcG9pbnRlciApO1xufTtcblxuLy8gcHVibGljXG5wcm90by5wb2ludGVyQ2FuY2VsID0gZnVuY3Rpb24oIGV2ZW50LCBwb2ludGVyICkge1xuICB0aGlzLmVtaXRFdmVudCggJ3BvaW50ZXJDYW5jZWwnLCBbIGV2ZW50LCBwb2ludGVyIF0gKTtcbn07XG5cbi8vIC0tLS0tICAtLS0tLSAvL1xuXG4vLyB1dGlsaXR5IGZ1bmN0aW9uIGZvciBnZXR0aW5nIHgveSBjb29yZHMgZnJvbSBldmVudFxuVW5pcG9pbnRlci5nZXRQb2ludGVyUG9pbnQgPSBmdW5jdGlvbiggcG9pbnRlciApIHtcbiAgcmV0dXJuIHtcbiAgICB4OiBwb2ludGVyLnBhZ2VYLFxuICAgIHk6IHBvaW50ZXIucGFnZVlcbiAgfTtcbn07XG5cbi8vIC0tLS0tICAtLS0tLSAvL1xuXG5yZXR1cm4gVW5pcG9pbnRlcjtcblxufSkpO1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vdW5pcG9pbnRlci91bmlwb2ludGVyLmpzXG4gKiogbW9kdWxlIGlkID0gMTRcbiAqKiBtb2R1bGUgY2h1bmtzID0gMCAxXG4gKiovIiwiLy8gcHJldi9uZXh0IGJ1dHRvbnNcbiggZnVuY3Rpb24oIHdpbmRvdywgZmFjdG9yeSApIHtcbiAgLy8gdW5pdmVyc2FsIG1vZHVsZSBkZWZpbml0aW9uXG4gIC8qIGpzaGludCBzdHJpY3Q6IGZhbHNlICovXG4gIGlmICggdHlwZW9mIGRlZmluZSA9PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgKSB7XG4gICAgLy8gQU1EXG4gICAgZGVmaW5lKCBbXG4gICAgICAnLi9mbGlja2l0eScsXG4gICAgICAndGFwLWxpc3RlbmVyL3RhcC1saXN0ZW5lcicsXG4gICAgICAnZml6enktdWktdXRpbHMvdXRpbHMnXG4gICAgXSwgZnVuY3Rpb24oIEZsaWNraXR5LCBUYXBMaXN0ZW5lciwgdXRpbHMgKSB7XG4gICAgICByZXR1cm4gZmFjdG9yeSggd2luZG93LCBGbGlja2l0eSwgVGFwTGlzdGVuZXIsIHV0aWxzICk7XG4gICAgfSk7XG4gIH0gZWxzZSBpZiAoIHR5cGVvZiBtb2R1bGUgPT0gJ29iamVjdCcgJiYgbW9kdWxlLmV4cG9ydHMgKSB7XG4gICAgLy8gQ29tbW9uSlNcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoXG4gICAgICB3aW5kb3csXG4gICAgICByZXF1aXJlKCcuL2ZsaWNraXR5JyksXG4gICAgICByZXF1aXJlKCd0YXAtbGlzdGVuZXInKSxcbiAgICAgIHJlcXVpcmUoJ2Zpenp5LXVpLXV0aWxzJylcbiAgICApO1xuICB9IGVsc2Uge1xuICAgIC8vIGJyb3dzZXIgZ2xvYmFsXG4gICAgZmFjdG9yeShcbiAgICAgIHdpbmRvdyxcbiAgICAgIHdpbmRvdy5GbGlja2l0eSxcbiAgICAgIHdpbmRvdy5UYXBMaXN0ZW5lcixcbiAgICAgIHdpbmRvdy5maXp6eVVJVXRpbHNcbiAgICApO1xuICB9XG5cbn0oIHdpbmRvdywgZnVuY3Rpb24gZmFjdG9yeSggd2luZG93LCBGbGlja2l0eSwgVGFwTGlzdGVuZXIsIHV0aWxzICkge1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgc3ZnVVJJID0gJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJztcblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gUHJldk5leHRCdXR0b24gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cblxuZnVuY3Rpb24gUHJldk5leHRCdXR0b24oIGRpcmVjdGlvbiwgcGFyZW50ICkge1xuICB0aGlzLmRpcmVjdGlvbiA9IGRpcmVjdGlvbjtcbiAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gIHRoaXMuX2NyZWF0ZSgpO1xufVxuXG5QcmV2TmV4dEJ1dHRvbi5wcm90b3R5cGUgPSBuZXcgVGFwTGlzdGVuZXIoKTtcblxuUHJldk5leHRCdXR0b24ucHJvdG90eXBlLl9jcmVhdGUgPSBmdW5jdGlvbigpIHtcbiAgLy8gcHJvcGVydGllc1xuICB0aGlzLmlzRW5hYmxlZCA9IHRydWU7XG4gIHRoaXMuaXNQcmV2aW91cyA9IHRoaXMuZGlyZWN0aW9uID09IC0xO1xuICB2YXIgbGVmdERpcmVjdGlvbiA9IHRoaXMucGFyZW50Lm9wdGlvbnMucmlnaHRUb0xlZnQgPyAxIDogLTE7XG4gIHRoaXMuaXNMZWZ0ID0gdGhpcy5kaXJlY3Rpb24gPT0gbGVmdERpcmVjdGlvbjtcblxuICB2YXIgZWxlbWVudCA9IHRoaXMuZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICBlbGVtZW50LmNsYXNzTmFtZSA9ICdmbGlja2l0eS1wcmV2LW5leHQtYnV0dG9uJztcbiAgZWxlbWVudC5jbGFzc05hbWUgKz0gdGhpcy5pc1ByZXZpb3VzID8gJyBwcmV2aW91cycgOiAnIG5leHQnO1xuICAvLyBwcmV2ZW50IGJ1dHRvbiBmcm9tIHN1Ym1pdHRpbmcgZm9ybSBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xMDgzNjA3Ni8xODIxODNcbiAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoICd0eXBlJywgJ2J1dHRvbicgKTtcbiAgLy8gaW5pdCBhcyBkaXNhYmxlZFxuICB0aGlzLmRpc2FibGUoKTtcblxuICBlbGVtZW50LnNldEF0dHJpYnV0ZSggJ2FyaWEtbGFiZWwnLCB0aGlzLmlzUHJldmlvdXMgPyAncHJldmlvdXMnIDogJ25leHQnICk7XG5cbiAgLy8gY3JlYXRlIGFycm93XG4gIHZhciBzdmcgPSB0aGlzLmNyZWF0ZVNWRygpO1xuICBlbGVtZW50LmFwcGVuZENoaWxkKCBzdmcgKTtcbiAgLy8gdXBkYXRlIG9uIHNlbGVjdFxuICB0aGlzLnBhcmVudC5vbiggJ3NlbGVjdCcsIGZ1bmN0aW9uKCkge1xuICAgIHRoaXMudXBkYXRlKCk7XG4gIH0uYmluZCggdGhpcyApKTtcbiAgLy8gdGFwXG4gIHRoaXMub24oICd0YXAnLCB0aGlzLm9uVGFwICk7XG4gIC8vIHBvaW50ZXJEb3duXG4gIHRoaXMub24oICdwb2ludGVyRG93bicsIGZ1bmN0aW9uIG9uUG9pbnRlckRvd24oIGJ1dHRvbiwgZXZlbnQgKSB7XG4gICAgdGhpcy5wYXJlbnQuY2hpbGRVSVBvaW50ZXJEb3duKCBldmVudCApO1xuICB9LmJpbmQoIHRoaXMgKSk7XG59O1xuXG5QcmV2TmV4dEJ1dHRvbi5wcm90b3R5cGUuYWN0aXZhdGUgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5iaW5kVGFwKCB0aGlzLmVsZW1lbnQgKTtcbiAgLy8gY2xpY2sgZXZlbnRzIGZyb20ga2V5Ym9hcmRcbiAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoICdjbGljaycsIHRoaXMgKTtcbiAgLy8gYWRkIHRvIERPTVxuICB0aGlzLnBhcmVudC5lbGVtZW50LmFwcGVuZENoaWxkKCB0aGlzLmVsZW1lbnQgKTtcbn07XG5cblByZXZOZXh0QnV0dG9uLnByb3RvdHlwZS5kZWFjdGl2YXRlID0gZnVuY3Rpb24oKSB7XG4gIC8vIHJlbW92ZSBmcm9tIERPTVxuICB0aGlzLnBhcmVudC5lbGVtZW50LnJlbW92ZUNoaWxkKCB0aGlzLmVsZW1lbnQgKTtcbiAgLy8gZG8gcmVndWxhciBUYXBMaXN0ZW5lciBkZXN0cm95XG4gIFRhcExpc3RlbmVyLnByb3RvdHlwZS5kZXN0cm95LmNhbGwoIHRoaXMgKTtcbiAgLy8gY2xpY2sgZXZlbnRzIGZyb20ga2V5Ym9hcmRcbiAgdGhpcy5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoICdjbGljaycsIHRoaXMgKTtcbn07XG5cblByZXZOZXh0QnV0dG9uLnByb3RvdHlwZS5jcmVhdGVTVkcgPSBmdW5jdGlvbigpIHtcbiAgdmFyIHN2ZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyggc3ZnVVJJLCAnc3ZnJyk7XG4gIHN2Zy5zZXRBdHRyaWJ1dGUoICd2aWV3Qm94JywgJzAgMCAxMDAgMTAwJyApO1xuICB2YXIgcGF0aCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyggc3ZnVVJJLCAncGF0aCcpO1xuICB2YXIgcGF0aE1vdmVtZW50cyA9IGdldEFycm93TW92ZW1lbnRzKCB0aGlzLnBhcmVudC5vcHRpb25zLmFycm93U2hhcGUgKTtcbiAgcGF0aC5zZXRBdHRyaWJ1dGUoICdkJywgcGF0aE1vdmVtZW50cyApO1xuICBwYXRoLnNldEF0dHJpYnV0ZSggJ2NsYXNzJywgJ2Fycm93JyApO1xuICAvLyByb3RhdGUgYXJyb3dcbiAgaWYgKCAhdGhpcy5pc0xlZnQgKSB7XG4gICAgcGF0aC5zZXRBdHRyaWJ1dGUoICd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKDEwMCwgMTAwKSByb3RhdGUoMTgwKSAnICk7XG4gIH1cbiAgc3ZnLmFwcGVuZENoaWxkKCBwYXRoICk7XG4gIHJldHVybiBzdmc7XG59O1xuXG4vLyBnZXQgU1ZHIHBhdGggbW92bWVtZW50XG5mdW5jdGlvbiBnZXRBcnJvd01vdmVtZW50cyggc2hhcGUgKSB7XG4gIC8vIHVzZSBzaGFwZSBhcyBtb3ZlbWVudCBpZiBzdHJpbmdcbiAgaWYgKCB0eXBlb2Ygc2hhcGUgPT0gJ3N0cmluZycgKSB7XG4gICAgcmV0dXJuIHNoYXBlO1xuICB9XG4gIC8vIGNyZWF0ZSBtb3ZlbWVudCBzdHJpbmdcbiAgcmV0dXJuICdNICcgKyBzaGFwZS54MCArICcsNTAnICtcbiAgICAnIEwgJyArIHNoYXBlLngxICsgJywnICsgKCBzaGFwZS55MSArIDUwICkgK1xuICAgICcgTCAnICsgc2hhcGUueDIgKyAnLCcgKyAoIHNoYXBlLnkyICsgNTAgKSArXG4gICAgJyBMICcgKyBzaGFwZS54MyArICcsNTAgJyArXG4gICAgJyBMICcgKyBzaGFwZS54MiArICcsJyArICggNTAgLSBzaGFwZS55MiApICtcbiAgICAnIEwgJyArIHNoYXBlLngxICsgJywnICsgKCA1MCAtIHNoYXBlLnkxICkgK1xuICAgICcgWic7XG59XG5cblByZXZOZXh0QnV0dG9uLnByb3RvdHlwZS5vblRhcCA9IGZ1bmN0aW9uKCkge1xuICBpZiAoICF0aGlzLmlzRW5hYmxlZCApIHtcbiAgICByZXR1cm47XG4gIH1cbiAgdGhpcy5wYXJlbnQudWlDaGFuZ2UoKTtcbiAgdmFyIG1ldGhvZCA9IHRoaXMuaXNQcmV2aW91cyA/ICdwcmV2aW91cycgOiAnbmV4dCc7XG4gIHRoaXMucGFyZW50WyBtZXRob2QgXSgpO1xufTtcblxuUHJldk5leHRCdXR0b24ucHJvdG90eXBlLmhhbmRsZUV2ZW50ID0gdXRpbHMuaGFuZGxlRXZlbnQ7XG5cblByZXZOZXh0QnV0dG9uLnByb3RvdHlwZS5vbmNsaWNrID0gZnVuY3Rpb24oKSB7XG4gIC8vIG9ubHkgYWxsb3cgY2xpY2tzIGZyb20ga2V5Ym9hcmRcbiAgdmFyIGZvY3VzZWQgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50O1xuICBpZiAoIGZvY3VzZWQgJiYgZm9jdXNlZCA9PSB0aGlzLmVsZW1lbnQgKSB7XG4gICAgdGhpcy5vblRhcCgpO1xuICB9XG59O1xuXG4vLyAtLS0tLSAgLS0tLS0gLy9cblxuUHJldk5leHRCdXR0b24ucHJvdG90eXBlLmVuYWJsZSA9IGZ1bmN0aW9uKCkge1xuICBpZiAoIHRoaXMuaXNFbmFibGVkICkge1xuICAgIHJldHVybjtcbiAgfVxuICB0aGlzLmVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcbiAgdGhpcy5pc0VuYWJsZWQgPSB0cnVlO1xufTtcblxuUHJldk5leHRCdXR0b24ucHJvdG90eXBlLmRpc2FibGUgPSBmdW5jdGlvbigpIHtcbiAgaWYgKCAhdGhpcy5pc0VuYWJsZWQgKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIHRoaXMuZWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XG4gIHRoaXMuaXNFbmFibGVkID0gZmFsc2U7XG59O1xuXG5QcmV2TmV4dEJ1dHRvbi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7XG4gIC8vIGluZGV4IG9mIGZpcnN0IG9yIGxhc3Qgc2xpZGUsIGlmIHByZXZpb3VzIG9yIG5leHRcbiAgdmFyIHNsaWRlcyA9IHRoaXMucGFyZW50LnNsaWRlcztcbiAgLy8gZW5hYmxlIGlzIHdyYXBBcm91bmQgYW5kIGF0IGxlYXN0IDIgc2xpZGVzXG4gIGlmICggdGhpcy5wYXJlbnQub3B0aW9ucy53cmFwQXJvdW5kICYmIHNsaWRlcy5sZW5ndGggPiAxICkge1xuICAgIHRoaXMuZW5hYmxlKCk7XG4gICAgcmV0dXJuO1xuICB9XG4gIHZhciBsYXN0SW5kZXggPSBzbGlkZXMubGVuZ3RoID8gc2xpZGVzLmxlbmd0aCAtIDEgOiAwO1xuICB2YXIgYm91bmRJbmRleCA9IHRoaXMuaXNQcmV2aW91cyA/IDAgOiBsYXN0SW5kZXg7XG4gIHZhciBtZXRob2QgPSB0aGlzLnBhcmVudC5zZWxlY3RlZEluZGV4ID09IGJvdW5kSW5kZXggPyAnZGlzYWJsZScgOiAnZW5hYmxlJztcbiAgdGhpc1sgbWV0aG9kIF0oKTtcbn07XG5cblByZXZOZXh0QnV0dG9uLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuZGVhY3RpdmF0ZSgpO1xufTtcblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gRmxpY2tpdHkgcHJvdG90eXBlIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vXG5cbnV0aWxzLmV4dGVuZCggRmxpY2tpdHkuZGVmYXVsdHMsIHtcbiAgcHJldk5leHRCdXR0b25zOiB0cnVlLFxuICBhcnJvd1NoYXBlOiB7XG4gICAgeDA6IDEwLFxuICAgIHgxOiA2MCwgeTE6IDUwLFxuICAgIHgyOiA3MCwgeTI6IDQwLFxuICAgIHgzOiAzMFxuICB9XG59KTtcblxuRmxpY2tpdHkuY3JlYXRlTWV0aG9kcy5wdXNoKCdfY3JlYXRlUHJldk5leHRCdXR0b25zJyk7XG52YXIgcHJvdG8gPSBGbGlja2l0eS5wcm90b3R5cGU7XG5cbnByb3RvLl9jcmVhdGVQcmV2TmV4dEJ1dHRvbnMgPSBmdW5jdGlvbigpIHtcbiAgaWYgKCAhdGhpcy5vcHRpb25zLnByZXZOZXh0QnV0dG9ucyApIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB0aGlzLnByZXZCdXR0b24gPSBuZXcgUHJldk5leHRCdXR0b24oIC0xLCB0aGlzICk7XG4gIHRoaXMubmV4dEJ1dHRvbiA9IG5ldyBQcmV2TmV4dEJ1dHRvbiggMSwgdGhpcyApO1xuXG4gIHRoaXMub24oICdhY3RpdmF0ZScsIHRoaXMuYWN0aXZhdGVQcmV2TmV4dEJ1dHRvbnMgKTtcbn07XG5cbnByb3RvLmFjdGl2YXRlUHJldk5leHRCdXR0b25zID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMucHJldkJ1dHRvbi5hY3RpdmF0ZSgpO1xuICB0aGlzLm5leHRCdXR0b24uYWN0aXZhdGUoKTtcbiAgdGhpcy5vbiggJ2RlYWN0aXZhdGUnLCB0aGlzLmRlYWN0aXZhdGVQcmV2TmV4dEJ1dHRvbnMgKTtcbn07XG5cbnByb3RvLmRlYWN0aXZhdGVQcmV2TmV4dEJ1dHRvbnMgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5wcmV2QnV0dG9uLmRlYWN0aXZhdGUoKTtcbiAgdGhpcy5uZXh0QnV0dG9uLmRlYWN0aXZhdGUoKTtcbiAgdGhpcy5vZmYoICdkZWFjdGl2YXRlJywgdGhpcy5kZWFjdGl2YXRlUHJldk5leHRCdXR0b25zICk7XG59O1xuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cblxuRmxpY2tpdHkuUHJldk5leHRCdXR0b24gPSBQcmV2TmV4dEJ1dHRvbjtcblxucmV0dXJuIEZsaWNraXR5O1xuXG59KSk7XG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9mbGlja2l0eS9qcy9wcmV2LW5leHQtYnV0dG9uLmpzXG4gKiogbW9kdWxlIGlkID0gMTVcbiAqKiBtb2R1bGUgY2h1bmtzID0gMCAxXG4gKiovIiwiLyohXG4gKiBUYXAgbGlzdGVuZXIgdjIuMC4wXG4gKiBsaXN0ZW5zIHRvIHRhcHNcbiAqIE1JVCBsaWNlbnNlXG4gKi9cblxuLypqc2hpbnQgYnJvd3NlcjogdHJ1ZSwgdW51c2VkOiB0cnVlLCB1bmRlZjogdHJ1ZSwgc3RyaWN0OiB0cnVlICovXG5cbiggZnVuY3Rpb24oIHdpbmRvdywgZmFjdG9yeSApIHtcbiAgLy8gdW5pdmVyc2FsIG1vZHVsZSBkZWZpbml0aW9uXG4gIC8qanNoaW50IHN0cmljdDogZmFsc2UqLyAvKmdsb2JhbHMgZGVmaW5lLCBtb2R1bGUsIHJlcXVpcmUgKi9cblxuICBpZiAoIHR5cGVvZiBkZWZpbmUgPT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kICkge1xuICAgIC8vIEFNRFxuICAgIGRlZmluZSggW1xuICAgICAgJ3VuaXBvaW50ZXIvdW5pcG9pbnRlcidcbiAgICBdLCBmdW5jdGlvbiggVW5pcG9pbnRlciApIHtcbiAgICAgIHJldHVybiBmYWN0b3J5KCB3aW5kb3csIFVuaXBvaW50ZXIgKTtcbiAgICB9KTtcbiAgfSBlbHNlIGlmICggdHlwZW9mIG1vZHVsZSA9PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cyApIHtcbiAgICAvLyBDb21tb25KU1xuICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShcbiAgICAgIHdpbmRvdyxcbiAgICAgIHJlcXVpcmUoJ3VuaXBvaW50ZXInKVxuICAgICk7XG4gIH0gZWxzZSB7XG4gICAgLy8gYnJvd3NlciBnbG9iYWxcbiAgICB3aW5kb3cuVGFwTGlzdGVuZXIgPSBmYWN0b3J5KFxuICAgICAgd2luZG93LFxuICAgICAgd2luZG93LlVuaXBvaW50ZXJcbiAgICApO1xuICB9XG5cbn0oIHdpbmRvdywgZnVuY3Rpb24gZmFjdG9yeSggd2luZG93LCBVbmlwb2ludGVyICkge1xuXG4ndXNlIHN0cmljdCc7XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICBUYXBMaXN0ZW5lciAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvL1xuXG5mdW5jdGlvbiBUYXBMaXN0ZW5lciggZWxlbSApIHtcbiAgdGhpcy5iaW5kVGFwKCBlbGVtICk7XG59XG5cbi8vIGluaGVyaXQgVW5pcG9pbnRlciAmIEV2ZW50RW1pdHRlclxudmFyIHByb3RvID0gVGFwTGlzdGVuZXIucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZSggVW5pcG9pbnRlci5wcm90b3R5cGUgKTtcblxuLyoqXG4gKiBiaW5kIHRhcCBldmVudCB0byBlbGVtZW50XG4gKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1cbiAqL1xucHJvdG8uYmluZFRhcCA9IGZ1bmN0aW9uKCBlbGVtICkge1xuICBpZiAoICFlbGVtICkge1xuICAgIHJldHVybjtcbiAgfVxuICB0aGlzLnVuYmluZFRhcCgpO1xuICB0aGlzLnRhcEVsZW1lbnQgPSBlbGVtO1xuICB0aGlzLl9iaW5kU3RhcnRFdmVudCggZWxlbSwgdHJ1ZSApO1xufTtcblxucHJvdG8udW5iaW5kVGFwID0gZnVuY3Rpb24oKSB7XG4gIGlmICggIXRoaXMudGFwRWxlbWVudCApIHtcbiAgICByZXR1cm47XG4gIH1cbiAgdGhpcy5fYmluZFN0YXJ0RXZlbnQoIHRoaXMudGFwRWxlbWVudCwgdHJ1ZSApO1xuICBkZWxldGUgdGhpcy50YXBFbGVtZW50O1xufTtcblxuLyoqXG4gKiBwb2ludGVyIHVwXG4gKiBAcGFyYW0ge0V2ZW50fSBldmVudFxuICogQHBhcmFtIHtFdmVudCBvciBUb3VjaH0gcG9pbnRlclxuICovXG5wcm90by5wb2ludGVyVXAgPSBmdW5jdGlvbiggZXZlbnQsIHBvaW50ZXIgKSB7XG4gIC8vIGlnbm9yZSBlbXVsYXRlZCBtb3VzZSB1cCBjbGlja3NcbiAgaWYgKCB0aGlzLmlzSWdub3JpbmdNb3VzZVVwICYmIGV2ZW50LnR5cGUgPT0gJ21vdXNldXAnICkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBwb2ludGVyUG9pbnQgPSBVbmlwb2ludGVyLmdldFBvaW50ZXJQb2ludCggcG9pbnRlciApO1xuICB2YXIgYm91bmRpbmdSZWN0ID0gdGhpcy50YXBFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICB2YXIgc2Nyb2xsWCA9IHdpbmRvdy5wYWdlWE9mZnNldDtcbiAgdmFyIHNjcm9sbFkgPSB3aW5kb3cucGFnZVlPZmZzZXQ7XG4gIC8vIGNhbGN1bGF0ZSBpZiBwb2ludGVyIGlzIGluc2lkZSB0YXBFbGVtZW50XG4gIHZhciBpc0luc2lkZSA9IHBvaW50ZXJQb2ludC54ID49IGJvdW5kaW5nUmVjdC5sZWZ0ICsgc2Nyb2xsWCAmJlxuICAgIHBvaW50ZXJQb2ludC54IDw9IGJvdW5kaW5nUmVjdC5yaWdodCArIHNjcm9sbFggJiZcbiAgICBwb2ludGVyUG9pbnQueSA+PSBib3VuZGluZ1JlY3QudG9wICsgc2Nyb2xsWSAmJlxuICAgIHBvaW50ZXJQb2ludC55IDw9IGJvdW5kaW5nUmVjdC5ib3R0b20gKyBzY3JvbGxZO1xuICAvLyB0cmlnZ2VyIGNhbGxiYWNrIGlmIHBvaW50ZXIgaXMgaW5zaWRlIGVsZW1lbnRcbiAgaWYgKCBpc0luc2lkZSApIHtcbiAgICB0aGlzLmVtaXRFdmVudCggJ3RhcCcsIFsgZXZlbnQsIHBvaW50ZXIgXSApO1xuICB9XG5cbiAgLy8gc2V0IGZsYWcgZm9yIGVtdWxhdGVkIGNsaWNrcyAzMDBtcyBhZnRlciB0b3VjaGVuZFxuICBpZiAoIGV2ZW50LnR5cGUgIT0gJ21vdXNldXAnICkge1xuICAgIHRoaXMuaXNJZ25vcmluZ01vdXNlVXAgPSB0cnVlO1xuICAgIC8vIHJlc2V0IGZsYWcgYWZ0ZXIgMzAwbXNcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuICAgICAgZGVsZXRlIF90aGlzLmlzSWdub3JpbmdNb3VzZVVwO1xuICAgIH0sIDQwMCApO1xuICB9XG59O1xuXG5wcm90by5kZXN0cm95ID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMucG9pbnRlckRvbmUoKTtcbiAgdGhpcy51bmJpbmRUYXAoKTtcbn07XG5cbi8vIC0tLS0tICAtLS0tLSAvL1xuXG5yZXR1cm4gVGFwTGlzdGVuZXI7XG5cbn0pKTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L3RhcC1saXN0ZW5lci90YXAtbGlzdGVuZXIuanNcbiAqKiBtb2R1bGUgaWQgPSAxNlxuICoqIG1vZHVsZSBjaHVua3MgPSAwIDFcbiAqKi8iLCIvLyBwYWdlIGRvdHNcbiggZnVuY3Rpb24oIHdpbmRvdywgZmFjdG9yeSApIHtcbiAgLy8gdW5pdmVyc2FsIG1vZHVsZSBkZWZpbml0aW9uXG4gIC8qIGpzaGludCBzdHJpY3Q6IGZhbHNlICovXG4gIGlmICggdHlwZW9mIGRlZmluZSA9PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgKSB7XG4gICAgLy8gQU1EXG4gICAgZGVmaW5lKCBbXG4gICAgICAnLi9mbGlja2l0eScsXG4gICAgICAndGFwLWxpc3RlbmVyL3RhcC1saXN0ZW5lcicsXG4gICAgICAnZml6enktdWktdXRpbHMvdXRpbHMnXG4gICAgXSwgZnVuY3Rpb24oIEZsaWNraXR5LCBUYXBMaXN0ZW5lciwgdXRpbHMgKSB7XG4gICAgICByZXR1cm4gZmFjdG9yeSggd2luZG93LCBGbGlja2l0eSwgVGFwTGlzdGVuZXIsIHV0aWxzICk7XG4gICAgfSk7XG4gIH0gZWxzZSBpZiAoIHR5cGVvZiBtb2R1bGUgPT0gJ29iamVjdCcgJiYgbW9kdWxlLmV4cG9ydHMgKSB7XG4gICAgLy8gQ29tbW9uSlNcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoXG4gICAgICB3aW5kb3csXG4gICAgICByZXF1aXJlKCcuL2ZsaWNraXR5JyksXG4gICAgICByZXF1aXJlKCd0YXAtbGlzdGVuZXInKSxcbiAgICAgIHJlcXVpcmUoJ2Zpenp5LXVpLXV0aWxzJylcbiAgICApO1xuICB9IGVsc2Uge1xuICAgIC8vIGJyb3dzZXIgZ2xvYmFsXG4gICAgZmFjdG9yeShcbiAgICAgIHdpbmRvdyxcbiAgICAgIHdpbmRvdy5GbGlja2l0eSxcbiAgICAgIHdpbmRvdy5UYXBMaXN0ZW5lcixcbiAgICAgIHdpbmRvdy5maXp6eVVJVXRpbHNcbiAgICApO1xuICB9XG5cbn0oIHdpbmRvdywgZnVuY3Rpb24gZmFjdG9yeSggd2luZG93LCBGbGlja2l0eSwgVGFwTGlzdGVuZXIsIHV0aWxzICkge1xuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBQYWdlRG90cyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvL1xuXG4ndXNlIHN0cmljdCc7XG5cbmZ1bmN0aW9uIFBhZ2VEb3RzKCBwYXJlbnQgKSB7XG4gIHRoaXMucGFyZW50ID0gcGFyZW50O1xuICB0aGlzLl9jcmVhdGUoKTtcbn1cblxuUGFnZURvdHMucHJvdG90eXBlID0gbmV3IFRhcExpc3RlbmVyKCk7XG5cblBhZ2VEb3RzLnByb3RvdHlwZS5fY3JlYXRlID0gZnVuY3Rpb24oKSB7XG4gIC8vIGNyZWF0ZSBob2xkZXIgZWxlbWVudFxuICB0aGlzLmhvbGRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29sJyk7XG4gIHRoaXMuaG9sZGVyLmNsYXNzTmFtZSA9ICdmbGlja2l0eS1wYWdlLWRvdHMnO1xuICAvLyBjcmVhdGUgZG90cywgYXJyYXkgb2YgZWxlbWVudHNcbiAgdGhpcy5kb3RzID0gW107XG4gIC8vIHRhcFxuICB0aGlzLm9uKCAndGFwJywgdGhpcy5vblRhcCApO1xuXG59O1xuXG5QYWdlRG90cy5wcm90b3R5cGUuYWN0aXZhdGUgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5zZXREb3RzKCk7XG4gIHRoaXMuYmluZFRhcCggdGhpcy5ob2xkZXIgKTtcbiAgLy8gYWRkIHRvIERPTVxuICB0aGlzLnBhcmVudC5lbGVtZW50LmFwcGVuZENoaWxkKCB0aGlzLmhvbGRlciApO1xufTtcblxuUGFnZURvdHMucHJvdG90eXBlLmRlYWN0aXZhdGUgPSBmdW5jdGlvbigpIHtcbiAgLy8gcmVtb3ZlIGZyb20gRE9NXG4gIHRoaXMucGFyZW50LmVsZW1lbnQucmVtb3ZlQ2hpbGQoIHRoaXMuaG9sZGVyICk7XG4gIFRhcExpc3RlbmVyLnByb3RvdHlwZS5kZXN0cm95LmNhbGwoIHRoaXMgKTtcbn07XG5cblBhZ2VEb3RzLnByb3RvdHlwZS5zZXREb3RzID0gZnVuY3Rpb24oKSB7XG4gIC8vIGdldCBkaWZmZXJlbmNlIGJldHdlZW4gbnVtYmVyIG9mIHNsaWRlcyBhbmQgbnVtYmVyIG9mIGRvdHNcbiAgdmFyIGRlbHRhID0gdGhpcy5wYXJlbnQuc2xpZGVzLmxlbmd0aCAtIHRoaXMuZG90cy5sZW5ndGg7XG4gIGlmICggZGVsdGEgPiAwICkge1xuICAgIHRoaXMuYWRkRG90cyggZGVsdGEgKTtcbiAgfSBlbHNlIGlmICggZGVsdGEgPCAwICkge1xuICAgIHRoaXMucmVtb3ZlRG90cyggLWRlbHRhICk7XG4gIH1cbn07XG5cblBhZ2VEb3RzLnByb3RvdHlwZS5hZGREb3RzID0gZnVuY3Rpb24oIGNvdW50ICkge1xuICB2YXIgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gIHZhciBuZXdEb3RzID0gW107XG4gIHdoaWxlICggY291bnQgKSB7XG4gICAgdmFyIGRvdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gICAgZG90LmNsYXNzTmFtZSA9ICdkb3QnO1xuICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKCBkb3QgKTtcbiAgICBuZXdEb3RzLnB1c2goIGRvdCApO1xuICAgIGNvdW50LS07XG4gIH1cbiAgdGhpcy5ob2xkZXIuYXBwZW5kQ2hpbGQoIGZyYWdtZW50ICk7XG4gIHRoaXMuZG90cyA9IHRoaXMuZG90cy5jb25jYXQoIG5ld0RvdHMgKTtcbn07XG5cblBhZ2VEb3RzLnByb3RvdHlwZS5yZW1vdmVEb3RzID0gZnVuY3Rpb24oIGNvdW50ICkge1xuICAvLyByZW1vdmUgZnJvbSB0aGlzLmRvdHMgY29sbGVjdGlvblxuICB2YXIgcmVtb3ZlRG90cyA9IHRoaXMuZG90cy5zcGxpY2UoIHRoaXMuZG90cy5sZW5ndGggLSBjb3VudCwgY291bnQgKTtcbiAgLy8gcmVtb3ZlIGZyb20gRE9NXG4gIHJlbW92ZURvdHMuZm9yRWFjaCggZnVuY3Rpb24oIGRvdCApIHtcbiAgICB0aGlzLmhvbGRlci5yZW1vdmVDaGlsZCggZG90ICk7XG4gIH0sIHRoaXMgKTtcbn07XG5cblBhZ2VEb3RzLnByb3RvdHlwZS51cGRhdGVTZWxlY3RlZCA9IGZ1bmN0aW9uKCkge1xuICAvLyByZW1vdmUgc2VsZWN0ZWQgY2xhc3Mgb24gcHJldmlvdXNcbiAgaWYgKCB0aGlzLnNlbGVjdGVkRG90ICkge1xuICAgIHRoaXMuc2VsZWN0ZWREb3QuY2xhc3NOYW1lID0gJ2RvdCc7XG4gIH1cbiAgLy8gZG9uJ3QgcHJvY2VlZCBpZiBubyBkb3RzXG4gIGlmICggIXRoaXMuZG90cy5sZW5ndGggKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIHRoaXMuc2VsZWN0ZWREb3QgPSB0aGlzLmRvdHNbIHRoaXMucGFyZW50LnNlbGVjdGVkSW5kZXggXTtcbiAgdGhpcy5zZWxlY3RlZERvdC5jbGFzc05hbWUgPSAnZG90IGlzLXNlbGVjdGVkJztcbn07XG5cblBhZ2VEb3RzLnByb3RvdHlwZS5vblRhcCA9IGZ1bmN0aW9uKCBldmVudCApIHtcbiAgdmFyIHRhcmdldCA9IGV2ZW50LnRhcmdldDtcbiAgLy8gb25seSBjYXJlIGFib3V0IGRvdCBjbGlja3NcbiAgaWYgKCB0YXJnZXQubm9kZU5hbWUgIT0gJ0xJJyApIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB0aGlzLnBhcmVudC51aUNoYW5nZSgpO1xuICB2YXIgaW5kZXggPSB0aGlzLmRvdHMuaW5kZXhPZiggdGFyZ2V0ICk7XG4gIHRoaXMucGFyZW50LnNlbGVjdCggaW5kZXggKTtcbn07XG5cblBhZ2VEb3RzLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuZGVhY3RpdmF0ZSgpO1xufTtcblxuRmxpY2tpdHkuUGFnZURvdHMgPSBQYWdlRG90cztcblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gRmxpY2tpdHkgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cblxudXRpbHMuZXh0ZW5kKCBGbGlja2l0eS5kZWZhdWx0cywge1xuICBwYWdlRG90czogdHJ1ZVxufSk7XG5cbkZsaWNraXR5LmNyZWF0ZU1ldGhvZHMucHVzaCgnX2NyZWF0ZVBhZ2VEb3RzJyk7XG5cbnZhciBwcm90byA9IEZsaWNraXR5LnByb3RvdHlwZTtcblxucHJvdG8uX2NyZWF0ZVBhZ2VEb3RzID0gZnVuY3Rpb24oKSB7XG4gIGlmICggIXRoaXMub3B0aW9ucy5wYWdlRG90cyApIHtcbiAgICByZXR1cm47XG4gIH1cbiAgdGhpcy5wYWdlRG90cyA9IG5ldyBQYWdlRG90cyggdGhpcyApO1xuICAvLyBldmVudHNcbiAgdGhpcy5vbiggJ2FjdGl2YXRlJywgdGhpcy5hY3RpdmF0ZVBhZ2VEb3RzICk7XG4gIHRoaXMub24oICdzZWxlY3QnLCB0aGlzLnVwZGF0ZVNlbGVjdGVkUGFnZURvdHMgKTtcbiAgdGhpcy5vbiggJ2NlbGxDaGFuZ2UnLCB0aGlzLnVwZGF0ZVBhZ2VEb3RzICk7XG4gIHRoaXMub24oICdyZXNpemUnLCB0aGlzLnVwZGF0ZVBhZ2VEb3RzICk7XG4gIHRoaXMub24oICdkZWFjdGl2YXRlJywgdGhpcy5kZWFjdGl2YXRlUGFnZURvdHMgKTtcblxuICB0aGlzLnBhZ2VEb3RzLm9uKCAncG9pbnRlckRvd24nLCBmdW5jdGlvbiggZXZlbnQgKSB7XG4gICAgdGhpcy5jaGlsZFVJUG9pbnRlckRvd24oIGV2ZW50ICk7XG4gIH0uYmluZCggdGhpcyApKTtcbn07XG5cbnByb3RvLmFjdGl2YXRlUGFnZURvdHMgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5wYWdlRG90cy5hY3RpdmF0ZSgpO1xufTtcblxucHJvdG8udXBkYXRlU2VsZWN0ZWRQYWdlRG90cyA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLnBhZ2VEb3RzLnVwZGF0ZVNlbGVjdGVkKCk7XG59O1xuXG5wcm90by51cGRhdGVQYWdlRG90cyA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLnBhZ2VEb3RzLnNldERvdHMoKTtcbn07XG5cbnByb3RvLmRlYWN0aXZhdGVQYWdlRG90cyA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLnBhZ2VEb3RzLmRlYWN0aXZhdGUoKTtcbn07XG5cbi8vIC0tLS0tICAtLS0tLSAvL1xuXG5GbGlja2l0eS5QYWdlRG90cyA9IFBhZ2VEb3RzO1xuXG5yZXR1cm4gRmxpY2tpdHk7XG5cbn0pKTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2ZsaWNraXR5L2pzL3BhZ2UtZG90cy5qc1xuICoqIG1vZHVsZSBpZCA9IDE3XG4gKiogbW9kdWxlIGNodW5rcyA9IDAgMVxuICoqLyIsIi8vIHBsYXllciAmIGF1dG9QbGF5XG4oIGZ1bmN0aW9uKCB3aW5kb3csIGZhY3RvcnkgKSB7XG4gIC8vIHVuaXZlcnNhbCBtb2R1bGUgZGVmaW5pdGlvblxuICAvKiBqc2hpbnQgc3RyaWN0OiBmYWxzZSAqL1xuICBpZiAoIHR5cGVvZiBkZWZpbmUgPT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kICkge1xuICAgIC8vIEFNRFxuICAgIGRlZmluZSggW1xuICAgICAgJ2V2LWVtaXR0ZXIvZXYtZW1pdHRlcicsXG4gICAgICAnZml6enktdWktdXRpbHMvdXRpbHMnLFxuICAgICAgJy4vZmxpY2tpdHknXG4gICAgXSwgZnVuY3Rpb24oIEV2RW1pdHRlciwgdXRpbHMsIEZsaWNraXR5ICkge1xuICAgICAgcmV0dXJuIGZhY3RvcnkoIEV2RW1pdHRlciwgdXRpbHMsIEZsaWNraXR5ICk7XG4gICAgfSk7XG4gIH0gZWxzZSBpZiAoIHR5cGVvZiBtb2R1bGUgPT0gJ29iamVjdCcgJiYgbW9kdWxlLmV4cG9ydHMgKSB7XG4gICAgLy8gQ29tbW9uSlNcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoXG4gICAgICByZXF1aXJlKCdldi1lbWl0dGVyJyksXG4gICAgICByZXF1aXJlKCdmaXp6eS11aS11dGlscycpLFxuICAgICAgcmVxdWlyZSgnLi9mbGlja2l0eScpXG4gICAgKTtcbiAgfSBlbHNlIHtcbiAgICAvLyBicm93c2VyIGdsb2JhbFxuICAgIGZhY3RvcnkoXG4gICAgICB3aW5kb3cuRXZFbWl0dGVyLFxuICAgICAgd2luZG93LmZpenp5VUlVdGlscyxcbiAgICAgIHdpbmRvdy5GbGlja2l0eVxuICAgICk7XG4gIH1cblxufSggd2luZG93LCBmdW5jdGlvbiBmYWN0b3J5KCBFdkVtaXR0ZXIsIHV0aWxzLCBGbGlja2l0eSApIHtcblxuJ3VzZSBzdHJpY3QnO1xuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBQYWdlIFZpc2liaWxpdHkgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cbi8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0d1aWRlL1VzZXJfZXhwZXJpZW5jZS9Vc2luZ190aGVfUGFnZV9WaXNpYmlsaXR5X0FQSVxuXG52YXIgaGlkZGVuUHJvcGVydHksIHZpc2liaWxpdHlFdmVudDtcbmlmICggJ2hpZGRlbicgaW4gZG9jdW1lbnQgKSB7XG4gIGhpZGRlblByb3BlcnR5ID0gJ2hpZGRlbic7XG4gIHZpc2liaWxpdHlFdmVudCA9ICd2aXNpYmlsaXR5Y2hhbmdlJztcbn0gZWxzZSBpZiAoICd3ZWJraXRIaWRkZW4nIGluIGRvY3VtZW50ICkge1xuICBoaWRkZW5Qcm9wZXJ0eSA9ICd3ZWJraXRIaWRkZW4nO1xuICB2aXNpYmlsaXR5RXZlbnQgPSAnd2Via2l0dmlzaWJpbGl0eWNoYW5nZSc7XG59XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFBsYXllciAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvL1xuXG5mdW5jdGlvbiBQbGF5ZXIoIHBhcmVudCApIHtcbiAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gIHRoaXMuc3RhdGUgPSAnc3RvcHBlZCc7XG4gIC8vIHZpc2liaWxpdHkgY2hhbmdlIGV2ZW50IGhhbmRsZXJcbiAgaWYgKCB2aXNpYmlsaXR5RXZlbnQgKSB7XG4gICAgdGhpcy5vblZpc2liaWxpdHlDaGFuZ2UgPSBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMudmlzaWJpbGl0eUNoYW5nZSgpO1xuICAgIH0uYmluZCggdGhpcyApO1xuICAgIHRoaXMub25WaXNpYmlsaXR5UGxheSA9IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy52aXNpYmlsaXR5UGxheSgpO1xuICAgIH0uYmluZCggdGhpcyApO1xuICB9XG59XG5cblBsYXllci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKCBFdkVtaXR0ZXIucHJvdG90eXBlICk7XG5cbi8vIHN0YXJ0IHBsYXlcblBsYXllci5wcm90b3R5cGUucGxheSA9IGZ1bmN0aW9uKCkge1xuICBpZiAoIHRoaXMuc3RhdGUgPT0gJ3BsYXlpbmcnICkge1xuICAgIHJldHVybjtcbiAgfVxuICAvLyBkbyBub3QgcGxheSBpZiBwYWdlIGlzIGhpZGRlbiwgc3RhcnQgcGxheWluZyB3aGVuIHBhZ2UgaXMgdmlzaWJsZVxuICB2YXIgaXNQYWdlSGlkZGVuID0gZG9jdW1lbnRbIGhpZGRlblByb3BlcnR5IF07XG4gIGlmICggdmlzaWJpbGl0eUV2ZW50ICYmIGlzUGFnZUhpZGRlbiApIHtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCB2aXNpYmlsaXR5RXZlbnQsIHRoaXMub25WaXNpYmlsaXR5UGxheSApO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHRoaXMuc3RhdGUgPSAncGxheWluZyc7XG4gIC8vIGxpc3RlbiB0byB2aXNpYmlsaXR5IGNoYW5nZVxuICBpZiAoIHZpc2liaWxpdHlFdmVudCApIHtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCB2aXNpYmlsaXR5RXZlbnQsIHRoaXMub25WaXNpYmlsaXR5Q2hhbmdlICk7XG4gIH1cbiAgLy8gc3RhcnQgdGlja2luZ1xuICB0aGlzLnRpY2soKTtcbn07XG5cblBsYXllci5wcm90b3R5cGUudGljayA9IGZ1bmN0aW9uKCkge1xuICAvLyBkbyBub3QgdGljayBpZiBub3QgcGxheWluZ1xuICBpZiAoIHRoaXMuc3RhdGUgIT0gJ3BsYXlpbmcnICkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciB0aW1lID0gdGhpcy5wYXJlbnQub3B0aW9ucy5hdXRvUGxheTtcbiAgLy8gZGVmYXVsdCB0byAzIHNlY29uZHNcbiAgdGltZSA9IHR5cGVvZiB0aW1lID09ICdudW1iZXInID8gdGltZSA6IDMwMDA7XG4gIHZhciBfdGhpcyA9IHRoaXM7XG4gIC8vIEhBQ0s6IHJlc2V0IHRpY2tzIGlmIHN0b3BwZWQgYW5kIHN0YXJ0ZWQgd2l0aGluIGludGVydmFsXG4gIHRoaXMuY2xlYXIoKTtcbiAgdGhpcy50aW1lb3V0ID0gc2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG4gICAgX3RoaXMucGFyZW50Lm5leHQoIHRydWUgKTtcbiAgICBfdGhpcy50aWNrKCk7XG4gIH0sIHRpbWUgKTtcbn07XG5cblBsYXllci5wcm90b3R5cGUuc3RvcCA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLnN0YXRlID0gJ3N0b3BwZWQnO1xuICB0aGlzLmNsZWFyKCk7XG4gIC8vIHJlbW92ZSB2aXNpYmlsaXR5IGNoYW5nZSBldmVudFxuICBpZiAoIHZpc2liaWxpdHlFdmVudCApIHtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCB2aXNpYmlsaXR5RXZlbnQsIHRoaXMub25WaXNpYmlsaXR5Q2hhbmdlICk7XG4gIH1cbn07XG5cblBsYXllci5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbigpIHtcbiAgY2xlYXJUaW1lb3V0KCB0aGlzLnRpbWVvdXQgKTtcbn07XG5cblBsYXllci5wcm90b3R5cGUucGF1c2UgPSBmdW5jdGlvbigpIHtcbiAgaWYgKCB0aGlzLnN0YXRlID09ICdwbGF5aW5nJyApIHtcbiAgICB0aGlzLnN0YXRlID0gJ3BhdXNlZCc7XG4gICAgdGhpcy5jbGVhcigpO1xuICB9XG59O1xuXG5QbGF5ZXIucHJvdG90eXBlLnVucGF1c2UgPSBmdW5jdGlvbigpIHtcbiAgLy8gcmUtc3RhcnQgcGxheSBpZiBwYXVzZWRcbiAgaWYgKCB0aGlzLnN0YXRlID09ICdwYXVzZWQnICkge1xuICAgIHRoaXMucGxheSgpO1xuICB9XG59O1xuXG4vLyBwYXVzZSBpZiBwYWdlIHZpc2liaWxpdHkgaXMgaGlkZGVuLCB1bnBhdXNlIGlmIHZpc2libGVcblBsYXllci5wcm90b3R5cGUudmlzaWJpbGl0eUNoYW5nZSA9IGZ1bmN0aW9uKCkge1xuICB2YXIgaXNQYWdlSGlkZGVuID0gZG9jdW1lbnRbIGhpZGRlblByb3BlcnR5IF07XG4gIHRoaXNbIGlzUGFnZUhpZGRlbiA/ICdwYXVzZScgOiAndW5wYXVzZScgXSgpO1xufTtcblxuUGxheWVyLnByb3RvdHlwZS52aXNpYmlsaXR5UGxheSA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLnBsYXkoKTtcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggdmlzaWJpbGl0eUV2ZW50LCB0aGlzLm9uVmlzaWJpbGl0eVBsYXkgKTtcbn07XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIEZsaWNraXR5IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vXG5cbnV0aWxzLmV4dGVuZCggRmxpY2tpdHkuZGVmYXVsdHMsIHtcbiAgcGF1c2VBdXRvUGxheU9uSG92ZXI6IHRydWVcbn0pO1xuXG5GbGlja2l0eS5jcmVhdGVNZXRob2RzLnB1c2goJ19jcmVhdGVQbGF5ZXInKTtcbnZhciBwcm90byA9IEZsaWNraXR5LnByb3RvdHlwZTtcblxucHJvdG8uX2NyZWF0ZVBsYXllciA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLnBsYXllciA9IG5ldyBQbGF5ZXIoIHRoaXMgKTtcblxuICB0aGlzLm9uKCAnYWN0aXZhdGUnLCB0aGlzLmFjdGl2YXRlUGxheWVyICk7XG4gIHRoaXMub24oICd1aUNoYW5nZScsIHRoaXMuc3RvcFBsYXllciApO1xuICB0aGlzLm9uKCAncG9pbnRlckRvd24nLCB0aGlzLnN0b3BQbGF5ZXIgKTtcbiAgdGhpcy5vbiggJ2RlYWN0aXZhdGUnLCB0aGlzLmRlYWN0aXZhdGVQbGF5ZXIgKTtcbn07XG5cbnByb3RvLmFjdGl2YXRlUGxheWVyID0gZnVuY3Rpb24oKSB7XG4gIGlmICggIXRoaXMub3B0aW9ucy5hdXRvUGxheSApIHtcbiAgICByZXR1cm47XG4gIH1cbiAgdGhpcy5wbGF5ZXIucGxheSgpO1xuICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ21vdXNlZW50ZXInLCB0aGlzICk7XG59O1xuXG4vLyBQbGF5ZXIgQVBJLCBkb24ndCBoYXRlIHRoZSAuLi4gdGhhbmtzIEkga25vdyB3aGVyZSB0aGUgZG9vciBpc1xuXG5wcm90by5wbGF5UGxheWVyID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMucGxheWVyLnBsYXkoKTtcbn07XG5cbnByb3RvLnN0b3BQbGF5ZXIgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5wbGF5ZXIuc3RvcCgpO1xufTtcblxucHJvdG8ucGF1c2VQbGF5ZXIgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5wbGF5ZXIucGF1c2UoKTtcbn07XG5cbnByb3RvLnVucGF1c2VQbGF5ZXIgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5wbGF5ZXIudW5wYXVzZSgpO1xufTtcblxucHJvdG8uZGVhY3RpdmF0ZVBsYXllciA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLnBsYXllci5zdG9wKCk7XG4gIHRoaXMuZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAnbW91c2VlbnRlcicsIHRoaXMgKTtcbn07XG5cbi8vIC0tLS0tIG1vdXNlZW50ZXIvbGVhdmUgLS0tLS0gLy9cblxuLy8gcGF1c2UgYXV0by1wbGF5IG9uIGhvdmVyXG5wcm90by5vbm1vdXNlZW50ZXIgPSBmdW5jdGlvbigpIHtcbiAgaWYgKCAhdGhpcy5vcHRpb25zLnBhdXNlQXV0b1BsYXlPbkhvdmVyICkge1xuICAgIHJldHVybjtcbiAgfVxuICB0aGlzLnBsYXllci5wYXVzZSgpO1xuICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ21vdXNlbGVhdmUnLCB0aGlzICk7XG59O1xuXG4vLyByZXN1bWUgYXV0by1wbGF5IG9uIGhvdmVyIG9mZlxucHJvdG8ub25tb3VzZWxlYXZlID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMucGxheWVyLnVucGF1c2UoKTtcbiAgdGhpcy5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoICdtb3VzZWxlYXZlJywgdGhpcyApO1xufTtcblxuLy8gLS0tLS0gIC0tLS0tIC8vXG5cbkZsaWNraXR5LlBsYXllciA9IFBsYXllcjtcblxucmV0dXJuIEZsaWNraXR5O1xuXG59KSk7XG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9mbGlja2l0eS9qcy9wbGF5ZXIuanNcbiAqKiBtb2R1bGUgaWQgPSAxOFxuICoqIG1vZHVsZSBjaHVua3MgPSAwIDFcbiAqKi8iLCIvLyBhZGQsIHJlbW92ZSBjZWxsXG4oIGZ1bmN0aW9uKCB3aW5kb3csIGZhY3RvcnkgKSB7XG4gIC8vIHVuaXZlcnNhbCBtb2R1bGUgZGVmaW5pdGlvblxuICAvKiBqc2hpbnQgc3RyaWN0OiBmYWxzZSAqL1xuICBpZiAoIHR5cGVvZiBkZWZpbmUgPT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kICkge1xuICAgIC8vIEFNRFxuICAgIGRlZmluZSggW1xuICAgICAgJy4vZmxpY2tpdHknLFxuICAgICAgJ2Zpenp5LXVpLXV0aWxzL3V0aWxzJ1xuICAgIF0sIGZ1bmN0aW9uKCBGbGlja2l0eSwgdXRpbHMgKSB7XG4gICAgICByZXR1cm4gZmFjdG9yeSggd2luZG93LCBGbGlja2l0eSwgdXRpbHMgKTtcbiAgICB9KTtcbiAgfSBlbHNlIGlmICggdHlwZW9mIG1vZHVsZSA9PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cyApIHtcbiAgICAvLyBDb21tb25KU1xuICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShcbiAgICAgIHdpbmRvdyxcbiAgICAgIHJlcXVpcmUoJy4vZmxpY2tpdHknKSxcbiAgICAgIHJlcXVpcmUoJ2Zpenp5LXVpLXV0aWxzJylcbiAgICApO1xuICB9IGVsc2Uge1xuICAgIC8vIGJyb3dzZXIgZ2xvYmFsXG4gICAgZmFjdG9yeShcbiAgICAgIHdpbmRvdyxcbiAgICAgIHdpbmRvdy5GbGlja2l0eSxcbiAgICAgIHdpbmRvdy5maXp6eVVJVXRpbHNcbiAgICApO1xuICB9XG5cbn0oIHdpbmRvdywgZnVuY3Rpb24gZmFjdG9yeSggd2luZG93LCBGbGlja2l0eSwgdXRpbHMgKSB7XG5cbid1c2Ugc3RyaWN0JztcblxuLy8gYXBwZW5kIGNlbGxzIHRvIGEgZG9jdW1lbnQgZnJhZ21lbnRcbmZ1bmN0aW9uIGdldENlbGxzRnJhZ21lbnQoIGNlbGxzICkge1xuICB2YXIgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gIGNlbGxzLmZvckVhY2goIGZ1bmN0aW9uKCBjZWxsICkge1xuICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKCBjZWxsLmVsZW1lbnQgKTtcbiAgfSk7XG4gIHJldHVybiBmcmFnbWVudDtcbn1cblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gYWRkL3JlbW92ZSBjZWxsIHByb3RvdHlwZSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvL1xuXG52YXIgcHJvdG8gPSBGbGlja2l0eS5wcm90b3R5cGU7XG5cbi8qKlxuICogSW5zZXJ0LCBwcmVwZW5kLCBvciBhcHBlbmQgY2VsbHNcbiAqIEBwYXJhbSB7RWxlbWVudCwgQXJyYXksIE5vZGVMaXN0fSBlbGVtc1xuICogQHBhcmFtIHtJbnRlZ2VyfSBpbmRleFxuICovXG5wcm90by5pbnNlcnQgPSBmdW5jdGlvbiggZWxlbXMsIGluZGV4ICkge1xuICB2YXIgY2VsbHMgPSB0aGlzLl9tYWtlQ2VsbHMoIGVsZW1zICk7XG4gIGlmICggIWNlbGxzIHx8ICFjZWxscy5sZW5ndGggKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIHZhciBsZW4gPSB0aGlzLmNlbGxzLmxlbmd0aDtcbiAgLy8gZGVmYXVsdCB0byBhcHBlbmRcbiAgaW5kZXggPSBpbmRleCA9PT0gdW5kZWZpbmVkID8gbGVuIDogaW5kZXg7XG4gIC8vIGFkZCBjZWxscyB3aXRoIGRvY3VtZW50IGZyYWdtZW50XG4gIHZhciBmcmFnbWVudCA9IGdldENlbGxzRnJhZ21lbnQoIGNlbGxzICk7XG4gIC8vIGFwcGVuZCB0byBzbGlkZXJcbiAgdmFyIGlzQXBwZW5kID0gaW5kZXggPT0gbGVuO1xuICBpZiAoIGlzQXBwZW5kICkge1xuICAgIHRoaXMuc2xpZGVyLmFwcGVuZENoaWxkKCBmcmFnbWVudCApO1xuICB9IGVsc2Uge1xuICAgIHZhciBpbnNlcnRDZWxsRWxlbWVudCA9IHRoaXMuY2VsbHNbIGluZGV4IF0uZWxlbWVudDtcbiAgICB0aGlzLnNsaWRlci5pbnNlcnRCZWZvcmUoIGZyYWdtZW50LCBpbnNlcnRDZWxsRWxlbWVudCApO1xuICB9XG4gIC8vIGFkZCB0byB0aGlzLmNlbGxzXG4gIGlmICggaW5kZXggPT09IDAgKSB7XG4gICAgLy8gcHJlcGVuZCwgYWRkIHRvIHN0YXJ0XG4gICAgdGhpcy5jZWxscyA9IGNlbGxzLmNvbmNhdCggdGhpcy5jZWxscyApO1xuICB9IGVsc2UgaWYgKCBpc0FwcGVuZCApIHtcbiAgICAvLyBhcHBlbmQsIGFkZCB0byBlbmRcbiAgICB0aGlzLmNlbGxzID0gdGhpcy5jZWxscy5jb25jYXQoIGNlbGxzICk7XG4gIH0gZWxzZSB7XG4gICAgLy8gaW5zZXJ0IGluIHRoaXMuY2VsbHNcbiAgICB2YXIgZW5kQ2VsbHMgPSB0aGlzLmNlbGxzLnNwbGljZSggaW5kZXgsIGxlbiAtIGluZGV4ICk7XG4gICAgdGhpcy5jZWxscyA9IHRoaXMuY2VsbHMuY29uY2F0KCBjZWxscyApLmNvbmNhdCggZW5kQ2VsbHMgKTtcbiAgfVxuXG4gIHRoaXMuX3NpemVDZWxscyggY2VsbHMgKTtcblxuICB2YXIgc2VsZWN0ZWRJbmRleERlbHRhID0gaW5kZXggPiB0aGlzLnNlbGVjdGVkSW5kZXggPyAwIDogY2VsbHMubGVuZ3RoO1xuICB0aGlzLl9jZWxsQWRkZWRSZW1vdmVkKCBpbmRleCwgc2VsZWN0ZWRJbmRleERlbHRhICk7XG59O1xuXG5wcm90by5hcHBlbmQgPSBmdW5jdGlvbiggZWxlbXMgKSB7XG4gIHRoaXMuaW5zZXJ0KCBlbGVtcywgdGhpcy5jZWxscy5sZW5ndGggKTtcbn07XG5cbnByb3RvLnByZXBlbmQgPSBmdW5jdGlvbiggZWxlbXMgKSB7XG4gIHRoaXMuaW5zZXJ0KCBlbGVtcywgMCApO1xufTtcblxuLyoqXG4gKiBSZW1vdmUgY2VsbHNcbiAqIEBwYXJhbSB7RWxlbWVudCwgQXJyYXksIE5vZGVMaXN0fSBlbGVtc1xuICovXG5wcm90by5yZW1vdmUgPSBmdW5jdGlvbiggZWxlbXMgKSB7XG4gIHZhciBjZWxscyA9IHRoaXMuZ2V0Q2VsbHMoIGVsZW1zICk7XG4gIHZhciBzZWxlY3RlZEluZGV4RGVsdGEgPSAwO1xuICB2YXIgbGVuID0gY2VsbHMubGVuZ3RoO1xuICB2YXIgaSwgY2VsbDtcbiAgLy8gY2FsY3VsYXRlIHNlbGVjdGVkSW5kZXhEZWx0YSwgZWFzaWVyIGlmIGRvbmUgaW4gc2VwZXJhdGUgbG9vcFxuICBmb3IgKCBpPTA7IGkgPCBsZW47IGkrKyApIHtcbiAgICBjZWxsID0gY2VsbHNbaV07XG4gICAgdmFyIHdhc0JlZm9yZSA9IHRoaXMuY2VsbHMuaW5kZXhPZiggY2VsbCApIDwgdGhpcy5zZWxlY3RlZEluZGV4O1xuICAgIHNlbGVjdGVkSW5kZXhEZWx0YSAtPSB3YXNCZWZvcmUgPyAxIDogMDtcbiAgfVxuXG4gIGZvciAoIGk9MDsgaSA8IGxlbjsgaSsrICkge1xuICAgIGNlbGwgPSBjZWxsc1tpXTtcbiAgICBjZWxsLnJlbW92ZSgpO1xuICAgIC8vIHJlbW92ZSBpdGVtIGZyb20gY29sbGVjdGlvblxuICAgIHV0aWxzLnJlbW92ZUZyb20oIHRoaXMuY2VsbHMsIGNlbGwgKTtcbiAgfVxuXG4gIGlmICggY2VsbHMubGVuZ3RoICkge1xuICAgIC8vIHVwZGF0ZSBzdHVmZlxuICAgIHRoaXMuX2NlbGxBZGRlZFJlbW92ZWQoIDAsIHNlbGVjdGVkSW5kZXhEZWx0YSApO1xuICB9XG59O1xuXG4vLyB1cGRhdGVzIHdoZW4gY2VsbHMgYXJlIGFkZGVkIG9yIHJlbW92ZWRcbnByb3RvLl9jZWxsQWRkZWRSZW1vdmVkID0gZnVuY3Rpb24oIGNoYW5nZWRDZWxsSW5kZXgsIHNlbGVjdGVkSW5kZXhEZWx0YSApIHtcbiAgLy8gVE9ETyB0aGlzIG1hdGggaXNuJ3QgcGVyZmVjdCB3aXRoIGdyb3VwZWQgc2xpZGVzXG4gIHNlbGVjdGVkSW5kZXhEZWx0YSA9IHNlbGVjdGVkSW5kZXhEZWx0YSB8fCAwO1xuICB0aGlzLnNlbGVjdGVkSW5kZXggKz0gc2VsZWN0ZWRJbmRleERlbHRhO1xuICB0aGlzLnNlbGVjdGVkSW5kZXggPSBNYXRoLm1heCggMCwgTWF0aC5taW4oIHRoaXMuc2xpZGVzLmxlbmd0aCAtIDEsIHRoaXMuc2VsZWN0ZWRJbmRleCApICk7XG5cbiAgdGhpcy5jZWxsQ2hhbmdlKCBjaGFuZ2VkQ2VsbEluZGV4LCB0cnVlICk7XG4gIC8vIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5XG4gIHRoaXMuZW1pdEV2ZW50KCAnY2VsbEFkZGVkUmVtb3ZlZCcsIFsgY2hhbmdlZENlbGxJbmRleCwgc2VsZWN0ZWRJbmRleERlbHRhIF0gKTtcbn07XG5cbi8qKlxuICogbG9naWMgdG8gYmUgcnVuIGFmdGVyIGEgY2VsbCdzIHNpemUgY2hhbmdlc1xuICogQHBhcmFtIHtFbGVtZW50fSBlbGVtIC0gY2VsbCdzIGVsZW1lbnRcbiAqL1xucHJvdG8uY2VsbFNpemVDaGFuZ2UgPSBmdW5jdGlvbiggZWxlbSApIHtcbiAgdmFyIGNlbGwgPSB0aGlzLmdldENlbGwoIGVsZW0gKTtcbiAgaWYgKCAhY2VsbCApIHtcbiAgICByZXR1cm47XG4gIH1cbiAgY2VsbC5nZXRTaXplKCk7XG5cbiAgdmFyIGluZGV4ID0gdGhpcy5jZWxscy5pbmRleE9mKCBjZWxsICk7XG4gIHRoaXMuY2VsbENoYW5nZSggaW5kZXggKTtcbn07XG5cbi8qKlxuICogbG9naWMgYW55IHRpbWUgYSBjZWxsIGlzIGNoYW5nZWQ6IGFkZGVkLCByZW1vdmVkLCBvciBzaXplIGNoYW5nZWRcbiAqIEBwYXJhbSB7SW50ZWdlcn0gY2hhbmdlZENlbGxJbmRleCAtIGluZGV4IG9mIHRoZSBjaGFuZ2VkIGNlbGwsIG9wdGlvbmFsXG4gKi9cbnByb3RvLmNlbGxDaGFuZ2UgPSBmdW5jdGlvbiggY2hhbmdlZENlbGxJbmRleCwgaXNQb3NpdGlvbmluZ1NsaWRlciApIHtcbiAgdmFyIHByZXZTbGlkZWFibGVXaWR0aCA9IHRoaXMuc2xpZGVhYmxlV2lkdGg7XG4gIHRoaXMuX3Bvc2l0aW9uQ2VsbHMoIGNoYW5nZWRDZWxsSW5kZXggKTtcbiAgdGhpcy5fZ2V0V3JhcFNoaWZ0Q2VsbHMoKTtcbiAgdGhpcy5zZXRHYWxsZXJ5U2l6ZSgpO1xuICB0aGlzLmVtaXRFdmVudCggJ2NlbGxDaGFuZ2UnLCBbIGNoYW5nZWRDZWxsSW5kZXggXSApO1xuICAvLyBwb3NpdGlvbiBzbGlkZXJcbiAgaWYgKCB0aGlzLm9wdGlvbnMuZnJlZVNjcm9sbCApIHtcbiAgICAvLyBzaGlmdCB4IGJ5IGNoYW5nZSBpbiBzbGlkZWFibGVXaWR0aFxuICAgIC8vIFRPRE8gZml4IHBvc2l0aW9uIHNoaWZ0cyB3aGVuIHByZXBlbmRpbmcgdy8gZnJlZVNjcm9sbFxuICAgIHZhciBkZWx0YVggPSBwcmV2U2xpZGVhYmxlV2lkdGggLSB0aGlzLnNsaWRlYWJsZVdpZHRoO1xuICAgIHRoaXMueCArPSBkZWx0YVggKiB0aGlzLmNlbGxBbGlnbjtcbiAgICB0aGlzLnBvc2l0aW9uU2xpZGVyKCk7XG4gIH0gZWxzZSB7XG4gICAgLy8gZG8gbm90IHBvc2l0aW9uIHNsaWRlciBhZnRlciBsYXp5IGxvYWRcbiAgICBpZiAoIGlzUG9zaXRpb25pbmdTbGlkZXIgKSB7XG4gICAgICB0aGlzLnBvc2l0aW9uU2xpZGVyQXRTZWxlY3RlZCgpO1xuICAgIH1cbiAgICB0aGlzLnNlbGVjdCggdGhpcy5zZWxlY3RlZEluZGV4ICk7XG4gIH1cbn07XG5cbi8vIC0tLS0tICAtLS0tLSAvL1xuXG5yZXR1cm4gRmxpY2tpdHk7XG5cbn0pKTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2ZsaWNraXR5L2pzL2FkZC1yZW1vdmUtY2VsbC5qc1xuICoqIG1vZHVsZSBpZCA9IDE5XG4gKiogbW9kdWxlIGNodW5rcyA9IDAgMVxuICoqLyIsIi8vIGxhenlsb2FkXG4oIGZ1bmN0aW9uKCB3aW5kb3csIGZhY3RvcnkgKSB7XG4gIC8vIHVuaXZlcnNhbCBtb2R1bGUgZGVmaW5pdGlvblxuICAvKiBqc2hpbnQgc3RyaWN0OiBmYWxzZSAqL1xuICBpZiAoIHR5cGVvZiBkZWZpbmUgPT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kICkge1xuICAgIC8vIEFNRFxuICAgIGRlZmluZSggW1xuICAgICAgJy4vZmxpY2tpdHknLFxuICAgICAgJ2Zpenp5LXVpLXV0aWxzL3V0aWxzJ1xuICAgIF0sIGZ1bmN0aW9uKCBGbGlja2l0eSwgdXRpbHMgKSB7XG4gICAgICByZXR1cm4gZmFjdG9yeSggd2luZG93LCBGbGlja2l0eSwgdXRpbHMgKTtcbiAgICB9KTtcbiAgfSBlbHNlIGlmICggdHlwZW9mIG1vZHVsZSA9PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cyApIHtcbiAgICAvLyBDb21tb25KU1xuICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShcbiAgICAgIHdpbmRvdyxcbiAgICAgIHJlcXVpcmUoJy4vZmxpY2tpdHknKSxcbiAgICAgIHJlcXVpcmUoJ2Zpenp5LXVpLXV0aWxzJylcbiAgICApO1xuICB9IGVsc2Uge1xuICAgIC8vIGJyb3dzZXIgZ2xvYmFsXG4gICAgZmFjdG9yeShcbiAgICAgIHdpbmRvdyxcbiAgICAgIHdpbmRvdy5GbGlja2l0eSxcbiAgICAgIHdpbmRvdy5maXp6eVVJVXRpbHNcbiAgICApO1xuICB9XG5cbn0oIHdpbmRvdywgZnVuY3Rpb24gZmFjdG9yeSggd2luZG93LCBGbGlja2l0eSwgdXRpbHMgKSB7XG4ndXNlIHN0cmljdCc7XG5cbkZsaWNraXR5LmNyZWF0ZU1ldGhvZHMucHVzaCgnX2NyZWF0ZUxhenlsb2FkJyk7XG52YXIgcHJvdG8gPSBGbGlja2l0eS5wcm90b3R5cGU7XG5cbnByb3RvLl9jcmVhdGVMYXp5bG9hZCA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLm9uKCAnc2VsZWN0JywgdGhpcy5sYXp5TG9hZCApO1xufTtcblxucHJvdG8ubGF6eUxvYWQgPSBmdW5jdGlvbigpIHtcbiAgdmFyIGxhenlMb2FkID0gdGhpcy5vcHRpb25zLmxhenlMb2FkO1xuICBpZiAoICFsYXp5TG9hZCApIHtcbiAgICByZXR1cm47XG4gIH1cbiAgLy8gZ2V0IGFkamFjZW50IGNlbGxzLCB1c2UgbGF6eUxvYWQgb3B0aW9uIGZvciBhZGphY2VudCBjb3VudFxuICB2YXIgYWRqQ291bnQgPSB0eXBlb2YgbGF6eUxvYWQgPT0gJ251bWJlcicgPyBsYXp5TG9hZCA6IDA7XG4gIHZhciBjZWxsRWxlbXMgPSB0aGlzLmdldEFkamFjZW50Q2VsbEVsZW1lbnRzKCBhZGpDb3VudCApO1xuICAvLyBnZXQgbGF6eSBpbWFnZXMgaW4gdGhvc2UgY2VsbHNcbiAgdmFyIGxhenlJbWFnZXMgPSBbXTtcbiAgY2VsbEVsZW1zLmZvckVhY2goIGZ1bmN0aW9uKCBjZWxsRWxlbSApIHtcbiAgICB2YXIgbGF6eUNlbGxJbWFnZXMgPSBnZXRDZWxsTGF6eUltYWdlcyggY2VsbEVsZW0gKTtcbiAgICBsYXp5SW1hZ2VzID0gbGF6eUltYWdlcy5jb25jYXQoIGxhenlDZWxsSW1hZ2VzICk7XG4gIH0pO1xuICAvLyBsb2FkIGxhenkgaW1hZ2VzXG4gIGxhenlJbWFnZXMuZm9yRWFjaCggZnVuY3Rpb24oIGltZyApIHtcbiAgICBuZXcgTGF6eUxvYWRlciggaW1nLCB0aGlzICk7XG4gIH0sIHRoaXMgKTtcbn07XG5cbmZ1bmN0aW9uIGdldENlbGxMYXp5SW1hZ2VzKCBjZWxsRWxlbSApIHtcbiAgLy8gY2hlY2sgaWYgY2VsbCBlbGVtZW50IGlzIGxhenkgaW1hZ2VcbiAgaWYgKCBjZWxsRWxlbS5ub2RlTmFtZSA9PSAnSU1HJyAmJlxuICAgIGNlbGxFbGVtLmdldEF0dHJpYnV0ZSgnZGF0YS1mbGlja2l0eS1sYXp5bG9hZCcpICkge1xuICAgIHJldHVybiBbIGNlbGxFbGVtIF07XG4gIH1cbiAgLy8gc2VsZWN0IGxhenkgaW1hZ2VzIGluIGNlbGxcbiAgdmFyIGltZ3MgPSBjZWxsRWxlbS5xdWVyeVNlbGVjdG9yQWxsKCdpbWdbZGF0YS1mbGlja2l0eS1sYXp5bG9hZF0nKTtcbiAgcmV0dXJuIHV0aWxzLm1ha2VBcnJheSggaW1ncyApO1xufVxuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBMYXp5TG9hZGVyIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vXG5cbi8qKlxuICogY2xhc3MgdG8gaGFuZGxlIGxvYWRpbmcgaW1hZ2VzXG4gKi9cbmZ1bmN0aW9uIExhenlMb2FkZXIoIGltZywgZmxpY2tpdHkgKSB7XG4gIHRoaXMuaW1nID0gaW1nO1xuICB0aGlzLmZsaWNraXR5ID0gZmxpY2tpdHk7XG4gIHRoaXMubG9hZCgpO1xufVxuXG5MYXp5TG9hZGVyLnByb3RvdHlwZS5oYW5kbGVFdmVudCA9IHV0aWxzLmhhbmRsZUV2ZW50O1xuXG5MYXp5TG9hZGVyLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuaW1nLmFkZEV2ZW50TGlzdGVuZXIoICdsb2FkJywgdGhpcyApO1xuICB0aGlzLmltZy5hZGRFdmVudExpc3RlbmVyKCAnZXJyb3InLCB0aGlzICk7XG4gIC8vIGxvYWQgaW1hZ2VcbiAgdGhpcy5pbWcuc3JjID0gdGhpcy5pbWcuZ2V0QXR0cmlidXRlKCdkYXRhLWZsaWNraXR5LWxhenlsb2FkJyk7XG4gIC8vIHJlbW92ZSBhdHRyXG4gIHRoaXMuaW1nLnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS1mbGlja2l0eS1sYXp5bG9hZCcpO1xufTtcblxuTGF6eUxvYWRlci5wcm90b3R5cGUub25sb2FkID0gZnVuY3Rpb24oIGV2ZW50ICkge1xuICB0aGlzLmNvbXBsZXRlKCBldmVudCwgJ2ZsaWNraXR5LWxhenlsb2FkZWQnICk7XG59O1xuXG5MYXp5TG9hZGVyLnByb3RvdHlwZS5vbmVycm9yID0gZnVuY3Rpb24oIGV2ZW50ICkge1xuICB0aGlzLmNvbXBsZXRlKCBldmVudCwgJ2ZsaWNraXR5LWxhenllcnJvcicgKTtcbn07XG5cbkxhenlMb2FkZXIucHJvdG90eXBlLmNvbXBsZXRlID0gZnVuY3Rpb24oIGV2ZW50LCBjbGFzc05hbWUgKSB7XG4gIC8vIHVuYmluZCBldmVudHNcbiAgdGhpcy5pbWcucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ2xvYWQnLCB0aGlzICk7XG4gIHRoaXMuaW1nLnJlbW92ZUV2ZW50TGlzdGVuZXIoICdlcnJvcicsIHRoaXMgKTtcblxuICB2YXIgY2VsbCA9IHRoaXMuZmxpY2tpdHkuZ2V0UGFyZW50Q2VsbCggdGhpcy5pbWcgKTtcbiAgdmFyIGNlbGxFbGVtID0gY2VsbCAmJiBjZWxsLmVsZW1lbnQ7XG4gIHRoaXMuZmxpY2tpdHkuY2VsbFNpemVDaGFuZ2UoIGNlbGxFbGVtICk7XG5cbiAgdGhpcy5pbWcuY2xhc3NMaXN0LmFkZCggY2xhc3NOYW1lICk7XG4gIHRoaXMuZmxpY2tpdHkuZGlzcGF0Y2hFdmVudCggJ2xhenlMb2FkJywgZXZlbnQsIGNlbGxFbGVtICk7XG59O1xuXG4vLyAtLS0tLSAgLS0tLS0gLy9cblxuRmxpY2tpdHkuTGF6eUxvYWRlciA9IExhenlMb2FkZXI7XG5cbnJldHVybiBGbGlja2l0eTtcblxufSkpO1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vZmxpY2tpdHkvanMvbGF6eWxvYWQuanNcbiAqKiBtb2R1bGUgaWQgPSAyMFxuICoqIG1vZHVsZSBjaHVua3MgPSAwIDFcbiAqKi8iLCIvKiFcbiAqIGltYWdlc0xvYWRlZCB2NC4xLjFcbiAqIEphdmFTY3JpcHQgaXMgYWxsIGxpa2UgXCJZb3UgaW1hZ2VzIGFyZSBkb25lIHlldCBvciB3aGF0P1wiXG4gKiBNSVQgTGljZW5zZVxuICovXG5cbiggZnVuY3Rpb24oIHdpbmRvdywgZmFjdG9yeSApIHsgJ3VzZSBzdHJpY3QnO1xuICAvLyB1bml2ZXJzYWwgbW9kdWxlIGRlZmluaXRpb25cblxuICAvKmdsb2JhbCBkZWZpbmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlLCByZXF1aXJlOiBmYWxzZSAqL1xuXG4gIGlmICggdHlwZW9mIGRlZmluZSA9PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgKSB7XG4gICAgLy8gQU1EXG4gICAgZGVmaW5lKCBbXG4gICAgICAnZXYtZW1pdHRlci9ldi1lbWl0dGVyJ1xuICAgIF0sIGZ1bmN0aW9uKCBFdkVtaXR0ZXIgKSB7XG4gICAgICByZXR1cm4gZmFjdG9yeSggd2luZG93LCBFdkVtaXR0ZXIgKTtcbiAgICB9KTtcbiAgfSBlbHNlIGlmICggdHlwZW9mIG1vZHVsZSA9PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cyApIHtcbiAgICAvLyBDb21tb25KU1xuICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShcbiAgICAgIHdpbmRvdyxcbiAgICAgIHJlcXVpcmUoJ2V2LWVtaXR0ZXInKVxuICAgICk7XG4gIH0gZWxzZSB7XG4gICAgLy8gYnJvd3NlciBnbG9iYWxcbiAgICB3aW5kb3cuaW1hZ2VzTG9hZGVkID0gZmFjdG9yeShcbiAgICAgIHdpbmRvdyxcbiAgICAgIHdpbmRvdy5FdkVtaXR0ZXJcbiAgICApO1xuICB9XG5cbn0pKCB3aW5kb3csXG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICBmYWN0b3J5IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vXG5cbmZ1bmN0aW9uIGZhY3RvcnkoIHdpbmRvdywgRXZFbWl0dGVyICkge1xuXG4ndXNlIHN0cmljdCc7XG5cbnZhciAkID0gd2luZG93LmpRdWVyeTtcbnZhciBjb25zb2xlID0gd2luZG93LmNvbnNvbGU7XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIGhlbHBlcnMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cblxuLy8gZXh0ZW5kIG9iamVjdHNcbmZ1bmN0aW9uIGV4dGVuZCggYSwgYiApIHtcbiAgZm9yICggdmFyIHByb3AgaW4gYiApIHtcbiAgICBhWyBwcm9wIF0gPSBiWyBwcm9wIF07XG4gIH1cbiAgcmV0dXJuIGE7XG59XG5cbi8vIHR1cm4gZWxlbWVudCBvciBub2RlTGlzdCBpbnRvIGFuIGFycmF5XG5mdW5jdGlvbiBtYWtlQXJyYXkoIG9iaiApIHtcbiAgdmFyIGFyeSA9IFtdO1xuICBpZiAoIEFycmF5LmlzQXJyYXkoIG9iaiApICkge1xuICAgIC8vIHVzZSBvYmplY3QgaWYgYWxyZWFkeSBhbiBhcnJheVxuICAgIGFyeSA9IG9iajtcbiAgfSBlbHNlIGlmICggdHlwZW9mIG9iai5sZW5ndGggPT0gJ251bWJlcicgKSB7XG4gICAgLy8gY29udmVydCBub2RlTGlzdCB0byBhcnJheVxuICAgIGZvciAoIHZhciBpPTA7IGkgPCBvYmoubGVuZ3RoOyBpKysgKSB7XG4gICAgICBhcnkucHVzaCggb2JqW2ldICk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIC8vIGFycmF5IG9mIHNpbmdsZSBpbmRleFxuICAgIGFyeS5wdXNoKCBvYmogKTtcbiAgfVxuICByZXR1cm4gYXJ5O1xufVxuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBpbWFnZXNMb2FkZWQgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cblxuLyoqXG4gKiBAcGFyYW0ge0FycmF5LCBFbGVtZW50LCBOb2RlTGlzdCwgU3RyaW5nfSBlbGVtXG4gKiBAcGFyYW0ge09iamVjdCBvciBGdW5jdGlvbn0gb3B0aW9ucyAtIGlmIGZ1bmN0aW9uLCB1c2UgYXMgY2FsbGJhY2tcbiAqIEBwYXJhbSB7RnVuY3Rpb259IG9uQWx3YXlzIC0gY2FsbGJhY2sgZnVuY3Rpb25cbiAqL1xuZnVuY3Rpb24gSW1hZ2VzTG9hZGVkKCBlbGVtLCBvcHRpb25zLCBvbkFsd2F5cyApIHtcbiAgLy8gY29lcmNlIEltYWdlc0xvYWRlZCgpIHdpdGhvdXQgbmV3LCB0byBiZSBuZXcgSW1hZ2VzTG9hZGVkKClcbiAgaWYgKCAhKCB0aGlzIGluc3RhbmNlb2YgSW1hZ2VzTG9hZGVkICkgKSB7XG4gICAgcmV0dXJuIG5ldyBJbWFnZXNMb2FkZWQoIGVsZW0sIG9wdGlvbnMsIG9uQWx3YXlzICk7XG4gIH1cbiAgLy8gdXNlIGVsZW0gYXMgc2VsZWN0b3Igc3RyaW5nXG4gIGlmICggdHlwZW9mIGVsZW0gPT0gJ3N0cmluZycgKSB7XG4gICAgZWxlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoIGVsZW0gKTtcbiAgfVxuXG4gIHRoaXMuZWxlbWVudHMgPSBtYWtlQXJyYXkoIGVsZW0gKTtcbiAgdGhpcy5vcHRpb25zID0gZXh0ZW5kKCB7fSwgdGhpcy5vcHRpb25zICk7XG5cbiAgaWYgKCB0eXBlb2Ygb3B0aW9ucyA9PSAnZnVuY3Rpb24nICkge1xuICAgIG9uQWx3YXlzID0gb3B0aW9ucztcbiAgfSBlbHNlIHtcbiAgICBleHRlbmQoIHRoaXMub3B0aW9ucywgb3B0aW9ucyApO1xuICB9XG5cbiAgaWYgKCBvbkFsd2F5cyApIHtcbiAgICB0aGlzLm9uKCAnYWx3YXlzJywgb25BbHdheXMgKTtcbiAgfVxuXG4gIHRoaXMuZ2V0SW1hZ2VzKCk7XG5cbiAgaWYgKCAkICkge1xuICAgIC8vIGFkZCBqUXVlcnkgRGVmZXJyZWQgb2JqZWN0XG4gICAgdGhpcy5qcURlZmVycmVkID0gbmV3ICQuRGVmZXJyZWQoKTtcbiAgfVxuXG4gIC8vIEhBQ0sgY2hlY2sgYXN5bmMgdG8gYWxsb3cgdGltZSB0byBiaW5kIGxpc3RlbmVyc1xuICBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmNoZWNrKCk7XG4gIH0uYmluZCggdGhpcyApKTtcbn1cblxuSW1hZ2VzTG9hZGVkLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoIEV2RW1pdHRlci5wcm90b3R5cGUgKTtcblxuSW1hZ2VzTG9hZGVkLnByb3RvdHlwZS5vcHRpb25zID0ge307XG5cbkltYWdlc0xvYWRlZC5wcm90b3R5cGUuZ2V0SW1hZ2VzID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuaW1hZ2VzID0gW107XG5cbiAgLy8gZmlsdGVyICYgZmluZCBpdGVtcyBpZiB3ZSBoYXZlIGFuIGl0ZW0gc2VsZWN0b3JcbiAgdGhpcy5lbGVtZW50cy5mb3JFYWNoKCB0aGlzLmFkZEVsZW1lbnRJbWFnZXMsIHRoaXMgKTtcbn07XG5cbi8qKlxuICogQHBhcmFtIHtOb2RlfSBlbGVtZW50XG4gKi9cbkltYWdlc0xvYWRlZC5wcm90b3R5cGUuYWRkRWxlbWVudEltYWdlcyA9IGZ1bmN0aW9uKCBlbGVtICkge1xuICAvLyBmaWx0ZXIgc2libGluZ3NcbiAgaWYgKCBlbGVtLm5vZGVOYW1lID09ICdJTUcnICkge1xuICAgIHRoaXMuYWRkSW1hZ2UoIGVsZW0gKTtcbiAgfVxuICAvLyBnZXQgYmFja2dyb3VuZCBpbWFnZSBvbiBlbGVtZW50XG4gIGlmICggdGhpcy5vcHRpb25zLmJhY2tncm91bmQgPT09IHRydWUgKSB7XG4gICAgdGhpcy5hZGRFbGVtZW50QmFja2dyb3VuZEltYWdlcyggZWxlbSApO1xuICB9XG5cbiAgLy8gZmluZCBjaGlsZHJlblxuICAvLyBubyBub24tZWxlbWVudCBub2RlcywgIzE0M1xuICB2YXIgbm9kZVR5cGUgPSBlbGVtLm5vZGVUeXBlO1xuICBpZiAoICFub2RlVHlwZSB8fCAhZWxlbWVudE5vZGVUeXBlc1sgbm9kZVR5cGUgXSApIHtcbiAgICByZXR1cm47XG4gIH1cbiAgdmFyIGNoaWxkSW1ncyA9IGVsZW0ucXVlcnlTZWxlY3RvckFsbCgnaW1nJyk7XG4gIC8vIGNvbmNhdCBjaGlsZEVsZW1zIHRvIGZpbHRlckZvdW5kIGFycmF5XG4gIGZvciAoIHZhciBpPTA7IGkgPCBjaGlsZEltZ3MubGVuZ3RoOyBpKysgKSB7XG4gICAgdmFyIGltZyA9IGNoaWxkSW1nc1tpXTtcbiAgICB0aGlzLmFkZEltYWdlKCBpbWcgKTtcbiAgfVxuXG4gIC8vIGdldCBjaGlsZCBiYWNrZ3JvdW5kIGltYWdlc1xuICBpZiAoIHR5cGVvZiB0aGlzLm9wdGlvbnMuYmFja2dyb3VuZCA9PSAnc3RyaW5nJyApIHtcbiAgICB2YXIgY2hpbGRyZW4gPSBlbGVtLnF1ZXJ5U2VsZWN0b3JBbGwoIHRoaXMub3B0aW9ucy5iYWNrZ3JvdW5kICk7XG4gICAgZm9yICggaT0wOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyBpKysgKSB7XG4gICAgICB2YXIgY2hpbGQgPSBjaGlsZHJlbltpXTtcbiAgICAgIHRoaXMuYWRkRWxlbWVudEJhY2tncm91bmRJbWFnZXMoIGNoaWxkICk7XG4gICAgfVxuICB9XG59O1xuXG52YXIgZWxlbWVudE5vZGVUeXBlcyA9IHtcbiAgMTogdHJ1ZSxcbiAgOTogdHJ1ZSxcbiAgMTE6IHRydWVcbn07XG5cbkltYWdlc0xvYWRlZC5wcm90b3R5cGUuYWRkRWxlbWVudEJhY2tncm91bmRJbWFnZXMgPSBmdW5jdGlvbiggZWxlbSApIHtcbiAgdmFyIHN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZSggZWxlbSApO1xuICBpZiAoICFzdHlsZSApIHtcbiAgICAvLyBGaXJlZm94IHJldHVybnMgbnVsbCBpZiBpbiBhIGhpZGRlbiBpZnJhbWUgaHR0cHM6Ly9idWd6aWwubGEvNTQ4Mzk3XG4gICAgcmV0dXJuO1xuICB9XG4gIC8vIGdldCB1cmwgaW5zaWRlIHVybChcIi4uLlwiKVxuICB2YXIgcmVVUkwgPSAvdXJsXFwoKFsnXCJdKT8oLio/KVxcMVxcKS9naTtcbiAgdmFyIG1hdGNoZXMgPSByZVVSTC5leGVjKCBzdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgKTtcbiAgd2hpbGUgKCBtYXRjaGVzICE9PSBudWxsICkge1xuICAgIHZhciB1cmwgPSBtYXRjaGVzICYmIG1hdGNoZXNbMl07XG4gICAgaWYgKCB1cmwgKSB7XG4gICAgICB0aGlzLmFkZEJhY2tncm91bmQoIHVybCwgZWxlbSApO1xuICAgIH1cbiAgICBtYXRjaGVzID0gcmVVUkwuZXhlYyggc3R5bGUuYmFja2dyb3VuZEltYWdlICk7XG4gIH1cbn07XG5cbi8qKlxuICogQHBhcmFtIHtJbWFnZX0gaW1nXG4gKi9cbkltYWdlc0xvYWRlZC5wcm90b3R5cGUuYWRkSW1hZ2UgPSBmdW5jdGlvbiggaW1nICkge1xuICB2YXIgbG9hZGluZ0ltYWdlID0gbmV3IExvYWRpbmdJbWFnZSggaW1nICk7XG4gIHRoaXMuaW1hZ2VzLnB1c2goIGxvYWRpbmdJbWFnZSApO1xufTtcblxuSW1hZ2VzTG9hZGVkLnByb3RvdHlwZS5hZGRCYWNrZ3JvdW5kID0gZnVuY3Rpb24oIHVybCwgZWxlbSApIHtcbiAgdmFyIGJhY2tncm91bmQgPSBuZXcgQmFja2dyb3VuZCggdXJsLCBlbGVtICk7XG4gIHRoaXMuaW1hZ2VzLnB1c2goIGJhY2tncm91bmQgKTtcbn07XG5cbkltYWdlc0xvYWRlZC5wcm90b3R5cGUuY2hlY2sgPSBmdW5jdGlvbigpIHtcbiAgdmFyIF90aGlzID0gdGhpcztcbiAgdGhpcy5wcm9ncmVzc2VkQ291bnQgPSAwO1xuICB0aGlzLmhhc0FueUJyb2tlbiA9IGZhbHNlO1xuICAvLyBjb21wbGV0ZSBpZiBubyBpbWFnZXNcbiAgaWYgKCAhdGhpcy5pbWFnZXMubGVuZ3RoICkge1xuICAgIHRoaXMuY29tcGxldGUoKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBmdW5jdGlvbiBvblByb2dyZXNzKCBpbWFnZSwgZWxlbSwgbWVzc2FnZSApIHtcbiAgICAvLyBIQUNLIC0gQ2hyb21lIHRyaWdnZXJzIGV2ZW50IGJlZm9yZSBvYmplY3QgcHJvcGVydGllcyBoYXZlIGNoYW5nZWQuICM4M1xuICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuICAgICAgX3RoaXMucHJvZ3Jlc3MoIGltYWdlLCBlbGVtLCBtZXNzYWdlICk7XG4gICAgfSk7XG4gIH1cblxuICB0aGlzLmltYWdlcy5mb3JFYWNoKCBmdW5jdGlvbiggbG9hZGluZ0ltYWdlICkge1xuICAgIGxvYWRpbmdJbWFnZS5vbmNlKCAncHJvZ3Jlc3MnLCBvblByb2dyZXNzICk7XG4gICAgbG9hZGluZ0ltYWdlLmNoZWNrKCk7XG4gIH0pO1xufTtcblxuSW1hZ2VzTG9hZGVkLnByb3RvdHlwZS5wcm9ncmVzcyA9IGZ1bmN0aW9uKCBpbWFnZSwgZWxlbSwgbWVzc2FnZSApIHtcbiAgdGhpcy5wcm9ncmVzc2VkQ291bnQrKztcbiAgdGhpcy5oYXNBbnlCcm9rZW4gPSB0aGlzLmhhc0FueUJyb2tlbiB8fCAhaW1hZ2UuaXNMb2FkZWQ7XG4gIC8vIHByb2dyZXNzIGV2ZW50XG4gIHRoaXMuZW1pdEV2ZW50KCAncHJvZ3Jlc3MnLCBbIHRoaXMsIGltYWdlLCBlbGVtIF0gKTtcbiAgaWYgKCB0aGlzLmpxRGVmZXJyZWQgJiYgdGhpcy5qcURlZmVycmVkLm5vdGlmeSApIHtcbiAgICB0aGlzLmpxRGVmZXJyZWQubm90aWZ5KCB0aGlzLCBpbWFnZSApO1xuICB9XG4gIC8vIGNoZWNrIGlmIGNvbXBsZXRlZFxuICBpZiAoIHRoaXMucHJvZ3Jlc3NlZENvdW50ID09IHRoaXMuaW1hZ2VzLmxlbmd0aCApIHtcbiAgICB0aGlzLmNvbXBsZXRlKCk7XG4gIH1cblxuICBpZiAoIHRoaXMub3B0aW9ucy5kZWJ1ZyAmJiBjb25zb2xlICkge1xuICAgIGNvbnNvbGUubG9nKCAncHJvZ3Jlc3M6ICcgKyBtZXNzYWdlLCBpbWFnZSwgZWxlbSApO1xuICB9XG59O1xuXG5JbWFnZXNMb2FkZWQucHJvdG90eXBlLmNvbXBsZXRlID0gZnVuY3Rpb24oKSB7XG4gIHZhciBldmVudE5hbWUgPSB0aGlzLmhhc0FueUJyb2tlbiA/ICdmYWlsJyA6ICdkb25lJztcbiAgdGhpcy5pc0NvbXBsZXRlID0gdHJ1ZTtcbiAgdGhpcy5lbWl0RXZlbnQoIGV2ZW50TmFtZSwgWyB0aGlzIF0gKTtcbiAgdGhpcy5lbWl0RXZlbnQoICdhbHdheXMnLCBbIHRoaXMgXSApO1xuICBpZiAoIHRoaXMuanFEZWZlcnJlZCApIHtcbiAgICB2YXIganFNZXRob2QgPSB0aGlzLmhhc0FueUJyb2tlbiA/ICdyZWplY3QnIDogJ3Jlc29sdmUnO1xuICAgIHRoaXMuanFEZWZlcnJlZFsganFNZXRob2QgXSggdGhpcyApO1xuICB9XG59O1xuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cblxuZnVuY3Rpb24gTG9hZGluZ0ltYWdlKCBpbWcgKSB7XG4gIHRoaXMuaW1nID0gaW1nO1xufVxuXG5Mb2FkaW5nSW1hZ2UucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZSggRXZFbWl0dGVyLnByb3RvdHlwZSApO1xuXG5Mb2FkaW5nSW1hZ2UucHJvdG90eXBlLmNoZWNrID0gZnVuY3Rpb24oKSB7XG4gIC8vIElmIGNvbXBsZXRlIGlzIHRydWUgYW5kIGJyb3dzZXIgc3VwcG9ydHMgbmF0dXJhbCBzaXplcyxcbiAgLy8gdHJ5IHRvIGNoZWNrIGZvciBpbWFnZSBzdGF0dXMgbWFudWFsbHkuXG4gIHZhciBpc0NvbXBsZXRlID0gdGhpcy5nZXRJc0ltYWdlQ29tcGxldGUoKTtcbiAgaWYgKCBpc0NvbXBsZXRlICkge1xuICAgIC8vIHJlcG9ydCBiYXNlZCBvbiBuYXR1cmFsV2lkdGhcbiAgICB0aGlzLmNvbmZpcm0oIHRoaXMuaW1nLm5hdHVyYWxXaWR0aCAhPT0gMCwgJ25hdHVyYWxXaWR0aCcgKTtcbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBJZiBub25lIG9mIHRoZSBjaGVja3MgYWJvdmUgbWF0Y2hlZCwgc2ltdWxhdGUgbG9hZGluZyBvbiBkZXRhY2hlZCBlbGVtZW50LlxuICB0aGlzLnByb3h5SW1hZ2UgPSBuZXcgSW1hZ2UoKTtcbiAgdGhpcy5wcm94eUltYWdlLmFkZEV2ZW50TGlzdGVuZXIoICdsb2FkJywgdGhpcyApO1xuICB0aGlzLnByb3h5SW1hZ2UuYWRkRXZlbnRMaXN0ZW5lciggJ2Vycm9yJywgdGhpcyApO1xuICAvLyBiaW5kIHRvIGltYWdlIGFzIHdlbGwgZm9yIEZpcmVmb3guICMxOTFcbiAgdGhpcy5pbWcuYWRkRXZlbnRMaXN0ZW5lciggJ2xvYWQnLCB0aGlzICk7XG4gIHRoaXMuaW1nLmFkZEV2ZW50TGlzdGVuZXIoICdlcnJvcicsIHRoaXMgKTtcbiAgdGhpcy5wcm94eUltYWdlLnNyYyA9IHRoaXMuaW1nLnNyYztcbn07XG5cbkxvYWRpbmdJbWFnZS5wcm90b3R5cGUuZ2V0SXNJbWFnZUNvbXBsZXRlID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzLmltZy5jb21wbGV0ZSAmJiB0aGlzLmltZy5uYXR1cmFsV2lkdGggIT09IHVuZGVmaW5lZDtcbn07XG5cbkxvYWRpbmdJbWFnZS5wcm90b3R5cGUuY29uZmlybSA9IGZ1bmN0aW9uKCBpc0xvYWRlZCwgbWVzc2FnZSApIHtcbiAgdGhpcy5pc0xvYWRlZCA9IGlzTG9hZGVkO1xuICB0aGlzLmVtaXRFdmVudCggJ3Byb2dyZXNzJywgWyB0aGlzLCB0aGlzLmltZywgbWVzc2FnZSBdICk7XG59O1xuXG4vLyAtLS0tLSBldmVudHMgLS0tLS0gLy9cblxuLy8gdHJpZ2dlciBzcGVjaWZpZWQgaGFuZGxlciBmb3IgZXZlbnQgdHlwZVxuTG9hZGluZ0ltYWdlLnByb3RvdHlwZS5oYW5kbGVFdmVudCA9IGZ1bmN0aW9uKCBldmVudCApIHtcbiAgdmFyIG1ldGhvZCA9ICdvbicgKyBldmVudC50eXBlO1xuICBpZiAoIHRoaXNbIG1ldGhvZCBdICkge1xuICAgIHRoaXNbIG1ldGhvZCBdKCBldmVudCApO1xuICB9XG59O1xuXG5Mb2FkaW5nSW1hZ2UucHJvdG90eXBlLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLmNvbmZpcm0oIHRydWUsICdvbmxvYWQnICk7XG4gIHRoaXMudW5iaW5kRXZlbnRzKCk7XG59O1xuXG5Mb2FkaW5nSW1hZ2UucHJvdG90eXBlLm9uZXJyb3IgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5jb25maXJtKCBmYWxzZSwgJ29uZXJyb3InICk7XG4gIHRoaXMudW5iaW5kRXZlbnRzKCk7XG59O1xuXG5Mb2FkaW5nSW1hZ2UucHJvdG90eXBlLnVuYmluZEV2ZW50cyA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLnByb3h5SW1hZ2UucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ2xvYWQnLCB0aGlzICk7XG4gIHRoaXMucHJveHlJbWFnZS5yZW1vdmVFdmVudExpc3RlbmVyKCAnZXJyb3InLCB0aGlzICk7XG4gIHRoaXMuaW1nLnJlbW92ZUV2ZW50TGlzdGVuZXIoICdsb2FkJywgdGhpcyApO1xuICB0aGlzLmltZy5yZW1vdmVFdmVudExpc3RlbmVyKCAnZXJyb3InLCB0aGlzICk7XG59O1xuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBCYWNrZ3JvdW5kIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vXG5cbmZ1bmN0aW9uIEJhY2tncm91bmQoIHVybCwgZWxlbWVudCApIHtcbiAgdGhpcy51cmwgPSB1cmw7XG4gIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gIHRoaXMuaW1nID0gbmV3IEltYWdlKCk7XG59XG5cbi8vIGluaGVyaXQgTG9hZGluZ0ltYWdlIHByb3RvdHlwZVxuQmFja2dyb3VuZC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKCBMb2FkaW5nSW1hZ2UucHJvdG90eXBlICk7XG5cbkJhY2tncm91bmQucHJvdG90eXBlLmNoZWNrID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuaW1nLmFkZEV2ZW50TGlzdGVuZXIoICdsb2FkJywgdGhpcyApO1xuICB0aGlzLmltZy5hZGRFdmVudExpc3RlbmVyKCAnZXJyb3InLCB0aGlzICk7XG4gIHRoaXMuaW1nLnNyYyA9IHRoaXMudXJsO1xuICAvLyBjaGVjayBpZiBpbWFnZSBpcyBhbHJlYWR5IGNvbXBsZXRlXG4gIHZhciBpc0NvbXBsZXRlID0gdGhpcy5nZXRJc0ltYWdlQ29tcGxldGUoKTtcbiAgaWYgKCBpc0NvbXBsZXRlICkge1xuICAgIHRoaXMuY29uZmlybSggdGhpcy5pbWcubmF0dXJhbFdpZHRoICE9PSAwLCAnbmF0dXJhbFdpZHRoJyApO1xuICAgIHRoaXMudW5iaW5kRXZlbnRzKCk7XG4gIH1cbn07XG5cbkJhY2tncm91bmQucHJvdG90eXBlLnVuYmluZEV2ZW50cyA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLmltZy5yZW1vdmVFdmVudExpc3RlbmVyKCAnbG9hZCcsIHRoaXMgKTtcbiAgdGhpcy5pbWcucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ2Vycm9yJywgdGhpcyApO1xufTtcblxuQmFja2dyb3VuZC5wcm90b3R5cGUuY29uZmlybSA9IGZ1bmN0aW9uKCBpc0xvYWRlZCwgbWVzc2FnZSApIHtcbiAgdGhpcy5pc0xvYWRlZCA9IGlzTG9hZGVkO1xuICB0aGlzLmVtaXRFdmVudCggJ3Byb2dyZXNzJywgWyB0aGlzLCB0aGlzLmVsZW1lbnQsIG1lc3NhZ2UgXSApO1xufTtcblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0galF1ZXJ5IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vXG5cbkltYWdlc0xvYWRlZC5tYWtlSlF1ZXJ5UGx1Z2luID0gZnVuY3Rpb24oIGpRdWVyeSApIHtcbiAgalF1ZXJ5ID0galF1ZXJ5IHx8IHdpbmRvdy5qUXVlcnk7XG4gIGlmICggIWpRdWVyeSApIHtcbiAgICByZXR1cm47XG4gIH1cbiAgLy8gc2V0IGxvY2FsIHZhcmlhYmxlXG4gICQgPSBqUXVlcnk7XG4gIC8vICQoKS5pbWFnZXNMb2FkZWQoKVxuICAkLmZuLmltYWdlc0xvYWRlZCA9IGZ1bmN0aW9uKCBvcHRpb25zLCBjYWxsYmFjayApIHtcbiAgICB2YXIgaW5zdGFuY2UgPSBuZXcgSW1hZ2VzTG9hZGVkKCB0aGlzLCBvcHRpb25zLCBjYWxsYmFjayApO1xuICAgIHJldHVybiBpbnN0YW5jZS5qcURlZmVycmVkLnByb21pc2UoICQodGhpcykgKTtcbiAgfTtcbn07XG4vLyB0cnkgbWFraW5nIHBsdWdpblxuSW1hZ2VzTG9hZGVkLm1ha2VKUXVlcnlQbHVnaW4oKTtcblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vXG5cbnJldHVybiBJbWFnZXNMb2FkZWQ7XG5cbn0pO1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vaW1hZ2VzTG9hZGVkL2ltYWdlc2xvYWRlZC5qc1xuICoqIG1vZHVsZSBpZCA9IDIxXG4gKiogbW9kdWxlIGNodW5rcyA9IDAgMVxuICoqLyIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5GbGlja2l0eURpcmVjdGl2ZSA9IEZsaWNraXR5RGlyZWN0aXZlO1xuXG52YXIgX2ZsaWNraXR5ID0gcmVxdWlyZSgnLi9mbGlja2l0eS5jb250cm9sbGVyJyk7XG5cbmZ1bmN0aW9uIEZsaWNraXR5RGlyZWN0aXZlKCR0aW1lb3V0LCBGbGlja2l0eVNlcnZpY2UpIHtcbiAgICAnbmdJbmplY3QnO1xuXG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgICAgc2NvcGU6IHt9LFxuICAgICAgICBiaW5kVG9Db250cm9sbGVyOiB7XG4gICAgICAgICAgICBiY0ZsaWNraXR5OiAnQD8nLFxuICAgICAgICAgICAgYmNGbGlja2l0eUlkOiAnQD8nXG4gICAgICAgIH0sXG4gICAgICAgIGNvbXBpbGU6IGZ1bmN0aW9uIGNvbXBpbGUoKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHByZTogcHJlTGlua0Z1bmN0aW9uLFxuICAgICAgICAgICAgICAgIHBvc3Q6IHBvc3RMaW5rRnVuY3Rpb25cbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG4gICAgICAgIGNvbnRyb2xsZXI6IF9mbGlja2l0eS5GbGlja2l0eUNvbnRyb2xsZXIsXG4gICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJ1xuICAgIH07XG5cbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuXG4gICAgZnVuY3Rpb24gcHJlTGlua0Z1bmN0aW9uKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycywgJGNvbnRyb2xsZXIpIHtcbiAgICAgICAgJ25nSW5qZWN0JztcblxuICAgICAgICAvLyBJZiBubyBJRCB3YXMgcGFzc2VkIGluXG5cbiAgICAgICAgaWYgKCEkY29udHJvbGxlci5iY0ZsaWNraXR5SWQpIHtcbiAgICAgICAgICAgIC8vIFVzZSB0aGUgZWxlbWVudCdzIElEIGlmIG9uZSBleGlzdHNcbiAgICAgICAgICAgIGlmICgkYXR0cnMuaWQpIHtcbiAgICAgICAgICAgICAgICAkY29udHJvbGxlci5iY0ZsaWNraXR5SWQgPSAkYXR0cnMuaWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQb3N0IExpbmtcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBwb3N0TGlua0Z1bmN0aW9uKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycywgJGNvbnRyb2xsZXIpIHtcbiAgICAgICAgJ25nSW5qZWN0JztcblxuICAgICAgICAvLyBNYWtlIHN1cmUgdGhpcyBgY3JlYXRlKClgIGdldHMgcGlja2VkIHVwIGluIHRoZSBuZXh0IGRpZ2VzdCBjeWNsZVxuXG4gICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSBGbGlja2l0eVxuICAgICAgICAgICAgRmxpY2tpdHlTZXJ2aWNlLmNyZWF0ZSgkZWxlbWVudFswXSwgJGNvbnRyb2xsZXIuYmNGbGlja2l0eUlkLCAkY29udHJvbGxlci5vcHRpb25zKS50aGVuKGZ1bmN0aW9uIChmbGlja2l0eUluc3RhbmNlKSB7XG5cbiAgICAgICAgICAgICAgICAvLyBFeHBvc2UgdGhlIEZsaWNraXR5IGluc3RhbmNlIGFuZCBJRFxuICAgICAgICAgICAgICAgICRjb250cm9sbGVyLkZsaWNraXR5ID0gZmxpY2tpdHlJbnN0YW5jZS5pbnN0YW5jZTtcbiAgICAgICAgICAgICAgICAkY29udHJvbGxlci5iY0ZsaWNraXR5SWQgPSBmbGlja2l0eUluc3RhbmNlLmlkO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFdoZW4gdGhlIGRpcmVjdGl2ZSBpcyBiZWluZyBkZXN0cm95ZWRcbiAgICAgICAgdmFyIG9uRGVzdHJveSA9ICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAvLyBNYWtlIHN1cmUgd2UgZGVzdHJveSB0aGUgRmxpY2tpdHkgaW5zdGFuY2VcbiAgICAgICAgICAgIEZsaWNraXR5U2VydmljZS5kZXN0cm95KCRjb250cm9sbGVyLmJjRmxpY2tpdHlJZCk7XG4gICAgICAgIH0pO1xuICAgIH1cbn0gLyogZ2xvYmFsIEZsaWNraXR5ICovXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvZmxpY2tpdHkuZGlyZWN0aXZlLmpzXG4gKiovIiwiLyogZ2xvYmFsIEZsaWNraXR5ICovXG5pbXBvcnQgeyBGbGlja2l0eUNvbnRyb2xsZXIgfSBmcm9tICcuL2ZsaWNraXR5LmNvbnRyb2xsZXInO1xuXG5leHBvcnQgZnVuY3Rpb24gRmxpY2tpdHlEaXJlY3RpdmUoXG4gICAgJHRpbWVvdXQsXG4gICAgRmxpY2tpdHlTZXJ2aWNlXG4pIHtcbiAgICAnbmdJbmplY3QnO1xuXG4gICAgY29uc3QgZGlyZWN0aXZlID0ge1xuICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICBzY29wZToge30sXG4gICAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHtcbiAgICAgICAgICAgIGJjRmxpY2tpdHk6ICdAPycsXG4gICAgICAgICAgICBiY0ZsaWNraXR5SWQ6ICdAPycsXG4gICAgICAgIH0sXG4gICAgICAgIGNvbXBpbGU6ICgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgcHJlOiBwcmVMaW5rRnVuY3Rpb24sXG4gICAgICAgICAgICAgICAgcG9zdDogcG9zdExpbmtGdW5jdGlvbixcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG4gICAgICAgIGNvbnRyb2xsZXI6IEZsaWNraXR5Q29udHJvbGxlcixcbiAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgIH07XG5cbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuXG5cbiAgICBmdW5jdGlvbiBwcmVMaW5rRnVuY3Rpb24oJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzLCAkY29udHJvbGxlcikge1xuICAgICAgICAnbmdJbmplY3QnO1xuXG4gICAgICAgIC8vIElmIG5vIElEIHdhcyBwYXNzZWQgaW5cbiAgICAgICAgaWYgKCEkY29udHJvbGxlci5iY0ZsaWNraXR5SWQpIHtcbiAgICAgICAgICAgIC8vIFVzZSB0aGUgZWxlbWVudCdzIElEIGlmIG9uZSBleGlzdHNcbiAgICAgICAgICAgIGlmICgkYXR0cnMuaWQpIHtcbiAgICAgICAgICAgICAgICAkY29udHJvbGxlci5iY0ZsaWNraXR5SWQgPSAkYXR0cnMuaWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFBvc3QgTGlua1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIHBvc3RMaW5rRnVuY3Rpb24oJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzLCAkY29udHJvbGxlcikge1xuICAgICAgICAnbmdJbmplY3QnO1xuXG4gICAgICAgIC8vIE1ha2Ugc3VyZSB0aGlzIGBjcmVhdGUoKWAgZ2V0cyBwaWNrZWQgdXAgaW4gdGhlIG5leHQgZGlnZXN0IGN5Y2xlXG4gICAgICAgICR0aW1lb3V0KCgpID0+IHtcblxuICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSBGbGlja2l0eVxuICAgICAgICAgICAgRmxpY2tpdHlTZXJ2aWNlLmNyZWF0ZSgkZWxlbWVudFswXSwgJGNvbnRyb2xsZXIuYmNGbGlja2l0eUlkLCAkY29udHJvbGxlci5vcHRpb25zKVxuICAgICAgICAgICAgICAgIC50aGVuKChmbGlja2l0eUluc3RhbmNlKSA9PiB7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gRXhwb3NlIHRoZSBGbGlja2l0eSBpbnN0YW5jZSBhbmQgSURcbiAgICAgICAgICAgICAgICAgICAgJGNvbnRyb2xsZXIuRmxpY2tpdHkgPSBmbGlja2l0eUluc3RhbmNlLmluc3RhbmNlO1xuICAgICAgICAgICAgICAgICAgICAkY29udHJvbGxlci5iY0ZsaWNraXR5SWQgPSBmbGlja2l0eUluc3RhbmNlLmlkO1xuXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIDtcblxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBXaGVuIHRoZSBkaXJlY3RpdmUgaXMgYmVpbmcgZGVzdHJveWVkXG4gICAgICAgIGNvbnN0IG9uRGVzdHJveSA9ICRzY29wZS4kb24oJyRkZXN0cm95JywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAvLyBNYWtlIHN1cmUgd2UgZGVzdHJveSB0aGUgRmxpY2tpdHkgaW5zdGFuY2VcbiAgICAgICAgICAgIEZsaWNraXR5U2VydmljZS5kZXN0cm95KCRjb250cm9sbGVyLmJjRmxpY2tpdHlJZCk7XG4gICAgICAgIH0pO1xuXG4gICAgfVxuXG5cbn1cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vfi9lc2xpbnQtbG9hZGVyIS4vc3JjL2ZsaWNraXR5LmRpcmVjdGl2ZS5qc1xuICoqLyIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG52YXIgRmxpY2tpdHlDb250cm9sbGVyID0gZXhwb3J0cy5GbGlja2l0eUNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRmxpY2tpdHlDb250cm9sbGVyKEZsaWNraXR5Q29uZmlnKSB7XG4gICAgICAgICduZ0luamVjdCc7XG5cbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEZsaWNraXR5Q29udHJvbGxlcik7XG5cbiAgICAgICAgdGhpcy5GbGlja2l0eUNvbmZpZyA9IEZsaWNraXR5Q29uZmlnO1xuXG4gICAgICAgIHRoaXMuX2FjdGl2YXRlKCk7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKEZsaWNraXR5Q29udHJvbGxlciwgW3tcbiAgICAgICAga2V5OiAnX2FjdGl2YXRlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9hY3RpdmF0ZSgpIHtcblxuICAgICAgICAgICAgLy8gRXh0ZW5kIHRoZSBkZWZhdWx0IG9wdGlvbnMgd2l0aCB1c2VyIGNvbmZpZ3VyYXRpb25cbiAgICAgICAgICAgIHRoaXMub3B0aW9ucyA9IGFuZ3VsYXIuZXh0ZW5kKHt9LCB0aGlzLkZsaWNraXR5Q29uZmlnLCBhbmd1bGFyLmZyb21Kc29uKHRoaXMuYmNGbGlja2l0eSB8IHt9KSk7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gRmxpY2tpdHlDb250cm9sbGVyO1xufSgpO1xuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2ZsaWNraXR5LmNvbnRyb2xsZXIuanNcbiAqKi8iLCJleHBvcnQgY2xhc3MgRmxpY2tpdHlDb250cm9sbGVyIHtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBGbGlja2l0eUNvbmZpZ1xuICAgICkge1xuICAgICAgICAnbmdJbmplY3QnO1xuXG4gICAgICAgIHRoaXMuRmxpY2tpdHlDb25maWcgPSBGbGlja2l0eUNvbmZpZztcblxuXG4gICAgICAgIHRoaXMuX2FjdGl2YXRlKCk7XG5cbiAgICB9XG5cblxuXG5cbiAgICBfYWN0aXZhdGUoKSB7XG5cbiAgICAgICAgLy8gRXh0ZW5kIHRoZSBkZWZhdWx0IG9wdGlvbnMgd2l0aCB1c2VyIGNvbmZpZ3VyYXRpb25cbiAgICAgICAgdGhpcy5vcHRpb25zID1cbiAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKHt9LCB0aGlzLkZsaWNraXR5Q29uZmlnLCBhbmd1bGFyLmZyb21Kc29uKHRoaXMuYmNGbGlja2l0eSB8IHt9KSk7XG5cbiAgICB9XG5cblxufVxuXG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL34vZXNsaW50LWxvYWRlciEuL3NyYy9mbGlja2l0eS5jb250cm9sbGVyLmpzXG4gKiovIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLkZsaWNraXR5TmV4dERpcmVjdGl2ZSA9IEZsaWNraXR5TmV4dERpcmVjdGl2ZTtcblxudmFyIF9uZXh0ID0gcmVxdWlyZSgnLi9uZXh0LmNvbnRyb2xsZXInKTtcblxuZnVuY3Rpb24gRmxpY2tpdHlOZXh0RGlyZWN0aXZlKCRsb2csICR0aW1lb3V0LCAkcm9vdFNjb3BlLCBGbGlja2l0eUNvbmZpZywgRmxpY2tpdHlTZXJ2aWNlKSB7XG4gICAgJ25nSW5qZWN0JztcblxuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgIHNjb3BlOiB7fSxcbiAgICAgICAgYmluZFRvQ29udHJvbGxlcjoge1xuICAgICAgICAgICAgYmNGbGlja2l0eU5leHQ6ICc9PycsXG4gICAgICAgICAgICBiY0ZsaWNraXR5SWQ6ICdAPydcbiAgICAgICAgfSxcbiAgICAgICAgY29tcGlsZTogZnVuY3Rpb24gY29tcGlsZSgpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgcHJlOiBwcmVMaW5rRnVuY3Rpb25cbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG4gICAgICAgIGNvbnRyb2xsZXI6IF9uZXh0Lk5leHRDb250cm9sbGVyLFxuICAgICAgICBjb250cm9sbGVyQXM6ICd2bSdcbiAgICB9O1xuXG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcblxuICAgIC8qKlxuICAgICAqIFByZSBMaW5rXG4gICAgICovXG4gICAgZnVuY3Rpb24gcHJlTGlua0Z1bmN0aW9uKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycywgJGNvbnRyb2xsZXIpIHtcbiAgICAgICAgJ25nSW5qZWN0JztcblxuICAgICAgICAvLyBHZXQgdGhlIElEXG5cbiAgICAgICAgdmFyIElEID0gJGNvbnRyb2xsZXIuZmxpY2tpdHlJZDtcblxuICAgICAgICAvLyBEZWZpbmUgdGhlIGJyb2FkY2FzdCBuYW1lcyB0byBsaXN0ZW4gZm9yXG4gICAgICAgIHZhciBzZWxlY3RFdmVudCA9ICdGbGlja2l0eTonICsgSUQgKyAnOmNlbGxTZWxlY3QnO1xuICAgICAgICB2YXIgc2V0dGxlRXZlbnQgPSAnRmxpY2tpdHk6JyArICRjb250cm9sbGVyLmZsaWNraXR5SWQgKyAnOnNldHRsZSc7XG5cbiAgICAgICAgLy8gTGlzdGVuXG4gICAgICAgIHZhciBjZWxsU2VsZWN0ID0gJHJvb3RTY29wZS4kb24oc2VsZWN0RXZlbnQsIGZ1bmN0aW9uIChldmVudCwgZGF0YSkge1xuICAgICAgICAgICAgX2Rpc2FibGVCdXR0b25JZk5lZWRlZChkYXRhLmluc3RhbmNlLmNlbGxzLmxlbmd0aCwgZGF0YS5pbnN0YW5jZS5zZWxlY3RlZEluZGV4ICsgMSk7XG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgc2V0dGxlID0gJHJvb3RTY29wZS4kb24oc2V0dGxlRXZlbnQsIGZ1bmN0aW9uIChldmVudCwgZGF0YSkge1xuICAgICAgICAgICAgX2Rpc2FibGVCdXR0b25JZk5lZWRlZChkYXRhLmluc3RhbmNlLmNlbGxzLmxlbmd0aCwgZGF0YS5pbnN0YW5jZS5zZWxlY3RlZEluZGV4ICsgMSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICRlbGVtZW50Lm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgLy8gTW92ZSB0byB0aGUgbmV4dCBjZWxsXG4gICAgICAgICAgICBGbGlja2l0eVNlcnZpY2UubmV4dCgkY29udHJvbGxlci5mbGlja2l0eUlkLCAkY29udHJvbGxlci53cmFwQXJvdW5kKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIERpc2FibGUgYnV0dG9uIGlmIG5lZWRlZFxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0ge0ludH0gaW5kZXhcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIF9kaXNhYmxlQnV0dG9uSWZOZWVkZWQoaW5kZXgsIGNlbGxDb3VudCkge1xuXG4gICAgICAgICAgICAvLyBEaXNhYmxlIGJ1dHRvbiBpZiBhdCB0aGUgYmVnaW5uaW5nIGFuZCB3ZSBzaG91bGRuJ3Qgd3JhcFxuICAgICAgICAgICAgaWYgKCEkY29udHJvbGxlci53cmFwQXJvdW5kICYmIGluZGV4ID09PSBjZWxsQ291bnQpIHtcbiAgICAgICAgICAgICAgICAkYXR0cnMuJHNldCgnZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJGF0dHJzLiRzZXQoJ2Rpc2FibGVkJywgZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL25leHQvZmxpY2tpdHlOZXh0LmRpcmVjdGl2ZS5qc1xuICoqLyIsImltcG9ydCB7IE5leHRDb250cm9sbGVyIH0gZnJvbSAnLi9uZXh0LmNvbnRyb2xsZXInO1xuXG5leHBvcnQgZnVuY3Rpb24gRmxpY2tpdHlOZXh0RGlyZWN0aXZlKFxuICAgICRsb2csICR0aW1lb3V0LCAkcm9vdFNjb3BlLFxuICAgIEZsaWNraXR5Q29uZmlnLCBGbGlja2l0eVNlcnZpY2Vcbikge1xuICAgICduZ0luamVjdCc7XG5cbiAgICBjb25zdCBkaXJlY3RpdmUgPSB7XG4gICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgIHNjb3BlOiB7fSxcbiAgICAgICAgYmluZFRvQ29udHJvbGxlcjoge1xuICAgICAgICAgICAgYmNGbGlja2l0eU5leHQ6ICc9PycsXG4gICAgICAgICAgICBiY0ZsaWNraXR5SWQ6ICdAPycsXG4gICAgICAgIH0sXG4gICAgICAgIGNvbXBpbGU6ICgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgcHJlOiBwcmVMaW5rRnVuY3Rpb24sXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgICBjb250cm9sbGVyOiBOZXh0Q29udHJvbGxlcixcbiAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgIH07XG5cbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuXG5cblxuXG4gICAgLyoqXG4gICAgICogUHJlIExpbmtcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBwcmVMaW5rRnVuY3Rpb24oXG4gICAgICAgICRzY29wZSwgJGVsZW1lbnQsICRhdHRycywgJGNvbnRyb2xsZXJcbiAgICApIHtcbiAgICAgICAgJ25nSW5qZWN0JztcblxuICAgICAgICAvLyBHZXQgdGhlIElEXG4gICAgICAgIGNvbnN0IElEID0gJGNvbnRyb2xsZXIuZmxpY2tpdHlJZDtcblxuICAgICAgICAvLyBEZWZpbmUgdGhlIGJyb2FkY2FzdCBuYW1lcyB0byBsaXN0ZW4gZm9yXG4gICAgICAgIGNvbnN0IHNlbGVjdEV2ZW50ID0gJ0ZsaWNraXR5OicgKyBJRCArICc6Y2VsbFNlbGVjdCc7XG4gICAgICAgIGNvbnN0IHNldHRsZUV2ZW50ID0gJ0ZsaWNraXR5OicgKyAkY29udHJvbGxlci5mbGlja2l0eUlkICsgJzpzZXR0bGUnO1xuXG4gICAgICAgIC8vIExpc3RlblxuICAgICAgICBjb25zdCBjZWxsU2VsZWN0ID0gJHJvb3RTY29wZS4kb24oc2VsZWN0RXZlbnQsIChldmVudCwgZGF0YSkgPT4ge1xuICAgICAgICAgICAgX2Rpc2FibGVCdXR0b25JZk5lZWRlZChkYXRhLmluc3RhbmNlLmNlbGxzLmxlbmd0aCwgZGF0YS5pbnN0YW5jZS5zZWxlY3RlZEluZGV4ICsgMSk7XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBzZXR0bGUgPSAkcm9vdFNjb3BlLiRvbihzZXR0bGVFdmVudCwgKGV2ZW50LCBkYXRhKSA9PiB7XG4gICAgICAgICAgICBfZGlzYWJsZUJ1dHRvbklmTmVlZGVkKGRhdGEuaW5zdGFuY2UuY2VsbHMubGVuZ3RoLCBkYXRhLmluc3RhbmNlLnNlbGVjdGVkSW5kZXggKyAxKTtcbiAgICAgICAgfSk7XG5cblxuICAgICAgICAkZWxlbWVudC5vbignY2xpY2snLCAoKSA9PiB7XG5cbiAgICAgICAgICAgIC8vIE1vdmUgdG8gdGhlIG5leHQgY2VsbFxuICAgICAgICAgICAgRmxpY2tpdHlTZXJ2aWNlLm5leHQoJGNvbnRyb2xsZXIuZmxpY2tpdHlJZCwgJGNvbnRyb2xsZXIud3JhcEFyb3VuZCk7XG5cbiAgICAgICAgfSk7XG5cblxuXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIERpc2FibGUgYnV0dG9uIGlmIG5lZWRlZFxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0ge0ludH0gaW5kZXhcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIF9kaXNhYmxlQnV0dG9uSWZOZWVkZWQoaW5kZXgsIGNlbGxDb3VudCkge1xuXG4gICAgICAgICAgICAvLyBEaXNhYmxlIGJ1dHRvbiBpZiBhdCB0aGUgYmVnaW5uaW5nIGFuZCB3ZSBzaG91bGRuJ3Qgd3JhcFxuICAgICAgICAgICAgaWYgKCEkY29udHJvbGxlci53cmFwQXJvdW5kICYmIGluZGV4ID09PSBjZWxsQ291bnQpIHtcbiAgICAgICAgICAgICAgICAkYXR0cnMuJHNldCgnZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJGF0dHJzLiRzZXQoJ2Rpc2FibGVkJywgZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG5cbn1cblxuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9+L2VzbGludC1sb2FkZXIhLi9zcmMvbmV4dC9mbGlja2l0eU5leHQuZGlyZWN0aXZlLmpzXG4gKiovIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciBOZXh0Q29udHJvbGxlciA9IGV4cG9ydHMuTmV4dENvbnRyb2xsZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gTmV4dENvbnRyb2xsZXIoJGxvZywgJHEsICR0aW1lb3V0LCBGbGlja2l0eUNvbmZpZywgRmxpY2tpdHlTZXJ2aWNlKSB7XG4gICAgICAgICduZ0luamVjdCc7XG5cbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE5leHRDb250cm9sbGVyKTtcblxuICAgICAgICB0aGlzLiRsb2cgPSAkbG9nO1xuICAgICAgICB0aGlzLiRxID0gJHE7XG4gICAgICAgIHRoaXMuJHRpbWVvdXQgPSAkdGltZW91dDtcbiAgICAgICAgdGhpcy5GbGlja2l0eUNvbmZpZyA9IEZsaWNraXR5Q29uZmlnO1xuICAgICAgICB0aGlzLkZsaWNraXR5U2VydmljZSA9IEZsaWNraXR5U2VydmljZTtcblxuICAgICAgICB0aGlzLl9hY3RpdmF0ZSgpO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhOZXh0Q29udHJvbGxlciwgW3tcbiAgICAgICAga2V5OiAnX2FjdGl2YXRlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9hY3RpdmF0ZSgpIHtcbiAgICAgICAgICAgIC8vIEFzc2lnbiBvciBmYWxsIGJhY2sgdG8gZGVmYXVsdFxuICAgICAgICAgICAgdGhpcy53cmFwQXJvdW5kID0gdGhpcy5iY0ZsaWNraXR5TmV4dCB8fCB0aGlzLkZsaWNraXR5Q29uZmlnLndyYXBBcm91bmQ7XG4gICAgICAgICAgICB0aGlzLmZsaWNraXR5SWQgPSBudWxsO1xuXG4gICAgICAgICAgICAvLyBNYWtlIHN1cmUgd2UgaGF2ZSBhbiBJRFxuICAgICAgICAgICAgdGhpcy5fc2V0SWQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTZXQgSUQgdG8gd2hhdCBpcyBkZWZpbmVkLCBmYWxsYmFjayB0byBmaXJzdCBpbnN0YW5jZVxuICAgICAgICAgKlxuICAgICAgICAgKiBAcmV0dXJuIHtTdHJpbmd9IGZsaWNraXR5SWRcbiAgICAgICAgICovXG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19zZXRJZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfc2V0SWQoKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgICAgICAgICByZXR1cm4gdGhpcy4kcShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuYmNGbGlja2l0eUlkKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmZsaWNraXR5SWQgPSBfdGhpcy5iY0ZsaWNraXR5SWQ7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoX3RoaXMuZmxpY2tpdHlJZCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuRmxpY2tpdHlTZXJ2aWNlLmdldEZpcnN0KCkudGhlbihmdW5jdGlvbiAoaW5zdGFuY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5mbGlja2l0eUlkID0gaW5zdGFuY2UuaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShfdGhpcy5mbGlja2l0eUlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLiRsb2cud2FybihlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBOZXh0Q29udHJvbGxlcjtcbn0oKTtcblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9uZXh0L25leHQuY29udHJvbGxlci5qc1xuICoqLyIsImV4cG9ydCBjbGFzcyBOZXh0Q29udHJvbGxlciB7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgJGxvZywgJHEsICR0aW1lb3V0LFxuICAgICAgICBGbGlja2l0eUNvbmZpZywgRmxpY2tpdHlTZXJ2aWNlXG4gICAgKSB7XG4gICAgICAgICduZ0luamVjdCc7XG5cbiAgICAgICAgdGhpcy4kbG9nID0gJGxvZztcbiAgICAgICAgdGhpcy4kcSA9ICRxO1xuICAgICAgICB0aGlzLiR0aW1lb3V0ID0gJHRpbWVvdXQ7XG4gICAgICAgIHRoaXMuRmxpY2tpdHlDb25maWcgPSBGbGlja2l0eUNvbmZpZztcbiAgICAgICAgdGhpcy5GbGlja2l0eVNlcnZpY2UgPSBGbGlja2l0eVNlcnZpY2U7XG5cblxuICAgICAgICB0aGlzLl9hY3RpdmF0ZSgpO1xuXG4gICAgfVxuXG5cblxuXG4gICAgX2FjdGl2YXRlKCkge1xuICAgICAgICAvLyBBc3NpZ24gb3IgZmFsbCBiYWNrIHRvIGRlZmF1bHRcbiAgICAgICAgdGhpcy53cmFwQXJvdW5kID0gdGhpcy5iY0ZsaWNraXR5TmV4dCB8fCB0aGlzLkZsaWNraXR5Q29uZmlnLndyYXBBcm91bmQ7XG4gICAgICAgIHRoaXMuZmxpY2tpdHlJZCA9IG51bGw7XG5cbiAgICAgICAgLy8gTWFrZSBzdXJlIHdlIGhhdmUgYW4gSURcbiAgICAgICAgdGhpcy5fc2V0SWQoKTtcblxuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogU2V0IElEIHRvIHdoYXQgaXMgZGVmaW5lZCwgZmFsbGJhY2sgdG8gZmlyc3QgaW5zdGFuY2VcbiAgICAgKlxuICAgICAqIEByZXR1cm4ge1N0cmluZ30gZmxpY2tpdHlJZFxuICAgICAqL1xuICAgIF9zZXRJZCgpIHtcblxuICAgICAgICByZXR1cm4gdGhpcy4kcSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmJjRmxpY2tpdHlJZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZmxpY2tpdHlJZCA9IHRoaXMuYmNGbGlja2l0eUlkO1xuICAgICAgICAgICAgICAgIHJlc29sdmUodGhpcy5mbGlja2l0eUlkKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy4kdGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuRmxpY2tpdHlTZXJ2aWNlLmdldEZpcnN0KClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKChpbnN0YW5jZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmxpY2tpdHlJZCA9IGluc3RhbmNlLmlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUodGhpcy5mbGlja2l0eUlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kbG9nLndhcm4oZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICA7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSk7XG5cbiAgICB9XG5cblxufVxuXG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL34vZXNsaW50LWxvYWRlciEuL3NyYy9uZXh0L25leHQuY29udHJvbGxlci5qc1xuICoqLyIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5GbGlja2l0eVByZXZpb3VzRGlyZWN0aXZlID0gRmxpY2tpdHlQcmV2aW91c0RpcmVjdGl2ZTtcblxudmFyIF9wcmV2aW91cyA9IHJlcXVpcmUoJy4vcHJldmlvdXMuY29udHJvbGxlcicpO1xuXG5mdW5jdGlvbiBGbGlja2l0eVByZXZpb3VzRGlyZWN0aXZlKCRsb2csICR0aW1lb3V0LCAkcm9vdFNjb3BlLCBGbGlja2l0eUNvbmZpZywgRmxpY2tpdHlTZXJ2aWNlKSB7XG4gICAgJ25nSW5qZWN0JztcblxuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgIHNjb3BlOiB7fSxcbiAgICAgICAgYmluZFRvQ29udHJvbGxlcjoge1xuICAgICAgICAgICAgYmNGbGlja2l0eVByZXZpb3VzOiAnPT8nLFxuICAgICAgICAgICAgYmNGbGlja2l0eUlkOiAnQD8nXG4gICAgICAgIH0sXG4gICAgICAgIGNvbXBpbGU6IGZ1bmN0aW9uIGNvbXBpbGUoKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHByZTogcHJlTGlua0Z1bmN0aW9uXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgICBjb250cm9sbGVyOiBfcHJldmlvdXMuUHJldmlvdXNDb250cm9sbGVyLFxuICAgICAgICBjb250cm9sbGVyQXM6ICd2bSdcbiAgICB9O1xuXG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcblxuICAgIC8qKlxuICAgICAqIFByZSBMaW5rXG4gICAgICovXG4gICAgZnVuY3Rpb24gcHJlTGlua0Z1bmN0aW9uKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycywgJGNvbnRyb2xsZXIpIHtcbiAgICAgICAgJ25nSW5qZWN0JztcblxuICAgICAgICAvLyBHZXQgdGhlIElEXG5cbiAgICAgICAgdmFyIElEID0gJGNvbnRyb2xsZXIuZmxpY2tpdHlJZDtcblxuICAgICAgICAvLyBEZWZpbmUgdGhlIGJyb2FkY2FzdCBuYW1lcyB0byBsaXN0ZW4gZm9yXG4gICAgICAgIHZhciBzZWxlY3RFdmVudCA9ICdGbGlja2l0eTonICsgSUQgKyAnOmNlbGxTZWxlY3QnO1xuICAgICAgICB2YXIgc2V0dGxlRXZlbnQgPSAnRmxpY2tpdHk6JyArICRjb250cm9sbGVyLmZsaWNraXR5SWQgKyAnOnNldHRsZSc7XG5cbiAgICAgICAgLy8gTGlzdGVuXG4gICAgICAgIHZhciBjZWxsU2VsZWN0ID0gJHJvb3RTY29wZS4kb24oc2VsZWN0RXZlbnQsIGZ1bmN0aW9uIChldmVudCwgZGF0YSkge1xuICAgICAgICAgICAgX2Rpc2FibGVCdXR0b25JZk5lZWRlZChkYXRhLmluc3RhbmNlLnNlbGVjdGVkSW5kZXgpO1xuICAgICAgICB9KTtcbiAgICAgICAgdmFyIHNldHRsZSA9ICRyb290U2NvcGUuJG9uKHNldHRsZUV2ZW50LCBmdW5jdGlvbiAoZXZlbnQsIGRhdGEpIHtcbiAgICAgICAgICAgIF9kaXNhYmxlQnV0dG9uSWZOZWVkZWQoZGF0YS5pbnN0YW5jZS5zZWxlY3RlZEluZGV4KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJGVsZW1lbnQub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAvLyBNb3ZlIHRvIHRoZSBuZXh0IGNlbGxcbiAgICAgICAgICAgIEZsaWNraXR5U2VydmljZS5wcmV2aW91cygkY29udHJvbGxlci5mbGlja2l0eUlkLCAkY29udHJvbGxlci53cmFwQXJvdW5kKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIERpc2FibGUgYnV0dG9uIGlmIG5lZWRlZFxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0ge0ludH0gaW5kZXhcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIF9kaXNhYmxlQnV0dG9uSWZOZWVkZWQoaW5kZXgpIHtcbiAgICAgICAgICAgIC8vIERpc2FibGUgYnV0dG9uIGlmIGF0IHRoZSBiZWdpbm5pbmcgYW5kIHdlIHNob3VsZG4ndCB3cmFwXG4gICAgICAgICAgICBpZiAoISRjb250cm9sbGVyLndyYXBBcm91bmQgJiYgaW5kZXggPT09IDApIHtcbiAgICAgICAgICAgICAgICAkYXR0cnMuJHNldCgnZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJGF0dHJzLiRzZXQoJ2Rpc2FibGVkJywgZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL3ByZXZpb3VzL2ZsaWNraXR5UHJldmlvdXMuZGlyZWN0aXZlLmpzXG4gKiovIiwiaW1wb3J0IHsgUHJldmlvdXNDb250cm9sbGVyIH0gZnJvbSAnLi9wcmV2aW91cy5jb250cm9sbGVyJztcblxuZXhwb3J0IGZ1bmN0aW9uIEZsaWNraXR5UHJldmlvdXNEaXJlY3RpdmUoXG4gICAgJGxvZywgJHRpbWVvdXQsICRyb290U2NvcGUsXG4gICAgRmxpY2tpdHlDb25maWcsIEZsaWNraXR5U2VydmljZVxuKSB7XG4gICAgJ25nSW5qZWN0JztcblxuICAgIGNvbnN0IGRpcmVjdGl2ZSA9IHtcbiAgICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgICAgc2NvcGU6IHt9LFxuICAgICAgICBiaW5kVG9Db250cm9sbGVyOiB7XG4gICAgICAgICAgICBiY0ZsaWNraXR5UHJldmlvdXM6ICc9PycsXG4gICAgICAgICAgICBiY0ZsaWNraXR5SWQ6ICdAPycsXG4gICAgICAgIH0sXG4gICAgICAgIGNvbXBpbGU6ICgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgcHJlOiBwcmVMaW5rRnVuY3Rpb24sXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgICBjb250cm9sbGVyOiBQcmV2aW91c0NvbnRyb2xsZXIsXG4gICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICB9O1xuXG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcblxuXG4gICAgLyoqXG4gICAgICogUHJlIExpbmtcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBwcmVMaW5rRnVuY3Rpb24oXG4gICAgICAgICRzY29wZSwgJGVsZW1lbnQsICRhdHRycywgJGNvbnRyb2xsZXJcbiAgICApIHtcbiAgICAgICAgJ25nSW5qZWN0JztcblxuICAgICAgICAvLyBHZXQgdGhlIElEXG4gICAgICAgIGNvbnN0IElEID0gJGNvbnRyb2xsZXIuZmxpY2tpdHlJZDtcblxuICAgICAgICAvLyBEZWZpbmUgdGhlIGJyb2FkY2FzdCBuYW1lcyB0byBsaXN0ZW4gZm9yXG4gICAgICAgIGNvbnN0IHNlbGVjdEV2ZW50ID0gJ0ZsaWNraXR5OicgKyBJRCArICc6Y2VsbFNlbGVjdCc7XG4gICAgICAgIGNvbnN0IHNldHRsZUV2ZW50ID0gJ0ZsaWNraXR5OicgKyAkY29udHJvbGxlci5mbGlja2l0eUlkICsgJzpzZXR0bGUnO1xuXG4gICAgICAgIC8vIExpc3RlblxuICAgICAgICBjb25zdCBjZWxsU2VsZWN0ID0gJHJvb3RTY29wZS4kb24oc2VsZWN0RXZlbnQsIChldmVudCwgZGF0YSkgPT4ge1xuICAgICAgICAgICAgX2Rpc2FibGVCdXR0b25JZk5lZWRlZChkYXRhLmluc3RhbmNlLnNlbGVjdGVkSW5kZXgpO1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc3Qgc2V0dGxlID0gJHJvb3RTY29wZS4kb24oc2V0dGxlRXZlbnQsIChldmVudCwgZGF0YSkgPT4ge1xuICAgICAgICAgICAgX2Rpc2FibGVCdXR0b25JZk5lZWRlZChkYXRhLmluc3RhbmNlLnNlbGVjdGVkSW5kZXgpO1xuICAgICAgICB9KTtcblxuXG4gICAgICAgICRlbGVtZW50Lm9uKCdjbGljaycsICgpID0+IHtcblxuICAgICAgICAgICAgLy8gTW92ZSB0byB0aGUgbmV4dCBjZWxsXG4gICAgICAgICAgICBGbGlja2l0eVNlcnZpY2UucHJldmlvdXMoJGNvbnRyb2xsZXIuZmxpY2tpdHlJZCwgJGNvbnRyb2xsZXIud3JhcEFyb3VuZCk7XG5cbiAgICAgICAgfSk7XG5cblxuXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIERpc2FibGUgYnV0dG9uIGlmIG5lZWRlZFxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0ge0ludH0gaW5kZXhcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIF9kaXNhYmxlQnV0dG9uSWZOZWVkZWQoaW5kZXgpIHtcbiAgICAgICAgICAgIC8vIERpc2FibGUgYnV0dG9uIGlmIGF0IHRoZSBiZWdpbm5pbmcgYW5kIHdlIHNob3VsZG4ndCB3cmFwXG4gICAgICAgICAgICBpZiAoISRjb250cm9sbGVyLndyYXBBcm91bmQgJiYgaW5kZXggPT09IDApIHtcbiAgICAgICAgICAgICAgICAkYXR0cnMuJHNldCgnZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJGF0dHJzLiRzZXQoJ2Rpc2FibGVkJywgZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICB9XG5cblxufVxuXG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL34vZXNsaW50LWxvYWRlciEuL3NyYy9wcmV2aW91cy9mbGlja2l0eVByZXZpb3VzLmRpcmVjdGl2ZS5qc1xuICoqLyIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG52YXIgUHJldmlvdXNDb250cm9sbGVyID0gZXhwb3J0cy5QcmV2aW91c0NvbnRyb2xsZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUHJldmlvdXNDb250cm9sbGVyKCRsb2csICRxLCAkdGltZW91dCwgRmxpY2tpdHlDb25maWcsIEZsaWNraXR5U2VydmljZSkge1xuICAgICAgICAnbmdJbmplY3QnO1xuXG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQcmV2aW91c0NvbnRyb2xsZXIpO1xuXG4gICAgICAgIHRoaXMuJGxvZyA9ICRsb2c7XG4gICAgICAgIHRoaXMuJHEgPSAkcTtcbiAgICAgICAgdGhpcy4kdGltZW91dCA9ICR0aW1lb3V0O1xuICAgICAgICB0aGlzLkZsaWNraXR5Q29uZmlnID0gRmxpY2tpdHlDb25maWc7XG4gICAgICAgIHRoaXMuRmxpY2tpdHlTZXJ2aWNlID0gRmxpY2tpdHlTZXJ2aWNlO1xuXG4gICAgICAgIHRoaXMuX2FjdGl2YXRlKCk7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKFByZXZpb3VzQ29udHJvbGxlciwgW3tcbiAgICAgICAga2V5OiAnX2FjdGl2YXRlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9hY3RpdmF0ZSgpIHtcbiAgICAgICAgICAgIC8vIEFzc2lnbiBvciBmYWxsIGJhY2sgdG8gZGVmYXVsdFxuICAgICAgICAgICAgdGhpcy53cmFwQXJvdW5kID0gdGhpcy5iY0ZsaWNraXR5UHJldmlvdXMgfHwgdGhpcy5GbGlja2l0eUNvbmZpZy53cmFwQXJvdW5kO1xuICAgICAgICAgICAgdGhpcy5mbGlja2l0eUlkID0gbnVsbDtcblxuICAgICAgICAgICAgLy8gTWFrZSBzdXJlIHdlIGhhdmUgYW4gSURcbiAgICAgICAgICAgIHRoaXMuX3NldElkKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogU2V0IElEIHRvIHdoYXQgaXMgZGVmaW5lZCwgZmFsbGJhY2sgdG8gZmlyc3QgaW5zdGFuY2VcbiAgICAgICAgICpcbiAgICAgICAgICogQHJldHVybiB7U3RyaW5nfSBmbGlja2l0eUlkXG4gICAgICAgICAqL1xuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfc2V0SWQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3NldElkKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHEoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLmJjRmxpY2tpdHlJZCkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5mbGlja2l0eUlkID0gX3RoaXMuYmNGbGlja2l0eUlkO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKF90aGlzLmZsaWNraXR5SWQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLiR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLkZsaWNraXR5U2VydmljZS5nZXRGaXJzdCgpLnRoZW4oZnVuY3Rpb24gKGluc3RhbmNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZmxpY2tpdHlJZCA9IGluc3RhbmNlLmlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoX3RoaXMuZmxpY2tpdHlJZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy4kbG9nLndhcm4oZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gUHJldmlvdXNDb250cm9sbGVyO1xufSgpO1xuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL3ByZXZpb3VzL3ByZXZpb3VzLmNvbnRyb2xsZXIuanNcbiAqKi8iLCJleHBvcnQgY2xhc3MgUHJldmlvdXNDb250cm9sbGVyIHtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICAkbG9nLCAkcSwgJHRpbWVvdXQsXG4gICAgICAgIEZsaWNraXR5Q29uZmlnLCBGbGlja2l0eVNlcnZpY2VcbiAgICApIHtcbiAgICAgICAgJ25nSW5qZWN0JztcblxuICAgICAgICB0aGlzLiRsb2cgPSAkbG9nO1xuICAgICAgICB0aGlzLiRxID0gJHE7XG4gICAgICAgIHRoaXMuJHRpbWVvdXQgPSAkdGltZW91dDtcbiAgICAgICAgdGhpcy5GbGlja2l0eUNvbmZpZyA9IEZsaWNraXR5Q29uZmlnO1xuICAgICAgICB0aGlzLkZsaWNraXR5U2VydmljZSA9IEZsaWNraXR5U2VydmljZTtcblxuXG4gICAgICAgIHRoaXMuX2FjdGl2YXRlKCk7XG5cbiAgICB9XG5cblxuXG5cbiAgICBfYWN0aXZhdGUoKSB7XG4gICAgICAgIC8vIEFzc2lnbiBvciBmYWxsIGJhY2sgdG8gZGVmYXVsdFxuICAgICAgICB0aGlzLndyYXBBcm91bmQgPSB0aGlzLmJjRmxpY2tpdHlQcmV2aW91cyB8fCB0aGlzLkZsaWNraXR5Q29uZmlnLndyYXBBcm91bmQ7XG4gICAgICAgIHRoaXMuZmxpY2tpdHlJZCA9IG51bGw7XG5cbiAgICAgICAgLy8gTWFrZSBzdXJlIHdlIGhhdmUgYW4gSURcbiAgICAgICAgdGhpcy5fc2V0SWQoKTtcblxuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogU2V0IElEIHRvIHdoYXQgaXMgZGVmaW5lZCwgZmFsbGJhY2sgdG8gZmlyc3QgaW5zdGFuY2VcbiAgICAgKlxuICAgICAqIEByZXR1cm4ge1N0cmluZ30gZmxpY2tpdHlJZFxuICAgICAqL1xuICAgIF9zZXRJZCgpIHtcblxuICAgICAgICByZXR1cm4gdGhpcy4kcSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmJjRmxpY2tpdHlJZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZmxpY2tpdHlJZCA9IHRoaXMuYmNGbGlja2l0eUlkO1xuICAgICAgICAgICAgICAgIHJlc29sdmUodGhpcy5mbGlja2l0eUlkKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy4kdGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuRmxpY2tpdHlTZXJ2aWNlLmdldEZpcnN0KClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKChpbnN0YW5jZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmxpY2tpdHlJZCA9IGluc3RhbmNlLmlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUodGhpcy5mbGlja2l0eUlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kbG9nLndhcm4oZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICA7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSk7XG5cbiAgICB9XG5cblxufVxuXG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL34vZXNsaW50LWxvYWRlciEuL3NyYy9wcmV2aW91cy9wcmV2aW91cy5jb250cm9sbGVyLmpzXG4gKiovIl0sInNvdXJjZVJvb3QiOiIifQ==